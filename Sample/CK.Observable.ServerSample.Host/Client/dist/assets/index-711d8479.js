var kn=Object.defineProperty;var Cn=(a,e,t)=>e in a?kn(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var ft=(a,e,t)=>(Cn(a,typeof e!="symbol"?e+"":e,t),t),_r=(a,e,t)=>{if(!e.has(a))throw TypeError("Cannot "+t)};var qt=(a,e,t)=>(_r(a,e,"read from private field"),t?t.call(a):e.get(a)),Vt=(a,e,t)=>{if(e.has(a))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(a):e.set(a,t)},wr=(a,e,t,l)=>(_r(a,e,"write to private field"),l?l.call(a,t):e.set(a,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))l(h);new MutationObserver(h=>{for(const r of h)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function t(h){const r={};return h.integrity&&(r.integrity=h.integrity),h.referrerPolicy&&(r.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?r.credentials="include":h.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(h){if(h.ep)return;h.ep=!0;const r=t(h);fetch(h.href,r)}})();function Vr(a,e){return function(){return a.apply(e,arguments)}}const{toString:Tn}=Object.prototype,{getPrototypeOf:lr}=Object,je=(a=>e=>{const t=Tn.call(e);return a[t]||(a[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Mt=a=>(a=a.toLowerCase(),e=>je(e)===a),Me=a=>e=>typeof e===a,{isArray:Qt}=Array,Xt=Me("undefined");function In(a){return a!==null&&!Xt(a)&&a.constructor!==null&&!Xt(a.constructor)&&Ot(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const zr=Mt("ArrayBuffer");function Rn(a){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(a):e=a&&a.buffer&&zr(a.buffer),e}const On=Me("string"),Ot=Me("function"),Kr=Me("number"),Ne=a=>a!==null&&typeof a=="object",Pn=a=>a===!0||a===!1,ue=a=>{if(je(a)!=="object")return!1;const e=lr(a);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)},xn=Mt("Date"),jn=Mt("File"),Mn=Mt("Blob"),Nn=Mt("FileList"),Ln=a=>Ne(a)&&Ot(a.pipe),Bn=a=>{let e;return a&&(typeof FormData=="function"&&a instanceof FormData||Ot(a.append)&&((e=je(a))==="formdata"||e==="object"&&Ot(a.toString)&&a.toString()==="[object FormData]"))},Dn=Mt("URLSearchParams"),Un=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function re(a,e,{allOwnKeys:t=!1}={}){if(a===null||typeof a>"u")return;let l,h;if(typeof a!="object"&&(a=[a]),Qt(a))for(l=0,h=a.length;l<h;l++)e.call(null,a[l],l,a);else{const r=t?Object.getOwnPropertyNames(a):Object.keys(a),s=r.length;let g;for(l=0;l<s;l++)g=r[l],e.call(null,a[g],g,a)}}function Gr(a,e){e=e.toLowerCase();const t=Object.keys(a);let l=t.length,h;for(;l-- >0;)if(h=t[l],e===h.toLowerCase())return h;return null}const Qr=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Yr=a=>!Xt(a)&&a!==Qr;function Qe(){const{caseless:a}=Yr(this)&&this||{},e={},t=(l,h)=>{const r=a&&Gr(e,h)||h;ue(e[r])&&ue(l)?e[r]=Qe(e[r],l):ue(l)?e[r]=Qe({},l):Qt(l)?e[r]=l.slice():e[r]=l};for(let l=0,h=arguments.length;l<h;l++)arguments[l]&&re(arguments[l],t);return e}const Fn=(a,e,t,{allOwnKeys:l}={})=>(re(e,(h,r)=>{t&&Ot(h)?a[r]=Vr(h,t):a[r]=h},{allOwnKeys:l}),a),Wn=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),$n=(a,e,t,l)=>{a.prototype=Object.create(e.prototype,l),a.prototype.constructor=a,Object.defineProperty(a,"super",{value:e.prototype}),t&&Object.assign(a.prototype,t)},Hn=(a,e,t,l)=>{let h,r,s;const g={};if(e=e||{},a==null)return e;do{for(h=Object.getOwnPropertyNames(a),r=h.length;r-- >0;)s=h[r],(!l||l(s,a,e))&&!g[s]&&(e[s]=a[s],g[s]=!0);a=t!==!1&&lr(a)}while(a&&(!t||t(a,e))&&a!==Object.prototype);return e},qn=(a,e,t)=>{a=String(a),(t===void 0||t>a.length)&&(t=a.length),t-=e.length;const l=a.indexOf(e,t);return l!==-1&&l===t},Vn=a=>{if(!a)return null;if(Qt(a))return a;let e=a.length;if(!Kr(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=a[e];return t},zn=(a=>e=>a&&e instanceof a)(typeof Uint8Array<"u"&&lr(Uint8Array)),Kn=(a,e)=>{const l=(a&&a[Symbol.iterator]).call(a);let h;for(;(h=l.next())&&!h.done;){const r=h.value;e.call(a,r[0],r[1])}},Gn=(a,e)=>{let t;const l=[];for(;(t=a.exec(e))!==null;)l.push(t);return l},Qn=Mt("HTMLFormElement"),Yn=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,l,h){return l.toUpperCase()+h}),vr=(({hasOwnProperty:a})=>(e,t)=>a.call(e,t))(Object.prototype),Jn=Mt("RegExp"),Jr=(a,e)=>{const t=Object.getOwnPropertyDescriptors(a),l={};re(t,(h,r)=>{let s;(s=e(h,r,a))!==!1&&(l[r]=s||h)}),Object.defineProperties(a,l)},Xn=a=>{Jr(a,(e,t)=>{if(Ot(a)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const l=a[t];if(Ot(l)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Zn=(a,e)=>{const t={},l=h=>{h.forEach(r=>{t[r]=!0})};return Qt(a)?l(a):l(String(a).split(e)),t},ti=()=>{},ei=(a,e)=>(a=+a,Number.isFinite(a)?a:e),$e="abcdefghijklmnopqrstuvwxyz",Sr="0123456789",Xr={DIGIT:Sr,ALPHA:$e,ALPHA_DIGIT:$e+$e.toUpperCase()+Sr},ri=(a=16,e=Xr.ALPHA_DIGIT)=>{let t="";const{length:l}=e;for(;a--;)t+=e[Math.random()*l|0];return t};function ni(a){return!!(a&&Ot(a.append)&&a[Symbol.toStringTag]==="FormData"&&a[Symbol.iterator])}const ii=a=>{const e=new Array(10),t=(l,h)=>{if(Ne(l)){if(e.indexOf(l)>=0)return;if(!("toJSON"in l)){e[h]=l;const r=Qt(l)?[]:{};return re(l,(s,g)=>{const d=t(s,h+1);!Xt(d)&&(r[g]=d)}),e[h]=void 0,r}}return l};return t(a,0)},oi=Mt("AsyncFunction"),si=a=>a&&(Ne(a)||Ot(a))&&Ot(a.then)&&Ot(a.catch),it={isArray:Qt,isArrayBuffer:zr,isBuffer:In,isFormData:Bn,isArrayBufferView:Rn,isString:On,isNumber:Kr,isBoolean:Pn,isObject:Ne,isPlainObject:ue,isUndefined:Xt,isDate:xn,isFile:jn,isBlob:Mn,isRegExp:Jn,isFunction:Ot,isStream:Ln,isURLSearchParams:Dn,isTypedArray:zn,isFileList:Nn,forEach:re,merge:Qe,extend:Fn,trim:Un,stripBOM:Wn,inherits:$n,toFlatObject:Hn,kindOf:je,kindOfTest:Mt,endsWith:qn,toArray:Vn,forEachEntry:Kn,matchAll:Gn,isHTMLForm:Qn,hasOwnProperty:vr,hasOwnProp:vr,reduceDescriptors:Jr,freezeMethods:Xn,toObjectSet:Zn,toCamelCase:Yn,noop:ti,toFiniteNumber:ei,findKey:Gr,global:Qr,isContextDefined:Yr,ALPHABET:Xr,generateString:ri,isSpecCompliantForm:ni,toJSONObject:ii,isAsyncFn:oi,isThenable:si};function bt(a,e,t,l,h){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=a,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),l&&(this.request=l),h&&(this.response=h)}it.inherits(bt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:it.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Zr=bt.prototype,tn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(a=>{tn[a]={value:a}});Object.defineProperties(bt,tn);Object.defineProperty(Zr,"isAxiosError",{value:!0});bt.from=(a,e,t,l,h,r)=>{const s=Object.create(Zr);return it.toFlatObject(a,s,function(d){return d!==Error.prototype},g=>g!=="isAxiosError"),bt.call(s,a.message,e,t,l,h),s.cause=a,s.name=a.name,r&&Object.assign(s,r),s};const ai=null;function Ye(a){return it.isPlainObject(a)||it.isArray(a)}function en(a){return it.endsWith(a,"[]")?a.slice(0,-2):a}function Er(a,e,t){return a?a.concat(e).map(function(h,r){return h=en(h),!t&&r?"["+h+"]":h}).join(t?".":""):e}function li(a){return it.isArray(a)&&!a.some(Ye)}const ci=it.toFlatObject(it,{},null,function(e){return/^is[A-Z]/.test(e)});function Le(a,e,t){if(!it.isObject(a))throw new TypeError("target must be an object");e=e||new FormData,t=it.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,y){return!it.isUndefined(y[b])});const l=t.metaTokens,h=t.visitor||f,r=t.dots,s=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&it.isSpecCompliantForm(e);if(!it.isFunction(h))throw new TypeError("visitor must be a function");function i(u){if(u===null)return"";if(it.isDate(u))return u.toISOString();if(!d&&it.isBlob(u))throw new bt("Blob is not supported. Use a Buffer instead.");return it.isArrayBuffer(u)||it.isTypedArray(u)?d&&typeof Blob=="function"?new Blob([u]):Buffer.from(u):u}function f(u,b,y){let w=u;if(u&&!y&&typeof u=="object"){if(it.endsWith(b,"{}"))b=l?b:b.slice(0,-2),u=JSON.stringify(u);else if(it.isArray(u)&&li(u)||(it.isFileList(u)||it.endsWith(b,"[]"))&&(w=it.toArray(u)))return b=en(b),w.forEach(function(k,j){!(it.isUndefined(k)||k===null)&&e.append(s===!0?Er([b],j,r):s===null?b:b+"[]",i(k))}),!1}return Ye(u)?!0:(e.append(Er(y,b,r),i(u)),!1)}const c=[],n=Object.assign(ci,{defaultVisitor:f,convertValue:i,isVisitable:Ye});function o(u,b){if(!it.isUndefined(u)){if(c.indexOf(u)!==-1)throw Error("Circular reference detected in "+b.join("."));c.push(u),it.forEach(u,function(w,S){(!(it.isUndefined(w)||w===null)&&h.call(e,w,it.isString(S)?S.trim():S,b,n))===!0&&o(w,b?b.concat(S):[S])}),c.pop()}}if(!it.isObject(a))throw new TypeError("data must be an object");return o(a),e}function Ar(a){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(l){return e[l]})}function cr(a,e){this._pairs=[],a&&Le(a,this,e)}const rn=cr.prototype;rn.append=function(e,t){this._pairs.push([e,t])};rn.toString=function(e){const t=e?function(l){return e.call(this,l,Ar)}:Ar;return this._pairs.map(function(h){return t(h[0])+"="+t(h[1])},"").join("&")};function ui(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function nn(a,e,t){if(!e)return a;const l=t&&t.encode||ui,h=t&&t.serialize;let r;if(h?r=h(e,t):r=it.isURLSearchParams(e)?e.toString():new cr(e,t).toString(l),r){const s=a.indexOf("#");s!==-1&&(a=a.slice(0,s)),a+=(a.indexOf("?")===-1?"?":"&")+r}return a}class hi{constructor(){this.handlers=[]}use(e,t,l){return this.handlers.push({fulfilled:e,rejected:t,synchronous:l?l.synchronous:!1,runWhen:l?l.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){it.forEach(this.handlers,function(l){l!==null&&e(l)})}}const kr=hi,on={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fi=typeof URLSearchParams<"u"?URLSearchParams:cr,di=typeof FormData<"u"?FormData:null,pi=typeof Blob<"u"?Blob:null,gi={isBrowser:!0,classes:{URLSearchParams:fi,FormData:di,Blob:pi},protocols:["http","https","file","blob","url","data"]},sn=typeof window<"u"&&typeof document<"u",bi=(a=>sn&&["ReactNative","NativeScript","NS"].indexOf(a)<0)(typeof navigator<"u"&&navigator.product),mi=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),yi=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sn,hasStandardBrowserEnv:bi,hasStandardBrowserWebWorkerEnv:mi},Symbol.toStringTag,{value:"Module"})),jt={...yi,...gi};function _i(a,e){return Le(a,new jt.classes.URLSearchParams,Object.assign({visitor:function(t,l,h,r){return jt.isNode&&it.isBuffer(t)?(this.append(l,t.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},e))}function wi(a){return it.matchAll(/\w+|\[(\w*)]/g,a).map(e=>e[0]==="[]"?"":e[1]||e[0])}function vi(a){const e={},t=Object.keys(a);let l;const h=t.length;let r;for(l=0;l<h;l++)r=t[l],e[r]=a[r];return e}function an(a){function e(t,l,h,r){let s=t[r++];if(s==="__proto__")return!0;const g=Number.isFinite(+s),d=r>=t.length;return s=!s&&it.isArray(h)?h.length:s,d?(it.hasOwnProp(h,s)?h[s]=[h[s],l]:h[s]=l,!g):((!h[s]||!it.isObject(h[s]))&&(h[s]=[]),e(t,l,h[s],r)&&it.isArray(h[s])&&(h[s]=vi(h[s])),!g)}if(it.isFormData(a)&&it.isFunction(a.entries)){const t={};return it.forEachEntry(a,(l,h)=>{e(wi(l),h,t,0)}),t}return null}function Si(a,e,t){if(it.isString(a))try{return(e||JSON.parse)(a),it.trim(a)}catch(l){if(l.name!=="SyntaxError")throw l}return(t||JSON.stringify)(a)}const ur={transitional:on,adapter:["xhr","http"],transformRequest:[function(e,t){const l=t.getContentType()||"",h=l.indexOf("application/json")>-1,r=it.isObject(e);if(r&&it.isHTMLForm(e)&&(e=new FormData(e)),it.isFormData(e))return h?JSON.stringify(an(e)):e;if(it.isArrayBuffer(e)||it.isBuffer(e)||it.isStream(e)||it.isFile(e)||it.isBlob(e))return e;if(it.isArrayBufferView(e))return e.buffer;if(it.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let g;if(r){if(l.indexOf("application/x-www-form-urlencoded")>-1)return _i(e,this.formSerializer).toString();if((g=it.isFileList(e))||l.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Le(g?{"files[]":e}:e,d&&new d,this.formSerializer)}}return r||h?(t.setContentType("application/json",!1),Si(e)):e}],transformResponse:[function(e){const t=this.transitional||ur.transitional,l=t&&t.forcedJSONParsing,h=this.responseType==="json";if(e&&it.isString(e)&&(l&&!this.responseType||h)){const s=!(t&&t.silentJSONParsing)&&h;try{return JSON.parse(e)}catch(g){if(s)throw g.name==="SyntaxError"?bt.from(g,bt.ERR_BAD_RESPONSE,this,null,this.response):g}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jt.classes.FormData,Blob:jt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};it.forEach(["delete","get","head","post","put","patch"],a=>{ur.headers[a]={}});const hr=ur,Ei=it.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ai=a=>{const e={};let t,l,h;return a&&a.split(`
`).forEach(function(s){h=s.indexOf(":"),t=s.substring(0,h).trim().toLowerCase(),l=s.substring(h+1).trim(),!(!t||e[t]&&Ei[t])&&(t==="set-cookie"?e[t]?e[t].push(l):e[t]=[l]:e[t]=e[t]?e[t]+", "+l:l)}),e},Cr=Symbol("internals");function Jt(a){return a&&String(a).trim().toLowerCase()}function he(a){return a===!1||a==null?a:it.isArray(a)?a.map(he):String(a)}function ki(a){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let l;for(;l=t.exec(a);)e[l[1]]=l[2];return e}const Ci=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function He(a,e,t,l,h){if(it.isFunction(l))return l.call(this,e,t);if(h&&(e=t),!!it.isString(e)){if(it.isString(l))return e.indexOf(l)!==-1;if(it.isRegExp(l))return l.test(e)}}function Ti(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,l)=>t.toUpperCase()+l)}function Ii(a,e){const t=it.toCamelCase(" "+e);["get","set","has"].forEach(l=>{Object.defineProperty(a,l+t,{value:function(h,r,s){return this[l].call(this,e,h,r,s)},configurable:!0})})}let Be=class{constructor(e){e&&this.set(e)}set(e,t,l){const h=this;function r(g,d,i){const f=Jt(d);if(!f)throw new Error("header name must be a non-empty string");const c=it.findKey(h,f);(!c||h[c]===void 0||i===!0||i===void 0&&h[c]!==!1)&&(h[c||d]=he(g))}const s=(g,d)=>it.forEach(g,(i,f)=>r(i,f,d));return it.isPlainObject(e)||e instanceof this.constructor?s(e,t):it.isString(e)&&(e=e.trim())&&!Ci(e)?s(Ai(e),t):e!=null&&r(t,e,l),this}get(e,t){if(e=Jt(e),e){const l=it.findKey(this,e);if(l){const h=this[l];if(!t)return h;if(t===!0)return ki(h);if(it.isFunction(t))return t.call(this,h,l);if(it.isRegExp(t))return t.exec(h);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Jt(e),e){const l=it.findKey(this,e);return!!(l&&this[l]!==void 0&&(!t||He(this,this[l],l,t)))}return!1}delete(e,t){const l=this;let h=!1;function r(s){if(s=Jt(s),s){const g=it.findKey(l,s);g&&(!t||He(l,l[g],g,t))&&(delete l[g],h=!0)}}return it.isArray(e)?e.forEach(r):r(e),h}clear(e){const t=Object.keys(this);let l=t.length,h=!1;for(;l--;){const r=t[l];(!e||He(this,this[r],r,e,!0))&&(delete this[r],h=!0)}return h}normalize(e){const t=this,l={};return it.forEach(this,(h,r)=>{const s=it.findKey(l,r);if(s){t[s]=he(h),delete t[r];return}const g=e?Ti(r):String(r).trim();g!==r&&delete t[r],t[g]=he(h),l[g]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return it.forEach(this,(l,h)=>{l!=null&&l!==!1&&(t[h]=e&&it.isArray(l)?l.join(", "):l)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const l=new this(e);return t.forEach(h=>l.set(h)),l}static accessor(e){const l=(this[Cr]=this[Cr]={accessors:{}}).accessors,h=this.prototype;function r(s){const g=Jt(s);l[g]||(Ii(h,s),l[g]=!0)}return it.isArray(e)?e.forEach(r):r(e),this}};Be.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);it.reduceDescriptors(Be.prototype,({value:a},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>a,set(l){this[t]=l}}});it.freezeMethods(Be);const Bt=Be;function qe(a,e){const t=this||hr,l=e||t,h=Bt.from(l.headers);let r=l.data;return it.forEach(a,function(g){r=g.call(t,r,h.normalize(),e?e.status:void 0)}),h.normalize(),r}function ln(a){return!!(a&&a.__CANCEL__)}function ne(a,e,t){bt.call(this,a??"canceled",bt.ERR_CANCELED,e,t),this.name="CanceledError"}it.inherits(ne,bt,{__CANCEL__:!0});function Ri(a,e,t){const l=t.config.validateStatus;!t.status||!l||l(t.status)?a(t):e(new bt("Request failed with status code "+t.status,[bt.ERR_BAD_REQUEST,bt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const Oi=jt.hasStandardBrowserEnv?{write(a,e,t,l,h,r){const s=[a+"="+encodeURIComponent(e)];it.isNumber(t)&&s.push("expires="+new Date(t).toGMTString()),it.isString(l)&&s.push("path="+l),it.isString(h)&&s.push("domain="+h),r===!0&&s.push("secure"),document.cookie=s.join("; ")},read(a){const e=document.cookie.match(new RegExp("(^|;\\s*)("+a+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(a){this.write(a,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Pi(a){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function xi(a,e){return e?a.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):a}function cn(a,e){return a&&!Pi(e)?xi(a,e):e}const ji=jt.hasStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let l;function h(r){let s=r;return e&&(t.setAttribute("href",s),s=t.href),t.setAttribute("href",s),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return l=h(window.location.href),function(s){const g=it.isString(s)?h(s):s;return g.protocol===l.protocol&&g.host===l.host}}():function(){return function(){return!0}}();function Mi(a){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return e&&e[1]||""}function Ni(a,e){a=a||10;const t=new Array(a),l=new Array(a);let h=0,r=0,s;return e=e!==void 0?e:1e3,function(d){const i=Date.now(),f=l[r];s||(s=i),t[h]=d,l[h]=i;let c=r,n=0;for(;c!==h;)n+=t[c++],c=c%a;if(h=(h+1)%a,h===r&&(r=(r+1)%a),i-s<e)return;const o=f&&i-f;return o?Math.round(n*1e3/o):void 0}}function Tr(a,e){let t=0;const l=Ni(50,250);return h=>{const r=h.loaded,s=h.lengthComputable?h.total:void 0,g=r-t,d=l(g),i=r<=s;t=r;const f={loaded:r,total:s,progress:s?r/s:void 0,bytes:g,rate:d||void 0,estimated:d&&s&&i?(s-r)/d:void 0,event:h};f[e?"download":"upload"]=!0,a(f)}}const Li=typeof XMLHttpRequest<"u",Bi=Li&&function(a){return new Promise(function(t,l){let h=a.data;const r=Bt.from(a.headers).normalize();let{responseType:s,withXSRFToken:g}=a,d;function i(){a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let f;if(it.isFormData(h)){if(jt.hasStandardBrowserEnv||jt.hasStandardBrowserWebWorkerEnv)r.setContentType(!1);else if((f=r.getContentType())!==!1){const[b,...y]=f?f.split(";").map(w=>w.trim()).filter(Boolean):[];r.setContentType([b||"multipart/form-data",...y].join("; "))}}let c=new XMLHttpRequest;if(a.auth){const b=a.auth.username||"",y=a.auth.password?unescape(encodeURIComponent(a.auth.password)):"";r.set("Authorization","Basic "+btoa(b+":"+y))}const n=cn(a.baseURL,a.url);c.open(a.method.toUpperCase(),nn(n,a.params,a.paramsSerializer),!0),c.timeout=a.timeout;function o(){if(!c)return;const b=Bt.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),w={data:!s||s==="text"||s==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:b,config:a,request:c};Ri(function(k){t(k),i()},function(k){l(k),i()},w),c=null}if("onloadend"in c?c.onloadend=o:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(o)},c.onabort=function(){c&&(l(new bt("Request aborted",bt.ECONNABORTED,a,c)),c=null)},c.onerror=function(){l(new bt("Network Error",bt.ERR_NETWORK,a,c)),c=null},c.ontimeout=function(){let y=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const w=a.transitional||on;a.timeoutErrorMessage&&(y=a.timeoutErrorMessage),l(new bt(y,w.clarifyTimeoutError?bt.ETIMEDOUT:bt.ECONNABORTED,a,c)),c=null},jt.hasStandardBrowserEnv&&(g&&it.isFunction(g)&&(g=g(a)),g||g!==!1&&ji(n))){const b=a.xsrfHeaderName&&a.xsrfCookieName&&Oi.read(a.xsrfCookieName);b&&r.set(a.xsrfHeaderName,b)}h===void 0&&r.setContentType(null),"setRequestHeader"in c&&it.forEach(r.toJSON(),function(y,w){c.setRequestHeader(w,y)}),it.isUndefined(a.withCredentials)||(c.withCredentials=!!a.withCredentials),s&&s!=="json"&&(c.responseType=a.responseType),typeof a.onDownloadProgress=="function"&&c.addEventListener("progress",Tr(a.onDownloadProgress,!0)),typeof a.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Tr(a.onUploadProgress)),(a.cancelToken||a.signal)&&(d=b=>{c&&(l(!b||b.type?new ne(null,a,c):b),c.abort(),c=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const u=Mi(n);if(u&&jt.protocols.indexOf(u)===-1){l(new bt("Unsupported protocol "+u+":",bt.ERR_BAD_REQUEST,a));return}c.send(h||null)})},Je={http:ai,xhr:Bi};it.forEach(Je,(a,e)=>{if(a){try{Object.defineProperty(a,"name",{value:e})}catch{}Object.defineProperty(a,"adapterName",{value:e})}});const Ir=a=>`- ${a}`,Di=a=>it.isFunction(a)||a===null||a===!1,un={getAdapter:a=>{a=it.isArray(a)?a:[a];const{length:e}=a;let t,l;const h={};for(let r=0;r<e;r++){t=a[r];let s;if(l=t,!Di(t)&&(l=Je[(s=String(t)).toLowerCase()],l===void 0))throw new bt(`Unknown adapter '${s}'`);if(l)break;h[s||"#"+r]=l}if(!l){const r=Object.entries(h).map(([g,d])=>`adapter ${g} `+(d===!1?"is not supported by the environment":"is not available in the build"));let s=e?r.length>1?`since :
`+r.map(Ir).join(`
`):" "+Ir(r[0]):"as no adapter specified";throw new bt("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return l},adapters:Je};function Ve(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new ne(null,a)}function Rr(a){return Ve(a),a.headers=Bt.from(a.headers),a.data=qe.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),un.getAdapter(a.adapter||hr.adapter)(a).then(function(l){return Ve(a),l.data=qe.call(a,a.transformResponse,l),l.headers=Bt.from(l.headers),l},function(l){return ln(l)||(Ve(a),l&&l.response&&(l.response.data=qe.call(a,a.transformResponse,l.response),l.response.headers=Bt.from(l.response.headers))),Promise.reject(l)})}const Or=a=>a instanceof Bt?a.toJSON():a;function zt(a,e){e=e||{};const t={};function l(i,f,c){return it.isPlainObject(i)&&it.isPlainObject(f)?it.merge.call({caseless:c},i,f):it.isPlainObject(f)?it.merge({},f):it.isArray(f)?f.slice():f}function h(i,f,c){if(it.isUndefined(f)){if(!it.isUndefined(i))return l(void 0,i,c)}else return l(i,f,c)}function r(i,f){if(!it.isUndefined(f))return l(void 0,f)}function s(i,f){if(it.isUndefined(f)){if(!it.isUndefined(i))return l(void 0,i)}else return l(void 0,f)}function g(i,f,c){if(c in e)return l(i,f);if(c in a)return l(void 0,i)}const d={url:r,method:r,data:r,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:g,headers:(i,f)=>h(Or(i),Or(f),!0)};return it.forEach(Object.keys(Object.assign({},a,e)),function(f){const c=d[f]||h,n=c(a[f],e[f],f);it.isUndefined(n)&&c!==g||(t[f]=n)}),t}const hn="1.6.7",fr={};["object","boolean","number","function","string","symbol"].forEach((a,e)=>{fr[a]=function(l){return typeof l===a||"a"+(e<1?"n ":" ")+a}});const Pr={};fr.transitional=function(e,t,l){function h(r,s){return"[Axios v"+hn+"] Transitional option '"+r+"'"+s+(l?". "+l:"")}return(r,s,g)=>{if(e===!1)throw new bt(h(s," has been removed"+(t?" in "+t:"")),bt.ERR_DEPRECATED);return t&&!Pr[s]&&(Pr[s]=!0,console.warn(h(s," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(r,s,g):!0}};function Ui(a,e,t){if(typeof a!="object")throw new bt("options must be an object",bt.ERR_BAD_OPTION_VALUE);const l=Object.keys(a);let h=l.length;for(;h-- >0;){const r=l[h],s=e[r];if(s){const g=a[r],d=g===void 0||s(g,r,a);if(d!==!0)throw new bt("option "+r+" must be "+d,bt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new bt("Unknown option "+r,bt.ERR_BAD_OPTION)}}const Xe={assertOptions:Ui,validators:fr},Ut=Xe.validators;let pe=class{constructor(e){this.defaults=e,this.interceptors={request:new kr,response:new kr}}async request(e,t){try{return await this._request(e,t)}catch(l){if(l instanceof Error){let h;Error.captureStackTrace?Error.captureStackTrace(h={}):h=new Error;const r=h.stack?h.stack.replace(/^.+\n/,""):"";l.stack?r&&!String(l.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(l.stack+=`
`+r):l.stack=r}throw l}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=zt(this.defaults,t);const{transitional:l,paramsSerializer:h,headers:r}=t;l!==void 0&&Xe.assertOptions(l,{silentJSONParsing:Ut.transitional(Ut.boolean),forcedJSONParsing:Ut.transitional(Ut.boolean),clarifyTimeoutError:Ut.transitional(Ut.boolean)},!1),h!=null&&(it.isFunction(h)?t.paramsSerializer={serialize:h}:Xe.assertOptions(h,{encode:Ut.function,serialize:Ut.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=r&&it.merge(r.common,r[t.method]);r&&it.forEach(["delete","get","head","post","put","patch","common"],u=>{delete r[u]}),t.headers=Bt.concat(s,r);const g=[];let d=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(t)===!1||(d=d&&b.synchronous,g.unshift(b.fulfilled,b.rejected))});const i=[];this.interceptors.response.forEach(function(b){i.push(b.fulfilled,b.rejected)});let f,c=0,n;if(!d){const u=[Rr.bind(this),void 0];for(u.unshift.apply(u,g),u.push.apply(u,i),n=u.length,f=Promise.resolve(t);c<n;)f=f.then(u[c++],u[c++]);return f}n=g.length;let o=t;for(c=0;c<n;){const u=g[c++],b=g[c++];try{o=u(o)}catch(y){b.call(this,y);break}}try{f=Rr.call(this,o)}catch(u){return Promise.reject(u)}for(c=0,n=i.length;c<n;)f=f.then(i[c++],i[c++]);return f}getUri(e){e=zt(this.defaults,e);const t=cn(e.baseURL,e.url);return nn(t,e.params,e.paramsSerializer)}};it.forEach(["delete","get","head","options"],function(e){pe.prototype[e]=function(t,l){return this.request(zt(l||{},{method:e,url:t,data:(l||{}).data}))}});it.forEach(["post","put","patch"],function(e){function t(l){return function(r,s,g){return this.request(zt(g||{},{method:e,headers:l?{"Content-Type":"multipart/form-data"}:{},url:r,data:s}))}}pe.prototype[e]=t(),pe.prototype[e+"Form"]=t(!0)});const fe=pe;let Fi=class fn{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(r){t=r});const l=this;this.promise.then(h=>{if(!l._listeners)return;let r=l._listeners.length;for(;r-- >0;)l._listeners[r](h);l._listeners=null}),this.promise.then=h=>{let r;const s=new Promise(g=>{l.subscribe(g),r=g}).then(h);return s.cancel=function(){l.unsubscribe(r)},s},e(function(r,s,g){l.reason||(l.reason=new ne(r,s,g),t(l.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new fn(function(h){e=h}),cancel:e}}};const Wi=Fi;function $i(a){return function(t){return a.apply(null,t)}}function Hi(a){return it.isObject(a)&&a.isAxiosError===!0}const Ze={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ze).forEach(([a,e])=>{Ze[e]=a});const qi=Ze;function dn(a){const e=new fe(a),t=Vr(fe.prototype.request,e);return it.extend(t,fe.prototype,e,{allOwnKeys:!0}),it.extend(t,e,null,{allOwnKeys:!0}),t.create=function(h){return dn(zt(a,h))},t}const wt=dn(hr);wt.Axios=fe;wt.CanceledError=ne;wt.CancelToken=Wi;wt.isCancel=ln;wt.VERSION=hn;wt.toFormData=Le;wt.AxiosError=bt;wt.Cancel=wt.CanceledError;wt.all=function(e){return Promise.all(e)};wt.spread=$i;wt.isAxiosError=Hi;wt.mergeConfig=zt;wt.AxiosHeaders=Bt;wt.formToJSON=a=>an(it.isHTMLForm(a)?new FormData(a):a);wt.getAdapter=un.getAdapter;wt.HttpStatusCode=qi;wt.default=wt;const pn=wt,{Axios:Xo,AxiosError:Zo,CanceledError:ts,isCancel:es,CancelToken:rs,VERSION:ns,all:is,Cancel:os,isAxiosError:ss,spread:as,toFormData:ls,AxiosHeaders:Vi,HttpStatusCode:cs,formToJSON:us,getAdapter:hs,mergeConfig:fs}=pn;var xt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function oe(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var gn={exports:{}};(function(a,e){(function(t){a.exports=t()})(function(){return function t(l,h,r){function s(i,f){if(!h[i]){if(!l[i]){var c=typeof oe=="function"&&oe;if(!f&&c)return c(i,!0);if(g)return g(i,!0);var n=new Error("Cannot find module '"+i+"'");throw n.code="MODULE_NOT_FOUND",n}var o=h[i]={exports:{}};l[i][0].call(o.exports,function(u){return s(l[i][1][u]||u)},o,o.exports,t,l,h,r)}return h[i].exports}for(var g=typeof oe=="function"&&oe,d=0;d<r.length;d++)s(r[d]);return s}({1:[function(t,l,h){var r=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(h,"__esModule",{value:!0}),h.TypedEventEmitter=void 0;const s=r(t("events")),g=t("./shared");class d{}h.TypedEventEmitter=d,(0,g.applyMixin)(d,s.default)},{"./shared":17,events:49}],2:[function(t,l,h){(function(r,s){(function(){var g=this&&this.__createBinding||(Object.create?function(W,_,R,T){T===void 0&&(T=R);var Y=Object.getOwnPropertyDescriptor(_,R);Y&&!("get"in Y?!_.__esModule:Y.writable||Y.configurable)||(Y={enumerable:!0,get:function(){return _[R]}}),Object.defineProperty(W,T,Y)}:function(W,_,R,T){T===void 0&&(T=R),W[T]=_[R]}),d=this&&this.__setModuleDefault||(Object.create?function(W,_){Object.defineProperty(W,"default",{enumerable:!0,value:_})}:function(W,_){W.default=_}),i=this&&this.__importStar||function(W){if(W&&W.__esModule)return W;var _={};if(W!=null)for(var R in W)R!=="default"&&Object.prototype.hasOwnProperty.call(W,R)&&g(_,W,R);return d(_,W),_},f=this&&this.__importDefault||function(W){return W&&W.__esModule?W:{default:W}};Object.defineProperty(h,"__esModule",{value:!0});const c=f(t("./topic-alias-recv")),n=f(t("mqtt-packet")),o=f(t("./default-message-id-provider")),u=t("readable-stream"),b=f(t("reinterval")),y=f(t("rfdc/default")),w=i(t("./validations")),S=f(t("debug")),k=f(t("./store")),j=f(t("./handlers")),L=t("./TypedEmitter"),I=r?r.nextTick:W=>{setTimeout(W,0)},A=s.setImmediate||((...W)=>{const _=W.shift();I(()=>{_(...W)})}),E={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:3e4,clean:!0,resubscribe:!0,writeCache:!0},N=["ECONNREFUSED","EADDRINUSE","ECONNRESET","ENOTFOUND","ETIMEDOUT"];class G extends L.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(_,R){super(),this.options=R||{};for(const T in E)this.options[T]===void 0?this.options[T]=E[T]:this.options[T]=R[T];this.log=this.options.log||(0,S.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: options.protocol",R.protocol),this.log("MqttClient :: options.protocolVersion",R.protocolVersion),this.log("MqttClient :: options.username",R.username),this.log("MqttClient :: options.keepalive",R.keepalive),this.log("MqttClient :: options.reconnectPeriod",R.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",R.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",R.properties?R.properties.topicAliasMaximum:void 0),this.options.clientId=typeof R.clientId=="string"?R.clientId:G.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=R.protocolVersion===5&&R.customHandleAcks?R.customHandleAcks:(...T)=>{T[3](null,0)},this.options.writeCache||(n.default.writeToStream.cacheNumbers=!1),this.streamBuilder=_,this.messageIdProvider=this.options.messageIdProvider===void 0?new o.default:this.options.messageIdProvider,this.outgoingStore=R.outgoingStore||new k.default,this.incomingStore=R.incomingStore||new k.default,this.queueQoSZero=R.queueQoSZero===void 0||R.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.pingTimer=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,R.properties&&R.properties.topicAliasMaximum>0&&(R.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new c.default(R.properties.topicAliasMaximum)),this.on("connect",()=>{const{queue:T}=this,Y=()=>{const J=T.shift();this.log("deliver :: entry %o",J);let et=null;if(!J)return void this._resubscribe();et=J.packet,this.log("deliver :: call _sendPacket for %o",et);let M=!0;et.messageId&&et.messageId!==0&&(this.messageIdProvider.register(et.messageId)||(M=!1)),M?this._sendPacket(et,C=>{J.cb&&J.cb(C),Y()}):(this.log("messageId: %d has already used. The message is skipped and removed.",et.messageId),Y())};this.log("connect :: sending queued packets"),Y()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this.log("close :: clearing ping timer"),this.pingTimer!==null&&(this.pingTimer.clear(),this.pingTimer=null),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(_,R){R()}handleMessage(_,R){R()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var _;const R=new u.Writable,T=n.default.parser(this.options);let Y=null;const J=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),T.on("packet",x=>{this.log("parser :: on packet push to packets array."),J.push(x)});const et=()=>{this.log("work :: getting next packet in queue");const x=J.shift();if(x)this.log("work :: packet pulled from queue"),(0,j.default)(this,x,M);else{this.log("work :: no packets in queue");const z=Y;Y=null,this.log("work :: done flag is %s",!!z),z&&z()}},M=()=>{if(J.length)I(et);else{const x=Y;Y=null,x()}};R._write=(x,z,B)=>{Y=B,this.log("writable stream :: parsing buffer"),T.parse(x),et()},this.log("connect :: pipe stream to writable stream"),this.stream.pipe(R),this.stream.on("error",x=>{this.log("streamErrorHandler :: error",x.message),N.includes(x.code)?(this.log("streamErrorHandler :: emitting error"),this.emit("error",x)):this.noop(x)}),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");const C={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(C.will=Object.assign(Object.assign({},this.options.will),{payload:(_=this.options.will)===null||_===void 0?void 0:_.payload})),this.topicAliasRecv&&(C.properties||(C.properties={}),this.topicAliasRecv&&(C.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(C),T.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){const x=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(x)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this._cleanUp(!0)},this.options.connectTimeout),this}publish(_,R,T,Y){this.log("publish :: message `%s` to topic `%s`",R,_);const{options:J}=this;typeof T=="function"&&(Y=T,T=null),T=T||{},T=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),T);const{qos:et,retain:M,dup:C,properties:x,cbStorePut:z}=T;if(this._checkDisconnecting(Y))return this;const B=()=>{let V=0;if((et===1||et===2)&&(V=this._nextId(),V===null))return this.log("No messageId left"),!1;const $={cmd:"publish",topic:_,payload:R,qos:et,retain:M,messageId:V,dup:C};switch(J.protocolVersion===5&&($.properties=x),this.log("publish :: qos",et),et){case 1:case 2:this.outgoing[$.messageId]={volatile:!1,cb:Y||this.noop},this.log("MqttClient:publish: packet cmd: %s",$.cmd),this._sendPacket($,void 0,z);break;default:this.log("MqttClient:publish: packet cmd: %s",$.cmd),this._sendPacket($,Y,z)}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!B())&&this._storeProcessingQueue.push({invoke:B,cbStorePut:T.cbStorePut,callback:Y}),this}publishAsync(_,R,T){return new Promise((Y,J)=>{this.publish(_,R,T,(et,M)=>{et?J(et):Y(M)})})}subscribe(_,R,T){const Y=this.options.protocolVersion;typeof R=="function"&&(T=R),T=T||this.noop;let J=!1,et=[];typeof _=="string"?et=_=[_]:Array.isArray(_)?et=_:typeof _=="object"&&(J=_.resubscribe,delete _.resubscribe,et=Object.keys(_));const M=w.validateTopics(et);if(M!==null)return A(T,new Error(`Invalid topic ${M}`)),this;if(this._checkDisconnecting(T))return this.log("subscribe: discconecting true"),this;const C={qos:0};Y===5&&(C.nl=!1,C.rap=!1,C.rh=0);const x=(R=Object.assign(Object.assign({},C),R)).properties,z=[],B=($,H)=>{if(H=H||R,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,$)||this._resubscribeTopics[$].qos<H.qos||J){const Z={topic:$,qos:H.qos};Y===5&&(Z.nl=H.nl,Z.rap=H.rap,Z.rh=H.rh,Z.properties=x),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",Z.topic,Z.qos),z.push(Z)}};if(Array.isArray(_)?_.forEach($=>{this.log("subscribe: array topic %s",$),B($)}):Object.keys(_).forEach($=>{this.log("subscribe: object topic %s, %o",$,_[$]),B($,_[$])}),!z.length)return T(null,[]),this;const V=()=>{const $=this._nextId();if($===null)return this.log("No messageId left"),!1;const H={cmd:"subscribe",subscriptions:z,messageId:$};if(x&&(H.properties=x),this.options.resubscribe){this.log("subscribe :: resubscribe true");const Z=[];z.forEach(X=>{if(this.options.reconnectPeriod>0){const tt={qos:X.qos};Y===5&&(tt.nl=X.nl||!1,tt.rap=X.rap||!1,tt.rh=X.rh||0,tt.properties=X.properties),this._resubscribeTopics[X.topic]=tt,Z.push(X.topic)}}),this.messageIdToTopic[H.messageId]=Z}return this.outgoing[H.messageId]={volatile:!0,cb(Z,X){if(!Z){const{granted:tt}=X;for(let O=0;O<tt.length;O+=1)z[O].qos=tt[O]}T(Z,z)}},this.log("subscribe :: call _sendPacket"),this._sendPacket(H),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!V())&&this._storeProcessingQueue.push({invoke:V,callback:T}),this}subscribeAsync(_,R){return new Promise((T,Y)=>{this.subscribe(_,R,(J,et)=>{J?Y(J):T(et)})})}unsubscribe(_,R,T){typeof _=="string"&&(_=[_]),typeof R=="function"&&(T=R),T=T||this.noop;const Y=w.validateTopics(_);if(Y!==null)return A(T,new Error(`Invalid topic ${Y}`)),this;if(this._checkDisconnecting(T))return this;const J=()=>{const et=this._nextId();if(et===null)return this.log("No messageId left"),!1;const M={cmd:"unsubscribe",messageId:et,unsubscriptions:[]};return typeof _=="string"?M.unsubscriptions=[_]:Array.isArray(_)&&(M.unsubscriptions=_),this.options.resubscribe&&M.unsubscriptions.forEach(C=>{delete this._resubscribeTopics[C]}),typeof R=="object"&&R.properties&&(M.properties=R.properties),this.outgoing[M.messageId]={volatile:!0,cb:T},this.log("unsubscribe: call _sendPacket"),this._sendPacket(M),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!J())&&this._storeProcessingQueue.push({invoke:J,callback:T}),this}unsubscribeAsync(_,R){return new Promise((T,Y)=>{this.unsubscribe(_,R,(J,et)=>{J?Y(J):T(et)})})}end(_,R,T){this.log("end :: (%s)",this.options.clientId),_!=null&&typeof _=="boolean"||(T=T||R,R=_,_=!1),typeof R!="object"&&(T=T||R,R=null),this.log("end :: cb? %s",!!T),T&&typeof T=="function"||(T=this.noop);const Y=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(et=>{this.outgoingStore.close(M=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),T){const C=et||M;this.log("end :: closeStores: invoking callback with args"),T(C)}})}),this._deferredReconnect&&this._deferredReconnect()},J=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,_),this._cleanUp(_,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),I(Y)},R)};return this.disconnecting?(T(),this):(this._clearReconnect(),this.disconnecting=!0,!_&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,J,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),J()),this)}endAsync(_,R){return new Promise((T,Y)=>{this.end(_,R,J=>{J?Y(J):T()})})}removeOutgoingMessage(_){if(this.outgoing[_]){const{cb:R}=this.outgoing[_];this._removeOutgoingAndStoreMessage(_,()=>{R(new Error("Message removed"))})}return this}reconnect(_){this.log("client reconnect");const R=()=>{_?(this.options.incomingStore=_.incomingStore,this.options.outgoingStore=_.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new k.default,this.outgoingStore=this.options.outgoingStore||new k.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=R:R(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(_=>{this.outgoing[_].volatile&&typeof this.outgoing[_].cb=="function"&&(this.outgoing[_].cb(new Error("Connection closed")),delete this.outgoing[_])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(_=>{typeof this.outgoing[_].cb=="function"&&(this.outgoing[_].cb(new Error("Connection closed")),delete this.outgoing[_])}))}_removeTopicAliasAndRecoverTopicName(_){let R;_.properties&&(R=_.properties.topicAlias);let T=_.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",R,T),T.length===0){if(R===void 0)return new Error("Unregistered Topic Alias");if(T=this.topicAliasSend.getTopicByAlias(R),T===void 0)return new Error("Unregistered Topic Alias");_.topic=T}R&&delete _.properties.topicAlias}_checkDisconnecting(_){return this.disconnecting&&(_&&_!==this.noop?_(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(_,R,T={}){if(R&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",R)),this.log("_cleanUp :: forced? %s",_),_)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{const Y=Object.assign({cmd:"disconnect"},T);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(Y,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),A(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}this.disconnecting||(this.log("_cleanUp :: client not disconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this.pingTimer!==null&&(this.log("_cleanUp :: clearing pingTimer"),this.pingTimer.clear(),this.pingTimer=null),R&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",R),R())}_storeAndSend(_,R,T){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",_.cmd);let Y,J=_;if(J.cmd==="publish"&&(J=(0,y.default)(_),Y=this._removeTopicAliasAndRecoverTopicName(J),Y))return R&&R(Y);this.outgoingStore.put(J,et=>{if(et)return R&&R(et);T(),this._writePacket(_,R)})}_applyTopicAlias(_){if(this.options.protocolVersion===5&&_.cmd==="publish"){let R;_.properties&&(R=_.properties.topicAlias);const T=_.topic.toString();if(this.topicAliasSend)if(R){if(T.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",T,R),!this.topicAliasSend.put(T,R)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",T,R),new Error("Sending Topic Alias out of range")}else T.length!==0&&(this.options.autoAssignTopicAlias?(R=this.topicAliasSend.getAliasByTopic(T),R?(_.topic="",_.properties=Object.assign(Object.assign({},_.properties),{topicAlias:R}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",T,R)):(R=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put(T,R),_.properties=Object.assign(Object.assign({},_.properties),{topicAlias:R}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",T,R))):this.options.autoUseTopicAlias&&(R=this.topicAliasSend.getAliasByTopic(T),R&&(_.topic="",_.properties=Object.assign(Object.assign({},_.properties),{topicAlias:R}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",T,R))));else if(R)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",T,R),new Error("Sending Topic Alias out of range")}}_noop(_){this.log("noop ::",_)}_writePacket(_,R){this.log("_writePacket :: packet: %O",_),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",_),this._shiftPingInterval(),this.log("_writePacket :: writing to stream");const T=n.default.writeToStream(_,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",T),!T&&R&&R!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",R)):R&&(this.log("_writePacket :: invoking cb"),R())}_sendPacket(_,R,T,Y){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),T=T||this.noop,R=R||this.noop;const J=this._applyTopicAlias(_);if(J)R(J);else{if(!this.connected)return _.cmd==="auth"?void this._writePacket(_,R):(this.log("_sendPacket :: client not connected. Storing packet offline."),void this._storePacket(_,R,T));if(Y)this._writePacket(_,R);else{switch(_.cmd){case"publish":break;case"pubrel":return void this._storeAndSend(_,R,T);default:return void this._writePacket(_,R)}switch(_.qos){case 2:case 1:this._storeAndSend(_,R,T);break;default:this._writePacket(_,R)}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}}}_storePacket(_,R,T){this.log("_storePacket :: packet: %o",_),this.log("_storePacket :: cb? %s",!!R),T=T||this.noop;let Y=_;if(Y.cmd==="publish"){Y=(0,y.default)(_);const et=this._removeTopicAliasAndRecoverTopicName(Y);if(et)return R&&R(et)}const J=Y.qos||0;J===0&&this.queueQoSZero||Y.cmd!=="publish"?this.queue.push({packet:Y,cb:R}):J>0?(R=this.outgoing[Y.messageId]?this.outgoing[Y.messageId].cb:null,this.outgoingStore.put(Y,et=>{if(et)return R&&R(et);T()})):R&&R(new Error("No connection to broker"))}_setupPingTimer(){this.log("_setupPingTimer :: keepalive %d (seconds)",this.options.keepalive),!this.pingTimer&&this.options.keepalive&&(this.pingResp=!0,this.pingTimer=(0,b.default)(()=>{this._checkPing()},1e3*this.options.keepalive))}_shiftPingInterval(){this.pingTimer&&this.options.keepalive&&this.options.reschedulePings&&this.pingTimer.reschedule(1e3*this.options.keepalive)}_checkPing(){this.log("_checkPing :: checking ping..."),this.pingResp?(this.log("_checkPing :: ping response received. Clearing flag and sending `pingreq`"),this.pingResp=!1,this._sendPacket({cmd:"pingreq"})):(this.log("_checkPing :: calling _cleanUp with force true"),this._cleanUp(!0))}_resubscribe(){this.log("_resubscribe");const _=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&_.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let R=0;R<_.length;R++){const T={};T[_[R]]=this._resubscribeTopics[_[R]],T.resubscribe=!0,this.subscribe(T,{properties:T[_[R]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(_){if(this.disconnected)return void this.emit("connect",_);this.connackPacket=_,this.messageIdProvider.clear(),this._setupPingTimer(),this.connected=!0;const R=()=>{let T=this.outgoingStore.createStream();const Y=()=>{T.destroy(),T=null,this._flushStoreProcessingQueue(),J()},J=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",Y),T.on("error",M=>{J(),this._flushStoreProcessingQueue(),this.removeListener("close",Y),this.emit("error",M)});const et=()=>{if(!T)return;const M=T.read(1);let C;M?(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[M.messageId]?et():this.disconnecting||this.reconnectTimer?T.destroy&&T.destroy():(C=this.outgoing[M.messageId]?this.outgoing[M.messageId].cb:null,this.outgoing[M.messageId]={volatile:!1,cb(x,z){C&&C(x,z),et()}},this._packetIdsDuringStoreProcessing[M.messageId]=!0,this.messageIdProvider.register(M.messageId)?this._sendPacket(M,void 0,void 0,!0):this.log("messageId: %d has already used.",M.messageId))):T.once("readable",et)};T.on("end",()=>{let M=!0;for(const C in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[C]){M=!1;break}M?(J(),this.removeListener("close",Y),this._invokeAllStoreProcessingQueue(),this.emit("connect",_)):R()}),et()};R()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){const _=this._storeProcessingQueue[0];if(_&&_.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(const _ of this._storeProcessingQueue)_.cbStorePut&&_.cbStorePut(new Error("Connection closed")),_.callback&&_.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(_,R){delete this.outgoing[_],this.outgoingStore.del({messageId:_},(T,Y)=>{R(T,Y),this.messageIdProvider.deallocate(_),this._invokeStoreProcessingQueue()})}}h.default=G}).call(this)}).call(this,t("_process"),typeof xt<"u"?xt:typeof self<"u"?self:typeof window<"u"?window:{})},{"./TypedEmitter":1,"./default-message-id-provider":9,"./handlers":13,"./store":18,"./topic-alias-recv":19,"./validations":22,_process:102,debug:30,"mqtt-packet":75,"readable-stream":125,reinterval:131,"rfdc/default":132}],3:[function(t,l,h){var r=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(h,"__esModule",{value:!0});const s=t("buffer"),g=t("readable-stream"),d=r(t("duplexify"));let i,f,c,n=!1;h.default=(o,u)=>{if(u.hostname=u.hostname||u.host,!u.hostname)throw new Error("Could not determine host. Specify host manually.");const b=u.protocolId==="MQIsdp"&&u.protocolVersion===3?"mqttv3.1":"mqtt";(function(w){w.hostname||(w.hostname="localhost"),w.path||(w.path="/"),w.wsOptions||(w.wsOptions={})})(u);const y=function(w,S){const k=w.protocol==="alis"?"wss":"ws";let j=`${k}://${w.hostname}${w.path}`;return w.port&&w.port!==80&&w.port!==443&&(j=`${k}://${w.hostname}:${w.port}${w.path}`),typeof w.transformWsUrl=="function"&&(j=w.transformWsUrl(j,w,S)),j}(u,o);return i=u.my,i.connectSocket({url:y,protocols:b}),f=function(){const w=new g.Transform;return w._write=(S,k,j)=>{i.sendSocketMessage({data:S.buffer,success(){j()},fail(){j(new Error)}})},w._flush=S=>{i.closeSocket({success(){S()}})},w}(),c=d.default.obj(),n||(n=!0,i.onSocketOpen(()=>{c.setReadable(f),c.setWritable(f),c.emit("connect")}),i.onSocketMessage(w=>{if(typeof w.data=="string"){const S=s.Buffer.from(w.data,"base64");f.push(S)}else{const S=new FileReader;S.addEventListener("load",()=>{let k=S.result;k=k instanceof ArrayBuffer?s.Buffer.from(k):s.Buffer.from(k,"utf8"),f.push(k)}),S.readAsArrayBuffer(w.data)}}),i.onSocketClose(()=>{c.end(),c.destroy()}),i.onSocketError(w=>{c.destroy(w)})),c}},{buffer:29,duplexify:32,"readable-stream":125}],4:[function(t,l,h){var r=this&&this.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(h,"__esModule",{value:!0}),h.connectAsync=void 0;const s=r(t("debug")),g=r(t("url")),d=r(t("../client")),i=r(t("../is-browser")),f=(0,s.default)("mqttjs"),c={};function n(o,u){if(f("connecting to an MQTT broker..."),typeof o!="object"||u||(u=o,o=""),u=u||{},o&&typeof o=="string"){const y=g.default.parse(o,!0);if(y.port!=null&&(y.port=Number(y.port)),(u=Object.assign(Object.assign({},y),u)).protocol===null)throw new Error("Missing protocol");u.protocol=u.protocol.replace(/:$/,"")}if(function(y){let w;y.auth&&(w=y.auth.match(/^(.+):(.+)$/),w?(y.username=w[1],y.password=w[2]):y.username=y.auth)}(u),u.query&&typeof u.query.clientId=="string"&&(u.clientId=u.query.clientId),u.cert&&u.key){if(!u.protocol)throw new Error("Missing secure protocol key");if(["mqtts","wss","wxs","alis"].indexOf(u.protocol)===-1)switch(u.protocol){case"mqtt":u.protocol="mqtts";break;case"ws":u.protocol="wss";break;case"wx":u.protocol="wxs";break;case"ali":u.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${u.protocol}"!`)}}if(!c[u.protocol]){const y=["mqtts","wss"].indexOf(u.protocol)!==-1;u.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((w,S)=>(!y||S%2!=0)&&typeof c[w]=="function")[0]}if(u.clean===!1&&!u.clientId)throw new Error("Missing clientId for unclean clients");u.protocol&&(u.defaultProtocol=u.protocol);const b=new d.default(function(y){return u.servers&&(y._reconnectCount&&y._reconnectCount!==u.servers.length||(y._reconnectCount=0),u.host=u.servers[y._reconnectCount].host,u.port=u.servers[y._reconnectCount].port,u.protocol=u.servers[y._reconnectCount].protocol?u.servers[y._reconnectCount].protocol:u.defaultProtocol,u.hostname=u.host,y._reconnectCount++),f("calling streambuilder for",u.protocol),c[u.protocol](y,u)},u);return b.on("error",()=>{}),b}i.default?(c.wx=t("./wx").default,c.wxs=t("./wx").default,c.ali=t("./ali").default,c.alis=t("./ali").default):(c.mqtt=t("./tcp").default,c.tcp=t("./tcp").default,c.ssl=t("./tls").default,c.tls=c.ssl,c.mqtts=t("./tls").default),c.ws=t("./ws").default,c.wss=t("./ws").default,h.connectAsync=function(o,u,b=!0){return new Promise((y,w)=>{const S=n(o,u),k={connect:L=>{j(),y(S)},end:()=>{j(),y(S)},error:L=>{j(),S.end(),w(L)}};function j(){Object.keys(k).forEach(L=>{S.off(L,k[L])})}b===!1&&(k.close=()=>{k.error(new Error("Couldn't connect to server"))}),Object.keys(k).forEach(L=>{S.on(L,k[L])})})},h.default=n},{"../client":2,"../is-browser":16,"./ali":3,"./tcp":5,"./tls":6,"./ws":7,"./wx":8,debug:30,url:137}],5:[function(t,l,h){var r=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(h,"__esModule",{value:!0});const s=r(t("net")),g=(0,r(t("debug")).default)("mqttjs:tcp");h.default=(d,i)=>{i.port=i.port||1883,i.hostname=i.hostname||i.host||"localhost";const{port:f}=i,c=i.hostname;return g("port %d and host %s",f,c),s.default.createConnection(f,c)}},{debug:30,net:26}],6:[function(t,l,h){var r=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(h,"__esModule",{value:!0});const s=r(t("tls")),g=r(t("net")),d=(0,r(t("debug")).default)("mqttjs:tls");h.default=(i,f)=>{f.port=f.port||8883,f.host=f.hostname||f.host||"localhost",g.default.isIP(f.host)===0&&(f.servername=f.host),f.rejectUnauthorized=f.rejectUnauthorized!==!1,delete f.path,d("port %d host %s rejectUnauthorized %b",f.port,f.host,f.rejectUnauthorized);const c=s.default.connect(f);function n(o){f.rejectUnauthorized&&i.emit("error",o),c.end()}return c.on("secureConnect",()=>{f.rejectUnauthorized&&!c.authorized?c.emit("error",new Error("TLS not authorized")):c.removeListener("error",n)}),c.on("error",n),c}},{debug:30,net:26,tls:26}],7:[function(t,l,h){var r=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(h,"__esModule",{value:!0});const s=t("buffer"),g=r(t("ws")),d=r(t("debug")),i=r(t("duplexify")),f=t("readable-stream"),c=r(t("../is-browser")),n=(0,d.default)("mqttjs:ws"),o=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function u(y,w){let S=`${y.protocol}://${y.hostname}:${y.port}${y.path}`;return typeof y.transformWsUrl=="function"&&(S=y.transformWsUrl(S,y,w)),S}function b(y){const w=y;return y.hostname||(w.hostname="localhost"),y.port||(y.protocol==="wss"?w.port=443:w.port=80),y.path||(w.path="/"),y.wsOptions||(w.wsOptions={}),c.default||y.protocol!=="wss"||o.forEach(S=>{Object.prototype.hasOwnProperty.call(y,S)&&!Object.prototype.hasOwnProperty.call(y.wsOptions,S)&&(w.wsOptions[S]=y[S])}),w}h.default=c.default?(y,w)=>{let S;n("browserStreamBuilder");const k=function(Y){const J=b(Y);if(J.hostname||(J.hostname=J.host),!J.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");const et=new URL(document.URL);J.hostname=et.hostname,J.port||(J.port=Number(et.port))}return J.objectMode===void 0&&(J.objectMode=!(J.binary===!0||J.binary===void 0)),J}(w),j=k.browserBufferSize||524288,L=w.browserBufferTimeout||1e3,I=!w.objectMode,A=function(Y,J){const et=J.protocolId==="MQIsdp"&&J.protocolVersion===3?"mqttv3.1":"mqtt",M=u(J,Y);let C;return C=J.createWebsocket?J.createWebsocket(M,[et],J):new WebSocket(M,[et]),C.binaryType="arraybuffer",C}(y,w),E=function(Y,J,et){const M=new f.Transform({objectMode:Y.objectMode});return M._write=J,M._flush=et,M}(w,function Y(J,et,M){A.bufferedAmount>j&&setTimeout(Y,L,J,et,M),I&&typeof J=="string"&&(J=s.Buffer.from(J,"utf8"));try{A.send(J)}catch(C){return M(C)}M()},function(Y){A.close(),Y()});w.objectMode||(E._writev=T),E.on("close",()=>{A.close()});const N=A.addEventListener!==void 0;function G(){S.setReadable(E),S.setWritable(E),S.emit("connect")}function W(){S.end(),S.destroy()}function _(Y){S.destroy(Y)}function R(Y){let{data:J}=Y;J=J instanceof ArrayBuffer?s.Buffer.from(J):s.Buffer.from(J,"utf8"),E.push(J)}function T(Y,J){const et=new Array(Y.length);for(let M=0;M<Y.length;M++)typeof Y[M].chunk=="string"?et[M]=s.Buffer.from(Y[M],"utf8"):et[M]=Y[M].chunk;this._write(s.Buffer.concat(et),"binary",J)}return A.readyState===A.OPEN?S=E:(S=(0,i.default)(void 0,void 0,w),w.objectMode||(S._writev=T),N?A.addEventListener("open",G):A.onopen=G),S.socket=A,N?(A.addEventListener("close",W),A.addEventListener("error",_),A.addEventListener("message",R)):(A.onclose=W,A.onerror=_,A.onmessage=R),S}:(y,w)=>{n("streamBuilder");const S=b(w),k=u(S,y),j=function(I,A,E){n("createWebSocket"),n(`protocol: ${E.protocolId} ${E.protocolVersion}`);const N=E.protocolId==="MQIsdp"&&E.protocolVersion===3?"mqttv3.1":"mqtt";let G;return n(`creating new Websocket for url: ${A} and protocol: ${N}`),G=E.createWebsocket?E.createWebsocket(A,[N],E):new g.default(A,[N],E.wsOptions),G}(0,k,S),L=g.default.createWebSocketStream(j,S.wsOptions);return L.url=k,j.on("close",()=>{L.destroy()}),L}},{"../is-browser":16,buffer:29,debug:30,duplexify:32,"readable-stream":125,ws:141}],8:[function(t,l,h){var r=this&&this.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(h,"__esModule",{value:!0});const s=t("buffer"),g=t("readable-stream"),d=r(t("duplexify"));let i,f,c;h.default=(n,o)=>{if(o.hostname=o.hostname||o.host,!o.hostname)throw new Error("Could not determine host. Specify host manually.");const u=o.protocolId==="MQIsdp"&&o.protocolVersion===3?"mqttv3.1":"mqtt";(function(w){w.hostname||(w.hostname="localhost"),w.path||(w.path="/"),w.wsOptions||(w.wsOptions={})})(o);const b=function(w,S){const k=w.protocol==="wxs"?"wss":"ws";let j=`${k}://${w.hostname}${w.path}`;return w.port&&w.port!==80&&w.port!==443&&(j=`${k}://${w.hostname}:${w.port}${w.path}`),typeof w.transformWsUrl=="function"&&(j=w.transformWsUrl(j,w,S)),j}(o,n);i=wx.connectSocket({url:b,protocols:[u]}),f=function(){const w=new g.Transform;return w._write=(S,k,j)=>{i.send({data:S.buffer,success(){j()},fail(L){j(new Error(L))}})},w._flush=S=>{i.close({success(){S()}})},w}(),c=d.default.obj(),c._destroy=(w,S)=>{i.close({success(){S&&S(w)}})};const y=c.destroy;return c.destroy=()=>{c.destroy=y,setTimeout(()=>{i.close({fail(){c._destroy(new Error)}})},0)},i.onOpen(()=>{c.setReadable(f),c.setWritable(f),c.emit("connect")}),i.onMessage(w=>{let{data:S}=w;S=S instanceof ArrayBuffer?s.Buffer.from(S):s.Buffer.from(S,"utf8"),f.push(S)}),i.onClose(()=>{c.emit("close"),c.end(),c.destroy()}),i.onError(w=>{c.destroy(new Error(w.errMsg))}),c}},{buffer:29,duplexify:32,"readable-stream":125}],9:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=class{constructor(){this.nextId=Math.max(1,Math.floor(65535*Math.random()))}allocate(){const r=this.nextId++;return this.nextId===65536&&(this.nextId=1),r}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(r){return!0}deallocate(r){}clear(){}}},{}],10:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.ReasonCodes=void 0,h.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},h.default=(r,s)=>{const{messageId:g}=s,d=s.cmd;let i=null;const f=r.outgoing[g]?r.outgoing[g].cb:null;let c;if(f){switch(r.log("_handleAck :: packet type",d),d){case"pubcomp":case"puback":{const n=s.reasonCode;n&&n>0&&n!==16?(c=new Error(`Publish error: ${h.ReasonCodes[n]}`),c.code=n,r._removeOutgoingAndStoreMessage(g,()=>{f(c,s)})):r._removeOutgoingAndStoreMessage(g,f);break}case"pubrec":{i={cmd:"pubrel",qos:2,messageId:g};const n=s.reasonCode;n&&n>0&&n!==16?(c=new Error(`Publish error: ${h.ReasonCodes[n]}`),c.code=n,r._removeOutgoingAndStoreMessage(g,()=>{f(c,s)})):r._sendPacket(i);break}case"suback":{delete r.outgoing[g],r.messageIdProvider.deallocate(g);const n=s.granted;for(let o=0;o<n.length;o++)if(128&n[o]){const u=r.messageIdToTopic[g];u&&u.forEach(b=>{delete r._resubscribeTopics[b]})}delete r.messageIdToTopic[g],r._invokeStoreProcessingQueue(),f(null,s);break}case"unsuback":delete r.outgoing[g],r.messageIdProvider.deallocate(g),r._invokeStoreProcessingQueue(),f(null);break;default:r.emit("error",new Error("unrecognized packet type"))}r.disconnecting&&Object.keys(r.outgoing).length===0&&r.emit("outgoingEmpty")}else r.log("_handleAck :: Server sent an ack in error. Ignoring.")}},{}],11:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0});const r=t("../shared"),s=t("./ack");h.default=(g,d)=>{const{options:i}=g,f=i.protocolVersion,c=f===5?d.reasonCode:d.returnCode;if(f===5)g.handleAuth(d,(n,o)=>{if(n)g.emit("error",n);else if(c===24)g.reconnecting=!1,g._sendPacket(o);else{const u=new r.ErrorWithReasonCode(`Connection refused: ${s.ReasonCodes[c]}`,c);g.emit("error",u)}});else{const n=new r.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${f}`,c);g.emit("error",n)}}},{"../shared":17,"./ack":10}],12:[function(t,l,h){var r=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(h,"__esModule",{value:!0});const s=t("./ack"),g=r(t("../topic-alias-send")),d=t("../shared");h.default=(i,f)=>{i.log("_handleConnack");const{options:c}=i,n=c.protocolVersion===5?f.reasonCode:f.returnCode;if(clearTimeout(i.connackTimer),delete i.topicAliasSend,f.properties){if(f.properties.topicAliasMaximum){if(f.properties.topicAliasMaximum>65535)return void i.emit("error",new Error("topicAliasMaximum from broker is out of range"));f.properties.topicAliasMaximum>0&&(i.topicAliasSend=new g.default(f.properties.topicAliasMaximum))}f.properties.serverKeepAlive&&c.keepalive&&(c.keepalive=f.properties.serverKeepAlive,i._shiftPingInterval()),f.properties.maximumPacketSize&&(c.properties||(c.properties={}),c.properties.maximumPacketSize=f.properties.maximumPacketSize)}if(n===0)i.reconnecting=!1,i._onConnect(f);else if(n>0){const o=new d.ErrorWithReasonCode(`Connection refused: ${s.ReasonCodes[n]}`,n);i.emit("error",o)}}},{"../shared":17,"../topic-alias-send":20,"./ack":10}],13:[function(t,l,h){var r=this&&this.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(h,"__esModule",{value:!0});const s=r(t("./publish")),g=r(t("./auth")),d=r(t("./connack")),i=r(t("./ack")),f=r(t("./pubrel"));h.default=(c,n,o)=>{const{options:u}=c;if(u.protocolVersion===5&&u.properties&&u.properties.maximumPacketSize&&u.properties.maximumPacketSize<n.length)return c.emit("error",new Error(`exceeding packets size ${n.cmd}`)),c.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),c;switch(c.log("_handlePacket :: emitting packetreceive"),c.emit("packetreceive",n),n.cmd){case"publish":(0,s.default)(c,n,o);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":(0,i.default)(c,n),o();break;case"pubrel":(0,f.default)(c,n,o);break;case"connack":(0,d.default)(c,n),o();break;case"auth":(0,g.default)(c,n),o();break;case"pingresp":c.pingResp=!0,o();break;case"disconnect":c.emit("disconnect",n),o();break;default:c.log("_handlePacket :: unknown command"),o()}}},{"./ack":10,"./auth":11,"./connack":12,"./publish":14,"./pubrel":15}],14:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0});const r=[0,16,128,131,135,144,145,151,153];h.default=(s,g,d)=>{s.log("handlePublish: packet %o",g),d=d!==void 0?d:s.noop;let i=g.topic.toString();const f=g.payload,{qos:c}=g,{messageId:n}=g,{options:o}=s;if(s.options.protocolVersion===5){let u;if(g.properties&&(u=g.properties.topicAlias),u!==void 0)if(i.length===0){if(!(u>0&&u<=65535))return s.log("handlePublish :: topic alias out of range. alias: %d",u),void s.emit("error",new Error("Received Topic Alias is out of range"));{const b=s.topicAliasRecv.getTopicByAlias(u);if(!b)return s.log("handlePublish :: unregistered topic alias. alias: %d",u),void s.emit("error",new Error("Received unregistered Topic Alias"));i=b,s.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",i,u)}}else{if(!s.topicAliasRecv.put(i,u))return s.log("handlePublish :: topic alias out of range. alias: %d",u),void s.emit("error",new Error("Received Topic Alias is out of range"));s.log("handlePublish :: registered topic: %s - alias: %d",i,u)}}switch(s.log("handlePublish: qos %d",c),c){case 2:o.customHandleAcks(i,f,g,(u,b)=>(typeof u=="number"&&(b=u,u=null),u?s.emit("error",u):r.indexOf(b)===-1?s.emit("error",new Error("Wrong reason code for pubrec")):void(b?s._sendPacket({cmd:"pubrec",messageId:n,reasonCode:b},d):s.incomingStore.put(g,()=>{s._sendPacket({cmd:"pubrec",messageId:n},d)}))));break;case 1:o.customHandleAcks(i,f,g,(u,b)=>(typeof u=="number"&&(b=u,u=null),u?s.emit("error",u):r.indexOf(b)===-1?s.emit("error",new Error("Wrong reason code for puback")):(b||s.emit("message",i,f,g),void s.handleMessage(g,y=>{if(y)return d&&d(y);s._sendPacket({cmd:"puback",messageId:n,reasonCode:b},d)}))));break;case 0:s.emit("message",i,f,g),s.handleMessage(g,d);break;default:s.log("handlePublish: unknown QoS. Doing nothing.")}}},{}],15:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=(r,s,g)=>{r.log("handling pubrel packet");const d=g!==void 0?g:r.noop,{messageId:i}=s,f={cmd:"pubcomp",messageId:i};r.incomingStore.get(s,(c,n)=>{c?r._sendPacket(f,d):(r.emit("message",n.topic,n.payload,n),r.handleMessage(n,o=>{if(o)return d(o);r.incomingStore.del(n,r.noop),r._sendPacket(f,d)}))})}},{}],16:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0});const r=typeof window<"u"&&window.document!==void 0||typeof self<"u"&&typeof self.postMessage=="function";h.default=r},{}],17:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.applyMixin=h.ErrorWithReasonCode=void 0;class r extends Error{constructor(g,d){super(g),this.code=d,Object.setPrototypeOf(this,r.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}}h.ErrorWithReasonCode=r,h.applyMixin=function(s,g,d=!1){var i;const f=[g];for(;;){const c=f[0],n=Object.getPrototypeOf(c);if(!(n!=null&&n.prototype))break;f.unshift(n)}for(const c of f)for(const n of Object.getOwnPropertyNames(c.prototype))(d||n!=="constructor")&&Object.defineProperty(s.prototype,n,(i=Object.getOwnPropertyDescriptor(c.prototype,n))!==null&&i!==void 0?i:Object.create(null))}},{}],18:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0});const r=t("readable-stream"),s={objectMode:!0},g={clean:!0};h.default=class{constructor(d){this.options=d||{},this.options=Object.assign(Object.assign({},g),d),this._inflights=new Map}put(d,i){return this._inflights.set(d.messageId,d),i&&i(),this}createStream(){const d=new r.Readable(s),i=[];let f=!1,c=0;return this._inflights.forEach((n,o)=>{i.push(n)}),d._read=()=>{!f&&c<i.length?d.push(i[c++]):d.push(null)},d.destroy=n=>{if(!f)return f=!0,setTimeout(()=>{d.emit("close")},0),d},d}del(d,i){const f=this._inflights.get(d.messageId);return f?(this._inflights.delete(d.messageId),i(null,f)):i&&i(new Error("missing packet")),this}get(d,i){const f=this._inflights.get(d.messageId);return f?i(null,f):i&&i(new Error("missing packet")),this}close(d){this.options.clean&&(this._inflights=null),d&&d()}}},{"readable-stream":125}],19:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0}),h.default=class{constructor(r){this.aliasToTopic={},this.max=r}put(r,s){return!(s===0||s>this.max)&&(this.aliasToTopic[s]=r,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(r){return this.aliasToTopic[r]}clear(){this.aliasToTopic={}}}},{}],20:[function(t,l,h){var r=this&&this.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(h,"__esModule",{value:!0});const s=r(t("lru-cache")),g=t("number-allocator");h.default=class{constructor(d){d>0&&(this.aliasToTopic=new s.default({max:d}),this.topicToAlias={},this.numberAllocator=new g.NumberAllocator(1,d),this.max=d,this.length=0)}put(d,i){if(i===0||i>this.max)return!1;const f=this.aliasToTopic.get(i);return f&&delete this.topicToAlias[f],this.aliasToTopic.set(i,d),this.topicToAlias[d]=i,this.numberAllocator.use(i),this.length=this.aliasToTopic.size,!0}getTopicByAlias(d){return this.aliasToTopic.get(d)}getAliasByTopic(d){const i=this.topicToAlias[d];return i!==void 0&&this.aliasToTopic.get(i),i}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}}},{"lru-cache":72,"number-allocator":98}],21:[function(t,l,h){Object.defineProperty(h,"__esModule",{value:!0});const r=t("number-allocator");h.default=class{constructor(){this.numberAllocator=new r.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(s){return this.numberAllocator.use(s)}deallocate(s){this.numberAllocator.free(s)}clear(){this.numberAllocator.clear()}}},{"number-allocator":98}],22:[function(t,l,h){function r(s){const g=s.split("/");for(let d=0;d<g.length;d++)if(g[d]!=="+"){if(g[d]==="#")return d===g.length-1;if(g[d].indexOf("+")!==-1||g[d].indexOf("#")!==-1)return!1}return!0}Object.defineProperty(h,"__esModule",{value:!0}),h.validateTopics=h.validateTopic=void 0,h.validateTopic=r,h.validateTopics=function(s){if(s.length===0)return"empty_topic_list";for(let g=0;g<s.length;g++)if(!r(s[g]))return s[g];return null}},{}],23:[function(t,l,h){var r=this&&this.__createBinding||(Object.create?function(y,w,S,k){k===void 0&&(k=S);var j=Object.getOwnPropertyDescriptor(w,S);j&&!("get"in j?!w.__esModule:j.writable||j.configurable)||(j={enumerable:!0,get:function(){return w[S]}}),Object.defineProperty(y,k,j)}:function(y,w,S,k){k===void 0&&(k=S),y[k]=w[S]}),s=this&&this.__setModuleDefault||(Object.create?function(y,w){Object.defineProperty(y,"default",{enumerable:!0,value:w})}:function(y,w){y.default=w}),g=this&&this.__importStar||function(y){if(y&&y.__esModule)return y;var w={};if(y!=null)for(var S in y)S!=="default"&&Object.prototype.hasOwnProperty.call(y,S)&&r(w,y,S);return s(w,y),w},d=this&&this.__exportStar||function(y,w){for(var S in y)S==="default"||Object.prototype.hasOwnProperty.call(w,S)||r(w,y,S)},i=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(h,"__esModule",{value:!0}),h.ReasonCodes=h.UniqueMessageIdProvider=h.DefaultMessageIdProvider=h.Store=h.MqttClient=h.connectAsync=h.connect=h.Client=void 0;const f=i(t("./lib/client"));h.MqttClient=f.default;const c=i(t("./lib/default-message-id-provider"));h.DefaultMessageIdProvider=c.default;const n=i(t("./lib/unique-message-id-provider"));h.UniqueMessageIdProvider=n.default;const o=i(t("./lib/store"));h.Store=o.default;const u=g(t("./lib/connect"));h.connect=u.default,Object.defineProperty(h,"connectAsync",{enumerable:!0,get:function(){return u.connectAsync}}),h.Client=f.default,d(t("./lib/client"),h),d(t("./lib/shared"),h);var b=t("./lib/handlers/ack");Object.defineProperty(h,"ReasonCodes",{enumerable:!0,get:function(){return b.ReasonCodes}})},{"./lib/client":2,"./lib/connect":4,"./lib/default-message-id-provider":9,"./lib/handlers/ack":10,"./lib/shared":17,"./lib/store":18,"./lib/unique-message-id-provider":21}],24:[function(t,l,h){const{AbortController:r,AbortSignal:s}=typeof self<"u"?self:typeof window<"u"?window:void 0;l.exports=r,l.exports.AbortSignal=s,l.exports.default=r},{}],25:[function(t,l,h){h.byteLength=function(n){var o=f(n),u=o[0],b=o[1];return 3*(u+b)/4-b},h.toByteArray=function(n){var o,u,b=f(n),y=b[0],w=b[1],S=new g(function(L,I,A){return 3*(I+A)/4-A}(0,y,w)),k=0,j=w>0?y-4:y;for(u=0;u<j;u+=4)o=s[n.charCodeAt(u)]<<18|s[n.charCodeAt(u+1)]<<12|s[n.charCodeAt(u+2)]<<6|s[n.charCodeAt(u+3)],S[k++]=o>>16&255,S[k++]=o>>8&255,S[k++]=255&o;return w===2&&(o=s[n.charCodeAt(u)]<<2|s[n.charCodeAt(u+1)]>>4,S[k++]=255&o),w===1&&(o=s[n.charCodeAt(u)]<<10|s[n.charCodeAt(u+1)]<<4|s[n.charCodeAt(u+2)]>>2,S[k++]=o>>8&255,S[k++]=255&o),S},h.fromByteArray=function(n){for(var o,u=n.length,b=u%3,y=[],w=16383,S=0,k=u-b;S<k;S+=w)y.push(c(n,S,S+w>k?k:S+w));return b===1?(o=n[u-1],y.push(r[o>>2]+r[o<<4&63]+"==")):b===2&&(o=(n[u-2]<<8)+n[u-1],y.push(r[o>>10]+r[o>>4&63]+r[o<<2&63]+"=")),y.join("")};for(var r=[],s=[],g=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0;i<64;++i)r[i]=d[i],s[d.charCodeAt(i)]=i;function f(n){var o=n.length;if(o%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=n.indexOf("=");return u===-1&&(u=o),[u,u===o?0:4-u%4]}function c(n,o,u){for(var b,y,w=[],S=o;S<u;S+=3)b=(n[S]<<16&16711680)+(n[S+1]<<8&65280)+(255&n[S+2]),w.push(r[(y=b)>>18&63]+r[y>>12&63]+r[y>>6&63]+r[63&y]);return w.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},{}],26:[function(t,l,h){},{}],27:[function(t,l,h){var r=t("buffer"),s=r.Buffer;function g(i,f){for(var c in i)f[c]=i[c]}function d(i,f,c){return s(i,f,c)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?l.exports=r:(g(r,h),h.Buffer=d),g(s,d),d.from=function(i,f,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,f,c)},d.alloc=function(i,f,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var n=s(i);return f!==void 0?typeof c=="string"?n.fill(f,c):n.fill(f):n.fill(0),n},d.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},d.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(i)}},{buffer:29}],28:[function(t,l,h){var r=t("safe-buffer").Buffer,s=r.isEncoding||function(y){switch((y=""+y)&&y.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function g(y){var w;switch(this.encoding=function(S){var k=function(j){if(!j)return"utf8";for(var L;;)switch(j){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return j;default:if(L)return;j=(""+j).toLowerCase(),L=!0}}(S);if(typeof k!="string"&&(r.isEncoding===s||!s(S)))throw new Error("Unknown encoding: "+S);return k||S}(y),this.encoding){case"utf16le":this.text=f,this.end=c,w=4;break;case"utf8":this.fillLast=i,w=4;break;case"base64":this.text=n,this.end=o,w=3;break;default:return this.write=u,void(this.end=b)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(w)}function d(y){return y<=127?0:y>>5==6?2:y>>4==14?3:y>>3==30?4:y>>6==2?-1:-2}function i(y){var w=this.lastTotal-this.lastNeed,S=function(k,j,L){if((192&j[0])!=128)return k.lastNeed=0,"�";if(k.lastNeed>1&&j.length>1){if((192&j[1])!=128)return k.lastNeed=1,"�";if(k.lastNeed>2&&j.length>2&&(192&j[2])!=128)return k.lastNeed=2,"�"}}(this,y);return S!==void 0?S:this.lastNeed<=y.length?(y.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(y.copy(this.lastChar,w,0,y.length),void(this.lastNeed-=y.length))}function f(y,w){if((y.length-w)%2==0){var S=y.toString("utf16le",w);if(S){var k=S.charCodeAt(S.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=y[y.length-1],y.toString("utf16le",w,y.length-1)}function c(y){var w=y&&y.length?this.write(y):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function n(y,w){var S=(y.length-w)%3;return S===0?y.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=y[y.length-1]:(this.lastChar[0]=y[y.length-2],this.lastChar[1]=y[y.length-1]),y.toString("base64",w,y.length-S))}function o(y){var w=y&&y.length?this.write(y):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function u(y){return y.toString(this.encoding)}function b(y){return y&&y.length?this.write(y):""}h.StringDecoder=g,g.prototype.write=function(y){if(y.length===0)return"";var w,S;if(this.lastNeed){if((w=this.fillLast(y))===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<y.length?w?w+this.text(y,S):this.text(y,S):w||""},g.prototype.end=function(y){var w=y&&y.length?this.write(y):"";return this.lastNeed?w+"�":w},g.prototype.text=function(y,w){var S=function(j,L,I){var A=L.length-1;if(A<I)return 0;var E=d(L[A]);return E>=0?(E>0&&(j.lastNeed=E-1),E):--A<I||E===-2?0:(E=d(L[A]),E>=0?(E>0&&(j.lastNeed=E-2),E):--A<I||E===-2?0:(E=d(L[A]),E>=0?(E>0&&(E===2?E=0:j.lastNeed=E-3),E):0))}(this,y,w);if(!this.lastNeed)return y.toString("utf8",w);this.lastTotal=S;var k=y.length-(S-this.lastNeed);return y.copy(this.lastChar,0,k),y.toString("utf8",w,k)},g.prototype.fillLast=function(y){if(this.lastNeed<=y.length)return y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);y.copy(this.lastChar,this.lastTotal-this.lastNeed,0,y.length),this.lastNeed-=y.length}},{"safe-buffer":27}],29:[function(t,l,h){(function(r){(function(){var s=t("base64-js"),g=t("ieee754");h.Buffer=f,h.SlowBuffer=function(p){return+p!=p&&(p=0),f.alloc(+p)},h.INSPECT_MAX_BYTES=50;var d=2147483647;function i(p){if(p>d)throw new RangeError('The value "'+p+'" is invalid for option "size"');var m=new Uint8Array(p);return m.__proto__=f.prototype,m}function f(p,m,v){if(typeof p=="number"){if(typeof m=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(p)}return c(p,m,v)}function c(p,m,v){if(typeof p=="string")return function(K,D){if(typeof D=="string"&&D!==""||(D="utf8"),!f.isEncoding(D))throw new TypeError("Unknown encoding: "+D);var Q=0|y(K,D),rt=i(Q),nt=rt.write(K,D);return nt!==Q&&(rt=rt.slice(0,nt)),rt}(p,m);if(ArrayBuffer.isView(p))return u(p);if(p==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(tt(p,ArrayBuffer)||p&&tt(p.buffer,ArrayBuffer))return function(K,D,Q){if(D<0||K.byteLength<D)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<D+(Q||0))throw new RangeError('"length" is outside of buffer bounds');var rt;return rt=D===void 0&&Q===void 0?new Uint8Array(K):Q===void 0?new Uint8Array(K,D):new Uint8Array(K,D,Q),rt.__proto__=f.prototype,rt}(p,m,v);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var P=p.valueOf&&p.valueOf();if(P!=null&&P!==p)return f.from(P,m,v);var F=function(K){if(f.isBuffer(K)){var D=0|b(K.length),Q=i(D);return Q.length===0||K.copy(Q,0,0,D),Q}if(K.length!==void 0)return typeof K.length!="number"||O(K.length)?i(0):u(K);if(K.type==="Buffer"&&Array.isArray(K.data))return u(K.data)}(p);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return f.from(p[Symbol.toPrimitive]("string"),m,v);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}function n(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function o(p){return n(p),i(p<0?0:0|b(p))}function u(p){for(var m=p.length<0?0:0|b(p.length),v=i(m),P=0;P<m;P+=1)v[P]=255&p[P];return v}function b(p){if(p>=d)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d.toString(16)+" bytes");return 0|p}function y(p,m){if(f.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||tt(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);var v=p.length,P=arguments.length>2&&arguments[2]===!0;if(!P&&v===0)return 0;for(var F=!1;;)switch(m){case"ascii":case"latin1":case"binary":return v;case"utf8":case"utf-8":return H(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*v;case"hex":return v>>>1;case"base64":return Z(p).length;default:if(F)return P?-1:H(p).length;m=(""+m).toLowerCase(),F=!0}}function w(p,m,v){var P=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((v===void 0||v>this.length)&&(v=this.length),v<=0)||(v>>>=0)<=(m>>>=0))return"";for(p||(p="utf8");;)switch(p){case"hex":return J(this,m,v);case"utf8":case"utf-8":return _(this,m,v);case"ascii":return T(this,m,v);case"latin1":case"binary":return Y(this,m,v);case"base64":return W(this,m,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return et(this,m,v);default:if(P)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),P=!0}}function S(p,m,v){var P=p[m];p[m]=p[v],p[v]=P}function k(p,m,v,P,F){if(p.length===0)return-1;if(typeof v=="string"?(P=v,v=0):v>2147483647?v=2147483647:v<-2147483648&&(v=-2147483648),O(v=+v)&&(v=F?0:p.length-1),v<0&&(v=p.length+v),v>=p.length){if(F)return-1;v=p.length-1}else if(v<0){if(!F)return-1;v=0}if(typeof m=="string"&&(m=f.from(m,P)),f.isBuffer(m))return m.length===0?-1:j(p,m,v,P,F);if(typeof m=="number")return m&=255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(p,m,v):Uint8Array.prototype.lastIndexOf.call(p,m,v):j(p,[m],v,P,F);throw new TypeError("val must be string, number or Buffer")}function j(p,m,v,P,F){var K,D=1,Q=p.length,rt=m.length;if(P!==void 0&&((P=String(P).toLowerCase())==="ucs2"||P==="ucs-2"||P==="utf16le"||P==="utf-16le")){if(p.length<2||m.length<2)return-1;D=2,Q/=2,rt/=2,v/=2}function nt(ut,U){return D===1?ut[U]:ut.readUInt16BE(U*D)}if(F){var st=-1;for(K=v;K<Q;K++)if(nt(p,K)===nt(m,st===-1?0:K-st)){if(st===-1&&(st=K),K-st+1===rt)return st*D}else st!==-1&&(K-=K-st),st=-1}else for(v+rt>Q&&(v=Q-rt),K=v;K>=0;K--){for(var dt=!0,ct=0;ct<rt;ct++)if(nt(p,K+ct)!==nt(m,ct)){dt=!1;break}if(dt)return K}return-1}function L(p,m,v,P){v=Number(v)||0;var F=p.length-v;P?(P=Number(P))>F&&(P=F):P=F;var K=m.length;P>K/2&&(P=K/2);for(var D=0;D<P;++D){var Q=parseInt(m.substr(2*D,2),16);if(O(Q))return D;p[v+D]=Q}return D}function I(p,m,v,P){return X(H(m,p.length-v),p,v,P)}function A(p,m,v,P){return X(function(F){for(var K=[],D=0;D<F.length;++D)K.push(255&F.charCodeAt(D));return K}(m),p,v,P)}function E(p,m,v,P){return A(p,m,v,P)}function N(p,m,v,P){return X(Z(m),p,v,P)}function G(p,m,v,P){return X(function(F,K){for(var D,Q,rt,nt=[],st=0;st<F.length&&!((K-=2)<0);++st)Q=(D=F.charCodeAt(st))>>8,rt=D%256,nt.push(rt),nt.push(Q);return nt}(m,p.length-v),p,v,P)}function W(p,m,v){return m===0&&v===p.length?s.fromByteArray(p):s.fromByteArray(p.slice(m,v))}function _(p,m,v){v=Math.min(p.length,v);for(var P=[],F=m;F<v;){var K,D,Q,rt,nt=p[F],st=null,dt=nt>239?4:nt>223?3:nt>191?2:1;if(F+dt<=v)switch(dt){case 1:nt<128&&(st=nt);break;case 2:(192&(K=p[F+1]))==128&&(rt=(31&nt)<<6|63&K)>127&&(st=rt);break;case 3:K=p[F+1],D=p[F+2],(192&K)==128&&(192&D)==128&&(rt=(15&nt)<<12|(63&K)<<6|63&D)>2047&&(rt<55296||rt>57343)&&(st=rt);break;case 4:K=p[F+1],D=p[F+2],Q=p[F+3],(192&K)==128&&(192&D)==128&&(192&Q)==128&&(rt=(15&nt)<<18|(63&K)<<12|(63&D)<<6|63&Q)>65535&&rt<1114112&&(st=rt)}st===null?(st=65533,dt=1):st>65535&&(st-=65536,P.push(st>>>10&1023|55296),st=56320|1023&st),P.push(st),F+=dt}return function(ct){var ut=ct.length;if(ut<=R)return String.fromCharCode.apply(String,ct);for(var U="",q=0;q<ut;)U+=String.fromCharCode.apply(String,ct.slice(q,q+=R));return U}(P)}h.kMaxLength=d,f.TYPED_ARRAY_SUPPORT=function(){try{var p=new Uint8Array(1);return p.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},p.foo()===42}catch{return!1}}(),f.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=function(p,m,v){return c(p,m,v)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(p,m,v){return function(P,F,K){return n(P),P<=0?i(P):F!==void 0?typeof K=="string"?i(P).fill(F,K):i(P).fill(F):i(P)}(p,m,v)},f.allocUnsafe=function(p){return o(p)},f.allocUnsafeSlow=function(p){return o(p)},f.isBuffer=function(p){return p!=null&&p._isBuffer===!0&&p!==f.prototype},f.compare=function(p,m){if(tt(p,Uint8Array)&&(p=f.from(p,p.offset,p.byteLength)),tt(m,Uint8Array)&&(m=f.from(m,m.offset,m.byteLength)),!f.isBuffer(p)||!f.isBuffer(m))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(p===m)return 0;for(var v=p.length,P=m.length,F=0,K=Math.min(v,P);F<K;++F)if(p[F]!==m[F]){v=p[F],P=m[F];break}return v<P?-1:P<v?1:0},f.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(p,m){if(!Array.isArray(p))throw new TypeError('"list" argument must be an Array of Buffers');if(p.length===0)return f.alloc(0);var v;if(m===void 0)for(m=0,v=0;v<p.length;++v)m+=p[v].length;var P=f.allocUnsafe(m),F=0;for(v=0;v<p.length;++v){var K=p[v];if(tt(K,Uint8Array)&&(K=f.from(K)),!f.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(P,F),F+=K.length}return P},f.byteLength=y,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var p=this.length;if(p%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<p;m+=2)S(this,m,m+1);return this},f.prototype.swap32=function(){var p=this.length;if(p%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<p;m+=4)S(this,m,m+3),S(this,m+1,m+2);return this},f.prototype.swap64=function(){var p=this.length;if(p%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<p;m+=8)S(this,m,m+7),S(this,m+1,m+6),S(this,m+2,m+5),S(this,m+3,m+4);return this},f.prototype.toString=function(){var p=this.length;return p===0?"":arguments.length===0?_(this,0,p):w.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(p){if(!f.isBuffer(p))throw new TypeError("Argument must be a Buffer");return this===p||f.compare(this,p)===0},f.prototype.inspect=function(){var p="",m=h.INSPECT_MAX_BYTES;return p=this.toString("hex",0,m).replace(/(.{2})/g,"$1 ").trim(),this.length>m&&(p+=" ... "),"<Buffer "+p+">"},f.prototype.compare=function(p,m,v,P,F){if(tt(p,Uint8Array)&&(p=f.from(p,p.offset,p.byteLength)),!f.isBuffer(p))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof p);if(m===void 0&&(m=0),v===void 0&&(v=p?p.length:0),P===void 0&&(P=0),F===void 0&&(F=this.length),m<0||v>p.length||P<0||F>this.length)throw new RangeError("out of range index");if(P>=F&&m>=v)return 0;if(P>=F)return-1;if(m>=v)return 1;if(this===p)return 0;for(var K=(F>>>=0)-(P>>>=0),D=(v>>>=0)-(m>>>=0),Q=Math.min(K,D),rt=this.slice(P,F),nt=p.slice(m,v),st=0;st<Q;++st)if(rt[st]!==nt[st]){K=rt[st],D=nt[st];break}return K<D?-1:D<K?1:0},f.prototype.includes=function(p,m,v){return this.indexOf(p,m,v)!==-1},f.prototype.indexOf=function(p,m,v){return k(this,p,m,v,!0)},f.prototype.lastIndexOf=function(p,m,v){return k(this,p,m,v,!1)},f.prototype.write=function(p,m,v,P){if(m===void 0)P="utf8",v=this.length,m=0;else if(v===void 0&&typeof m=="string")P=m,v=this.length,m=0;else{if(!isFinite(m))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");m>>>=0,isFinite(v)?(v>>>=0,P===void 0&&(P="utf8")):(P=v,v=void 0)}var F=this.length-m;if((v===void 0||v>F)&&(v=F),p.length>0&&(v<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");P||(P="utf8");for(var K=!1;;)switch(P){case"hex":return L(this,p,m,v);case"utf8":case"utf-8":return I(this,p,m,v);case"ascii":return A(this,p,m,v);case"latin1":case"binary":return E(this,p,m,v);case"base64":return N(this,p,m,v);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,p,m,v);default:if(K)throw new TypeError("Unknown encoding: "+P);P=(""+P).toLowerCase(),K=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function T(p,m,v){var P="";v=Math.min(p.length,v);for(var F=m;F<v;++F)P+=String.fromCharCode(127&p[F]);return P}function Y(p,m,v){var P="";v=Math.min(p.length,v);for(var F=m;F<v;++F)P+=String.fromCharCode(p[F]);return P}function J(p,m,v){var P=p.length;(!m||m<0)&&(m=0),(!v||v<0||v>P)&&(v=P);for(var F="",K=m;K<v;++K)F+=$(p[K]);return F}function et(p,m,v){for(var P=p.slice(m,v),F="",K=0;K<P.length;K+=2)F+=String.fromCharCode(P[K]+256*P[K+1]);return F}function M(p,m,v){if(p%1!=0||p<0)throw new RangeError("offset is not uint");if(p+m>v)throw new RangeError("Trying to access beyond buffer length")}function C(p,m,v,P,F,K){if(!f.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>F||m<K)throw new RangeError('"value" argument is out of bounds');if(v+P>p.length)throw new RangeError("Index out of range")}function x(p,m,v,P,F,K){if(v+P>p.length)throw new RangeError("Index out of range");if(v<0)throw new RangeError("Index out of range")}function z(p,m,v,P,F){return m=+m,v>>>=0,F||x(p,0,v,4),g.write(p,m,v,P,23,4),v+4}function B(p,m,v,P,F){return m=+m,v>>>=0,F||x(p,0,v,8),g.write(p,m,v,P,52,8),v+8}f.prototype.slice=function(p,m){var v=this.length;(p=~~p)<0?(p+=v)<0&&(p=0):p>v&&(p=v),(m=m===void 0?v:~~m)<0?(m+=v)<0&&(m=0):m>v&&(m=v),m<p&&(m=p);var P=this.subarray(p,m);return P.__proto__=f.prototype,P},f.prototype.readUIntLE=function(p,m,v){p>>>=0,m>>>=0,v||M(p,m,this.length);for(var P=this[p],F=1,K=0;++K<m&&(F*=256);)P+=this[p+K]*F;return P},f.prototype.readUIntBE=function(p,m,v){p>>>=0,m>>>=0,v||M(p,m,this.length);for(var P=this[p+--m],F=1;m>0&&(F*=256);)P+=this[p+--m]*F;return P},f.prototype.readUInt8=function(p,m){return p>>>=0,m||M(p,1,this.length),this[p]},f.prototype.readUInt16LE=function(p,m){return p>>>=0,m||M(p,2,this.length),this[p]|this[p+1]<<8},f.prototype.readUInt16BE=function(p,m){return p>>>=0,m||M(p,2,this.length),this[p]<<8|this[p+1]},f.prototype.readUInt32LE=function(p,m){return p>>>=0,m||M(p,4,this.length),(this[p]|this[p+1]<<8|this[p+2]<<16)+16777216*this[p+3]},f.prototype.readUInt32BE=function(p,m){return p>>>=0,m||M(p,4,this.length),16777216*this[p]+(this[p+1]<<16|this[p+2]<<8|this[p+3])},f.prototype.readIntLE=function(p,m,v){p>>>=0,m>>>=0,v||M(p,m,this.length);for(var P=this[p],F=1,K=0;++K<m&&(F*=256);)P+=this[p+K]*F;return P>=(F*=128)&&(P-=Math.pow(2,8*m)),P},f.prototype.readIntBE=function(p,m,v){p>>>=0,m>>>=0,v||M(p,m,this.length);for(var P=m,F=1,K=this[p+--P];P>0&&(F*=256);)K+=this[p+--P]*F;return K>=(F*=128)&&(K-=Math.pow(2,8*m)),K},f.prototype.readInt8=function(p,m){return p>>>=0,m||M(p,1,this.length),128&this[p]?-1*(255-this[p]+1):this[p]},f.prototype.readInt16LE=function(p,m){p>>>=0,m||M(p,2,this.length);var v=this[p]|this[p+1]<<8;return 32768&v?4294901760|v:v},f.prototype.readInt16BE=function(p,m){p>>>=0,m||M(p,2,this.length);var v=this[p+1]|this[p]<<8;return 32768&v?4294901760|v:v},f.prototype.readInt32LE=function(p,m){return p>>>=0,m||M(p,4,this.length),this[p]|this[p+1]<<8|this[p+2]<<16|this[p+3]<<24},f.prototype.readInt32BE=function(p,m){return p>>>=0,m||M(p,4,this.length),this[p]<<24|this[p+1]<<16|this[p+2]<<8|this[p+3]},f.prototype.readFloatLE=function(p,m){return p>>>=0,m||M(p,4,this.length),g.read(this,p,!0,23,4)},f.prototype.readFloatBE=function(p,m){return p>>>=0,m||M(p,4,this.length),g.read(this,p,!1,23,4)},f.prototype.readDoubleLE=function(p,m){return p>>>=0,m||M(p,8,this.length),g.read(this,p,!0,52,8)},f.prototype.readDoubleBE=function(p,m){return p>>>=0,m||M(p,8,this.length),g.read(this,p,!1,52,8)},f.prototype.writeUIntLE=function(p,m,v,P){p=+p,m>>>=0,v>>>=0,P||C(this,p,m,v,Math.pow(2,8*v)-1,0);var F=1,K=0;for(this[m]=255&p;++K<v&&(F*=256);)this[m+K]=p/F&255;return m+v},f.prototype.writeUIntBE=function(p,m,v,P){p=+p,m>>>=0,v>>>=0,P||C(this,p,m,v,Math.pow(2,8*v)-1,0);var F=v-1,K=1;for(this[m+F]=255&p;--F>=0&&(K*=256);)this[m+F]=p/K&255;return m+v},f.prototype.writeUInt8=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,1,255,0),this[m]=255&p,m+1},f.prototype.writeUInt16LE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,2,65535,0),this[m]=255&p,this[m+1]=p>>>8,m+2},f.prototype.writeUInt16BE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,2,65535,0),this[m]=p>>>8,this[m+1]=255&p,m+2},f.prototype.writeUInt32LE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,4,4294967295,0),this[m+3]=p>>>24,this[m+2]=p>>>16,this[m+1]=p>>>8,this[m]=255&p,m+4},f.prototype.writeUInt32BE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,4,4294967295,0),this[m]=p>>>24,this[m+1]=p>>>16,this[m+2]=p>>>8,this[m+3]=255&p,m+4},f.prototype.writeIntLE=function(p,m,v,P){if(p=+p,m>>>=0,!P){var F=Math.pow(2,8*v-1);C(this,p,m,v,F-1,-F)}var K=0,D=1,Q=0;for(this[m]=255&p;++K<v&&(D*=256);)p<0&&Q===0&&this[m+K-1]!==0&&(Q=1),this[m+K]=(p/D>>0)-Q&255;return m+v},f.prototype.writeIntBE=function(p,m,v,P){if(p=+p,m>>>=0,!P){var F=Math.pow(2,8*v-1);C(this,p,m,v,F-1,-F)}var K=v-1,D=1,Q=0;for(this[m+K]=255&p;--K>=0&&(D*=256);)p<0&&Q===0&&this[m+K+1]!==0&&(Q=1),this[m+K]=(p/D>>0)-Q&255;return m+v},f.prototype.writeInt8=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,1,127,-128),p<0&&(p=255+p+1),this[m]=255&p,m+1},f.prototype.writeInt16LE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,2,32767,-32768),this[m]=255&p,this[m+1]=p>>>8,m+2},f.prototype.writeInt16BE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,2,32767,-32768),this[m]=p>>>8,this[m+1]=255&p,m+2},f.prototype.writeInt32LE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,4,2147483647,-2147483648),this[m]=255&p,this[m+1]=p>>>8,this[m+2]=p>>>16,this[m+3]=p>>>24,m+4},f.prototype.writeInt32BE=function(p,m,v){return p=+p,m>>>=0,v||C(this,p,m,4,2147483647,-2147483648),p<0&&(p=4294967295+p+1),this[m]=p>>>24,this[m+1]=p>>>16,this[m+2]=p>>>8,this[m+3]=255&p,m+4},f.prototype.writeFloatLE=function(p,m,v){return z(this,p,m,!0,v)},f.prototype.writeFloatBE=function(p,m,v){return z(this,p,m,!1,v)},f.prototype.writeDoubleLE=function(p,m,v){return B(this,p,m,!0,v)},f.prototype.writeDoubleBE=function(p,m,v){return B(this,p,m,!1,v)},f.prototype.copy=function(p,m,v,P){if(!f.isBuffer(p))throw new TypeError("argument should be a Buffer");if(v||(v=0),P||P===0||(P=this.length),m>=p.length&&(m=p.length),m||(m=0),P>0&&P<v&&(P=v),P===v||p.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(v<0||v>=this.length)throw new RangeError("Index out of range");if(P<0)throw new RangeError("sourceEnd out of bounds");P>this.length&&(P=this.length),p.length-m<P-v&&(P=p.length-m+v);var F=P-v;if(this===p&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(m,v,P);else if(this===p&&v<m&&m<P)for(var K=F-1;K>=0;--K)p[K+m]=this[K+v];else Uint8Array.prototype.set.call(p,this.subarray(v,P),m);return F},f.prototype.fill=function(p,m,v,P){if(typeof p=="string"){if(typeof m=="string"?(P=m,m=0,v=this.length):typeof v=="string"&&(P=v,v=this.length),P!==void 0&&typeof P!="string")throw new TypeError("encoding must be a string");if(typeof P=="string"&&!f.isEncoding(P))throw new TypeError("Unknown encoding: "+P);if(p.length===1){var F=p.charCodeAt(0);(P==="utf8"&&F<128||P==="latin1")&&(p=F)}}else typeof p=="number"&&(p&=255);if(m<0||this.length<m||this.length<v)throw new RangeError("Out of range index");if(v<=m)return this;var K;if(m>>>=0,v=v===void 0?this.length:v>>>0,p||(p=0),typeof p=="number")for(K=m;K<v;++K)this[K]=p;else{var D=f.isBuffer(p)?p:f.from(p,P),Q=D.length;if(Q===0)throw new TypeError('The value "'+p+'" is invalid for argument "value"');for(K=0;K<v-m;++K)this[K+m]=D[K%Q]}return this};var V=/[^+/0-9A-Za-z-_]/g;function $(p){return p<16?"0"+p.toString(16):p.toString(16)}function H(p,m){var v;m=m||1/0;for(var P=p.length,F=null,K=[],D=0;D<P;++D){if((v=p.charCodeAt(D))>55295&&v<57344){if(!F){if(v>56319){(m-=3)>-1&&K.push(239,191,189);continue}if(D+1===P){(m-=3)>-1&&K.push(239,191,189);continue}F=v;continue}if(v<56320){(m-=3)>-1&&K.push(239,191,189),F=v;continue}v=65536+(F-55296<<10|v-56320)}else F&&(m-=3)>-1&&K.push(239,191,189);if(F=null,v<128){if((m-=1)<0)break;K.push(v)}else if(v<2048){if((m-=2)<0)break;K.push(v>>6|192,63&v|128)}else if(v<65536){if((m-=3)<0)break;K.push(v>>12|224,v>>6&63|128,63&v|128)}else{if(!(v<1114112))throw new Error("Invalid code point");if((m-=4)<0)break;K.push(v>>18|240,v>>12&63|128,v>>6&63|128,63&v|128)}}return K}function Z(p){return s.toByteArray(function(m){if((m=(m=m.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;m.length%4!=0;)m+="=";return m}(p))}function X(p,m,v,P){for(var F=0;F<P&&!(F+v>=m.length||F>=p.length);++F)m[F+v]=p[F];return F}function tt(p,m){return p instanceof m||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===m.name}function O(p){return p!=p}}).call(this)}).call(this,t("buffer").Buffer)},{"base64-js":25,buffer:29,ieee754:50}],30:[function(t,l,h){(function(r){(function(){h.formatArgs=function(g){if(g[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+g[0]+(this.useColors?"%c ":" ")+"+"+l.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;g.splice(1,0,d,"color: inherit");let i=0,f=0;g[0].replace(/%[a-zA-Z%]/g,c=>{c!=="%%"&&(i++,c==="%c"&&(f=i))}),g.splice(f,0,d)},h.save=function(g){try{g?h.storage.setItem("debug",g):h.storage.removeItem("debug")}catch{}},h.load=function(){let g;try{g=h.storage.getItem("debug")}catch{}return!g&&r!==void 0&&"env"in r&&(g=r.env.DEBUG),g},h.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},h.storage=function(){try{return localStorage}catch{}}(),h.destroy=(()=>{let g=!1;return()=>{g||(g=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),h.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],h.log=console.debug||console.log||(()=>{}),l.exports=t("./common")(h);const{formatters:s}=l.exports;s.j=function(g){try{return JSON.stringify(g)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,t("_process"))},{"./common":31,_process:102}],31:[function(t,l,h){l.exports=function(r){function s(i){let f,c,n,o=null;function u(...b){if(!u.enabled)return;const y=u,w=Number(new Date),S=w-(f||w);y.diff=S,y.prev=f,y.curr=w,f=w,b[0]=s.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");let k=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,(j,L)=>{if(j==="%%")return"%";k++;const I=s.formatters[L];if(typeof I=="function"){const A=b[k];j=I.call(y,A),b.splice(k,1),k--}return j}),s.formatArgs.call(y,b),(y.log||s.log).apply(y,b)}return u.namespace=i,u.useColors=s.useColors(),u.color=s.selectColor(i),u.extend=g,u.destroy=s.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>o!==null?o:(c!==s.namespaces&&(c=s.namespaces,n=s.enabled(i)),n),set:b=>{o=b}}),typeof s.init=="function"&&s.init(u),u}function g(i,f){const c=s(this.namespace+(f===void 0?":":f)+i);return c.log=this.log,c}function d(i){return i.toString().substring(2,i.toString().length-2).replace(/\.\*\?$/,"*")}return s.debug=s,s.default=s,s.coerce=function(i){return i instanceof Error?i.stack||i.message:i},s.disable=function(){const i=[...s.names.map(d),...s.skips.map(d).map(f=>"-"+f)].join(",");return s.enable(""),i},s.enable=function(i){let f;s.save(i),s.namespaces=i,s.names=[],s.skips=[];const c=(typeof i=="string"?i:"").split(/[\s,]+/),n=c.length;for(f=0;f<n;f++)c[f]&&((i=c[f].replace(/\*/g,".*?"))[0]==="-"?s.skips.push(new RegExp("^"+i.slice(1)+"$")):s.names.push(new RegExp("^"+i+"$")))},s.enabled=function(i){if(i[i.length-1]==="*")return!0;let f,c;for(f=0,c=s.skips.length;f<c;f++)if(s.skips[f].test(i))return!1;for(f=0,c=s.names.length;f<c;f++)if(s.names[f].test(i))return!0;return!1},s.humanize=t("ms"),s.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(r).forEach(i=>{s[i]=r[i]}),s.names=[],s.skips=[],s.formatters={},s.selectColor=function(i){let f=0;for(let c=0;c<i.length;c++)f=(f<<5)-f+i.charCodeAt(c),f|=0;return s.colors[Math.abs(f)%s.colors.length]},s.enable(s.load()),s}},{ms:97}],32:[function(t,l,h){(function(r,s){(function(){var g=t("readable-stream"),d=t("end-of-stream"),i=t("inherits"),f=t("stream-shift"),c=s.from&&s.from!==Uint8Array.from?s.from([0]):new s([0]),n=function(y,w){y._corked?y.once("uncork",w):w()},o=function(y,w){return function(S){S?function(k,j){k._autoDestroy&&k.destroy(j)}(y,S.message==="premature close"?null:S):w&&!y._ended&&y.end()}},u=function(){},b=function(y,w,S){if(!(this instanceof b))return new b(y,w,S);g.Duplex.call(this,S),this._writable=null,this._readable=null,this._readable2=null,this._autoDestroy=!S||S.autoDestroy!==!1,this._forwardDestroy=!S||S.destroy!==!1,this._forwardEnd=!S||S.end!==!1,this._corked=1,this._ondrain=null,this._drained=!1,this._forwarding=!1,this._unwrite=null,this._unread=null,this._ended=!1,this.destroyed=!1,y&&this.setWritable(y),w&&this.setReadable(w)};i(b,g.Duplex),b.obj=function(y,w,S){return S||(S={}),S.objectMode=!0,S.highWaterMark=16,new b(y,w,S)},b.prototype.cork=function(){++this._corked==1&&this.emit("cork")},b.prototype.uncork=function(){this._corked&&--this._corked==0&&this.emit("uncork")},b.prototype.setWritable=function(y){if(this._unwrite&&this._unwrite(),this.destroyed)y&&y.destroy&&y.destroy();else if(y!==null&&y!==!1){var w=this,S=d(y,{writable:!0,readable:!1},o(this,this._forwardEnd)),k=function(){var j=w._ondrain;w._ondrain=null,j&&j()};this._unwrite&&r.nextTick(k),this._writable=y,this._writable.on("drain",k),this._unwrite=function(){w._writable.removeListener("drain",k),S()},this.uncork()}else this.end()},b.prototype.setReadable=function(y){if(this._unread&&this._unread(),this.destroyed)y&&y.destroy&&y.destroy();else{if(y===null||y===!1)return this.push(null),void this.resume();var w,S=this,k=d(y,{writable:!1,readable:!0},o(this)),j=function(){S._forward()},L=function(){S.push(null)};this._drained=!0,this._readable=y,this._readable2=y._readableState?y:(w=y,new g.Readable({objectMode:!0,highWaterMark:16}).wrap(w)),this._readable2.on("readable",j),this._readable2.on("end",L),this._unread=function(){S._readable2.removeListener("readable",j),S._readable2.removeListener("end",L),k()},this._forward()}},b.prototype._read=function(){this._drained=!0,this._forward()},b.prototype._forward=function(){if(!this._forwarding&&this._readable2&&this._drained){var y;for(this._forwarding=!0;this._drained&&(y=f(this._readable2))!==null;)this.destroyed||(this._drained=this.push(y));this._forwarding=!1}},b.prototype.destroy=function(y,w){if(w||(w=u),this.destroyed)return w(null);this.destroyed=!0;var S=this;r.nextTick(function(){S._destroy(y),w(null)})},b.prototype._destroy=function(y){if(y){var w=this._ondrain;this._ondrain=null,w?w(y):this.emit("error",y)}this._forwardDestroy&&(this._readable&&this._readable.destroy&&this._readable.destroy(),this._writable&&this._writable.destroy&&this._writable.destroy()),this.emit("close")},b.prototype._write=function(y,w,S){if(!this.destroyed)return this._corked?n(this,this._write.bind(this,y,w,S)):y===c?this._finish(S):this._writable?void(this._writable.write(y)===!1?this._ondrain=S:this.destroyed||S()):S()},b.prototype._finish=function(y){var w=this;this.emit("preend"),n(this,function(){var S,k;S=w._forwardEnd&&w._writable,k=function(){w._writableState.prefinished===!1&&(w._writableState.prefinished=!0),w.emit("prefinish"),n(w,y)},S?S._writableState&&S._writableState.finished?k():S._writableState?S.end(k):(S.end(),k()):k()})},b.prototype.end=function(y,w,S){return typeof y=="function"?this.end(null,null,y):typeof w=="function"?this.end(y,null,w):(this._ended=!0,y&&this.write(y),this._writableState.ending||this._writableState.destroyed||this.write(c),g.Writable.prototype.end.call(this,S))},l.exports=b}).call(this)}).call(this,t("_process"),t("buffer").Buffer)},{_process:102,buffer:29,"end-of-stream":48,inherits:51,"readable-stream":47,"stream-shift":135}],33:[function(t,l,h){var r={};function s(d,i,f){f||(f=Error);var c=function(n){var o,u;function b(y,w,S){return n.call(this,function(k,j,L){return typeof i=="string"?i:i(k,j,L)}(y,w,S))||this}return u=n,(o=b).prototype=Object.create(u.prototype),o.prototype.constructor=o,o.__proto__=u,b}(f);c.prototype.name=f.name,c.prototype.code=d,r[d]=c}function g(d,i){if(Array.isArray(d)){var f=d.length;return d=d.map(function(c){return String(c)}),f>2?"one of ".concat(i," ").concat(d.slice(0,f-1).join(", "),", or ")+d[f-1]:f===2?"one of ".concat(i," ").concat(d[0]," or ").concat(d[1]):"of ".concat(i," ").concat(d[0])}return"of ".concat(i," ").concat(String(d))}s("ERR_INVALID_OPT_VALUE",function(d,i){return'The value "'+i+'" is invalid for option "'+d+'"'},TypeError),s("ERR_INVALID_ARG_TYPE",function(d,i,f){var c,n,o;if(typeof i=="string"&&(n="not ",i.substr(0,n.length)===n)?(c="must not be",i=i.replace(/^not /,"")):c="must be",function(b,y,w){return(w===void 0||w>b.length)&&(w=b.length),b.substring(w-y.length,w)===y}(d," argument"))o="The ".concat(d," ").concat(c," ").concat(g(i,"type"));else{var u=function(b,y,w){return typeof w!="number"&&(w=0),!(w+y.length>b.length)&&b.indexOf(y,w)!==-1}(d,".")?"property":"argument";o='The "'.concat(d,'" ').concat(u," ").concat(c," ").concat(g(i,"type"))}return o+=". Received type ".concat(typeof f)},TypeError),s("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),s("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),s("ERR_STREAM_PREMATURE_CLOSE","Premature close"),s("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),s("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),s("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),s("ERR_STREAM_WRITE_AFTER_END","write after end"),s("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),s("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),s("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),l.exports.codes=r},{}],34:[function(t,l,h){(function(r){(function(){var s=Object.keys||function(b){var y=[];for(var w in b)y.push(w);return y};l.exports=n;var g=t("./_stream_readable"),d=t("./_stream_writable");t("inherits")(n,g);for(var i=s(d.prototype),f=0;f<i.length;f++){var c=i[f];n.prototype[c]||(n.prototype[c]=d.prototype[c])}function n(b){if(!(this instanceof n))return new n(b);g.call(this,b),d.call(this,b),this.allowHalfOpen=!0,b&&(b.readable===!1&&(this.readable=!1),b.writable===!1&&(this.writable=!1),b.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}function o(){this._writableState.ended||r.nextTick(u,this)}function u(b){b.end()}Object.defineProperty(n.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(n.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(n.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(n.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(b){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}})}).call(this)}).call(this,t("_process"))},{"./_stream_readable":36,"./_stream_writable":38,_process:102,inherits:51}],35:[function(t,l,h){l.exports=s;var r=t("./_stream_transform");function s(g){if(!(this instanceof s))return new s(g);r.call(this,g)}t("inherits")(s,r),s.prototype._transform=function(g,d,i){i(null,g)}},{"./_stream_transform":37,inherits:51}],36:[function(t,l,h){(function(r,s){(function(){var g;l.exports=_,_.ReadableState=W,t("events").EventEmitter;var d=function(O,p){return O.listeners(p).length},i=t("./internal/streams/stream"),f=t("buffer").Buffer,c=s.Uint8Array||function(){},n,o=t("util");n=o&&o.debuglog?o.debuglog("stream"):function(){};var u,b,y,w=t("./internal/streams/buffer_list"),S=t("./internal/streams/destroy"),k=t("./internal/streams/state").getHighWaterMark,j=t("../errors").codes,L=j.ERR_INVALID_ARG_TYPE,I=j.ERR_STREAM_PUSH_AFTER_EOF,A=j.ERR_METHOD_NOT_IMPLEMENTED,E=j.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;t("inherits")(_,i);var N=S.errorOrDestroy,G=["error","close","destroy","pause","resume"];function W(O,p,m){g=g||t("./_stream_duplex"),O=O||{},typeof m!="boolean"&&(m=p instanceof g),this.objectMode=!!O.objectMode,m&&(this.objectMode=this.objectMode||!!O.readableObjectMode),this.highWaterMark=k(this,O,"readableHighWaterMark",m),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=O.emitClose!==!1,this.autoDestroy=!!O.autoDestroy,this.destroyed=!1,this.defaultEncoding=O.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,O.encoding&&(u||(u=t("string_decoder/").StringDecoder),this.decoder=new u(O.encoding),this.encoding=O.encoding)}function _(O){if(g=g||t("./_stream_duplex"),!(this instanceof _))return new _(O);var p=this instanceof g;this._readableState=new W(O,this,p),this.readable=!0,O&&(typeof O.read=="function"&&(this._read=O.read),typeof O.destroy=="function"&&(this._destroy=O.destroy)),i.call(this)}function R(O,p,m,v,P){n("readableAddChunk",p);var F,K=O._readableState;if(p===null)K.reading=!1,function(D,Q){if(n("onEofChunk"),!Q.ended){if(Q.decoder){var rt=Q.decoder.end();rt&&rt.length&&(Q.buffer.push(rt),Q.length+=Q.objectMode?1:rt.length)}Q.ended=!0,Q.sync?et(D):(Q.needReadable=!1,Q.emittedReadable||(Q.emittedReadable=!0,M(D)))}}(O,K);else if(P||(F=function(D,Q){var rt;nt=Q,f.isBuffer(nt)||nt instanceof c||typeof Q=="string"||Q===void 0||D.objectMode||(rt=new L("chunk",["string","Buffer","Uint8Array"],Q));var nt;return rt}(K,p)),F)N(O,F);else if(K.objectMode||p&&p.length>0)if(typeof p=="string"||K.objectMode||Object.getPrototypeOf(p)===f.prototype||(p=function(D){return f.from(D)}(p)),v)K.endEmitted?N(O,new E):T(O,K,p,!0);else if(K.ended)N(O,new I);else{if(K.destroyed)return!1;K.reading=!1,K.decoder&&!m?(p=K.decoder.write(p),K.objectMode||p.length!==0?T(O,K,p,!1):C(O,K)):T(O,K,p,!1)}else v||(K.reading=!1,C(O,K));return!K.ended&&(K.length<K.highWaterMark||K.length===0)}function T(O,p,m,v){p.flowing&&p.length===0&&!p.sync?(p.awaitDrain=0,O.emit("data",m)):(p.length+=p.objectMode?1:m.length,v?p.buffer.unshift(m):p.buffer.push(m),p.needReadable&&et(O)),C(O,p)}Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(O){this._readableState&&(this._readableState.destroyed=O)}}),_.prototype.destroy=S.destroy,_.prototype._undestroy=S.undestroy,_.prototype._destroy=function(O,p){p(O)},_.prototype.push=function(O,p){var m,v=this._readableState;return v.objectMode?m=!0:typeof O=="string"&&((p=p||v.defaultEncoding)!==v.encoding&&(O=f.from(O,p),p=""),m=!0),R(this,O,p,!1,m)},_.prototype.unshift=function(O){return R(this,O,null,!0,!1)},_.prototype.isPaused=function(){return this._readableState.flowing===!1},_.prototype.setEncoding=function(O){u||(u=t("string_decoder/").StringDecoder);var p=new u(O);this._readableState.decoder=p,this._readableState.encoding=this._readableState.decoder.encoding;for(var m=this._readableState.buffer.head,v="";m!==null;)v+=p.write(m.data),m=m.next;return this._readableState.buffer.clear(),v!==""&&this._readableState.buffer.push(v),this._readableState.length=v.length,this};var Y=1073741824;function J(O,p){return O<=0||p.length===0&&p.ended?0:p.objectMode?1:O!=O?p.flowing&&p.length?p.buffer.head.data.length:p.length:(O>p.highWaterMark&&(p.highWaterMark=function(m){return m>=Y?m=Y:(m--,m|=m>>>1,m|=m>>>2,m|=m>>>4,m|=m>>>8,m|=m>>>16,m++),m}(O)),O<=p.length?O:p.ended?p.length:(p.needReadable=!0,0))}function et(O){var p=O._readableState;n("emitReadable",p.needReadable,p.emittedReadable),p.needReadable=!1,p.emittedReadable||(n("emitReadable",p.flowing),p.emittedReadable=!0,r.nextTick(M,O))}function M(O){var p=O._readableState;n("emitReadable_",p.destroyed,p.length,p.ended),p.destroyed||!p.length&&!p.ended||(O.emit("readable"),p.emittedReadable=!1),p.needReadable=!p.flowing&&!p.ended&&p.length<=p.highWaterMark,$(O)}function C(O,p){p.readingMore||(p.readingMore=!0,r.nextTick(x,O,p))}function x(O,p){for(;!p.reading&&!p.ended&&(p.length<p.highWaterMark||p.flowing&&p.length===0);){var m=p.length;if(n("maybeReadMore read 0"),O.read(0),m===p.length)break}p.readingMore=!1}function z(O){var p=O._readableState;p.readableListening=O.listenerCount("readable")>0,p.resumeScheduled&&!p.paused?p.flowing=!0:O.listenerCount("data")>0&&O.resume()}function B(O){n("readable nexttick read 0"),O.read(0)}function V(O,p){n("resume",p.reading),p.reading||O.read(0),p.resumeScheduled=!1,O.emit("resume"),$(O),p.flowing&&!p.reading&&O.read(0)}function $(O){var p=O._readableState;for(n("flow",p.flowing);p.flowing&&O.read()!==null;);}function H(O,p){return p.length===0?null:(p.objectMode?m=p.buffer.shift():!O||O>=p.length?(m=p.decoder?p.buffer.join(""):p.buffer.length===1?p.buffer.first():p.buffer.concat(p.length),p.buffer.clear()):m=p.buffer.consume(O,p.decoder),m);var m}function Z(O){var p=O._readableState;n("endReadable",p.endEmitted),p.endEmitted||(p.ended=!0,r.nextTick(X,p,O))}function X(O,p){if(n("endReadableNT",O.endEmitted,O.length),!O.endEmitted&&O.length===0&&(O.endEmitted=!0,p.readable=!1,p.emit("end"),O.autoDestroy)){var m=p._writableState;(!m||m.autoDestroy&&m.finished)&&p.destroy()}}function tt(O,p){for(var m=0,v=O.length;m<v;m++)if(O[m]===p)return m;return-1}_.prototype.read=function(O){n("read",O),O=parseInt(O,10);var p=this._readableState,m=O;if(O!==0&&(p.emittedReadable=!1),O===0&&p.needReadable&&((p.highWaterMark!==0?p.length>=p.highWaterMark:p.length>0)||p.ended))return n("read: emitReadable",p.length,p.ended),p.length===0&&p.ended?Z(this):et(this),null;if((O=J(O,p))===0&&p.ended)return p.length===0&&Z(this),null;var v,P=p.needReadable;return n("need readable",P),(p.length===0||p.length-O<p.highWaterMark)&&n("length less than watermark",P=!0),p.ended||p.reading?n("reading or ended",P=!1):P&&(n("do read"),p.reading=!0,p.sync=!0,p.length===0&&(p.needReadable=!0),this._read(p.highWaterMark),p.sync=!1,p.reading||(O=J(m,p))),(v=O>0?H(O,p):null)===null?(p.needReadable=p.length<=p.highWaterMark,O=0):(p.length-=O,p.awaitDrain=0),p.length===0&&(p.ended||(p.needReadable=!0),m!==O&&p.ended&&Z(this)),v!==null&&this.emit("data",v),v},_.prototype._read=function(O){N(this,new A("_read()"))},_.prototype.pipe=function(O,p){var m=this,v=this._readableState;switch(v.pipesCount){case 0:v.pipes=O;break;case 1:v.pipes=[v.pipes,O];break;default:v.pipes.push(O)}v.pipesCount+=1,n("pipe count=%d opts=%j",v.pipesCount,p);var P=(!p||p.end!==!1)&&O!==r.stdout&&O!==r.stderr?K:ct;function F(ut,U){n("onunpipe"),ut===m&&U&&U.hasUnpiped===!1&&(U.hasUnpiped=!0,n("cleanup"),O.removeListener("close",st),O.removeListener("finish",dt),O.removeListener("drain",D),O.removeListener("error",nt),O.removeListener("unpipe",F),m.removeListener("end",K),m.removeListener("end",ct),m.removeListener("data",rt),Q=!0,!v.awaitDrain||O._writableState&&!O._writableState.needDrain||D())}function K(){n("onend"),O.end()}v.endEmitted?r.nextTick(P):m.once("end",P),O.on("unpipe",F);var D=function(ut){return function(){var U=ut._readableState;n("pipeOnDrain",U.awaitDrain),U.awaitDrain&&U.awaitDrain--,U.awaitDrain===0&&d(ut,"data")&&(U.flowing=!0,$(ut))}}(m);O.on("drain",D);var Q=!1;function rt(ut){n("ondata");var U=O.write(ut);n("dest.write",U),U===!1&&((v.pipesCount===1&&v.pipes===O||v.pipesCount>1&&tt(v.pipes,O)!==-1)&&!Q&&(n("false write response, pause",v.awaitDrain),v.awaitDrain++),m.pause())}function nt(ut){n("onerror",ut),ct(),O.removeListener("error",nt),d(O,"error")===0&&N(O,ut)}function st(){O.removeListener("finish",dt),ct()}function dt(){n("onfinish"),O.removeListener("close",st),ct()}function ct(){n("unpipe"),m.unpipe(O)}return m.on("data",rt),function(ut,U,q){if(typeof ut.prependListener=="function")return ut.prependListener(U,q);ut._events&&ut._events[U]?Array.isArray(ut._events[U])?ut._events[U].unshift(q):ut._events[U]=[q,ut._events[U]]:ut.on(U,q)}(O,"error",nt),O.once("close",st),O.once("finish",dt),O.emit("pipe",m),v.flowing||(n("pipe resume"),m.resume()),O},_.prototype.unpipe=function(O){var p=this._readableState,m={hasUnpiped:!1};if(p.pipesCount===0)return this;if(p.pipesCount===1)return O&&O!==p.pipes||(O||(O=p.pipes),p.pipes=null,p.pipesCount=0,p.flowing=!1,O&&O.emit("unpipe",this,m)),this;if(!O){var v=p.pipes,P=p.pipesCount;p.pipes=null,p.pipesCount=0,p.flowing=!1;for(var F=0;F<P;F++)v[F].emit("unpipe",this,{hasUnpiped:!1});return this}var K=tt(p.pipes,O);return K===-1||(p.pipes.splice(K,1),p.pipesCount-=1,p.pipesCount===1&&(p.pipes=p.pipes[0]),O.emit("unpipe",this,m)),this},_.prototype.on=function(O,p){var m=i.prototype.on.call(this,O,p),v=this._readableState;return O==="data"?(v.readableListening=this.listenerCount("readable")>0,v.flowing!==!1&&this.resume()):O==="readable"&&(v.endEmitted||v.readableListening||(v.readableListening=v.needReadable=!0,v.flowing=!1,v.emittedReadable=!1,n("on readable",v.length,v.reading),v.length?et(this):v.reading||r.nextTick(B,this))),m},_.prototype.addListener=_.prototype.on,_.prototype.removeListener=function(O,p){var m=i.prototype.removeListener.call(this,O,p);return O==="readable"&&r.nextTick(z,this),m},_.prototype.removeAllListeners=function(O){var p=i.prototype.removeAllListeners.apply(this,arguments);return O!=="readable"&&O!==void 0||r.nextTick(z,this),p},_.prototype.resume=function(){var O=this._readableState;return O.flowing||(n("resume"),O.flowing=!O.readableListening,function(p,m){m.resumeScheduled||(m.resumeScheduled=!0,r.nextTick(V,p,m))}(this,O)),O.paused=!1,this},_.prototype.pause=function(){return n("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(n("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},_.prototype.wrap=function(O){var p=this,m=this._readableState,v=!1;for(var P in O.on("end",function(){if(n("wrapped end"),m.decoder&&!m.ended){var K=m.decoder.end();K&&K.length&&p.push(K)}p.push(null)}),O.on("data",function(K){n("wrapped data"),m.decoder&&(K=m.decoder.write(K)),m.objectMode&&K==null||(m.objectMode||K&&K.length)&&(p.push(K)||(v=!0,O.pause()))}),O)this[P]===void 0&&typeof O[P]=="function"&&(this[P]=function(K){return function(){return O[K].apply(O,arguments)}}(P));for(var F=0;F<G.length;F++)O.on(G[F],this.emit.bind(this,G[F]));return this._read=function(K){n("wrapped _read",K),v&&(v=!1,O.resume())},this},typeof Symbol=="function"&&(_.prototype[Symbol.asyncIterator]=function(){return b===void 0&&(b=t("./internal/streams/async_iterator")),b(this)}),Object.defineProperty(_.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(_.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(_.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(O){this._readableState&&(this._readableState.flowing=O)}}),_._fromList=H,Object.defineProperty(_.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(_.from=function(O,p){return y===void 0&&(y=t("./internal/streams/from")),y(_,O,p)})}).call(this)}).call(this,t("_process"),typeof xt<"u"?xt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":33,"./_stream_duplex":34,"./internal/streams/async_iterator":39,"./internal/streams/buffer_list":40,"./internal/streams/destroy":41,"./internal/streams/from":43,"./internal/streams/state":45,"./internal/streams/stream":46,_process:102,buffer:29,events:49,inherits:51,"string_decoder/":136,util:26}],37:[function(t,l,h){l.exports=n;var r=t("../errors").codes,s=r.ERR_METHOD_NOT_IMPLEMENTED,g=r.ERR_MULTIPLE_CALLBACK,d=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,i=r.ERR_TRANSFORM_WITH_LENGTH_0,f=t("./_stream_duplex");function c(b,y){var w=this._transformState;w.transforming=!1;var S=w.writecb;if(S===null)return this.emit("error",new g);w.writechunk=null,w.writecb=null,y!=null&&this.push(y),S(b);var k=this._readableState;k.reading=!1,(k.needReadable||k.length<k.highWaterMark)&&this._read(k.highWaterMark)}function n(b){if(!(this instanceof n))return new n(b);f.call(this,b),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,b&&(typeof b.transform=="function"&&(this._transform=b.transform),typeof b.flush=="function"&&(this._flush=b.flush)),this.on("prefinish",o)}function o(){var b=this;typeof this._flush!="function"||this._readableState.destroyed?u(this,null,null):this._flush(function(y,w){u(b,y,w)})}function u(b,y,w){if(y)return b.emit("error",y);if(w!=null&&b.push(w),b._writableState.length)throw new i;if(b._transformState.transforming)throw new d;return b.push(null)}t("inherits")(n,f),n.prototype.push=function(b,y){return this._transformState.needTransform=!1,f.prototype.push.call(this,b,y)},n.prototype._transform=function(b,y,w){w(new s("_transform()"))},n.prototype._write=function(b,y,w){var S=this._transformState;if(S.writecb=w,S.writechunk=b,S.writeencoding=y,!S.transforming){var k=this._readableState;(S.needTransform||k.needReadable||k.length<k.highWaterMark)&&this._read(k.highWaterMark)}},n.prototype._read=function(b){var y=this._transformState;y.writechunk===null||y.transforming?y.needTransform=!0:(y.transforming=!0,this._transform(y.writechunk,y.writeencoding,y.afterTransform))},n.prototype._destroy=function(b,y){f.prototype._destroy.call(this,b,function(w){y(w)})}},{"../errors":33,"./_stream_duplex":34,inherits:51}],38:[function(t,l,h){(function(r,s){(function(){function g(C){var x=this;this.next=null,this.entry=null,this.finish=function(){(function(z,B,V){var $=z.entry;for(z.entry=null;$;){var H=$.callback;B.pendingcb--,H(V),$=$.next}B.corkedRequestsFree.next=z})(x,C)}}var d;l.exports=_,_.WritableState=W;var i={deprecate:t("util-deprecate")},f=t("./internal/streams/stream"),c=t("buffer").Buffer,n=s.Uint8Array||function(){},o,u=t("./internal/streams/destroy"),b=t("./internal/streams/state").getHighWaterMark,y=t("../errors").codes,w=y.ERR_INVALID_ARG_TYPE,S=y.ERR_METHOD_NOT_IMPLEMENTED,k=y.ERR_MULTIPLE_CALLBACK,j=y.ERR_STREAM_CANNOT_PIPE,L=y.ERR_STREAM_DESTROYED,I=y.ERR_STREAM_NULL_VALUES,A=y.ERR_STREAM_WRITE_AFTER_END,E=y.ERR_UNKNOWN_ENCODING,N=u.errorOrDestroy;function G(){}function W(C,x,z){d=d||t("./_stream_duplex"),C=C||{},typeof z!="boolean"&&(z=x instanceof d),this.objectMode=!!C.objectMode,z&&(this.objectMode=this.objectMode||!!C.writableObjectMode),this.highWaterMark=b(this,C,"writableHighWaterMark",z),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var B=C.decodeStrings===!1;this.decodeStrings=!B,this.defaultEncoding=C.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(V){(function($,H){var Z=$._writableState,X=Z.sync,tt=Z.writecb;if(typeof tt!="function")throw new k;if(function(p){p.writing=!1,p.writecb=null,p.length-=p.writelen,p.writelen=0}(Z),H)(function(p,m,v,P,F){--m.pendingcb,v?(r.nextTick(F,P),r.nextTick(M,p,m),p._writableState.errorEmitted=!0,N(p,P)):(F(P),p._writableState.errorEmitted=!0,N(p,P),M(p,m))})($,Z,X,H,tt);else{var O=J(Z)||$.destroyed;O||Z.corked||Z.bufferProcessing||!Z.bufferedRequest||Y($,Z),X?r.nextTick(T,$,Z,O,tt):T($,Z,O,tt)}})(x,V)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=C.emitClose!==!1,this.autoDestroy=!!C.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}function _(C){var x=this instanceof(d=d||t("./_stream_duplex"));if(!x&&!o.call(_,this))return new _(C);this._writableState=new W(C,this,x),this.writable=!0,C&&(typeof C.write=="function"&&(this._write=C.write),typeof C.writev=="function"&&(this._writev=C.writev),typeof C.destroy=="function"&&(this._destroy=C.destroy),typeof C.final=="function"&&(this._final=C.final)),f.call(this)}function R(C,x,z,B,V,$,H){x.writelen=B,x.writecb=H,x.writing=!0,x.sync=!0,x.destroyed?x.onwrite(new L("write")):z?C._writev(V,x.onwrite):C._write(V,$,x.onwrite),x.sync=!1}function T(C,x,z,B){z||function(V,$){$.length===0&&$.needDrain&&($.needDrain=!1,V.emit("drain"))}(C,x),x.pendingcb--,B(),M(C,x)}function Y(C,x){x.bufferProcessing=!0;var z=x.bufferedRequest;if(C._writev&&z&&z.next){var B=x.bufferedRequestCount,V=new Array(B),$=x.corkedRequestsFree;$.entry=z;for(var H=0,Z=!0;z;)V[H]=z,z.isBuf||(Z=!1),z=z.next,H+=1;V.allBuffers=Z,R(C,x,!0,x.length,V,"",$.finish),x.pendingcb++,x.lastBufferedRequest=null,$.next?(x.corkedRequestsFree=$.next,$.next=null):x.corkedRequestsFree=new g(x),x.bufferedRequestCount=0}else{for(;z;){var X=z.chunk,tt=z.encoding,O=z.callback;if(R(C,x,!1,x.objectMode?1:X.length,X,tt,O),z=z.next,x.bufferedRequestCount--,x.writing)break}z===null&&(x.lastBufferedRequest=null)}x.bufferedRequest=z,x.bufferProcessing=!1}function J(C){return C.ending&&C.length===0&&C.bufferedRequest===null&&!C.finished&&!C.writing}function et(C,x){C._final(function(z){x.pendingcb--,z&&N(C,z),x.prefinished=!0,C.emit("prefinish"),M(C,x)})}function M(C,x){var z=J(x);if(z&&(function(V,$){$.prefinished||$.finalCalled||(typeof V._final!="function"||$.destroyed?($.prefinished=!0,V.emit("prefinish")):($.pendingcb++,$.finalCalled=!0,r.nextTick(et,V,$)))}(C,x),x.pendingcb===0&&(x.finished=!0,C.emit("finish"),x.autoDestroy))){var B=C._readableState;(!B||B.autoDestroy&&B.endEmitted)&&C.destroy()}return z}t("inherits")(_,f),W.prototype.getBuffer=function(){for(var C=this.bufferedRequest,x=[];C;)x.push(C),C=C.next;return x},function(){try{Object.defineProperty(W.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(o=Function.prototype[Symbol.hasInstance],Object.defineProperty(_,Symbol.hasInstance,{value:function(C){return!!o.call(this,C)||this===_&&C&&C._writableState instanceof W}})):o=function(C){return C instanceof this},_.prototype.pipe=function(){N(this,new j)},_.prototype.write=function(C,x,z){var B,V=this._writableState,$=!1,H=!V.objectMode&&(B=C,c.isBuffer(B)||B instanceof n);return H&&!c.isBuffer(C)&&(C=function(Z){return c.from(Z)}(C)),typeof x=="function"&&(z=x,x=null),H?x="buffer":x||(x=V.defaultEncoding),typeof z!="function"&&(z=G),V.ending?function(Z,X){var tt=new A;N(Z,tt),r.nextTick(X,tt)}(this,z):(H||function(Z,X,tt,O){var p;return tt===null?p=new I:typeof tt=="string"||X.objectMode||(p=new w("chunk",["string","Buffer"],tt)),!p||(N(Z,p),r.nextTick(O,p),!1)}(this,V,C,z))&&(V.pendingcb++,$=function(Z,X,tt,O,p,m){if(!tt){var v=function(D,Q,rt){return D.objectMode||D.decodeStrings===!1||typeof Q!="string"||(Q=c.from(Q,rt)),Q}(X,O,p);O!==v&&(tt=!0,p="buffer",O=v)}var P=X.objectMode?1:O.length;X.length+=P;var F=X.length<X.highWaterMark;if(F||(X.needDrain=!0),X.writing||X.corked){var K=X.lastBufferedRequest;X.lastBufferedRequest={chunk:O,encoding:p,isBuf:tt,callback:m,next:null},K?K.next=X.lastBufferedRequest:X.bufferedRequest=X.lastBufferedRequest,X.bufferedRequestCount+=1}else R(Z,X,!1,P,O,p,m);return F}(this,V,H,C,x,z)),$},_.prototype.cork=function(){this._writableState.corked++},_.prototype.uncork=function(){var C=this._writableState;C.corked&&(C.corked--,C.writing||C.corked||C.bufferProcessing||!C.bufferedRequest||Y(this,C))},_.prototype.setDefaultEncoding=function(C){if(typeof C=="string"&&(C=C.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((C+"").toLowerCase())>-1))throw new E(C);return this._writableState.defaultEncoding=C,this},Object.defineProperty(_.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(_.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),_.prototype._write=function(C,x,z){z(new S("_write()"))},_.prototype._writev=null,_.prototype.end=function(C,x,z){var B=this._writableState;return typeof C=="function"?(z=C,C=null,x=null):typeof x=="function"&&(z=x,x=null),C!=null&&this.write(C,x),B.corked&&(B.corked=1,this.uncork()),B.ending||function(V,$,H){$.ending=!0,M(V,$),H&&($.finished?r.nextTick(H):V.once("finish",H)),$.ended=!0,V.writable=!1}(this,B,z),this},Object.defineProperty(_.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(_.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(C){this._writableState&&(this._writableState.destroyed=C)}}),_.prototype.destroy=u.destroy,_.prototype._undestroy=u.undestroy,_.prototype._destroy=function(C,x){x(C)}}).call(this)}).call(this,t("_process"),typeof xt<"u"?xt:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":33,"./_stream_duplex":34,"./internal/streams/destroy":41,"./internal/streams/state":45,"./internal/streams/stream":46,_process:102,buffer:29,inherits:51,"util-deprecate":139}],39:[function(t,l,h){(function(r){(function(){var s;function g(L,I,A){return I in L?Object.defineProperty(L,I,{value:A,enumerable:!0,configurable:!0,writable:!0}):L[I]=A,L}var d=t("./end-of-stream"),i=Symbol("lastResolve"),f=Symbol("lastReject"),c=Symbol("error"),n=Symbol("ended"),o=Symbol("lastPromise"),u=Symbol("handlePromise"),b=Symbol("stream");function y(L,I){return{value:L,done:I}}function w(L){var I=L[i];if(I!==null){var A=L[b].read();A!==null&&(L[o]=null,L[i]=null,L[f]=null,I(y(A,!1)))}}function S(L){r.nextTick(w,L)}var k=Object.getPrototypeOf(function(){}),j=Object.setPrototypeOf((g(s={get stream(){return this[b]},next:function(){var L=this,I=this[c];if(I!==null)return Promise.reject(I);if(this[n])return Promise.resolve(y(void 0,!0));if(this[b].destroyed)return new Promise(function(G,W){r.nextTick(function(){L[c]?W(L[c]):G(y(void 0,!0))})});var A,E=this[o];if(E)A=new Promise(function(G,W){return function(_,R){G.then(function(){W[n]?_(y(void 0,!0)):W[u](_,R)},R)}}(E,this));else{var N=this[b].read();if(N!==null)return Promise.resolve(y(N,!1));A=new Promise(this[u])}return this[o]=A,A}},Symbol.asyncIterator,function(){return this}),g(s,"return",function(){var L=this;return new Promise(function(I,A){L[b].destroy(null,function(E){E?A(E):I(y(void 0,!0))})})}),s),k);l.exports=function(L){var I,A=Object.create(j,(g(I={},b,{value:L,writable:!0}),g(I,i,{value:null,writable:!0}),g(I,f,{value:null,writable:!0}),g(I,c,{value:null,writable:!0}),g(I,n,{value:L._readableState.endEmitted,writable:!0}),g(I,u,{value:function(E,N){var G=A[b].read();G?(A[o]=null,A[i]=null,A[f]=null,E(y(G,!1))):(A[i]=E,A[f]=N)},writable:!0}),I));return A[o]=null,d(L,function(E){if(E&&E.code!=="ERR_STREAM_PREMATURE_CLOSE"){var N=A[f];return N!==null&&(A[o]=null,A[i]=null,A[f]=null,N(E)),void(A[c]=E)}var G=A[i];G!==null&&(A[o]=null,A[i]=null,A[f]=null,G(y(void 0,!0))),A[n]=!0}),L.on("readable",S.bind(null,A)),A}}).call(this)}).call(this,t("_process"))},{"./end-of-stream":42,_process:102}],40:[function(t,l,h){function r(c,n){var o=Object.keys(c);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(c);n&&(u=u.filter(function(b){return Object.getOwnPropertyDescriptor(c,b).enumerable})),o.push.apply(o,u)}return o}function s(c,n,o){return n in c?Object.defineProperty(c,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):c[n]=o,c}function g(c,n){for(var o=0;o<n.length;o++){var u=n[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(c,u.key,u)}}var d=t("buffer").Buffer,i=t("util").inspect,f=i&&i.custom||"inspect";l.exports=function(){function c(){(function(u,b){if(!(u instanceof b))throw new TypeError("Cannot call a class as a function")})(this,c),this.head=null,this.tail=null,this.length=0}var n,o;return n=c,o=[{key:"push",value:function(u){var b={data:u,next:null};this.length>0?this.tail.next=b:this.head=b,this.tail=b,++this.length}},{key:"unshift",value:function(u){var b={data:u,next:this.head};this.length===0&&(this.tail=b),this.head=b,++this.length}},{key:"shift",value:function(){if(this.length!==0){var u=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,u}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(u){if(this.length===0)return"";for(var b=this.head,y=""+b.data;b=b.next;)y+=u+b.data;return y}},{key:"concat",value:function(u){if(this.length===0)return d.alloc(0);for(var b,y,w,S=d.allocUnsafe(u>>>0),k=this.head,j=0;k;)b=k.data,y=S,w=j,d.prototype.copy.call(b,y,w),j+=k.data.length,k=k.next;return S}},{key:"consume",value:function(u,b){var y;return u<this.head.data.length?(y=this.head.data.slice(0,u),this.head.data=this.head.data.slice(u)):y=u===this.head.data.length?this.shift():b?this._getString(u):this._getBuffer(u),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(u){var b=this.head,y=1,w=b.data;for(u-=w.length;b=b.next;){var S=b.data,k=u>S.length?S.length:u;if(k===S.length?w+=S:w+=S.slice(0,u),(u-=k)==0){k===S.length?(++y,b.next?this.head=b.next:this.head=this.tail=null):(this.head=b,b.data=S.slice(k));break}++y}return this.length-=y,w}},{key:"_getBuffer",value:function(u){var b=d.allocUnsafe(u),y=this.head,w=1;for(y.data.copy(b),u-=y.data.length;y=y.next;){var S=y.data,k=u>S.length?S.length:u;if(S.copy(b,b.length-u,0,k),(u-=k)==0){k===S.length?(++w,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=S.slice(k));break}++w}return this.length-=w,b}},{key:f,value:function(u,b){return i(this,function(y){for(var w=1;w<arguments.length;w++){var S=arguments[w]!=null?arguments[w]:{};w%2?r(Object(S),!0).forEach(function(k){s(y,k,S[k])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(S)):r(Object(S)).forEach(function(k){Object.defineProperty(y,k,Object.getOwnPropertyDescriptor(S,k))})}return y}({},b,{depth:0,customInspect:!1}))}}],o&&g(n.prototype,o),c}()},{buffer:29,util:26}],41:[function(t,l,h){(function(r){(function(){function s(i,f){d(i,f),g(i)}function g(i){i._writableState&&!i._writableState.emitClose||i._readableState&&!i._readableState.emitClose||i.emit("close")}function d(i,f){i.emit("error",f)}l.exports={destroy:function(i,f){var c=this,n=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return n||o?(f?f(i):i&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(d,this,i)):r.nextTick(d,this,i)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(i||null,function(u){!f&&u?c._writableState?c._writableState.errorEmitted?r.nextTick(g,c):(c._writableState.errorEmitted=!0,r.nextTick(s,c,u)):r.nextTick(s,c,u):f?(r.nextTick(g,c),f(u)):r.nextTick(g,c)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(i,f){var c=i._readableState,n=i._writableState;c&&c.autoDestroy||n&&n.autoDestroy?i.destroy(f):i.emit("error",f)}}}).call(this)}).call(this,t("_process"))},{_process:102}],42:[function(t,l,h){var r=t("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function s(){}l.exports=function g(d,i,f){if(typeof i=="function")return g(d,null,i);i||(i={}),f=function(L){var I=!1;return function(){if(!I){I=!0;for(var A=arguments.length,E=new Array(A),N=0;N<A;N++)E[N]=arguments[N];L.apply(this,E)}}}(f||s);var c=i.readable||i.readable!==!1&&d.readable,n=i.writable||i.writable!==!1&&d.writable,o=function(){d.writable||b()},u=d._writableState&&d._writableState.finished,b=function(){n=!1,u=!0,c||f.call(d)},y=d._readableState&&d._readableState.endEmitted,w=function(){c=!1,y=!0,n||f.call(d)},S=function(L){f.call(d,L)},k=function(){var L;return c&&!y?(d._readableState&&d._readableState.ended||(L=new r),f.call(d,L)):n&&!u?(d._writableState&&d._writableState.ended||(L=new r),f.call(d,L)):void 0},j=function(){d.req.on("finish",b)};return function(L){return L.setHeader&&typeof L.abort=="function"}(d)?(d.on("complete",b),d.on("abort",k),d.req?j():d.on("request",j)):n&&!d._writableState&&(d.on("end",o),d.on("close",o)),d.on("end",w),d.on("finish",b),i.error!==!1&&d.on("error",S),d.on("close",k),function(){d.removeListener("complete",b),d.removeListener("abort",k),d.removeListener("request",j),d.req&&d.req.removeListener("finish",b),d.removeListener("end",o),d.removeListener("close",o),d.removeListener("finish",b),d.removeListener("end",w),d.removeListener("error",S),d.removeListener("close",k)}}},{"../../../errors":33}],43:[function(t,l,h){l.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],44:[function(t,l,h){var r,s=t("../../../errors").codes,g=s.ERR_MISSING_ARGS,d=s.ERR_STREAM_DESTROYED;function i(n){if(n)throw n}function f(n){n()}function c(n,o){return n.pipe(o)}l.exports=function(){for(var n=arguments.length,o=new Array(n),u=0;u<n;u++)o[u]=arguments[u];var b,y=function(S){return S.length?typeof S[S.length-1]!="function"?i:S.pop():i}(o);if(Array.isArray(o[0])&&(o=o[0]),o.length<2)throw new g("streams");var w=o.map(function(S,k){var j=k<o.length-1;return function(L,I,A,E){E=function(W){var _=!1;return function(){_||(_=!0,W.apply(void 0,arguments))}}(E);var N=!1;L.on("close",function(){N=!0}),r===void 0&&(r=t("./end-of-stream")),r(L,{readable:I,writable:A},function(W){if(W)return E(W);N=!0,E()});var G=!1;return function(W){if(!N&&!G)return G=!0,function(_){return _.setHeader&&typeof _.abort=="function"}(L)?L.abort():typeof L.destroy=="function"?L.destroy():void E(W||new d("pipe"))}}(S,j,k>0,function(L){b||(b=L),L&&w.forEach(f),j||(w.forEach(f),y(b))})});return o.reduce(c)}},{"../../../errors":33,"./end-of-stream":42}],45:[function(t,l,h){var r=t("../../../errors").codes.ERR_INVALID_OPT_VALUE;l.exports={getHighWaterMark:function(s,g,d,i){var f=function(c,n,o){return c.highWaterMark!=null?c.highWaterMark:n?c[o]:null}(g,i,d);if(f!=null){if(!isFinite(f)||Math.floor(f)!==f||f<0)throw new r(i?d:"highWaterMark",f);return Math.floor(f)}return s.objectMode?16:16384}}},{"../../../errors":33}],46:[function(t,l,h){l.exports=t("events").EventEmitter},{events:49}],47:[function(t,l,h){(h=l.exports=t("./lib/_stream_readable.js")).Stream=h,h.Readable=h,h.Writable=t("./lib/_stream_writable.js"),h.Duplex=t("./lib/_stream_duplex.js"),h.Transform=t("./lib/_stream_transform.js"),h.PassThrough=t("./lib/_stream_passthrough.js"),h.finished=t("./lib/internal/streams/end-of-stream.js"),h.pipeline=t("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":34,"./lib/_stream_passthrough.js":35,"./lib/_stream_readable.js":36,"./lib/_stream_transform.js":37,"./lib/_stream_writable.js":38,"./lib/internal/streams/end-of-stream.js":42,"./lib/internal/streams/pipeline.js":44}],48:[function(t,l,h){(function(r){(function(){var s=t("once"),g=function(){},d=function(i,f,c){if(typeof f=="function")return d(i,null,f);f||(f={}),c=s(c||g);var n=i._writableState,o=i._readableState,u=f.readable||f.readable!==!1&&i.readable,b=f.writable||f.writable!==!1&&i.writable,y=!1,w=function(){i.writable||S()},S=function(){b=!1,u||c.call(i)},k=function(){u=!1,b||c.call(i)},j=function(N){c.call(i,N?new Error("exited with error code: "+N):null)},L=function(N){c.call(i,N)},I=function(){r.nextTick(A)},A=function(){if(!y)return(!u||o&&o.ended&&!o.destroyed)&&(!b||n&&n.ended&&!n.destroyed)?void 0:c.call(i,new Error("premature close"))},E=function(){i.req.on("finish",S)};return function(N){return N.setHeader&&typeof N.abort=="function"}(i)?(i.on("complete",S),i.on("abort",I),i.req?E():i.on("request",E)):b&&!n&&(i.on("end",w),i.on("close",w)),function(N){return N.stdio&&Array.isArray(N.stdio)&&N.stdio.length===3}(i)&&i.on("exit",j),i.on("end",k),i.on("finish",S),f.error!==!1&&i.on("error",L),i.on("close",I),function(){y=!0,i.removeListener("complete",S),i.removeListener("abort",I),i.removeListener("request",E),i.req&&i.req.removeListener("finish",S),i.removeListener("end",w),i.removeListener("close",w),i.removeListener("finish",S),i.removeListener("exit",j),i.removeListener("end",k),i.removeListener("error",L),i.removeListener("close",I)}};l.exports=d}).call(this)}).call(this,t("_process"))},{_process:102,once:100}],49:[function(t,l,h){var r,s=typeof Reflect=="object"?Reflect:null,g=s&&typeof s.apply=="function"?s.apply:function(j,L,I){return Function.prototype.apply.call(j,L,I)};r=s&&typeof s.ownKeys=="function"?s.ownKeys:Object.getOwnPropertySymbols?function(j){return Object.getOwnPropertyNames(j).concat(Object.getOwnPropertySymbols(j))}:function(j){return Object.getOwnPropertyNames(j)};var d=Number.isNaN||function(j){return j!=j};function i(){i.init.call(this)}l.exports=i,l.exports.once=function(j,L){return new Promise(function(I,A){function E(G){j.removeListener(L,N),A(G)}function N(){typeof j.removeListener=="function"&&j.removeListener("error",E),I([].slice.call(arguments))}k(j,L,N,{once:!0}),L!=="error"&&function(G,W,_){typeof G.on=="function"&&k(G,"error",W,_)}(j,E,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var f=10;function c(j){if(typeof j!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof j)}function n(j){return j._maxListeners===void 0?i.defaultMaxListeners:j._maxListeners}function o(j,L,I,A){var E,N,G,W;if(c(I),(N=j._events)===void 0?(N=j._events=Object.create(null),j._eventsCount=0):(N.newListener!==void 0&&(j.emit("newListener",L,I.listener?I.listener:I),N=j._events),G=N[L]),G===void 0)G=N[L]=I,++j._eventsCount;else if(typeof G=="function"?G=N[L]=A?[I,G]:[G,I]:A?G.unshift(I):G.push(I),(E=n(j))>0&&G.length>E&&!G.warned){G.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");_.name="MaxListenersExceededWarning",_.emitter=j,_.type=L,_.count=G.length,W=_,console&&console.warn&&console.warn(W)}return j}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function b(j,L,I){var A={fired:!1,wrapFn:void 0,target:j,type:L,listener:I},E=u.bind(A);return E.listener=I,A.wrapFn=E,E}function y(j,L,I){var A=j._events;if(A===void 0)return[];var E=A[L];return E===void 0?[]:typeof E=="function"?I?[E.listener||E]:[E]:I?function(N){for(var G=new Array(N.length),W=0;W<G.length;++W)G[W]=N[W].listener||N[W];return G}(E):S(E,E.length)}function w(j){var L=this._events;if(L!==void 0){var I=L[j];if(typeof I=="function")return 1;if(I!==void 0)return I.length}return 0}function S(j,L){for(var I=new Array(L),A=0;A<L;++A)I[A]=j[A];return I}function k(j,L,I,A){if(typeof j.on=="function")A.once?j.once(L,I):j.on(L,I);else{if(typeof j.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof j);j.addEventListener(L,function E(N){A.once&&j.removeEventListener(L,E),I(N)})}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(j){if(typeof j!="number"||j<0||d(j))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+j+".");f=j}}),i.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||d(j))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+j+".");return this._maxListeners=j,this},i.prototype.getMaxListeners=function(){return n(this)},i.prototype.emit=function(j){for(var L=[],I=1;I<arguments.length;I++)L.push(arguments[I]);var A=j==="error",E=this._events;if(E!==void 0)A=A&&E.error===void 0;else if(!A)return!1;if(A){var N;if(L.length>0&&(N=L[0]),N instanceof Error)throw N;var G=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw G.context=N,G}var W=E[j];if(W===void 0)return!1;if(typeof W=="function")g(W,this,L);else{var _=W.length,R=S(W,_);for(I=0;I<_;++I)g(R[I],this,L)}return!0},i.prototype.addListener=function(j,L){return o(this,j,L,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(j,L){return o(this,j,L,!0)},i.prototype.once=function(j,L){return c(L),this.on(j,b(this,j,L)),this},i.prototype.prependOnceListener=function(j,L){return c(L),this.prependListener(j,b(this,j,L)),this},i.prototype.removeListener=function(j,L){var I,A,E,N,G;if(c(L),(A=this._events)===void 0)return this;if((I=A[j])===void 0)return this;if(I===L||I.listener===L)--this._eventsCount==0?this._events=Object.create(null):(delete A[j],A.removeListener&&this.emit("removeListener",j,I.listener||L));else if(typeof I!="function"){for(E=-1,N=I.length-1;N>=0;N--)if(I[N]===L||I[N].listener===L){G=I[N].listener,E=N;break}if(E<0)return this;E===0?I.shift():function(W,_){for(;_+1<W.length;_++)W[_]=W[_+1];W.pop()}(I,E),I.length===1&&(A[j]=I[0]),A.removeListener!==void 0&&this.emit("removeListener",j,G||L)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(j){var L,I,A;if((I=this._events)===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[j]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete I[j]),this;if(arguments.length===0){var E,N=Object.keys(I);for(A=0;A<N.length;++A)(E=N[A])!=="removeListener"&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(L=I[j])=="function")this.removeListener(j,L);else if(L!==void 0)for(A=L.length-1;A>=0;A--)this.removeListener(j,L[A]);return this},i.prototype.listeners=function(j){return y(this,j,!0)},i.prototype.rawListeners=function(j){return y(this,j,!1)},i.listenerCount=function(j,L){return typeof j.listenerCount=="function"?j.listenerCount(L):w.call(j,L)},i.prototype.listenerCount=w,i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},{}],50:[function(t,l,h){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */h.read=function(r,s,g,d,i){var f,c,n=8*i-d-1,o=(1<<n)-1,u=o>>1,b=-7,y=g?i-1:0,w=g?-1:1,S=r[s+y];for(y+=w,f=S&(1<<-b)-1,S>>=-b,b+=n;b>0;f=256*f+r[s+y],y+=w,b-=8);for(c=f&(1<<-b)-1,f>>=-b,b+=d;b>0;c=256*c+r[s+y],y+=w,b-=8);if(f===0)f=1-u;else{if(f===o)return c?NaN:1/0*(S?-1:1);c+=Math.pow(2,d),f-=u}return(S?-1:1)*c*Math.pow(2,f-d)},h.write=function(r,s,g,d,i,f){var c,n,o,u=8*f-i-1,b=(1<<u)-1,y=b>>1,w=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=d?0:f-1,k=d?1:-1,j=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(n=isNaN(s)?1:0,c=b):(c=Math.floor(Math.log(s)/Math.LN2),s*(o=Math.pow(2,-c))<1&&(c--,o*=2),(s+=c+y>=1?w/o:w*Math.pow(2,1-y))*o>=2&&(c++,o/=2),c+y>=b?(n=0,c=b):c+y>=1?(n=(s*o-1)*Math.pow(2,i),c+=y):(n=s*Math.pow(2,y-1)*Math.pow(2,i),c=0));i>=8;r[g+S]=255&n,S+=k,n/=256,i-=8);for(c=c<<i|n,u+=i;u>0;r[g+S]=255&c,S+=k,c/=256,u-=8);r[g+S-k]|=128*j}},{}],51:[function(t,l,h){typeof Object.create=="function"?l.exports=function(r,s){s&&(r.super_=s,r.prototype=Object.create(s.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:l.exports=function(r,s){if(s){r.super_=s;var g=function(){};g.prototype=s.prototype,r.prototype=new g,r.prototype.constructor=r}}},{}],52:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.ContainerIterator=h.Container=h.Base=void 0,h.ContainerIterator=class{constructor(s=0){this.iteratorType=s}equals(s){return this.o===s.o}};class r{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}}h.Base=r,h.Container=class extends r{}},{}],53:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.HashContainerIterator=h.HashContainer=void 0;var r,s=t("../../ContainerBase"),g=(r=t("../../../utils/checkObject"))&&r.t?r:{default:r},d=t("../../../utils/throwError");class i extends s.ContainerIterator{constructor(n,o,u){super(u),this.o=n,this.h=o,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.L,this})}}h.HashContainerIterator=i;class f extends s.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(n){const{L:o,B:u}=n;o.B=u,u.L=o,n===this.p&&(this.p=u),n===this._&&(this._=o),this.i-=1}M(n,o,u){let b;if(u===void 0&&(u=(0,g.default)(n)),u){const y=n[this.HASH_TAG];if(y!==void 0)return this.H[y].l=o,this.i;Object.defineProperty(n,this.HASH_TAG,{value:this.H.length,configurable:!0}),b={u:n,l:o,L:this._,B:this.h},this.H.push(b)}else{const y=this.g[n];if(y)return y.l=o,this.i;b={u:n,l:o,L:this._,B:this.h},this.g[n]=b}return this.i===0?(this.p=b,this.h.B=b):this._.B=b,this._=b,this.h.L=b,++this.i}I(n,o){if(o===void 0&&(o=(0,g.default)(n)),o){const u=n[this.HASH_TAG];return u===void 0?this.h:this.H[u]}return this.g[n]||this.h}clear(){const n=this.HASH_TAG;this.H.forEach(function(o){delete o.u[n]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(n,o){let u;if(o===void 0&&(o=(0,g.default)(n)),o){const b=n[this.HASH_TAG];if(b===void 0)return!1;delete n[this.HASH_TAG],u=this.H[b],delete this.H[b]}else{if(u=this.g[n],u===void 0)return!1;delete this.g[n]}return this.V(u),!0}eraseElementByIterator(n){const o=n.o;return o===this.h&&(0,d.throwIteratorAccessError)(),this.V(o),n.next()}eraseElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let o=this.p;for(;n--;)o=o.B;return this.V(o),this.i}}h.HashContainer=f},{"../../../utils/checkObject":70,"../../../utils/throwError":71,"../../ContainerBase":52}],54:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r,s=t("./Base"),g=(r=t("../../utils/checkObject"))&&r.t?r:{default:r},d=t("../../utils/throwError");class i extends s.HashContainerIterator{constructor(o,u,b,y){super(o,u,y),this.container=b}get pointer(){this.o===this.h&&(0,d.throwIteratorAccessError)();const o=this;return new Proxy([],{get:(u,b)=>b==="0"?o.o.u:b==="1"?o.o.l:void 0,set(u,b,y){if(b!=="1")throw new TypeError("props must be 1");return o.o.l=y,!0}})}copy(){return new i(this.o,this.h,this.container,this.iteratorType)}}class f extends s.HashContainer{constructor(o=[]){super();const u=this;o.forEach(function(b){u.setElement(b[0],b[1])})}begin(){return new i(this.p,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this._,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(o,u,b){return this.M(o,u,b)}getElementByKey(o,u){if(u===void 0&&(u=(0,g.default)(o)),u){const y=o[this.HASH_TAG];return y!==void 0?this.H[y].l:void 0}const b=this.g[o];return b?b.l:void 0}getElementByPos(o){if(o<0||o>this.i-1)throw new RangeError;let u=this.p;for(;o--;)u=u.B;return[u.u,u.l]}find(o,u){const b=this.I(o,u);return new i(b,this.h,this)}forEach(o){let u=0,b=this.p;for(;b!==this.h;)o([b.u,b.l],u++,this),b=b.B}[Symbol.iterator](){return(function*(){let o=this.p;for(;o!==this.h;)yield[o.u,o.l],o=o.B}).bind(this)()}}var c=f;h.default=c},{"../../utils/checkObject":70,"../../utils/throwError":71,"./Base":53}],55:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("./Base"),s=t("../../utils/throwError");class g extends r.HashContainerIterator{constructor(c,n,o,u){super(c,n,u),this.container=o}get pointer(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o.u}copy(){return new g(this.o,this.h,this.container,this.iteratorType)}}class d extends r.HashContainer{constructor(c=[]){super();const n=this;c.forEach(function(o){n.insert(o)})}begin(){return new g(this.p,this.h,this)}end(){return new g(this.h,this.h,this)}rBegin(){return new g(this._,this.h,this,1)}rEnd(){return new g(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(c,n){return this.M(c,void 0,n)}getElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let n=this.p;for(;c--;)n=n.B;return n.u}find(c,n){const o=this.I(c,n);return new g(o,this.h,this)}forEach(c){let n=0,o=this.p;for(;o!==this.h;)c(o.u,n++,this),o=o.B}[Symbol.iterator](){return(function*(){let c=this.p;for(;c!==this.h;)yield c.u,c=c.B}).bind(this)()}}var i=d;h.default=i},{"../../utils/throwError":71,"./Base":53}],56:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("../ContainerBase");class s extends r.Base{constructor(i=[],f=function(n,o){return n>o?-1:n<o?1:0},c=!0){if(super(),this.v=f,Array.isArray(i))this.C=c?[...i]:i;else{this.C=[];const o=this;i.forEach(function(u){o.C.push(u)})}this.i=this.C.length;const n=this.i>>1;for(let o=this.i-1>>1;o>=0;--o)this.k(o,n)}m(i){const f=this.C[i];for(;i>0;){const c=i-1>>1,n=this.C[c];if(this.v(n,f)<=0)break;this.C[i]=n,i=c}this.C[i]=f}k(i,f){const c=this.C[i];for(;i<f;){let n=i<<1|1;const o=n+1;let u=this.C[n];if(o<this.i&&this.v(u,this.C[o])>0&&(n=o,u=this.C[o]),this.v(u,c)>=0)break;this.C[i]=u,i=n}this.C[i]=c}clear(){this.i=0,this.C.length=0}push(i){this.C.push(i),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;const i=this.C[0],f=this.C.pop();return this.i-=1,this.i&&(this.C[0]=f,this.k(0,this.i>>1)),i}top(){return this.C[0]}find(i){return this.C.indexOf(i)>=0}remove(i){const f=this.C.indexOf(i);return!(f<0)&&(f===0?this.pop():f===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(f,1,this.C.pop()),this.i-=1,this.m(f),this.k(f,this.i>>1)),!0)}updateItem(i){const f=this.C.indexOf(i);return!(f<0)&&(this.m(f),this.k(f,this.i>>1),!0)}toArray(){return[...this.C]}}var g=s;h.default=g},{"../ContainerBase":52}],57:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("../ContainerBase");class s extends r.Base{constructor(i=[]){super(),this.j=0,this.q=[];const f=this;i.forEach(function(c){f.push(c)})}clear(){this.q=[],this.i=this.j=0}push(i){const f=this.q.length;if(this.j/f>.5&&this.j+this.i>=f&&f>4096){const c=this.i;for(let n=0;n<c;++n)this.q[n]=this.q[this.j+n];this.j=0,this.q[this.i]=i}else this.q[this.j+this.i]=i;return++this.i}pop(){if(this.i===0)return;const i=this.q[this.j++];return this.i-=1,i}front(){if(this.i!==0)return this.q[this.j]}}var g=s;h.default=g},{"../ContainerBase":52}],58:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("../ContainerBase");class s extends r.Base{constructor(i=[]){super(),this.S=[];const f=this;i.forEach(function(c){f.push(c)})}clear(){this.i=0,this.S=[]}push(i){return this.S.push(i),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}}var g=s;h.default=g},{"../ContainerBase":52}],59:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.RandomIterator=void 0;var r=t("../../ContainerBase"),s=t("../../../utils/throwError");class g extends r.ContainerIterator{constructor(i,f){super(f),this.o=i,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,s.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,s.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,s.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,s.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(i){this.container.setElementByPos(this.o,i)}}h.RandomIterator=g},{"../../../utils/throwError":71,"../../ContainerBase":52}],60:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("../../ContainerBase");class s extends r.Container{}var g=s;h.default=g},{"../../ContainerBase":52}],61:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r,s=(r=t("./Base"))&&r.t?r:{default:r},g=t("./Base/RandomIterator");class d extends g.RandomIterator{constructor(n,o,u){super(n,u),this.container=o}copy(){return new d(this.o,this.container,this.iteratorType)}}class i extends s.default{constructor(n=[],o=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];const u=(()=>{if(typeof n.length=="number")return n.length;if(typeof n.size=="number")return n.size;if(typeof n.size=="function")return n.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=o,this.P=Math.max(Math.ceil(u/this.F),1);for(let w=0;w<this.P;++w)this.A.push(new Array(this.F));const b=Math.ceil(u/this.F);this.j=this.R=(this.P>>1)-(b>>1),this.D=this.N=this.F-u%this.F>>1;const y=this;n.forEach(function(w){y.pushBack(w)})}T(){const n=[],o=Math.max(this.P>>1,1);for(let u=0;u<o;++u)n[u]=new Array(this.F);for(let u=this.j;u<this.P;++u)n[n.length]=this.A[u];for(let u=0;u<this.R;++u)n[n.length]=this.A[u];n[n.length]=[...this.A[this.R]],this.j=o,this.R=n.length-1;for(let u=0;u<o;++u)n[n.length]=new Array(this.F);this.A=n,this.P=n.length}O(n){const o=this.D+n+1,u=o%this.F;let b=u-1,y=this.j+(o-u)/this.F;return u===0&&(y-=1),y%=this.P,b<0&&(b+=this.F),{curNodeBucketIndex:y,curNodePointerIndex:b}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new d(0,this)}end(){return new d(this.i,this)}rBegin(){return new d(this.i-1,this,1)}rEnd(){return new d(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(n){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=n,this.i}popBack(){if(this.i===0)return;const n=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,n}pushFront(n){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=n,this.i}popFront(){if(this.i===0)return;const n=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,n}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;const{curNodeBucketIndex:o,curNodePointerIndex:u}=this.O(n);return this.A[o][u]}setElementByPos(n,o){if(n<0||n>this.i-1)throw new RangeError;const{curNodeBucketIndex:u,curNodePointerIndex:b}=this.O(n);this.A[u][b]=o}insert(n,o,u=1){if(n<0||n>this.i)throw new RangeError;if(n===0)for(;u--;)this.pushFront(o);else if(n===this.i)for(;u--;)this.pushBack(o);else{const b=[];for(let y=n;y<this.i;++y)b.push(this.getElementByPos(y));this.cut(n-1);for(let y=0;y<u;++y)this.pushBack(o);for(let y=0;y<b.length;++y)this.pushBack(b[y])}return this.i}cut(n){if(n<0)return this.clear(),0;const{curNodeBucketIndex:o,curNodePointerIndex:u}=this.O(n);return this.R=o,this.N=u,this.i=n+1,this.i}eraseElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;if(n===0)this.popFront();else if(n===this.i-1)this.popBack();else{const o=[];for(let b=n+1;b<this.i;++b)o.push(this.getElementByPos(b));this.cut(n),this.popBack();const u=this;o.forEach(function(b){u.pushBack(b)})}return this.i}eraseElementByValue(n){if(this.i===0)return 0;const o=[];for(let b=0;b<this.i;++b){const y=this.getElementByPos(b);y!==n&&o.push(y)}const u=o.length;for(let b=0;b<u;++b)this.setElementByPos(b,o[b]);return this.cut(u-1)}eraseElementByIterator(n){const o=n.o;return this.eraseElementByPos(o),n=n.next()}find(n){for(let o=0;o<this.i;++o)if(this.getElementByPos(o)===n)return new d(o,this);return this.end()}reverse(){let n=0,o=this.i-1;for(;n<o;){const u=this.getElementByPos(n);this.setElementByPos(n,this.getElementByPos(o)),this.setElementByPos(o,u),n+=1,o-=1}}unique(){if(this.i<=1)return this.i;let n=1,o=this.getElementByPos(0);for(let u=1;u<this.i;++u){const b=this.getElementByPos(u);b!==o&&(o=b,this.setElementByPos(n++,b))}for(;this.i>n;)this.popBack();return this.i}sort(n){const o=[];for(let u=0;u<this.i;++u)o.push(this.getElementByPos(u));o.sort(n);for(let u=0;u<this.i;++u)this.setElementByPos(u,o[u])}shrinkToFit(){if(this.i===0)return;const n=[];this.forEach(function(o){n.push(o)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let o=0;o<this.P;++o)this.A.push(new Array(this.F));for(let o=0;o<n.length;++o)this.pushBack(n[o])}forEach(n){for(let o=0;o<this.i;++o)n(this.getElementByPos(o),o,this)}[Symbol.iterator](){return(function*(){for(let n=0;n<this.i;++n)yield this.getElementByPos(n)}).bind(this)()}}var f=i;h.default=f},{"./Base":60,"./Base/RandomIterator":59}],62:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r,s=(r=t("./Base"))&&r.t?r:{default:r},g=t("../ContainerBase"),d=t("../../utils/throwError");class i extends g.ContainerIterator{constructor(o,u,b,y){super(y),this.o=o,this.h=u,this.container=b,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o.l}set pointer(o){this.o===this.h&&(0,d.throwIteratorAccessError)(),this.o.l=o}copy(){return new i(this.o,this.h,this.container,this.iteratorType)}}class f extends s.default{constructor(o=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;const u=this;o.forEach(function(b){u.pushBack(b)})}V(o){const{L:u,B:b}=o;u.B=b,b.L=u,o===this.p&&(this.p=b),o===this._&&(this._=u),this.i-=1}G(o,u){const b=u.B,y={l:o,L:u,B:b};u.B=y,b.L=y,u===this.h&&(this.p=y),b===this.h&&(this._=y),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new i(this.p,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this._,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(o){if(o<0||o>this.i-1)throw new RangeError;let u=this.p;for(;o--;)u=u.B;return u.l}eraseElementByPos(o){if(o<0||o>this.i-1)throw new RangeError;let u=this.p;for(;o--;)u=u.B;return this.V(u),this.i}eraseElementByValue(o){let u=this.p;for(;u!==this.h;)u.l===o&&this.V(u),u=u.B;return this.i}eraseElementByIterator(o){const u=o.o;return u===this.h&&(0,d.throwIteratorAccessError)(),o=o.next(),this.V(u),o}pushBack(o){return this.G(o,this._),this.i}popBack(){if(this.i===0)return;const o=this._.l;return this.V(this._),o}pushFront(o){return this.G(o,this.h),this.i}popFront(){if(this.i===0)return;const o=this.p.l;return this.V(this.p),o}setElementByPos(o,u){if(o<0||o>this.i-1)throw new RangeError;let b=this.p;for(;o--;)b=b.B;b.l=u}insert(o,u,b=1){if(o<0||o>this.i)throw new RangeError;if(b<=0)return this.i;if(o===0)for(;b--;)this.pushFront(u);else if(o===this.i)for(;b--;)this.pushBack(u);else{let y=this.p;for(let S=1;S<o;++S)y=y.B;const w=y.B;for(this.i+=b;b--;)y.B={l:u,L:y},y.B.L=y,y=y.B;y.B=w,w.L=y}return this.i}find(o){let u=this.p;for(;u!==this.h;){if(u.l===o)return new i(u,this.h,this);u=u.B}return this.end()}reverse(){if(this.i<=1)return;let o=this.p,u=this._,b=0;for(;b<<1<this.i;){const y=o.l;o.l=u.l,u.l=y,o=o.B,u=u.L,b+=1}}unique(){if(this.i<=1)return this.i;let o=this.p;for(;o!==this.h;){let u=o;for(;u.B!==this.h&&u.l===u.B.l;)u=u.B,this.i-=1;o.B=u.B,o.B.L=o,o=o.B}return this.i}sort(o){if(this.i<=1)return;const u=[];this.forEach(function(y){u.push(y)}),u.sort(o);let b=this.p;u.forEach(function(y){b.l=y,b=b.B})}merge(o){const u=this;if(this.i===0)o.forEach(function(b){u.pushBack(b)});else{let b=this.p;o.forEach(function(y){for(;b!==u.h&&b.l<=y;)b=b.B;u.G(y,b.L)})}return this.i}forEach(o){let u=this.p,b=0;for(;u!==this.h;)o(u.l,b++,this),u=u.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let o=this.p;for(;o!==this.h;)yield o.l,o=o.B}).bind(this)()}}var c=f;h.default=c},{"../../utils/throwError":71,"../ContainerBase":52,"./Base":60}],63:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r,s=(r=t("./Base"))&&r.t?r:{default:r},g=t("./Base/RandomIterator");class d extends g.RandomIterator{constructor(n,o,u){super(n,u),this.container=o}copy(){return new d(this.o,this.container,this.iteratorType)}}class i extends s.default{constructor(n=[],o=!0){if(super(),Array.isArray(n))this.J=o?[...n]:n,this.i=n.length;else{this.J=[];const u=this;n.forEach(function(b){u.pushBack(b)})}}clear(){this.i=0,this.J.length=0}begin(){return new d(0,this)}end(){return new d(this.i,this)}rBegin(){return new d(this.i-1,this,1)}rEnd(){return new d(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;return this.J[n]}eraseElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;return this.J.splice(n,1),this.i-=1,this.i}eraseElementByValue(n){let o=0;for(let u=0;u<this.i;++u)this.J[u]!==n&&(this.J[o++]=this.J[u]);return this.i=this.J.length=o,this.i}eraseElementByIterator(n){const o=n.o;return n=n.next(),this.eraseElementByPos(o),n}pushBack(n){return this.J.push(n),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(n,o){if(n<0||n>this.i-1)throw new RangeError;this.J[n]=o}insert(n,o,u=1){if(n<0||n>this.i)throw new RangeError;return this.J.splice(n,0,...new Array(u).fill(o)),this.i+=u,this.i}find(n){for(let o=0;o<this.i;++o)if(this.J[o]===n)return new d(o,this);return this.end()}reverse(){this.J.reverse()}unique(){let n=1;for(let o=1;o<this.i;++o)this.J[o]!==this.J[o-1]&&(this.J[n++]=this.J[o]);return this.i=this.J.length=n,this.i}sort(n){this.J.sort(n)}forEach(n){for(let o=0;o<this.i;++o)n(this.J[o],o,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}}var f=i;h.default=f},{"./Base":60,"./Base/RandomIterator":59}],64:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("../../ContainerBase"),s=t("../../../utils/throwError");class g extends r.ContainerIterator{constructor(f,c,n){super(n),this.o=f,this.h=c,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,s.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,s.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,s.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let f=this.o;const c=this.h.tt;if(f===this.h)return c?c.rt-1:0;let n=0;for(f.U&&(n+=f.U.rt);f!==c;){const o=f.tt;f===o.W&&(n+=1,o.U&&(n+=o.U.rt)),f=o}return n}}var d=g;h.default=d},{"../../../utils/throwError":71,"../../ContainerBase":52}],65:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.TreeNodeEnableIndex=h.TreeNode=void 0;class r{constructor(g,d){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=g,this.l=d}L(){let g=this;if(g.ee===1&&g.tt.tt===g)g=g.W;else if(g.U)for(g=g.U;g.W;)g=g.W;else{let d=g.tt;for(;d.U===g;)g=d,d=g.tt;g=d}return g}B(){let g=this;if(g.W){for(g=g.W;g.U;)g=g.U;return g}{let d=g.tt;for(;d.W===g;)g=d,d=g.tt;return g.W!==d?d:g}}te(){const g=this.tt,d=this.W,i=d.U;return g.tt===this?g.tt=d:g.U===this?g.U=d:g.W=d,d.tt=g,d.U=this,this.tt=d,this.W=i,i&&(i.tt=this),d}se(){const g=this.tt,d=this.U,i=d.W;return g.tt===this?g.tt=d:g.U===this?g.U=d:g.W=d,d.tt=g,d.W=this,this.tt=d,this.U=i,i&&(i.tt=this),d}}h.TreeNode=r,h.TreeNodeEnableIndex=class extends r{constructor(){super(...arguments),this.rt=1}te(){const s=super.te();return this.ie(),s.ie(),s}se(){const s=super.se();return this.ie(),s.ie(),s}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}}},{}],66:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=t("./TreeNode"),s=t("../../ContainerBase"),g=t("../../../utils/throwError");class d extends s.Container{constructor(c=function(o,u){return o<u?-1:o>u?1:0},n=!1){super(),this.Y=void 0,this.v=c,n?(this.re=r.TreeNodeEnableIndex,this.M=function(o,u,b){const y=this.ne(o,u,b);if(y){let w=y.tt;for(;w!==this.h;)w.rt+=1,w=w.tt;const S=this.he(y);if(S){const{parentNode:k,grandParent:j,curNode:L}=S;k.ie(),j.ie(),L.ie()}}return this.i},this.V=function(o){let u=this.fe(o);for(;u!==this.h;)u.rt-=1,u=u.tt}):(this.re=r.TreeNode,this.M=function(o,u,b){const y=this.ne(o,u,b);return y&&this.he(y),this.i},this.V=this.fe),this.h=new this.re}X(c,n){let o=this.h;for(;c;){const u=this.v(c.u,n);if(u<0)c=c.W;else{if(!(u>0))return c;o=c,c=c.U}}return o}Z(c,n){let o=this.h;for(;c;)this.v(c.u,n)<=0?c=c.W:(o=c,c=c.U);return o}$(c,n){let o=this.h;for(;c;){const u=this.v(c.u,n);if(u<0)o=c,c=c.W;else{if(!(u>0))return c;c=c.U}}return o}rr(c,n){let o=this.h;for(;c;)this.v(c.u,n)<0?(o=c,c=c.W):c=c.U;return o}ue(c){for(;;){const n=c.tt;if(n===this.h)return;if(c.ee===1)return void(c.ee=0);if(c===n.U){const o=n.W;if(o.ee===1)o.ee=0,n.ee=1,n===this.Y?this.Y=n.te():n.te();else{if(o.W&&o.W.ee===1)return o.ee=n.ee,n.ee=0,o.W.ee=0,void(n===this.Y?this.Y=n.te():n.te());o.U&&o.U.ee===1?(o.ee=1,o.U.ee=0,o.se()):(o.ee=1,c=n)}}else{const o=n.U;if(o.ee===1)o.ee=0,n.ee=1,n===this.Y?this.Y=n.se():n.se();else{if(o.U&&o.U.ee===1)return o.ee=n.ee,n.ee=0,o.U.ee=0,void(n===this.Y?this.Y=n.se():n.se());o.W&&o.W.ee===1?(o.ee=1,o.W.ee=0,o.te()):(o.ee=1,c=n)}}}}fe(c){if(this.i===1)return this.clear(),this.h;let n=c;for(;n.U||n.W;){if(n.W)for(n=n.W;n.U;)n=n.U;else n=n.U;[c.u,n.u]=[n.u,c.u],[c.l,n.l]=[n.l,c.l],c=n}this.h.U===n?this.h.U=n.tt:this.h.W===n&&(this.h.W=n.tt),this.ue(n);const o=n.tt;return n===o.U?o.U=void 0:o.W=void 0,this.i-=1,this.Y.ee=0,o}oe(c,n){return c===void 0?!1:!!this.oe(c.U,n)||!!n(c)||this.oe(c.W,n)}he(c){for(;;){const n=c.tt;if(n.ee===0)return;const o=n.tt;if(n===o.U){const u=o.W;if(u&&u.ee===1){if(u.ee=n.ee=0,o===this.Y)return;o.ee=1,c=o;continue}if(c===n.W){if(c.ee=0,c.U&&(c.U.tt=n),c.W&&(c.W.tt=o),n.W=c.U,o.U=c.W,c.U=n,c.W=o,o===this.Y)this.Y=c,this.h.tt=c;else{const b=o.tt;b.U===o?b.U=c:b.W=c}return c.tt=o.tt,n.tt=c,o.tt=c,o.ee=1,{parentNode:n,grandParent:o,curNode:c}}n.ee=0,o===this.Y?this.Y=o.se():o.se(),o.ee=1}else{const u=o.U;if(u&&u.ee===1){if(u.ee=n.ee=0,o===this.Y)return;o.ee=1,c=o;continue}if(c===n.U){if(c.ee=0,c.U&&(c.U.tt=o),c.W&&(c.W.tt=n),o.W=c.U,n.U=c.W,c.U=o,c.W=n,o===this.Y)this.Y=c,this.h.tt=c;else{const b=o.tt;b.U===o?b.U=c:b.W=c}return c.tt=o.tt,n.tt=c,o.tt=c,o.ee=1,{parentNode:n,grandParent:o,curNode:c}}n.ee=0,o===this.Y?this.Y=o.te():o.te(),o.ee=1}return}}ne(c,n,o){if(this.Y===void 0)return this.i+=1,this.Y=new this.re(c,n),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,void(this.h.W=this.Y);let u;const b=this.h.U,y=this.v(b.u,c);if(y!==0){if(y>0)b.U=new this.re(c,n),b.U.tt=b,u=b.U,this.h.U=u;else{const w=this.h.W,S=this.v(w.u,c);if(S===0)return void(w.l=n);if(S<0)w.W=new this.re(c,n),w.W.tt=w,u=w.W,this.h.W=u;else{if(o!==void 0){const k=o.o;if(k!==this.h){const j=this.v(k.u,c);if(j===0)return void(k.l=n);if(j>0){const L=k.L(),I=this.v(L.u,c);if(I===0)return void(L.l=n);I<0&&(u=new this.re(c,n),L.W===void 0?(L.W=u,u.tt=L):(k.U=u,u.tt=k))}}}if(u===void 0)for(u=this.Y;;){const k=this.v(u.u,c);if(k>0){if(u.U===void 0){u.U=new this.re(c,n),u.U.tt=u,u=u.U;break}u=u.U}else{if(!(k<0))return void(u.l=n);if(u.W===void 0){u.W=new this.re(c,n),u.W.tt=u,u=u.W;break}u=u.W}}}}return this.i+=1,u}b.l=n}I(c,n){for(;c;){const o=this.v(c.u,n);if(o<0)c=c.W;else{if(!(o>0))return c;c=c.U}}return c||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(c,n){const o=c.o;if(o===this.h&&(0,g.throwIteratorAccessError)(),this.i===1)return o.u=n,!0;if(o===this.h.U)return this.v(o.B().u,n)>0&&(o.u=n,!0);if(o===this.h.W)return this.v(o.L().u,n)<0&&(o.u=n,!0);const u=o.L().u;if(this.v(u,n)>=0)return!1;const b=o.B().u;return!(this.v(b,n)<=0)&&(o.u=n,!0)}eraseElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let n=0;const o=this;return this.oe(this.Y,function(u){return c===n?(o.V(u),!0):(n+=1,!1)}),this.i}eraseElementByKey(c){if(this.i===0)return!1;const n=this.I(this.Y,c);return n!==this.h&&(this.V(n),!0)}eraseElementByIterator(c){const n=c.o;n===this.h&&(0,g.throwIteratorAccessError)();const o=n.W===void 0;return c.iteratorType===0?o&&c.next():o&&n.U!==void 0||c.next(),this.V(n),c}forEach(c){let n=0;for(const o of this)c(o,n++,this)}getElementByPos(c){if(c<0||c>this.i-1)throw new RangeError;let n,o=0;for(const u of this){if(o===c){n=u;break}o+=1}return n}getHeight(){if(this.i===0)return 0;const c=function(n){return n?Math.max(c(n.U),c(n.W))+1:0};return c(this.Y)}}var i=d;h.default=i},{"../../../utils/throwError":71,"../../ContainerBase":52,"./TreeNode":65}],67:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=d(t("./Base")),s=d(t("./Base/TreeIterator")),g=t("../../utils/throwError");function d(n){return n&&n.t?n:{default:n}}class i extends s.default{constructor(o,u,b,y){super(o,u,y),this.container=b}get pointer(){this.o===this.h&&(0,g.throwIteratorAccessError)();const o=this;return new Proxy([],{get:(u,b)=>b==="0"?o.o.u:b==="1"?o.o.l:void 0,set(u,b,y){if(b!=="1")throw new TypeError("props must be 1");return o.o.l=y,!0}})}copy(){return new i(this.o,this.h,this.container,this.iteratorType)}}class f extends r.default{constructor(o=[],u,b){super(u,b);const y=this;o.forEach(function(w){y.setElement(w[0],w[1])})}*K(o){o!==void 0&&(yield*this.K(o.U),yield[o.u,o.l],yield*this.K(o.W))}begin(){return new i(this.h.U||this.h,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this.h.W||this.h,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){if(this.i===0)return;const o=this.h.U;return[o.u,o.l]}back(){if(this.i===0)return;const o=this.h.W;return[o.u,o.l]}lowerBound(o){const u=this.X(this.Y,o);return new i(u,this.h,this)}upperBound(o){const u=this.Z(this.Y,o);return new i(u,this.h,this)}reverseLowerBound(o){const u=this.$(this.Y,o);return new i(u,this.h,this)}reverseUpperBound(o){const u=this.rr(this.Y,o);return new i(u,this.h,this)}setElement(o,u,b){return this.M(o,u,b)}find(o){const u=this.I(this.Y,o);return new i(u,this.h,this)}getElementByKey(o){return this.I(this.Y,o).l}union(o){const u=this;return o.forEach(function(b){u.setElement(b[0],b[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}}var c=f;h.default=c},{"../../utils/throwError":71,"./Base":66,"./Base/TreeIterator":64}],68:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=void 0;var r=d(t("./Base")),s=d(t("./Base/TreeIterator")),g=t("../../utils/throwError");function d(n){return n&&n.t?n:{default:n}}class i extends s.default{constructor(o,u,b,y){super(o,u,y),this.container=b}get pointer(){return this.o===this.h&&(0,g.throwIteratorAccessError)(),this.o.u}copy(){return new i(this.o,this.h,this.container,this.iteratorType)}}class f extends r.default{constructor(o=[],u,b){super(u,b);const y=this;o.forEach(function(w){y.insert(w)})}*K(o){o!==void 0&&(yield*this.K(o.U),yield o.u,yield*this.K(o.W))}begin(){return new i(this.h.U||this.h,this.h,this)}end(){return new i(this.h,this.h,this)}rBegin(){return new i(this.h.W||this.h,this.h,this,1)}rEnd(){return new i(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(o,u){return this.M(o,void 0,u)}find(o){const u=this.I(this.Y,o);return new i(u,this.h,this)}lowerBound(o){const u=this.X(this.Y,o);return new i(u,this.h,this)}upperBound(o){const u=this.Z(this.Y,o);return new i(u,this.h,this)}reverseLowerBound(o){const u=this.$(this.Y,o);return new i(u,this.h,this)}reverseUpperBound(o){const u=this.rr(this.Y,o);return new i(u,this.h,this)}union(o){const u=this;return o.forEach(function(b){u.insert(b)}),this.i}[Symbol.iterator](){return this.K(this.Y)}}var c=f;h.default=c},{"../../utils/throwError":71,"./Base":66,"./Base/TreeIterator":64}],69:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),Object.defineProperty(h,"Deque",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(h,"HashMap",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(h,"HashSet",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(h,"LinkList",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(h,"OrderedMap",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(h,"OrderedSet",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(h,"PriorityQueue",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(h,"Queue",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(h,"Stack",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(h,"Vector",{enumerable:!0,get:function(){return d.default}});var r=b(t("./container/OtherContainer/Stack")),s=b(t("./container/OtherContainer/Queue")),g=b(t("./container/OtherContainer/PriorityQueue")),d=b(t("./container/SequentialContainer/Vector")),i=b(t("./container/SequentialContainer/LinkList")),f=b(t("./container/SequentialContainer/Deque")),c=b(t("./container/TreeContainer/OrderedSet")),n=b(t("./container/TreeContainer/OrderedMap")),o=b(t("./container/HashContainer/HashSet")),u=b(t("./container/HashContainer/HashMap"));function b(y){return y&&y.t?y:{default:y}}},{"./container/HashContainer/HashMap":54,"./container/HashContainer/HashSet":55,"./container/OtherContainer/PriorityQueue":56,"./container/OtherContainer/Queue":57,"./container/OtherContainer/Stack":58,"./container/SequentialContainer/Deque":61,"./container/SequentialContainer/LinkList":62,"./container/SequentialContainer/Vector":63,"./container/TreeContainer/OrderedMap":67,"./container/TreeContainer/OrderedSet":68}],70:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.default=function(r){const s=typeof r;return s==="object"&&r!==null||s==="function"}},{}],71:[function(t,l,h){Object.defineProperty(h,"t",{value:!0}),h.throwIteratorAccessError=function(){throw new RangeError("Iterator access denied!")}},{}],72:[function(t,l,h){(function(r){(function(){const s=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,g=typeof AbortController=="function"?AbortController:class{constructor(){this.signal=new f}abort(I=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||I,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},d=typeof AbortSignal=="function",i=typeof g.AbortSignal=="function",f=d?AbortSignal:i?g.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(I){I.type==="abort"&&(this.aborted=!0,this.onabort(I),this._listeners.forEach(A=>A(I),this))}onabort(){}addEventListener(I,A){I==="abort"&&this._listeners.push(A)}removeEventListener(I,A){I==="abort"&&(this._listeners=this._listeners.filter(E=>E!==A))}},c=new Set,n=(I,A)=>{const E=`LRU_CACHE_OPTION_${I}`;b(E)&&y(E,`${I} option`,`options.${A}`,L)},o=(I,A)=>{const E=`LRU_CACHE_METHOD_${I}`;if(b(E)){const{prototype:N}=L,{get:G}=Object.getOwnPropertyDescriptor(N,I);y(E,`${I} method`,`cache.${A}()`,G)}},u=(...I)=>{typeof r=="object"&&r&&typeof r.emitWarning=="function"?r.emitWarning(...I):console.error(...I)},b=I=>!c.has(I),y=(I,A,E,N)=>{c.add(I),u(`The ${A} is deprecated. Please use ${E} instead.`,"DeprecationWarning",I,N)},w=I=>I&&I===Math.floor(I)&&I>0&&isFinite(I),S=I=>w(I)?I<=Math.pow(2,8)?Uint8Array:I<=Math.pow(2,16)?Uint16Array:I<=Math.pow(2,32)?Uint32Array:I<=Number.MAX_SAFE_INTEGER?k:null:null;class k extends Array{constructor(A){super(A),this.fill(0)}}class j{constructor(A){if(A===0)return[];const E=S(A);this.heap=new E(A),this.length=0}push(A){this.heap[this.length++]=A}pop(){return this.heap[--this.length]}}class L{constructor(A={}){const{max:E=0,ttl:N,ttlResolution:G=1,ttlAutopurge:W,updateAgeOnGet:_,updateAgeOnHas:R,allowStale:T,dispose:Y,disposeAfter:J,noDisposeOnSet:et,noUpdateTTL:M,maxSize:C=0,maxEntrySize:x=0,sizeCalculation:z,fetchMethod:B,fetchContext:V,noDeleteOnFetchRejection:$,noDeleteOnStaleGet:H,allowStaleOnFetchRejection:Z,allowStaleOnFetchAbort:X,ignoreFetchAbort:tt}=A,{length:O,maxAge:p,stale:m}=A instanceof L?{}:A;if(E!==0&&!w(E))throw new TypeError("max option must be a nonnegative integer");const v=E?S(E):Array;if(!v)throw new Error("invalid max value: "+E);if(this.max=E,this.maxSize=C,this.maxEntrySize=x||this.maxSize,this.sizeCalculation=z||O,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=B||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=V,!this.fetchMethod&&V!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(E).fill(null),this.valList=new Array(E).fill(null),this.next=new v(E),this.prev=new v(E),this.head=0,this.tail=0,this.free=new j(E),this.initialFill=1,this.size=0,typeof Y=="function"&&(this.dispose=Y),typeof J=="function"?(this.disposeAfter=J,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!et,this.noUpdateTTL=!!M,this.noDeleteOnFetchRejection=!!$,this.allowStaleOnFetchRejection=!!Z,this.allowStaleOnFetchAbort=!!X,this.ignoreFetchAbort=!!tt,this.maxEntrySize!==0){if(this.maxSize!==0&&!w(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!w(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!T||!!m,this.noDeleteOnStaleGet=!!H,this.updateAgeOnGet=!!_,this.updateAgeOnHas=!!R,this.ttlResolution=w(G)||G===0?G:1,this.ttlAutopurge=!!W,this.ttl=N||p||0,this.ttl){if(!w(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const P="LRU_CACHE_UNBOUNDED";b(P)&&(c.add(P),u("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",P,L))}m&&n("stale","allowStale"),p&&n("maxAge","ttl"),O&&n("length","sizeCalculation")}getRemainingTTL(A){return this.has(A,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new k(this.max),this.starts=new k(this.max),this.setItemTTL=(N,G,W=s.now())=>{if(this.starts[N]=G!==0?W:0,this.ttls[N]=G,G!==0&&this.ttlAutopurge){const _=setTimeout(()=>{this.isStale(N)&&this.delete(this.keyList[N])},G+1);_.unref&&_.unref()}},this.updateItemAge=N=>{this.starts[N]=this.ttls[N]!==0?s.now():0},this.statusTTL=(N,G)=>{N&&(N.ttl=this.ttls[G],N.start=this.starts[G],N.now=A||E(),N.remainingTTL=N.now+N.ttl-N.start)};let A=0;const E=()=>{const N=s.now();if(this.ttlResolution>0){A=N;const G=setTimeout(()=>A=0,this.ttlResolution);G.unref&&G.unref()}return N};this.getRemainingTTL=N=>{const G=this.keyMap.get(N);return G===void 0?0:this.ttls[G]===0||this.starts[G]===0?1/0:this.starts[G]+this.ttls[G]-(A||E())},this.isStale=N=>this.ttls[N]!==0&&this.starts[N]!==0&&(A||E())-this.starts[N]>this.ttls[N]}updateItemAge(A){}statusTTL(A,E){}setItemTTL(A,E,N){}isStale(A){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new k(this.max),this.removeItemSize=A=>{this.calculatedSize-=this.sizes[A],this.sizes[A]=0},this.requireSize=(A,E,N,G)=>{if(this.isBackgroundFetch(E))return 0;if(!w(N)){if(!G)throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");if(typeof G!="function")throw new TypeError("sizeCalculation must be a function");if(N=G(E,A),!w(N))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}return N},this.addItemSize=(A,E,N)=>{if(this.sizes[A]=E,this.maxSize){const G=this.maxSize-this.sizes[A];for(;this.calculatedSize>G;)this.evict(!0)}this.calculatedSize+=this.sizes[A],N&&(N.entrySize=E,N.totalCalculatedSize=this.calculatedSize)}}removeItemSize(A){}addItemSize(A,E){}requireSize(A,E,N,G){if(N||G)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:A=this.allowStale}={}){if(this.size)for(let E=this.tail;this.isValidIndex(E)&&(!A&&this.isStale(E)||(yield E),E!==this.head);)E=this.prev[E]}*rindexes({allowStale:A=this.allowStale}={}){if(this.size)for(let E=this.head;this.isValidIndex(E)&&(!A&&this.isStale(E)||(yield E),E!==this.tail);)E=this.next[E]}isValidIndex(A){return A!==void 0&&this.keyMap.get(this.keyList[A])===A}*entries(){for(const A of this.indexes())this.valList[A]===void 0||this.keyList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield[this.keyList[A],this.valList[A]])}*rentries(){for(const A of this.rindexes())this.valList[A]===void 0||this.keyList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield[this.keyList[A],this.valList[A]])}*keys(){for(const A of this.indexes())this.keyList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield this.keyList[A])}*rkeys(){for(const A of this.rindexes())this.keyList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield this.keyList[A])}*values(){for(const A of this.indexes())this.valList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield this.valList[A])}*rvalues(){for(const A of this.rindexes())this.valList[A]===void 0||this.isBackgroundFetch(this.valList[A])||(yield this.valList[A])}[Symbol.iterator](){return this.entries()}find(A,E){for(const N of this.indexes()){const G=this.valList[N],W=this.isBackgroundFetch(G)?G.__staleWhileFetching:G;if(W!==void 0&&A(W,this.keyList[N],this))return this.get(this.keyList[N],E)}}forEach(A,E=this){for(const N of this.indexes()){const G=this.valList[N],W=this.isBackgroundFetch(G)?G.__staleWhileFetching:G;W!==void 0&&A.call(E,W,this.keyList[N],this)}}rforEach(A,E=this){for(const N of this.rindexes()){const G=this.valList[N],W=this.isBackgroundFetch(G)?G.__staleWhileFetching:G;W!==void 0&&A.call(E,W,this.keyList[N],this)}}get prune(){return o("prune","purgeStale"),this.purgeStale}purgeStale(){let A=!1;for(const E of this.rindexes({allowStale:!0}))this.isStale(E)&&(this.delete(this.keyList[E]),A=!0);return A}dump(){const A=[];for(const E of this.indexes({allowStale:!0})){const N=this.keyList[E],G=this.valList[E],W=this.isBackgroundFetch(G)?G.__staleWhileFetching:G;if(W===void 0)continue;const _={value:W};if(this.ttls){_.ttl=this.ttls[E];const R=s.now()-this.starts[E];_.start=Math.floor(Date.now()-R)}this.sizes&&(_.size=this.sizes[E]),A.unshift([N,_])}return A}load(A){this.clear();for(const[E,N]of A){if(N.start){const G=Date.now()-N.start;N.start=s.now()-G}this.set(E,N.value,N)}}dispose(A,E,N){}set(A,E,{ttl:N=this.ttl,start:G,noDisposeOnSet:W=this.noDisposeOnSet,size:_=0,sizeCalculation:R=this.sizeCalculation,noUpdateTTL:T=this.noUpdateTTL,status:Y}={}){if(_=this.requireSize(A,E,_,R),this.maxEntrySize&&_>this.maxEntrySize)return Y&&(Y.set="miss",Y.maxEntrySizeExceeded=!0),this.delete(A),this;let J=this.size===0?void 0:this.keyMap.get(A);if(J===void 0)J=this.newIndex(),this.keyList[J]=A,this.valList[J]=E,this.keyMap.set(A,J),this.next[this.tail]=J,this.prev[J]=this.tail,this.tail=J,this.size++,this.addItemSize(J,_,Y),Y&&(Y.set="add"),T=!1;else{this.moveToTail(J);const et=this.valList[J];if(E!==et){if(this.isBackgroundFetch(et)?et.__abortController.abort(new Error("replaced")):W||(this.dispose(et,A,"set"),this.disposeAfter&&this.disposed.push([et,A,"set"])),this.removeItemSize(J),this.valList[J]=E,this.addItemSize(J,_,Y),Y){Y.set="replace";const M=et&&this.isBackgroundFetch(et)?et.__staleWhileFetching:et;M!==void 0&&(Y.oldValue=M)}}else Y&&(Y.set="update")}if(N===0||this.ttl!==0||this.ttls||this.initializeTTLTracking(),T||this.setItemTTL(J,N,G),this.statusTTL(Y,J),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const A=this.valList[this.head];return this.evict(!0),A}}evict(A){const E=this.head,N=this.keyList[E],G=this.valList[E];return this.isBackgroundFetch(G)?G.__abortController.abort(new Error("evicted")):(this.dispose(G,N,"evict"),this.disposeAfter&&this.disposed.push([G,N,"evict"])),this.removeItemSize(E),A&&(this.keyList[E]=null,this.valList[E]=null,this.free.push(E)),this.head=this.next[E],this.keyMap.delete(N),this.size--,E}has(A,{updateAgeOnHas:E=this.updateAgeOnHas,status:N}={}){const G=this.keyMap.get(A);if(G!==void 0){if(!this.isStale(G))return E&&this.updateItemAge(G),N&&(N.has="hit"),this.statusTTL(N,G),!0;N&&(N.has="stale",this.statusTTL(N,G))}else N&&(N.has="miss");return!1}peek(A,{allowStale:E=this.allowStale}={}){const N=this.keyMap.get(A);if(N!==void 0&&(E||!this.isStale(N))){const G=this.valList[N];return this.isBackgroundFetch(G)?G.__staleWhileFetching:G}}backgroundFetch(A,E,N,G){const W=E===void 0?void 0:this.valList[E];if(this.isBackgroundFetch(W))return W;const _=new g;N.signal&&N.signal.addEventListener("abort",()=>_.abort(N.signal.reason));const R={signal:_.signal,options:N,context:G},T=(et,M=!1)=>{const{aborted:C}=_.signal,x=N.ignoreFetchAbort&&et!==void 0;return N.status&&(C&&!M?(N.status.fetchAborted=!0,N.status.fetchError=_.signal.reason,x&&(N.status.fetchAbortIgnored=!0)):N.status.fetchResolved=!0),!C||x||M?(this.valList[E]===J&&(et===void 0?J.__staleWhileFetching?this.valList[E]=J.__staleWhileFetching:this.delete(A):(N.status&&(N.status.fetchUpdated=!0),this.set(A,et,R.options))),et):Y(_.signal.reason)},Y=et=>{const{aborted:M}=_.signal,C=M&&N.allowStaleOnFetchAbort,x=C||N.allowStaleOnFetchRejection,z=x||N.noDeleteOnFetchRejection;if(this.valList[E]===J&&(!z||J.__staleWhileFetching===void 0?this.delete(A):C||(this.valList[E]=J.__staleWhileFetching)),x)return N.status&&J.__staleWhileFetching!==void 0&&(N.status.returnedStale=!0),J.__staleWhileFetching;if(J.__returned===J)throw et};N.status&&(N.status.fetchDispatched=!0);const J=new Promise((et,M)=>{this.fetchMethod(A,W,R).then(C=>et(C),M),_.signal.addEventListener("abort",()=>{N.ignoreFetchAbort&&!N.allowStaleOnFetchAbort||(et(),N.allowStaleOnFetchAbort&&(et=C=>T(C,!0)))})}).then(T,et=>(N.status&&(N.status.fetchRejected=!0,N.status.fetchError=et),Y(et)));return J.__abortController=_,J.__staleWhileFetching=W,J.__returned=null,E===void 0?(this.set(A,J,{...R.options,status:void 0}),E=this.keyMap.get(A)):this.valList[E]=J,J}isBackgroundFetch(A){return A&&typeof A=="object"&&typeof A.then=="function"&&Object.prototype.hasOwnProperty.call(A,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(A,"__returned")&&(A.__returned===A||A.__returned===null)}async fetch(A,{allowStale:E=this.allowStale,updateAgeOnGet:N=this.updateAgeOnGet,noDeleteOnStaleGet:G=this.noDeleteOnStaleGet,ttl:W=this.ttl,noDisposeOnSet:_=this.noDisposeOnSet,size:R=0,sizeCalculation:T=this.sizeCalculation,noUpdateTTL:Y=this.noUpdateTTL,noDeleteOnFetchRejection:J=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:et=this.allowStaleOnFetchRejection,ignoreFetchAbort:M=this.ignoreFetchAbort,allowStaleOnFetchAbort:C=this.allowStaleOnFetchAbort,fetchContext:x=this.fetchContext,forceRefresh:z=!1,status:B,signal:V}={}){if(!this.fetchMethod)return B&&(B.fetch="get"),this.get(A,{allowStale:E,updateAgeOnGet:N,noDeleteOnStaleGet:G,status:B});const $={allowStale:E,updateAgeOnGet:N,noDeleteOnStaleGet:G,ttl:W,noDisposeOnSet:_,size:R,sizeCalculation:T,noUpdateTTL:Y,noDeleteOnFetchRejection:J,allowStaleOnFetchRejection:et,allowStaleOnFetchAbort:C,ignoreFetchAbort:M,status:B,signal:V};let H=this.keyMap.get(A);if(H===void 0){B&&(B.fetch="miss");const Z=this.backgroundFetch(A,H,$,x);return Z.__returned=Z}{const Z=this.valList[H];if(this.isBackgroundFetch(Z)){const m=E&&Z.__staleWhileFetching!==void 0;return B&&(B.fetch="inflight",m&&(B.returnedStale=!0)),m?Z.__staleWhileFetching:Z.__returned=Z}const X=this.isStale(H);if(!z&&!X)return B&&(B.fetch="hit"),this.moveToTail(H),N&&this.updateItemAge(H),this.statusTTL(B,H),Z;const tt=this.backgroundFetch(A,H,$,x),O=tt.__staleWhileFetching!==void 0,p=O&&E;return B&&(B.fetch=O&&X?"stale":"refresh",p&&X&&(B.returnedStale=!0)),p?tt.__staleWhileFetching:tt.__returned=tt}}get(A,{allowStale:E=this.allowStale,updateAgeOnGet:N=this.updateAgeOnGet,noDeleteOnStaleGet:G=this.noDeleteOnStaleGet,status:W}={}){const _=this.keyMap.get(A);if(_!==void 0){const R=this.valList[_],T=this.isBackgroundFetch(R);return this.statusTTL(W,_),this.isStale(_)?(W&&(W.get="stale"),T?(W&&(W.returnedStale=E&&R.__staleWhileFetching!==void 0),E?R.__staleWhileFetching:void 0):(G||this.delete(A),W&&(W.returnedStale=E),E?R:void 0)):(W&&(W.get="hit"),T?R.__staleWhileFetching:(this.moveToTail(_),N&&this.updateItemAge(_),R))}W&&(W.get="miss")}connect(A,E){this.prev[E]=A,this.next[A]=E}moveToTail(A){A!==this.tail&&(A===this.head?this.head=this.next[A]:this.connect(this.prev[A],this.next[A]),this.connect(this.tail,A),this.tail=A)}get del(){return o("del","delete"),this.delete}delete(A){let E=!1;if(this.size!==0){const N=this.keyMap.get(A);if(N!==void 0)if(E=!0,this.size===1)this.clear();else{this.removeItemSize(N);const G=this.valList[N];this.isBackgroundFetch(G)?G.__abortController.abort(new Error("deleted")):(this.dispose(G,A,"delete"),this.disposeAfter&&this.disposed.push([G,A,"delete"])),this.keyMap.delete(A),this.keyList[N]=null,this.valList[N]=null,N===this.tail?this.tail=this.prev[N]:N===this.head?this.head=this.next[N]:(this.next[this.prev[N]]=this.next[N],this.prev[this.next[N]]=this.prev[N]),this.size--,this.free.push(N)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return E}clear(){for(const A of this.rindexes({allowStale:!0})){const E=this.valList[A];if(this.isBackgroundFetch(E))E.__abortController.abort(new Error("deleted"));else{const N=this.keyList[A];this.dispose(E,N,"delete"),this.disposeAfter&&this.disposed.push([E,N,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return o("reset","clear"),this.clear}get length(){return((A,E)=>{const N=`LRU_CACHE_PROPERTY_${A}`;if(b(N)){const{prototype:G}=L,{get:W}=Object.getOwnPropertyDescriptor(G,A);y(N,`${A} property`,`cache.${E}`,W)}})("length","size"),this.size}static get AbortController(){return g}static get AbortSignal(){return f}}l.exports=L}).call(this)}).call(this,t("_process"))},{_process:102}],73:[function(t,l,h){const r=l.exports,{Buffer:s}=t("buffer");r.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},r.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},r.requiredHeaderFlagsErrors={};for(const d in r.requiredHeaderFlags){const i=r.requiredHeaderFlags[d];r.requiredHeaderFlagsErrors[d]="Invalid header flag bits, must be 0x"+i.toString(16)+" for "+r.types[d]+" packet"}r.codes={};for(const d in r.types){const i=r.types[d];r.codes[i]=d}r.CMD_SHIFT=4,r.CMD_MASK=240,r.DUP_MASK=8,r.QOS_MASK=3,r.QOS_SHIFT=1,r.RETAIN_MASK=1,r.VARBYTEINT_MASK=127,r.VARBYTEINT_FIN_MASK=128,r.VARBYTEINT_MAX=268435455,r.SESSIONPRESENT_MASK=1,r.SESSIONPRESENT_HEADER=s.from([r.SESSIONPRESENT_MASK]),r.CONNACK_HEADER=s.from([r.codes.connack<<r.CMD_SHIFT]),r.USERNAME_MASK=128,r.PASSWORD_MASK=64,r.WILL_RETAIN_MASK=32,r.WILL_QOS_MASK=24,r.WILL_QOS_SHIFT=3,r.WILL_FLAG_MASK=4,r.CLEAN_SESSION_MASK=2,r.CONNECT_HEADER=s.from([r.codes.connect<<r.CMD_SHIFT]),r.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},r.propertiesCodes={};for(const d in r.properties){const i=r.properties[d];r.propertiesCodes[i]=d}function g(d){return[0,1,2].map(i=>[0,1].map(f=>[0,1].map(c=>{const n=s.alloc(1);return n.writeUInt8(r.codes[d]<<r.CMD_SHIFT|(f?r.DUP_MASK:0)|i<<r.QOS_SHIFT|c,0,!0),n})))}r.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"},r.PUBLISH_HEADER=g("publish"),r.SUBSCRIBE_HEADER=g("subscribe"),r.SUBSCRIBE_OPTIONS_QOS_MASK=3,r.SUBSCRIBE_OPTIONS_NL_MASK=1,r.SUBSCRIBE_OPTIONS_NL_SHIFT=2,r.SUBSCRIBE_OPTIONS_RAP_MASK=1,r.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,r.SUBSCRIBE_OPTIONS_RH_MASK=3,r.SUBSCRIBE_OPTIONS_RH_SHIFT=4,r.SUBSCRIBE_OPTIONS_RH=[0,16,32],r.SUBSCRIBE_OPTIONS_NL=4,r.SUBSCRIBE_OPTIONS_RAP=8,r.SUBSCRIBE_OPTIONS_QOS=[0,1,2],r.UNSUBSCRIBE_HEADER=g("unsubscribe"),r.ACKS={unsuback:g("unsuback"),puback:g("puback"),pubcomp:g("pubcomp"),pubrel:g("pubrel"),pubrec:g("pubrec")},r.SUBACK_HEADER=s.from([r.codes.suback<<r.CMD_SHIFT]),r.VERSION3=s.from([3]),r.VERSION4=s.from([4]),r.VERSION5=s.from([5]),r.VERSION131=s.from([131]),r.VERSION132=s.from([132]),r.QOS=[0,1,2].map(d=>s.from([d])),r.EMPTY={pingreq:s.from([r.codes.pingreq<<4,0]),pingresp:s.from([r.codes.pingresp<<4,0]),disconnect:s.from([r.codes.disconnect<<4,0])},r.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},r.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},r.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},r.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},r.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},r.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}},{buffer:29}],74:[function(t,l,h){const r=t("./writeToStream"),s=t("events"),{Buffer:g}=t("buffer");class d extends s{constructor(){super(),this._array=new Array(20),this._i=0}write(f){return this._array[this._i++]=f,!0}concat(){let f=0;const c=new Array(this._array.length),n=this._array;let o,u=0;for(o=0;o<n.length&&n[o]!==void 0;o++)typeof n[o]!="string"?c[o]=n[o].length:c[o]=g.byteLength(n[o]),f+=c[o];const b=g.allocUnsafe(f);for(o=0;o<n.length&&n[o]!==void 0;o++)typeof n[o]!="string"?(n[o].copy(b,u),u+=c[o]):(b.write(n[o],u),u+=c[o]);return b}destroy(f){f&&this.emit("error",f)}}l.exports=function(i,f){const c=new d;return r(i,c,f),c.concat()}},{"./writeToStream":96,buffer:29,events:49}],75:[function(t,l,h){h.parser=t("./parser").parser,h.generate=t("./generate"),h.writeToStream=t("./writeToStream")},{"./generate":74,"./parser":95,"./writeToStream":96}],76:[function(t,l,h){const{Buffer:r}=t("buffer"),s=Symbol.for("BufferList");function g(d){if(!(this instanceof g))return new g(d);g._init.call(this,d)}g._init=function(d){Object.defineProperty(this,s,{value:!0}),this._bufs=[],this.length=0,d&&this.append(d)},g.prototype._new=function(d){return new g(d)},g.prototype._offset=function(d){if(d===0)return[0,0];let i=0;for(let f=0;f<this._bufs.length;f++){const c=i+this._bufs[f].length;if(d<c||f===this._bufs.length-1)return[f,d-i];i=c}},g.prototype._reverseOffset=function(d){const i=d[0];let f=d[1];for(let c=0;c<i;c++)f+=this._bufs[c].length;return f},g.prototype.get=function(d){if(d>this.length||d<0)return;const i=this._offset(d);return this._bufs[i[0]][i[1]]},g.prototype.slice=function(d,i){return typeof d=="number"&&d<0&&(d+=this.length),typeof i=="number"&&i<0&&(i+=this.length),this.copy(null,0,d,i)},g.prototype.copy=function(d,i,f,c){if((typeof f!="number"||f<0)&&(f=0),(typeof c!="number"||c>this.length)&&(c=this.length),f>=this.length||c<=0)return d||r.alloc(0);const n=!!d,o=this._offset(f),u=c-f;let b=u,y=n&&i||0,w=o[1];if(f===0&&c===this.length){if(!n)return this._bufs.length===1?this._bufs[0]:r.concat(this._bufs,this.length);for(let S=0;S<this._bufs.length;S++)this._bufs[S].copy(d,y),y+=this._bufs[S].length;return d}if(b<=this._bufs[o[0]].length-w)return n?this._bufs[o[0]].copy(d,i,w,w+b):this._bufs[o[0]].slice(w,w+b);n||(d=r.allocUnsafe(u));for(let S=o[0];S<this._bufs.length;S++){const k=this._bufs[S].length-w;if(!(b>k)){this._bufs[S].copy(d,y,w,w+b),y+=k;break}this._bufs[S].copy(d,y,w),y+=k,b-=k,w&&(w=0)}return d.length>y?d.slice(0,y):d},g.prototype.shallowSlice=function(d,i){if(d=d||0,i=typeof i!="number"?this.length:i,d<0&&(d+=this.length),i<0&&(i+=this.length),d===i)return this._new();const f=this._offset(d),c=this._offset(i),n=this._bufs.slice(f[0],c[0]+1);return c[1]===0?n.pop():n[n.length-1]=n[n.length-1].slice(0,c[1]),f[1]!==0&&(n[0]=n[0].slice(f[1])),this._new(n)},g.prototype.toString=function(d,i,f){return this.slice(i,f).toString(d)},g.prototype.consume=function(d){if(d=Math.trunc(d),Number.isNaN(d)||d<=0)return this;for(;this._bufs.length;){if(!(d>=this._bufs[0].length)){this._bufs[0]=this._bufs[0].slice(d),this.length-=d;break}d-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift()}return this},g.prototype.duplicate=function(){const d=this._new();for(let i=0;i<this._bufs.length;i++)d.append(this._bufs[i]);return d},g.prototype.append=function(d){if(d==null)return this;if(d.buffer)this._appendBuffer(r.from(d.buffer,d.byteOffset,d.byteLength));else if(Array.isArray(d))for(let i=0;i<d.length;i++)this.append(d[i]);else if(this._isBufferList(d))for(let i=0;i<d._bufs.length;i++)this.append(d._bufs[i]);else typeof d=="number"&&(d=d.toString()),this._appendBuffer(r.from(d));return this},g.prototype._appendBuffer=function(d){this._bufs.push(d),this.length+=d.length},g.prototype.indexOf=function(d,i,f){if(f===void 0&&typeof i=="string"&&(f=i,i=void 0),typeof d=="function"||Array.isArray(d))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof d=="number"?d=r.from([d]):typeof d=="string"?d=r.from(d,f):this._isBufferList(d)?d=d.slice():Array.isArray(d.buffer)?d=r.from(d.buffer,d.byteOffset,d.byteLength):r.isBuffer(d)||(d=r.from(d)),i=Number(i||0),isNaN(i)&&(i=0),i<0&&(i=this.length+i),i<0&&(i=0),d.length===0)return i>this.length?this.length:i;const c=this._offset(i);let n=c[0],o=c[1];for(;n<this._bufs.length;n++){const u=this._bufs[n];for(;o<u.length;)if(u.length-o>=d.length){const b=u.indexOf(d,o);if(b!==-1)return this._reverseOffset([n,b]);o=u.length-d.length+1}else{const b=this._reverseOffset([n,o]);if(this._match(b,d))return b;o++}o=0}return-1},g.prototype._match=function(d,i){if(this.length-d<i.length)return!1;for(let f=0;f<i.length;f++)if(this.get(d+f)!==i[f])return!1;return!0},function(){const d={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const i in d)(function(f){g.prototype[f]=d[f]===null?function(c,n){return this.slice(c,c+n)[f](0,n)}:function(c=0){return this.slice(c,c+d[f])[f](0)}})(i)}(),g.prototype._isBufferList=function(d){return d instanceof g||g.isBufferList(d)},g.isBufferList=function(d){return d!=null&&d[s]},l.exports=g},{buffer:29}],77:[function(t,l,h){const r=t("readable-stream").Duplex,s=t("inherits"),g=t("./BufferList");function d(i){if(!(this instanceof d))return new d(i);if(typeof i=="function"){this._callback=i;const f=(function(c){this._callback&&(this._callback(c),this._callback=null)}).bind(this);this.on("pipe",function(c){c.on("error",f)}),this.on("unpipe",function(c){c.removeListener("error",f)}),i=null}g._init.call(this,i),r.call(this)}s(d,r),Object.assign(d.prototype,g.prototype),d.prototype._new=function(i){return new d(i)},d.prototype._write=function(i,f,c){this._appendBuffer(i),typeof c=="function"&&c()},d.prototype._read=function(i){if(!this.length)return this.push(null);i=Math.min(i,this.length),this.push(this.slice(0,i)),this.consume(i)},d.prototype.end=function(i){r.prototype.end.call(this,i),this._callback&&(this._callback(null,this.slice()),this._callback=null)},d.prototype._destroy=function(i,f){this._bufs.length=0,this.length=0,f(i)},d.prototype._isBufferList=function(i){return i instanceof d||i instanceof g||d.isBufferList(i)},d.isBufferList=g.isBufferList,l.exports=d,l.exports.BufferListStream=d,l.exports.BufferList=g},{"./BufferList":76,inherits:51,"readable-stream":92}],78:[function(t,l,h){arguments[4][33][0].apply(h,arguments)},{dup:33}],79:[function(t,l,h){arguments[4][34][0].apply(h,arguments)},{"./_stream_readable":81,"./_stream_writable":83,_process:102,dup:34,inherits:51}],80:[function(t,l,h){arguments[4][35][0].apply(h,arguments)},{"./_stream_transform":82,dup:35,inherits:51}],81:[function(t,l,h){arguments[4][36][0].apply(h,arguments)},{"../errors":78,"./_stream_duplex":79,"./internal/streams/async_iterator":84,"./internal/streams/buffer_list":85,"./internal/streams/destroy":86,"./internal/streams/from":88,"./internal/streams/state":90,"./internal/streams/stream":91,_process:102,buffer:29,dup:36,events:49,inherits:51,"string_decoder/":136,util:26}],82:[function(t,l,h){arguments[4][37][0].apply(h,arguments)},{"../errors":78,"./_stream_duplex":79,dup:37,inherits:51}],83:[function(t,l,h){arguments[4][38][0].apply(h,arguments)},{"../errors":78,"./_stream_duplex":79,"./internal/streams/destroy":86,"./internal/streams/state":90,"./internal/streams/stream":91,_process:102,buffer:29,dup:38,inherits:51,"util-deprecate":139}],84:[function(t,l,h){arguments[4][39][0].apply(h,arguments)},{"./end-of-stream":87,_process:102,dup:39}],85:[function(t,l,h){arguments[4][40][0].apply(h,arguments)},{buffer:29,dup:40,util:26}],86:[function(t,l,h){arguments[4][41][0].apply(h,arguments)},{_process:102,dup:41}],87:[function(t,l,h){arguments[4][42][0].apply(h,arguments)},{"../../../errors":78,dup:42}],88:[function(t,l,h){arguments[4][43][0].apply(h,arguments)},{dup:43}],89:[function(t,l,h){arguments[4][44][0].apply(h,arguments)},{"../../../errors":78,"./end-of-stream":87,dup:44}],90:[function(t,l,h){arguments[4][45][0].apply(h,arguments)},{"../../../errors":78,dup:45}],91:[function(t,l,h){arguments[4][46][0].apply(h,arguments)},{dup:46,events:49}],92:[function(t,l,h){arguments[4][47][0].apply(h,arguments)},{"./lib/_stream_duplex.js":79,"./lib/_stream_passthrough.js":80,"./lib/_stream_readable.js":81,"./lib/_stream_transform.js":82,"./lib/_stream_writable.js":83,"./lib/internal/streams/end-of-stream.js":87,"./lib/internal/streams/pipeline.js":89,dup:47}],93:[function(t,l,h){const{Buffer:r}=t("buffer"),s={},g=r.isBuffer(r.from([1,2]).subarray(0,1));function d(i){const f=r.allocUnsafe(2);return f.writeUInt8(i>>8,0),f.writeUInt8(255&i,1),f}l.exports={cache:s,generateCache:function(){for(let i=0;i<65536;i++)s[i]=d(i)},generateNumber:d,genBufVariableByteInt:function(i){let f=0,c=0;const n=r.allocUnsafe(4);do f=i%128|0,(i=i/128|0)>0&&(f|=128),n.writeUInt8(f,c++);while(i>0&&c<4);return i>0&&(c=0),g?n.subarray(0,c):n.slice(0,c)},generate4ByteBuffer:function(i){const f=r.allocUnsafe(4);return f.writeUInt32BE(i,0),f}}},{buffer:29}],94:[function(t,l,h){l.exports=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}}},{}],95:[function(t,l,h){const r=t("bl"),s=t("events"),g=t("./packet"),d=t("./constants"),i=t("debug")("mqtt-packet:parser");class f extends s{constructor(){super(),this.parser=this.constructor.parser}static parser(n){return this instanceof f?(this.settings=n||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new f().parser(n)}_resetState(){i("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new g,this.error=null,this._list=r(),this._stateCounter=0}parse(n){for(this.error&&this._resetState(),this._list.append(n),i("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,i("parse: state complete. _stateCounter is now: %d",this._stateCounter),i("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return i("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){const n=this._list.readUInt8(0),o=n>>d.CMD_SHIFT;this.packet.cmd=d.types[o];const u=15&n,b=d.requiredHeaderFlags[o];return b!=null&&u!==b?this._emitError(new Error(d.requiredHeaderFlagsErrors[o])):(this.packet.retain=(n&d.RETAIN_MASK)!=0,this.packet.qos=n>>d.QOS_SHIFT&d.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(n&d.DUP_MASK)!=0,i("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){const n=this._parseVarByteNum(!0);return n&&(this.packet.length=n.value,this._list.consume(n.bytes)),i("_parseLength %d",n.value),!!n}_parsePayload(){i("_parsePayload: payload %O",this._list);let n=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}n=!0}return i("_parsePayload complete result: %s",n),n}_parseConnect(){let n,o,u,b;i("_parseConnect");const y={},w=this.packet,S=this._parseString();if(S===null)return this._emitError(new Error("Cannot parse protocolId"));if(S!=="MQTT"&&S!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(w.protocolId=S,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(w.protocolVersion=this._list.readUInt8(this._pos),w.protocolVersion>=128&&(w.bridgeMode=!0,w.protocolVersion=w.protocolVersion-128),w.protocolVersion!==3&&w.protocolVersion!==4&&w.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(1&this._list.readUInt8(this._pos))return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));y.username=this._list.readUInt8(this._pos)&d.USERNAME_MASK,y.password=this._list.readUInt8(this._pos)&d.PASSWORD_MASK,y.will=this._list.readUInt8(this._pos)&d.WILL_FLAG_MASK;const k=!!(this._list.readUInt8(this._pos)&d.WILL_RETAIN_MASK),j=(this._list.readUInt8(this._pos)&d.WILL_QOS_MASK)>>d.WILL_QOS_SHIFT;if(y.will)w.will={},w.will.retain=k,w.will.qos=j;else{if(k)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(j)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(w.clean=(this._list.readUInt8(this._pos)&d.CLEAN_SESSION_MASK)!=0,this._pos++,w.keepalive=this._parseNum(),w.keepalive===-1)return this._emitError(new Error("Packet too short"));if(w.protocolVersion===5){const I=this._parseProperties();Object.getOwnPropertyNames(I).length&&(w.properties=I)}const L=this._parseString();if(L===null)return this._emitError(new Error("Packet too short"));if(w.clientId=L,i("_parseConnect: packet.clientId: %s",w.clientId),y.will){if(w.protocolVersion===5){const I=this._parseProperties();Object.getOwnPropertyNames(I).length&&(w.will.properties=I)}if(n=this._parseString(),n===null)return this._emitError(new Error("Cannot parse will topic"));if(w.will.topic=n,i("_parseConnect: packet.will.topic: %s",w.will.topic),o=this._parseBuffer(),o===null)return this._emitError(new Error("Cannot parse will payload"));w.will.payload=o,i("_parseConnect: packet.will.paylaod: %s",w.will.payload)}if(y.username){if(b=this._parseString(),b===null)return this._emitError(new Error("Cannot parse username"));w.username=b,i("_parseConnect: packet.username: %s",w.username)}if(y.password){if(u=this._parseBuffer(),u===null)return this._emitError(new Error("Cannot parse password"));w.password=u}return this.settings=w,i("_parseConnect: complete"),w}_parseConnack(){i("_parseConnack");const n=this.packet;if(this._list.length<1)return null;const o=this._list.readUInt8(this._pos++);if(o>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(n.sessionPresent=!!(o&d.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?n.reasonCode=this._list.readUInt8(this._pos++):n.reasonCode=0;else{if(this._list.length<2)return null;n.returnCode=this._list.readUInt8(this._pos++)}if(n.returnCode===-1||n.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){const u=this._parseProperties();Object.getOwnPropertyNames(u).length&&(n.properties=u)}i("_parseConnack: complete")}_parsePublish(){i("_parsePublish");const n=this.packet;if(n.topic=this._parseString(),n.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(n.qos>0)||this._parseMessageId()){if(this.settings.protocolVersion===5){const o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(n.properties=o)}n.payload=this._list.slice(this._pos,n.length),i("_parsePublish: payload from buffer list: %o",n.payload)}}_parseSubscribe(){i("_parseSubscribe");const n=this.packet;let o,u,b,y,w,S,k;if(n.subscriptions=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const j=this._parseProperties();Object.getOwnPropertyNames(j).length&&(n.properties=j)}if(n.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<n.length;){if(o=this._parseString(),o===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=n.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(u=this._parseByte(),this.settings.protocolVersion===5){if(192&u)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(252&u)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(b=u&d.SUBSCRIBE_OPTIONS_QOS_MASK,b>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(S=(u>>d.SUBSCRIBE_OPTIONS_NL_SHIFT&d.SUBSCRIBE_OPTIONS_NL_MASK)!=0,w=(u>>d.SUBSCRIBE_OPTIONS_RAP_SHIFT&d.SUBSCRIBE_OPTIONS_RAP_MASK)!=0,y=u>>d.SUBSCRIBE_OPTIONS_RH_SHIFT&d.SUBSCRIBE_OPTIONS_RH_MASK,y>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));k={topic:o,qos:b},this.settings.protocolVersion===5?(k.nl=S,k.rap=w,k.rh=y):this.settings.bridgeMode&&(k.rh=0,k.rap=!0,k.nl=!0),i("_parseSubscribe: push subscription `%s` to subscription",k),n.subscriptions.push(k)}}}_parseSuback(){i("_parseSuback");const n=this.packet;if(this.packet.granted=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(n.properties=o)}if(n.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){const o=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!d.MQTT5_SUBACK_CODES[o])return this._emitError(new Error("Invalid suback code"))}else if(o>2&&o!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(o)}}}_parseUnsubscribe(){i("_parseUnsubscribe");const n=this.packet;if(n.unsubscriptions=[],this._parseMessageId()){if(this.settings.protocolVersion===5){const o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(n.properties=o)}if(n.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<n.length;){const o=this._parseString();if(o===null)return this._emitError(new Error("Cannot parse topic"));i("_parseUnsubscribe: push topic `%s` to unsubscriptions",o),n.unsubscriptions.push(o)}}}_parseUnsuback(){i("_parseUnsuback");const n=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&n.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(n.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){const o=this._parseProperties();for(Object.getOwnPropertyNames(o).length&&(n.properties=o),n.granted=[];this._pos<this.packet.length;){const u=this._list.readUInt8(this._pos++);if(!d.MQTT5_UNSUBACK_CODES[u])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(u)}}}_parseConfirmation(){i("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);const n=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(n.length>2){switch(n.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!d.MQTT5_PUBACK_PUBREC_CODES[n.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!d.MQTT5_PUBREL_PUBCOMP_CODES[n.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"))}i("_parseConfirmation: packet.reasonCode `%d`",n.reasonCode)}else n.reasonCode=0;if(n.length>3){const o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(n.properties=o)}}return!0}_parseDisconnect(){const n=this.packet;if(i("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(n.reasonCode=this._parseByte(),d.MQTT5_DISCONNECT_CODES[n.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):n.reasonCode=0;const o=this._parseProperties();Object.getOwnPropertyNames(o).length&&(n.properties=o)}return i("_parseDisconnect result: true"),!0}_parseAuth(){i("_parseAuth");const n=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(n.reasonCode=this._parseByte(),!d.MQTT5_AUTH_CODES[n.reasonCode])return this._emitError(new Error("Invalid auth reason code"));const o=this._parseProperties();return Object.getOwnPropertyNames(o).length&&(n.properties=o),i("_parseAuth: result: true"),!0}_parseMessageId(){const n=this.packet;return n.messageId=this._parseNum(),n.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(i("_parseMessageId: packet.messageId %d",n.messageId),!0)}_parseString(n){const o=this._parseNum(),u=o+this._pos;if(o===-1||u>this._list.length||u>this.packet.length)return null;const b=this._list.toString("utf8",this._pos,u);return this._pos+=o,i("_parseString: result: %s",b),b}_parseStringPair(){return i("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){const n=this._parseNum(),o=n+this._pos;if(n===-1||o>this._list.length||o>this.packet.length)return null;const u=this._list.slice(this._pos,o);return this._pos+=n,i("_parseBuffer: result: %o",u),u}_parseNum(){if(this._list.length-this._pos<2)return-1;const n=this._list.readUInt16BE(this._pos);return this._pos+=2,i("_parseNum: result: %s",n),n}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;const n=this._list.readUInt32BE(this._pos);return this._pos+=4,i("_parse4ByteNum: result: %s",n),n}_parseVarByteNum(n){i("_parseVarByteNum");let o,u=0,b=1,y=0,w=!1;const S=this._pos?this._pos:0;for(;u<4&&S+u<this._list.length;){if(o=this._list.readUInt8(S+u++),y+=b*(o&d.VARBYTEINT_MASK),b*=128,(o&d.VARBYTEINT_FIN_MASK)==0){w=!0;break}if(this._list.length<=u)break}return!w&&u===4&&this._list.length>=u&&this._emitError(new Error("Invalid variable byte integer")),S&&(this._pos+=u),w=!!w&&(n?{bytes:u,value:y}:y),i("_parseVarByteNum: result: %o",w),w}_parseByte(){let n;return this._pos<this._list.length&&(n=this._list.readUInt8(this._pos),this._pos++),i("_parseByte: result: %o",n),n}_parseByType(n){switch(i("_parseByType: type: %s",n),n){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){i("_parseProperties");const n=this._parseVarByteNum(),o=this._pos+n,u={};for(;this._pos<o;){const b=this._parseByte();if(!b)return this._emitError(new Error("Cannot parse property code type")),!1;const y=d.propertiesCodes[b];if(!y)return this._emitError(new Error("Unknown property")),!1;if(y!=="userProperties")u[y]?(Array.isArray(u[y])||(u[y]=[u[y]]),u[y].push(this._parseByType(d.propertiesTypes[y]))):u[y]=this._parseByType(d.propertiesTypes[y]);else{u[y]||(u[y]=Object.create(null));const w=this._parseByType(d.propertiesTypes[y]);if(u[y][w.name])if(Array.isArray(u[y][w.name]))u[y][w.name].push(w.value);else{const S=u[y][w.name];u[y][w.name]=[S],u[y][w.name].push(w.value)}else u[y][w.name]=w.value}}return u}_newPacket(){return i("_newPacket"),this.packet&&(this._list.consume(this.packet.length),i("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),i("_newPacket: new packet"),this.packet=new g,this._pos=0,!0}_emitError(n){i("_emitError",n),this.error=n,this.emit("error",n)}}l.exports=f},{"./constants":73,"./packet":94,bl:77,debug:30,events:49}],96:[function(t,l,h){const r=t("./constants"),{Buffer:s}=t("buffer"),g=s.allocUnsafe(0),d=s.from([0]),i=t("./numbers"),f=t("process-nextick-args").nextTick,c=t("debug")("mqtt-packet:writeToStream"),n=i.cache,o=i.generateNumber,u=i.generateCache,b=i.genBufVariableByteInt,y=i.generate4ByteBuffer;let w=N,S=!0;function k(M,C,x){switch(c("generate called"),C.cork&&(C.cork(),f(j,C)),S&&(S=!1,u()),c("generate: packet.cmd: %s",M.cmd),M.cmd){case"connect":return function(z,B,V){const $=z||{},H=$.protocolId||"MQTT";let Z=$.protocolVersion||4;const X=$.will;let tt=$.clean;const O=$.keepalive||0,p=$.clientId||"",m=$.username,v=$.password,P=$.properties;tt===void 0&&(tt=!0);let F,K,D=0;if(!H||typeof H!="string"&&!s.isBuffer(H))return B.destroy(new Error("Invalid protocolId")),!1;if(D+=H.length+2,Z!==3&&Z!==4&&Z!==5)return B.destroy(new Error("Invalid protocol version")),!1;if(D+=1,(typeof p=="string"||s.isBuffer(p))&&(p||Z>=4)&&(p||tt))D+=s.byteLength(p)+2;else{if(Z<4)return B.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(1*tt==0)return B.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof O!="number"||O<0||O>65535||O%1!=0)return B.destroy(new Error("Invalid keepalive")),!1;if(D+=2,D+=1,Z===5){if(F=_(B,P),!F)return!1;D+=F.length}if(X){if(typeof X!="object")return B.destroy(new Error("Invalid will")),!1;if(!X.topic||typeof X.topic!="string")return B.destroy(new Error("Invalid will topic")),!1;if(D+=s.byteLength(X.topic)+2,D+=2,X.payload){if(!(X.payload.length>=0))return B.destroy(new Error("Invalid will payload")),!1;typeof X.payload=="string"?D+=s.byteLength(X.payload):D+=X.payload.length}if(K={},Z===5){if(K=_(B,X.properties),!K)return!1;D+=K.length}}let Q=!1;if(m!=null){if(!et(m))return B.destroy(new Error("Invalid username")),!1;Q=!0,D+=s.byteLength(m)+2}if(v!=null){if(!Q)return B.destroy(new Error("Username is required to use password")),!1;if(!et(v))return B.destroy(new Error("Invalid password")),!1;D+=J(v)+2}B.write(r.CONNECT_HEADER),I(B,D),W(B,H),$.bridgeMode&&(Z+=128),B.write(Z===131?r.VERSION131:Z===132?r.VERSION132:Z===4?r.VERSION4:Z===5?r.VERSION5:r.VERSION3);let rt=0;return rt|=m!=null?r.USERNAME_MASK:0,rt|=v!=null?r.PASSWORD_MASK:0,rt|=X&&X.retain?r.WILL_RETAIN_MASK:0,rt|=X&&X.qos?X.qos<<r.WILL_QOS_SHIFT:0,rt|=X?r.WILL_FLAG_MASK:0,rt|=tt?r.CLEAN_SESSION_MASK:0,B.write(s.from([rt])),w(B,O),Z===5&&F.write(),W(B,p),X&&(Z===5&&K.write(),A(B,X.topic),W(B,X.payload)),m!=null&&W(B,m),v!=null&&W(B,v),!0}(M,C);case"connack":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=$===5?H.reasonCode:H.returnCode,X=H.properties;let tt=2;if(typeof Z!="number")return B.destroy(new Error("Invalid return code")),!1;let O=null;if($===5){if(O=_(B,X),!O)return!1;tt+=O.length}return B.write(r.CONNACK_HEADER),I(B,tt),B.write(H.sessionPresent?r.SESSIONPRESENT_HEADER:d),B.write(s.from([Z])),O!=null&&O.write(),!0}(M,C,x);case"publish":return function(z,B,V){c("publish: packet: %o",z);const $=V?V.protocolVersion:4,H=z||{},Z=H.qos||0,X=H.retain?r.RETAIN_MASK:0,tt=H.topic,O=H.payload||g,p=H.messageId,m=H.properties;let v=0;if(typeof tt=="string")v+=s.byteLength(tt)+2;else{if(!s.isBuffer(tt))return B.destroy(new Error("Invalid topic")),!1;v+=tt.length+2}if(s.isBuffer(O)?v+=O.length:v+=s.byteLength(O),Z&&typeof p!="number")return B.destroy(new Error("Invalid messageId")),!1;Z&&(v+=2);let P=null;if($===5){if(P=_(B,m),!P)return!1;v+=P.length}return B.write(r.PUBLISH_HEADER[Z][H.dup?1:0][X?1:0]),I(B,v),w(B,J(tt)),B.write(tt),Z>0&&w(B,p),P!=null&&P.write(),c("publish: payload: %o",O),B.write(O)}(M,C,x);case"puback":case"pubrec":case"pubrel":case"pubcomp":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.cmd||"puback",X=H.messageId,tt=H.dup&&Z==="pubrel"?r.DUP_MASK:0;let O=0;const p=H.reasonCode,m=H.properties;let v=$===5?3:2;if(Z==="pubrel"&&(O=1),typeof X!="number")return B.destroy(new Error("Invalid messageId")),!1;let P=null;if($===5&&typeof m=="object"){if(P=R(B,m,V,v),!P)return!1;v+=P.length}return B.write(r.ACKS[Z][O][tt][0]),v===3&&(v+=p!==0?1:-1),I(B,v),w(B,X),$===5&&v!==2&&B.write(s.from([p])),P!==null?P.write():v===4&&B.write(s.from([0])),!0}(M,C,x);case"subscribe":return function(z,B,V){c("subscribe: packet: ");const $=V?V.protocolVersion:4,H=z||{},Z=H.dup?r.DUP_MASK:0,X=H.messageId,tt=H.subscriptions,O=H.properties;let p=0;if(typeof X!="number")return B.destroy(new Error("Invalid messageId")),!1;p+=2;let m=null;if($===5){if(m=_(B,O),!m)return!1;p+=m.length}if(typeof tt!="object"||!tt.length)return B.destroy(new Error("Invalid subscriptions")),!1;for(let P=0;P<tt.length;P+=1){const F=tt[P].topic,K=tt[P].qos;if(typeof F!="string")return B.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof K!="number")return B.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if($===5){if(typeof(tt[P].nl||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(tt[P].rap||!1)!="boolean")return B.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;const D=tt[P].rh||0;if(typeof D!="number"||D>2)return B.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}p+=s.byteLength(F)+2+1}c("subscribe: writing to stream: %o",r.SUBSCRIBE_HEADER),B.write(r.SUBSCRIBE_HEADER[1][Z?1:0][0]),I(B,p),w(B,X),m!==null&&m.write();let v=!0;for(const P of tt){const F=P.topic,K=P.qos,D=+P.nl,Q=+P.rap,rt=P.rh;let nt;A(B,F),nt=r.SUBSCRIBE_OPTIONS_QOS[K],$===5&&(nt|=D?r.SUBSCRIBE_OPTIONS_NL:0,nt|=Q?r.SUBSCRIBE_OPTIONS_RAP:0,nt|=rt?r.SUBSCRIBE_OPTIONS_RH[rt]:0),v=B.write(s.from([nt]))}return v}(M,C,x);case"suback":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.messageId,X=H.granted,tt=H.properties;let O=0;if(typeof Z!="number")return B.destroy(new Error("Invalid messageId")),!1;if(O+=2,typeof X!="object"||!X.length)return B.destroy(new Error("Invalid qos vector")),!1;for(let m=0;m<X.length;m+=1){if(typeof X[m]!="number")return B.destroy(new Error("Invalid qos vector")),!1;O+=1}let p=null;if($===5){if(p=R(B,tt,V,O),!p)return!1;O+=p.length}return B.write(r.SUBACK_HEADER),I(B,O),w(B,Z),p!==null&&p.write(),B.write(s.from(X))}(M,C,x);case"unsubscribe":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.messageId,X=H.dup?r.DUP_MASK:0,tt=H.unsubscriptions,O=H.properties;let p=0;if(typeof Z!="number")return B.destroy(new Error("Invalid messageId")),!1;if(p+=2,typeof tt!="object"||!tt.length)return B.destroy(new Error("Invalid unsubscriptions")),!1;for(let P=0;P<tt.length;P+=1){if(typeof tt[P]!="string")return B.destroy(new Error("Invalid unsubscriptions")),!1;p+=s.byteLength(tt[P])+2}let m=null;if($===5){if(m=_(B,O),!m)return!1;p+=m.length}B.write(r.UNSUBSCRIBE_HEADER[1][X?1:0][0]),I(B,p),w(B,Z),m!==null&&m.write();let v=!0;for(let P=0;P<tt.length;P++)v=A(B,tt[P]);return v}(M,C,x);case"unsuback":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.messageId,X=H.dup?r.DUP_MASK:0,tt=H.granted,O=H.properties,p=H.cmd,m=0;let v=2;if(typeof Z!="number")return B.destroy(new Error("Invalid messageId")),!1;if($===5){if(typeof tt!="object"||!tt.length)return B.destroy(new Error("Invalid qos vector")),!1;for(let F=0;F<tt.length;F+=1){if(typeof tt[F]!="number")return B.destroy(new Error("Invalid qos vector")),!1;v+=1}}let P=null;if($===5){if(P=R(B,O,V,v),!P)return!1;v+=P.length}return B.write(r.ACKS[p][m][X][0]),I(B,v),w(B,Z),P!==null&&P.write(),$===5&&B.write(s.from(tt)),!0}(M,C,x);case"pingreq":case"pingresp":return function(z,B,V){return B.write(r.EMPTY[z.cmd])}(M,C);case"disconnect":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.reasonCode,X=H.properties;let tt=$===5?1:0,O=null;if($===5){if(O=R(B,X,V,tt),!O)return!1;tt+=O.length}return B.write(s.from([r.codes.disconnect<<4])),I(B,tt),$===5&&B.write(s.from([Z])),O!==null&&O.write(),!0}(M,C,x);case"auth":return function(z,B,V){const $=V?V.protocolVersion:4,H=z||{},Z=H.reasonCode,X=H.properties;let tt=$===5?1:0;$!==5&&B.destroy(new Error("Invalid mqtt version for auth packet"));const O=R(B,X,V,tt);return O?(tt+=O.length,B.write(s.from([r.codes.auth<<4])),I(B,tt),B.write(s.from([Z])),O!==null&&O.write(),!0):!1}(M,C,x);default:return C.destroy(new Error("Unknown command")),!1}}function j(M){M.uncork()}Object.defineProperty(k,"cacheNumbers",{get:()=>w===N,set(M){M?(n&&Object.keys(n).length!==0||(S=!0),w=N):(S=!1,w=G)}});const L={};function I(M,C){if(C>r.VARBYTEINT_MAX)return M.destroy(new Error(`Invalid variable byte integer: ${C}`)),!1;let x=L[C];return x||(x=b(C),C<16384&&(L[C]=x)),c("writeVarByteInt: writing to stream: %o",x),M.write(x)}function A(M,C){const x=s.byteLength(C);return w(M,x),c("writeString: %s",C),M.write(C,"utf8")}function E(M,C,x){A(M,C),A(M,x)}function N(M,C){return c("writeNumberCached: number: %d",C),c("writeNumberCached: %o",n[C]),M.write(n[C])}function G(M,C){const x=o(C);return c("writeNumberGenerated: %o",x),M.write(x)}function W(M,C){typeof C=="string"?A(M,C):C?(w(M,C.length),M.write(C)):w(M,0)}function _(M,C){if(typeof C!="object"||C.length!=null)return{length:1,write(){Y(M,{},0)}};let x=0;function z(B,V){let $=0;switch(r.propertiesTypes[B]){case"byte":if(typeof V!="boolean")return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=2;break;case"int8":if(typeof V!="number"||V<0||V>255)return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=2;break;case"binary":if(V&&V===null)return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=1+s.byteLength(V)+2;break;case"int16":if(typeof V!="number"||V<0||V>65535)return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=3;break;case"int32":if(typeof V!="number"||V<0||V>4294967295)return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=5;break;case"var":if(typeof V!="number"||V<0||V>268435455)return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=1+s.byteLength(b(V));break;case"string":if(typeof V!="string")return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=3+s.byteLength(V.toString());break;case"pair":if(typeof V!="object")return M.destroy(new Error(`Invalid ${B}: ${V}`)),!1;$+=Object.getOwnPropertyNames(V).reduce((H,Z)=>{const X=V[Z];return Array.isArray(X)?H+=X.reduce((tt,O)=>tt+=3+s.byteLength(Z.toString())+2+s.byteLength(O.toString()),0):H+=3+s.byteLength(Z.toString())+2+s.byteLength(V[Z].toString()),H},0);break;default:return M.destroy(new Error(`Invalid property ${B}: ${V}`)),!1}return $}if(C)for(const B in C){let V=0,$=0;const H=C[B];if(Array.isArray(H))for(let Z=0;Z<H.length;Z++){if($=z(B,H[Z]),!$)return!1;V+=$}else{if($=z(B,H),!$)return!1;V=$}if(!V)return!1;x+=V}return{length:s.byteLength(b(x))+x,write(){Y(M,C,x)}}}function R(M,C,x,z){const B=["reasonString","userProperties"],V=x&&x.properties&&x.properties.maximumPacketSize?x.properties.maximumPacketSize:0;let $=_(M,C);if(V)for(;z+$.length>V;){const H=B.shift();if(!H||!C[H])return!1;delete C[H],$=_(M,C)}return $}function T(M,C,x){switch(r.propertiesTypes[C]){case"byte":M.write(s.from([r.properties[C]])),M.write(s.from([+x]));break;case"int8":M.write(s.from([r.properties[C]])),M.write(s.from([x]));break;case"binary":M.write(s.from([r.properties[C]])),W(M,x);break;case"int16":M.write(s.from([r.properties[C]])),w(M,x);break;case"int32":M.write(s.from([r.properties[C]])),function(z,B){const V=y(B);c("write4ByteNumber: %o",V),z.write(V)}(M,x);break;case"var":M.write(s.from([r.properties[C]])),I(M,x);break;case"string":M.write(s.from([r.properties[C]])),A(M,x);break;case"pair":Object.getOwnPropertyNames(x).forEach(z=>{const B=x[z];Array.isArray(B)?B.forEach(V=>{M.write(s.from([r.properties[C]])),E(M,z.toString(),V.toString())}):(M.write(s.from([r.properties[C]])),E(M,z.toString(),B.toString()))});break;default:return M.destroy(new Error(`Invalid property ${C} value: ${x}`)),!1}}function Y(M,C,x){I(M,x);for(const z in C)if(Object.prototype.hasOwnProperty.call(C,z)&&C[z]!==null){const B=C[z];if(Array.isArray(B))for(let V=0;V<B.length;V++)T(M,z,B[V]);else T(M,z,B)}}function J(M){return M?M instanceof s?M.length:s.byteLength(M):0}function et(M){return typeof M=="string"||M instanceof s}l.exports=k},{"./constants":73,"./numbers":93,buffer:29,debug:30,"process-nextick-args":101}],97:[function(t,l,h){var r=1e3,s=60*r,g=60*s,d=24*g,i=7*d,f=365.25*d;function c(n,o,u,b){var y=o>=1.5*u;return Math.round(n/u)+" "+b+(y?"s":"")}l.exports=function(n,o){o=o||{};var u=typeof n;if(u==="string"&&n.length>0)return function(b){if(!((b=String(b)).length>100)){var y=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(b);if(y){var w=parseFloat(y[1]);switch((y[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return w*f;case"weeks":case"week":case"w":return w*i;case"days":case"day":case"d":return w*d;case"hours":case"hour":case"hrs":case"hr":case"h":return w*g;case"minutes":case"minute":case"mins":case"min":case"m":return w*s;case"seconds":case"second":case"secs":case"sec":case"s":return w*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return w;default:return}}}}(n);if(u==="number"&&isFinite(n))return o.long?function(b){var y=Math.abs(b);return y>=d?c(b,y,d,"day"):y>=g?c(b,y,g,"hour"):y>=s?c(b,y,s,"minute"):y>=r?c(b,y,r,"second"):b+" ms"}(n):function(b){var y=Math.abs(b);return y>=d?Math.round(b/d)+"d":y>=g?Math.round(b/g)+"h":y>=s?Math.round(b/s)+"m":y>=r?Math.round(b/r)+"s":b+"ms"}(n);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(n))}},{}],98:[function(t,l,h){const r=t("./lib/number-allocator.js");l.exports.NumberAllocator=r},{"./lib/number-allocator.js":99}],99:[function(t,l,h){const r=t("js-sdsl").OrderedSet,s=t("debug")("number-allocator:trace"),g=t("debug")("number-allocator:error");function d(f,c){this.low=f,this.high=c}function i(f,c){if(!(this instanceof i))return new i(f,c);this.min=f,this.max=c,this.ss=new r([],(n,o)=>n.compare(o)),s("Create"),this.clear()}d.prototype.equals=function(f){return this.low===f.low&&this.high===f.high},d.prototype.compare=function(f){return this.low<f.low&&this.high<f.low?-1:f.low<this.low&&f.high<this.low?1:0},i.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},i.prototype.alloc=function(){if(this.ss.size()===0)return s("alloc():empty"),null;const f=this.ss.begin(),c=f.pointer.low,n=f.pointer.high,o=c;return o+1<=n?this.ss.updateKeyByIterator(f,new d(c+1,n)):this.ss.eraseElementByPos(0),s("alloc():"+o),o},i.prototype.use=function(f){const c=new d(f,f),n=this.ss.lowerBound(c);if(!n.equals(this.ss.end())){const o=n.pointer.low,u=n.pointer.high;return n.pointer.equals(c)?(this.ss.eraseElementByIterator(n),s("use():"+f),!0):!(o>f)&&(o===f?(this.ss.updateKeyByIterator(n,new d(o+1,u)),s("use():"+f),!0):u===f?(this.ss.updateKeyByIterator(n,new d(o,u-1)),s("use():"+f),!0):(this.ss.updateKeyByIterator(n,new d(f+1,u)),this.ss.insert(new d(o,f-1)),s("use():"+f),!0))}return s("use():failed"),!1},i.prototype.free=function(f){if(f<this.min||f>this.max)return void g("free():"+f+" is out of range");const c=new d(f,f),n=this.ss.upperBound(c);if(n.equals(this.ss.end())){if(n.equals(this.ss.begin()))return void this.ss.insert(c);n.pre();const o=n.pointer.high;n.pointer.high+1===f?this.ss.updateKeyByIterator(n,new d(o,f)):this.ss.insert(c)}else if(n.equals(this.ss.begin()))if(f+1===n.pointer.low){const o=n.pointer.high;this.ss.updateKeyByIterator(n,new d(f,o))}else this.ss.insert(c);else{const o=n.pointer.low,u=n.pointer.high;n.pre();const b=n.pointer.low;n.pointer.high+1===f?f+1===o?(this.ss.eraseElementByIterator(n),this.ss.updateKeyByIterator(n,new d(b,u))):this.ss.updateKeyByIterator(n,new d(b,f)):f+1===o?(this.ss.eraseElementByIterator(n.next()),this.ss.insert(new d(f,u))):this.ss.insert(c)}s("free():"+f)},i.prototype.clear=function(){s("clear()"),this.ss.clear(),this.ss.insert(new d(this.min,this.max))},i.prototype.intervalCount=function(){return this.ss.size()},i.prototype.dump=function(){console.log("length:"+this.ss.size());for(const f of this.ss)console.log(f)},l.exports=i},{debug:30,"js-sdsl":69}],100:[function(t,l,h){var r=t("wrappy");function s(d){var i=function(){return i.called?i.value:(i.called=!0,i.value=d.apply(this,arguments))};return i.called=!1,i}function g(d){var i=function(){if(i.called)throw new Error(i.onceError);return i.called=!0,i.value=d.apply(this,arguments)},f=d.name||"Function wrapped with `once`";return i.onceError=f+" shouldn't be called more than once",i.called=!1,i}l.exports=r(s),l.exports.strict=r(g),s.proto=s(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return s(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return g(this)},configurable:!0})})},{wrappy:140}],101:[function(t,l,h){(function(r){(function(){r===void 0||!r.version||r.version.indexOf("v0.")===0||r.version.indexOf("v1.")===0&&r.version.indexOf("v1.8.")!==0?l.exports={nextTick:function(s,g,d,i){if(typeof s!="function")throw new TypeError('"callback" argument must be a function');var f,c,n=arguments.length;switch(n){case 0:case 1:return r.nextTick(s);case 2:return r.nextTick(function(){s.call(null,g)});case 3:return r.nextTick(function(){s.call(null,g,d)});case 4:return r.nextTick(function(){s.call(null,g,d,i)});default:for(f=new Array(n-1),c=0;c<f.length;)f[c++]=arguments[c];return r.nextTick(function(){s.apply(null,f)})}}}:l.exports=r}).call(this)}).call(this,t("_process"))},{_process:102}],102:[function(t,l,h){var r,s,g=l.exports={};function d(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function f(k){if(r===setTimeout)return setTimeout(k,0);if((r===d||!r)&&setTimeout)return r=setTimeout,setTimeout(k,0);try{return r(k,0)}catch{try{return r.call(null,k,0)}catch{return r.call(this,k,0)}}}(function(){try{r=typeof setTimeout=="function"?setTimeout:d}catch{r=d}try{s=typeof clearTimeout=="function"?clearTimeout:i}catch{s=i}})();var c,n=[],o=!1,u=-1;function b(){o&&c&&(o=!1,c.length?n=c.concat(n):u=-1,n.length&&y())}function y(){if(!o){var k=f(b);o=!0;for(var j=n.length;j;){for(c=n,n=[];++u<j;)c&&c[u].run();u=-1,j=n.length}c=null,o=!1,function(L){if(s===clearTimeout)return clearTimeout(L);if((s===i||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(L);try{return s(L)}catch{try{return s.call(null,L)}catch{return s.call(this,L)}}}(k)}}function w(k,j){this.fun=k,this.array=j}function S(){}g.nextTick=function(k){var j=new Array(arguments.length-1);if(arguments.length>1)for(var L=1;L<arguments.length;L++)j[L-1]=arguments[L];n.push(new w(k,j)),n.length!==1||o||f(y)},w.prototype.run=function(){this.fun.apply(null,this.array)},g.title="browser",g.browser=!0,g.env={},g.argv=[],g.version="",g.versions={},g.on=S,g.addListener=S,g.once=S,g.off=S,g.removeListener=S,g.removeAllListeners=S,g.emit=S,g.prependListener=S,g.prependOnceListener=S,g.listeners=function(k){return[]},g.binding=function(k){throw new Error("process.binding is not supported")},g.cwd=function(){return"/"},g.chdir=function(k){throw new Error("process.chdir is not supported")},g.umask=function(){return 0}},{}],103:[function(t,l,h){(function(r){(function(){(function(s){var g=typeof h=="object"&&h&&!h.nodeType&&h,d=typeof l=="object"&&l&&!l.nodeType&&l,i=typeof r=="object"&&r;i.global!==i&&i.window!==i&&i.self!==i||(s=i);var f,c,n=2147483647,o=36,u=1,b=26,y=38,w=700,S=72,k=128,j="-",L=/^xn--/,I=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=o-u,G=Math.floor,W=String.fromCharCode;function _(z){throw new RangeError(E[z])}function R(z,B){for(var V=z.length,$=[];V--;)$[V]=B(z[V]);return $}function T(z,B){var V=z.split("@"),$="";return V.length>1&&($=V[0]+"@",z=V[1]),$+R((z=z.replace(A,".")).split("."),B).join(".")}function Y(z){for(var B,V,$=[],H=0,Z=z.length;H<Z;)(B=z.charCodeAt(H++))>=55296&&B<=56319&&H<Z?(64512&(V=z.charCodeAt(H++)))==56320?$.push(((1023&B)<<10)+(1023&V)+65536):($.push(B),H--):$.push(B);return $}function J(z){return R(z,function(B){var V="";return B>65535&&(V+=W((B-=65536)>>>10&1023|55296),B=56320|1023&B),V+=W(B)}).join("")}function et(z,B){return z+22+75*(z<26)-((B!=0)<<5)}function M(z,B,V){var $=0;for(z=V?G(z/w):z>>1,z+=G(z/B);z>N*b>>1;$+=o)z=G(z/N);return G($+(N+1)*z/(z+y))}function C(z){var B,V,$,H,Z,X,tt,O,p,m,v,P=[],F=z.length,K=0,D=k,Q=S;for((V=z.lastIndexOf(j))<0&&(V=0),$=0;$<V;++$)z.charCodeAt($)>=128&&_("not-basic"),P.push(z.charCodeAt($));for(H=V>0?V+1:0;H<F;){for(Z=K,X=1,tt=o;H>=F&&_("invalid-input"),((O=(v=z.charCodeAt(H++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:o)>=o||O>G((n-K)/X))&&_("overflow"),K+=O*X,!(O<(p=tt<=Q?u:tt>=Q+b?b:tt-Q));tt+=o)X>G(n/(m=o-p))&&_("overflow"),X*=m;Q=M(K-Z,B=P.length+1,Z==0),G(K/B)>n-D&&_("overflow"),D+=G(K/B),K%=B,P.splice(K++,0,D)}return J(P)}function x(z){var B,V,$,H,Z,X,tt,O,p,m,v,P,F,K,D,Q=[];for(P=(z=Y(z)).length,B=k,V=0,Z=S,X=0;X<P;++X)(v=z[X])<128&&Q.push(W(v));for($=H=Q.length,H&&Q.push(j);$<P;){for(tt=n,X=0;X<P;++X)(v=z[X])>=B&&v<tt&&(tt=v);for(tt-B>G((n-V)/(F=$+1))&&_("overflow"),V+=(tt-B)*F,B=tt,X=0;X<P;++X)if((v=z[X])<B&&++V>n&&_("overflow"),v==B){for(O=V,p=o;!(O<(m=p<=Z?u:p>=Z+b?b:p-Z));p+=o)D=O-m,K=o-m,Q.push(W(et(m+D%K,0))),O=G(D/K);Q.push(W(et(O,0))),Z=M(V,F,$==H),V=0,++$}++V,++B}return Q.join("")}if(f={version:"1.4.1",ucs2:{decode:Y,encode:J},decode:C,encode:x,toASCII:function(z){return T(z,function(B){return I.test(B)?"xn--"+x(B):B})},toUnicode:function(z){return T(z,function(B){return L.test(B)?C(B.slice(4).toLowerCase()):B})}},g&&d)if(l.exports==g)d.exports=f;else for(c in f)f.hasOwnProperty(c)&&(g[c]=f[c]);else s.punycode=f})(this)}).call(this)}).call(this,typeof xt<"u"?xt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],104:[function(t,l,h){function r(g,d){return Object.prototype.hasOwnProperty.call(g,d)}l.exports=function(g,d,i,f){d=d||"&",i=i||"=";var c={};if(typeof g!="string"||g.length===0)return c;var n=/\+/g;g=g.split(d);var o=1e3;f&&typeof f.maxKeys=="number"&&(o=f.maxKeys);var u=g.length;o>0&&u>o&&(u=o);for(var b=0;b<u;++b){var y,w,S,k,j=g[b].replace(n,"%20"),L=j.indexOf(i);L>=0?(y=j.substr(0,L),w=j.substr(L+1)):(y=j,w=""),S=decodeURIComponent(y),k=decodeURIComponent(w),r(c,S)?s(c[S])?c[S].push(k):c[S]=[c[S],k]:c[S]=k}return c};var s=Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"}},{}],105:[function(t,l,h){var r=function(i){switch(typeof i){case"string":return i;case"boolean":return i?"true":"false";case"number":return isFinite(i)?i:"";default:return""}};l.exports=function(i,f,c,n){return f=f||"&",c=c||"=",i===null&&(i=void 0),typeof i=="object"?g(d(i),function(o){var u=encodeURIComponent(r(o))+c;return s(i[o])?g(i[o],function(b){return u+encodeURIComponent(r(b))}).join(f):u+encodeURIComponent(r(i[o]))}).join(f):n?encodeURIComponent(r(n))+c+encodeURIComponent(r(i)):""};var s=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function g(i,f){if(i.map)return i.map(f);for(var c=[],n=0;n<i.length;n++)c.push(f(i[n],n));return c}var d=Object.keys||function(i){var f=[];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&f.push(c);return f}},{}],106:[function(t,l,h){h.decode=h.parse=t("./decode"),h.encode=h.stringify=t("./encode")},{"./decode":104,"./encode":105}],107:[function(t,l,h){const{AbortError:r,codes:s}=t("../../ours/errors"),{isNodeStream:g,isWebStream:d,kControllerErrorFunction:i}=t("./utils"),f=t("./end-of-stream"),{ERR_INVALID_ARG_TYPE:c}=s;l.exports.addAbortSignal=function(n,o){if(((u,b)=>{if(typeof u!="object"||!("aborted"in u))throw new c(b,"AbortSignal",u)})(n,"signal"),!g(o)&&!d(o))throw new c("stream",["ReadableStream","WritableStream","Stream"],o);return l.exports.addAbortSignalNoValidate(n,o)},l.exports.addAbortSignalNoValidate=function(n,o){if(typeof n!="object"||!("aborted"in n))return o;const u=g(o)?()=>{o.destroy(new r(void 0,{cause:n.reason}))}:()=>{o[i](new r(void 0,{cause:n.reason}))};return n.aborted?u():(n.addEventListener("abort",u),f(o,()=>n.removeEventListener("abort",u))),o}},{"../../ours/errors":126,"./end-of-stream":113,"./utils":122}],108:[function(t,l,h){const{StringPrototypeSlice:r,SymbolIterator:s,TypedArrayPrototypeSet:g,Uint8Array:d}=t("../../ours/primordials"),{Buffer:i}=t("buffer"),{inspect:f}=t("../../ours/util");l.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(c){const n={data:c,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(c){const n={data:c,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const c=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,c}clear(){this.head=this.tail=null,this.length=0}join(c){if(this.length===0)return"";let n=this.head,o=""+n.data;for(;(n=n.next)!==null;)o+=c+n.data;return o}concat(c){if(this.length===0)return i.alloc(0);const n=i.allocUnsafe(c>>>0);let o=this.head,u=0;for(;o;)g(n,o.data,u),u+=o.data.length,o=o.next;return n}consume(c,n){const o=this.head.data;if(c<o.length){const u=o.slice(0,c);return this.head.data=o.slice(c),u}return c===o.length?this.shift():n?this._getString(c):this._getBuffer(c)}first(){return this.head.data}*[s](){for(let c=this.head;c;c=c.next)yield c.data}_getString(c){let n="",o=this.head,u=0;do{const b=o.data;if(!(c>b.length)){c===b.length?(n+=b,++u,o.next?this.head=o.next:this.head=this.tail=null):(n+=r(b,0,c),this.head=o,o.data=r(b,c));break}n+=b,c-=b.length,++u}while((o=o.next)!==null);return this.length-=u,n}_getBuffer(c){const n=i.allocUnsafe(c),o=c;let u=this.head,b=0;do{const y=u.data;if(!(c>y.length)){c===y.length?(g(n,y,o-c),++b,u.next?this.head=u.next:this.head=this.tail=null):(g(n,new d(y.buffer,y.byteOffset,c),o-c),this.head=u,u.data=y.slice(c));break}g(n,y,o-c),c-=y.length,++b}while((u=u.next)!==null);return this.length-=b,n}[Symbol.for("nodejs.util.inspect.custom")](c,n){return f(this,{...n,depth:0,customInspect:!1})}}},{"../../ours/primordials":127,"../../ours/util":128,buffer:29}],109:[function(t,l,h){const{pipeline:r}=t("./pipeline"),s=t("./duplex"),{destroyer:g}=t("./destroy"),{isNodeStream:d,isReadable:i,isWritable:f,isWebStream:c,isTransformStream:n,isWritableStream:o,isReadableStream:u}=t("./utils"),{AbortError:b,codes:{ERR_INVALID_ARG_VALUE:y,ERR_MISSING_ARGS:w}}=t("../../ours/errors"),S=t("./end-of-stream");l.exports=function(...k){if(k.length===0)throw new w("streams");if(k.length===1)return s.from(k[0]);const j=[...k];if(typeof k[0]=="function"&&(k[0]=s.from(k[0])),typeof k[k.length-1]=="function"){const T=k.length-1;k[T]=s.from(k[T])}for(let T=0;T<k.length;++T)if(d(k[T])||c(k[T])){if(T<k.length-1&&!(i(k[T])||u(k[T])||n(k[T])))throw new y(`streams[${T}]`,j[T],"must be readable");if(T>0&&!(f(k[T])||o(k[T])||n(k[T])))throw new y(`streams[${T}]`,j[T],"must be writable")}let L,I,A,E,N;const G=k[0],W=r(k,function(T){const Y=E;E=null,Y?Y(T):T?N.destroy(T):R||_||N.destroy()}),_=!!(f(G)||o(G)||n(G)),R=!!(i(W)||u(W)||n(W));if(N=new s({writableObjectMode:!(G==null||!G.writableObjectMode),readableObjectMode:!(W==null||!W.writableObjectMode),writable:_,readable:R}),_){if(d(G))N._write=function(Y,J,et){G.write(Y,J)?et():L=et},N._final=function(Y){G.end(),I=Y},G.on("drain",function(){if(L){const Y=L;L=null,Y()}});else if(c(G)){const Y=(n(G)?G.writable:G).getWriter();N._write=async function(J,et,M){try{await Y.ready,Y.write(J).catch(()=>{}),M()}catch(C){M(C)}},N._final=async function(J){try{await Y.ready,Y.close().catch(()=>{}),I=J}catch(et){J(et)}}}const T=n(W)?W.readable:W;S(T,()=>{if(I){const Y=I;I=null,Y()}})}if(R){if(d(W))W.on("readable",function(){if(A){const T=A;A=null,T()}}),W.on("end",function(){N.push(null)}),N._read=function(){for(;;){const T=W.read();if(T===null)return void(A=N._read);if(!N.push(T))return}};else if(c(W)){const T=(n(W)?W.readable:W).getReader();N._read=async function(){for(;;)try{const{value:Y,done:J}=await T.read();if(!N.push(Y))return;if(J)return void N.push(null)}catch{return}}}}return N._destroy=function(T,Y){T||E===null||(T=new b),A=null,L=null,I=null,E===null?Y(T):(E=Y,d(W)&&g(W,T))},N}},{"../../ours/errors":126,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./pipeline":118,"./utils":122}],110:[function(t,l,h){const r=t("process/"),{aggregateTwoErrors:s,codes:{ERR_MULTIPLE_CALLBACK:g},AbortError:d}=t("../../ours/errors"),{Symbol:i}=t("../../ours/primordials"),{kDestroyed:f,isDestroyed:c,isFinished:n,isServerRequest:o}=t("./utils"),u=i("kDestroy"),b=i("kConstruct");function y(W,_,R){W&&(W.stack,_&&!_.errored&&(_.errored=W),R&&!R.errored&&(R.errored=W))}function w(W,_,R){let T=!1;function Y(J){if(T)return;T=!0;const et=W._readableState,M=W._writableState;y(J,M,et),M&&(M.closed=!0),et&&(et.closed=!0),typeof R=="function"&&R(J),J?r.nextTick(S,W,J):r.nextTick(k,W)}try{W._destroy(_||null,Y)}catch(J){Y(J)}}function S(W,_){j(W,_),k(W)}function k(W){const _=W._readableState,R=W._writableState;R&&(R.closeEmitted=!0),_&&(_.closeEmitted=!0),(R!=null&&R.emitClose||_!=null&&_.emitClose)&&W.emit("close")}function j(W,_){const R=W._readableState,T=W._writableState;T!=null&&T.errorEmitted||R!=null&&R.errorEmitted||(T&&(T.errorEmitted=!0),R&&(R.errorEmitted=!0),W.emit("error",_))}function L(W,_,R){const T=W._readableState,Y=W._writableState;if(Y!=null&&Y.destroyed||T!=null&&T.destroyed)return this;T!=null&&T.autoDestroy||Y!=null&&Y.autoDestroy?W.destroy(_):_&&(_.stack,Y&&!Y.errored&&(Y.errored=_),T&&!T.errored&&(T.errored=_),R?r.nextTick(j,W,_):j(W,_))}function I(W){let _=!1;function R(T){if(_)return void L(W,T??new g);_=!0;const Y=W._readableState,J=W._writableState,et=J||Y;Y&&(Y.constructed=!0),J&&(J.constructed=!0),et.destroyed?W.emit(u,T):T?L(W,T,!0):r.nextTick(A,W)}try{W._construct(T=>{r.nextTick(R,T)})}catch(T){r.nextTick(R,T)}}function A(W){W.emit(b)}function E(W){return(W==null?void 0:W.setHeader)&&typeof W.abort=="function"}function N(W){W.emit("close")}function G(W,_){W.emit("error",_),r.nextTick(N,W)}l.exports={construct:function(W,_){if(typeof W._construct!="function")return;const R=W._readableState,T=W._writableState;R&&(R.constructed=!1),T&&(T.constructed=!1),W.once(b,_),W.listenerCount(b)>1||r.nextTick(I,W)},destroyer:function(W,_){W&&!c(W)&&(_||n(W)||(_=new d),o(W)?(W.socket=null,W.destroy(_)):E(W)?W.abort():E(W.req)?W.req.abort():typeof W.destroy=="function"?W.destroy(_):typeof W.close=="function"?W.close():_?r.nextTick(G,W,_):r.nextTick(N,W),W.destroyed||(W[f]=!0))},destroy:function(W,_){const R=this._readableState,T=this._writableState,Y=T||R;return T!=null&&T.destroyed||R!=null&&R.destroyed?(typeof _=="function"&&_(),this):(y(W,T,R),T&&(T.destroyed=!0),R&&(R.destroyed=!0),Y.constructed?w(this,W,_):this.once(u,function(J){w(this,s(J,W),_)}),this)},undestroy:function(){const W=this._readableState,_=this._writableState;W&&(W.constructed=!0,W.closed=!1,W.closeEmitted=!1,W.destroyed=!1,W.errored=null,W.errorEmitted=!1,W.reading=!1,W.ended=W.readable===!1,W.endEmitted=W.readable===!1),_&&(_.constructed=!0,_.destroyed=!1,_.closed=!1,_.closeEmitted=!1,_.errored=null,_.errorEmitted=!1,_.finalCalled=!1,_.prefinished=!1,_.ended=_.writable===!1,_.ending=_.writable===!1,_.finished=_.writable===!1)},errorOrDestroy:L}},{"../../ours/errors":126,"../../ours/primordials":127,"./utils":122,"process/":102}],111:[function(t,l,h){const{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:s,ObjectKeys:g,ObjectSetPrototypeOf:d}=t("../../ours/primordials");l.exports=c;const i=t("./readable"),f=t("./writable");d(c.prototype,i.prototype),d(c,i);{const b=g(f.prototype);for(let y=0;y<b.length;y++){const w=b[y];c.prototype[w]||(c.prototype[w]=f.prototype[w])}}function c(b){if(!(this instanceof c))return new c(b);i.call(this,b),f.call(this,b),b?(this.allowHalfOpen=b.allowHalfOpen!==!1,b.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),b.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let n,o;function u(){return n===void 0&&(n={}),n}r(c.prototype,{writable:{__proto__:null,...s(f.prototype,"writable")},writableHighWaterMark:{__proto__:null,...s(f.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...s(f.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...s(f.prototype,"writableBuffer")},writableLength:{__proto__:null,...s(f.prototype,"writableLength")},writableFinished:{__proto__:null,...s(f.prototype,"writableFinished")},writableCorked:{__proto__:null,...s(f.prototype,"writableCorked")},writableEnded:{__proto__:null,...s(f.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...s(f.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set(b){this._readableState&&this._writableState&&(this._readableState.destroyed=b,this._writableState.destroyed=b)}}}),c.fromWeb=function(b,y){return u().newStreamDuplexFromReadableWritablePair(b,y)},c.toWeb=function(b){return u().newReadableWritablePairFromDuplex(b)},c.from=function(b){return o||(o=t("./duplexify")),o(b,"body")}},{"../../ours/primordials":127,"./duplexify":112,"./readable":119,"./writable":123}],112:[function(t,l,h){const r=t("process/"),s=t("buffer"),{isReadable:g,isWritable:d,isIterable:i,isNodeStream:f,isReadableNodeStream:c,isWritableNodeStream:n,isDuplexNodeStream:o}=t("./utils"),u=t("./end-of-stream"),{AbortError:b,codes:{ERR_INVALID_ARG_TYPE:y,ERR_INVALID_RETURN_VALUE:w}}=t("../../ours/errors"),{destroyer:S}=t("./destroy"),k=t("./duplex"),j=t("./readable"),{createDeferredPromise:L}=t("../../ours/util"),I=t("./from"),A=globalThis.Blob||s.Blob,E=A!==void 0?function(R){return R instanceof A}:function(R){return!1},N=globalThis.AbortController||t("abort-controller").AbortController,{FunctionPrototypeCall:G}=t("../../ours/primordials");class W extends k{constructor(T){super(T),(T==null?void 0:T.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(T==null?void 0:T.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function _(R){const T=R.readable&&typeof R.readable.read!="function"?j.wrap(R.readable):R.readable,Y=R.writable;let J,et,M,C,x,z=!!g(T),B=!!d(Y);function V($){const H=C;C=null,H?H($):$&&x.destroy($)}return x=new W({readableObjectMode:!(T==null||!T.readableObjectMode),writableObjectMode:!(Y==null||!Y.writableObjectMode),readable:z,writable:B}),B&&(u(Y,$=>{B=!1,$&&S(T,$),V($)}),x._write=function($,H,Z){Y.write($,H)?Z():J=Z},x._final=function($){Y.end(),et=$},Y.on("drain",function(){if(J){const $=J;J=null,$()}}),Y.on("finish",function(){if(et){const $=et;et=null,$()}})),z&&(u(T,$=>{z=!1,$&&S(T,$),V($)}),T.on("readable",function(){if(M){const $=M;M=null,$()}}),T.on("end",function(){x.push(null)}),x._read=function(){for(;;){const $=T.read();if($===null)return void(M=x._read);if(!x.push($))return}}),x._destroy=function($,H){$||C===null||($=new b),M=null,J=null,et=null,C===null?H($):(C=H,S(Y,$),S(T,$))},x}l.exports=function R(T,Y){if(o(T))return T;if(c(T))return _({readable:T});if(n(T))return _({writable:T});if(f(T))return _({writable:!1,readable:!1});if(typeof T=="function"){const{value:et,write:M,final:C,destroy:x}=function(B){let{promise:V,resolve:$}=L();const H=new N,Z=H.signal;return{value:B(async function*(){for(;;){const tt=V;V=null;const{chunk:O,done:p,cb:m}=await tt;if(r.nextTick(m),p)return;if(Z.aborted)throw new b(void 0,{cause:Z.reason});({promise:V,resolve:$}=L()),yield O}}(),{signal:Z}),write(tt,O,p){const m=$;$=null,m({chunk:tt,done:!1,cb:p})},final(tt){const O=$;$=null,O({done:!0,cb:tt})},destroy(tt,O){H.abort(),O(tt)}}}(T);if(i(et))return I(W,et,{objectMode:!0,write:M,final:C,destroy:x});const z=et==null?void 0:et.then;if(typeof z=="function"){let B;const V=G(z,et,$=>{if($!=null)throw new w("nully","body",$)},$=>{S(B,$)});return B=new W({objectMode:!0,readable:!1,write:M,final($){C(async()=>{try{await V,r.nextTick($,null)}catch(H){r.nextTick($,H)}})},destroy:x})}throw new w("Iterable, AsyncIterable or AsyncFunction",Y,et)}if(E(T))return R(T.arrayBuffer());if(i(T))return I(W,T,{objectMode:!0,writable:!1});if(typeof(T==null?void 0:T.writable)=="object"||typeof(T==null?void 0:T.readable)=="object")return _({readable:T!=null&&T.readable?c(T==null?void 0:T.readable)?T==null?void 0:T.readable:R(T.readable):void 0,writable:T!=null&&T.writable?n(T==null?void 0:T.writable)?T==null?void 0:T.writable:R(T.writable):void 0});const J=T==null?void 0:T.then;if(typeof J=="function"){let et;return G(J,T,M=>{M!=null&&et.push(M),et.push(null)},M=>{S(et,M)}),et=new W({objectMode:!0,writable:!1,read(){}})}throw new y(Y,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],T)}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./from":114,"./readable":119,"./utils":122,"abort-controller":24,buffer:29,"process/":102}],113:[function(t,l,h){const r=t("process/"),{AbortError:s,codes:g}=t("../../ours/errors"),{ERR_INVALID_ARG_TYPE:d,ERR_STREAM_PREMATURE_CLOSE:i}=g,{kEmptyObject:f,once:c}=t("../../ours/util"),{validateAbortSignal:n,validateFunction:o,validateObject:u,validateBoolean:b}=t("../validators"),{Promise:y,PromisePrototypeThen:w}=t("../../ours/primordials"),{isClosed:S,isReadable:k,isReadableNodeStream:j,isReadableStream:L,isReadableFinished:I,isReadableErrored:A,isWritable:E,isWritableNodeStream:N,isWritableStream:G,isWritableFinished:W,isWritableErrored:_,isNodeStream:R,willEmitClose:T,kIsClosedPromise:Y}=t("./utils"),J=()=>{};function et(M,C,x){var z,B;if(arguments.length===2?(x=C,C=f):C==null?C=f:u(C,"options"),o(x,"callback"),n(C.signal,"options.signal"),x=c(x),L(M)||G(M))return function(nt,st,dt){let ct=!1,ut=J;if(st.signal)if(ut=()=>{ct=!0,dt.call(nt,new s(void 0,{cause:st.signal.reason}))},st.signal.aborted)r.nextTick(ut);else{const q=dt;dt=c((...lt)=>{st.signal.removeEventListener("abort",ut),q.apply(nt,lt)}),st.signal.addEventListener("abort",ut)}const U=(...q)=>{ct||r.nextTick(()=>dt.apply(nt,q))};return w(nt[Y].promise,U,U),J}(M,C,x);if(!R(M))throw new d("stream",["ReadableStream","WritableStream","Stream"],M);const V=(z=C.readable)!==null&&z!==void 0?z:j(M),$=(B=C.writable)!==null&&B!==void 0?B:N(M),H=M._writableState,Z=M._readableState,X=()=>{M.writable||p()};let tt=T(M)&&j(M)===V&&N(M)===$,O=W(M,!1);const p=()=>{O=!0,M.destroyed&&(tt=!1),(!tt||M.readable&&!V)&&(V&&!m||x.call(M))};let m=I(M,!1);const v=()=>{m=!0,M.destroyed&&(tt=!1),(!tt||M.writable&&!$)&&($&&!O||x.call(M))},P=nt=>{x.call(M,nt)};let F=S(M);const K=()=>{F=!0;const nt=_(M)||A(M);return nt&&typeof nt!="boolean"?x.call(M,nt):V&&!m&&j(M,!0)&&!I(M,!1)?x.call(M,new i):!$||O||W(M,!1)?void x.call(M):x.call(M,new i)},D=()=>{F=!0;const nt=_(M)||A(M);if(nt&&typeof nt!="boolean")return x.call(M,nt);x.call(M)},Q=()=>{M.req.on("finish",p)};(function(nt){return nt.setHeader&&typeof nt.abort=="function"})(M)?(M.on("complete",p),tt||M.on("abort",K),M.req?Q():M.on("request",Q)):$&&!H&&(M.on("end",X),M.on("close",X)),tt||typeof M.aborted!="boolean"||M.on("aborted",K),M.on("end",v),M.on("finish",p),C.error!==!1&&M.on("error",P),M.on("close",K),F?r.nextTick(K):H!=null&&H.errorEmitted||Z!=null&&Z.errorEmitted?tt||r.nextTick(D):(V||tt&&!k(M)||!O&&E(M)!==!1)&&($||tt&&!E(M)||!m&&k(M)!==!1)?Z&&M.req&&M.aborted&&r.nextTick(D):r.nextTick(D);const rt=()=>{x=J,M.removeListener("aborted",K),M.removeListener("complete",p),M.removeListener("abort",K),M.removeListener("request",Q),M.req&&M.req.removeListener("finish",p),M.removeListener("end",X),M.removeListener("close",X),M.removeListener("finish",p),M.removeListener("end",v),M.removeListener("error",P),M.removeListener("close",K)};if(C.signal&&!F){const nt=()=>{const st=x;rt(),st.call(M,new s(void 0,{cause:C.signal.reason}))};if(C.signal.aborted)r.nextTick(nt);else{const st=x;x=c((...dt)=>{C.signal.removeEventListener("abort",nt),st.apply(M,dt)}),C.signal.addEventListener("abort",nt)}}return rt}l.exports=et,l.exports.finished=function(M,C){var x;let z=!1;return C===null&&(C=f),(x=C)!==null&&x!==void 0&&x.cleanup&&(b(C.cleanup,"cleanup"),z=C.cleanup),new y((B,V)=>{const $=et(M,C,H=>{z&&$(),H?V(H):B()})})}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./utils":122,"process/":102}],114:[function(t,l,h){const r=t("process/"),{PromisePrototypeThen:s,SymbolAsyncIterator:g,SymbolIterator:d}=t("../../ours/primordials"),{Buffer:i}=t("buffer"),{ERR_INVALID_ARG_TYPE:f,ERR_STREAM_NULL_VALUES:c}=t("../../ours/errors").codes;l.exports=function(n,o,u){let b,y;if(typeof o=="string"||o instanceof i)return new n({objectMode:!0,...u,read(){this.push(o),this.push(null)}});if(o&&o[g])y=!0,b=o[g]();else{if(!o||!o[d])throw new f("iterable",["Iterable"],o);y=!1,b=o[d]()}const w=new n({objectMode:!0,highWaterMark:1,...u});let S=!1;return w._read=function(){S||(S=!0,async function(){for(;;){try{const{value:k,done:j}=y?await b.next():b.next();if(j)w.push(null);else{const L=k&&typeof k.then=="function"?await k:k;if(L===null)throw S=!1,new c;if(w.push(L))continue;S=!1}}catch(k){w.destroy(k)}break}}())},w._destroy=function(k,j){s(async function(L){const I=L!=null,A=typeof b.throw=="function";if(I&&A){const{value:E,done:N}=await b.throw(L);if(await E,N)return}if(typeof b.return=="function"){const{value:E}=await b.return();await E}}(k),()=>r.nextTick(j,k),L=>r.nextTick(j,L||k))},w}},{"../../ours/errors":126,"../../ours/primordials":127,buffer:29,"process/":102}],115:[function(t,l,h){const{ArrayIsArray:r,ObjectSetPrototypeOf:s}=t("../../ours/primordials"),{EventEmitter:g}=t("events");function d(f){g.call(this,f)}function i(f,c,n){if(typeof f.prependListener=="function")return f.prependListener(c,n);f._events&&f._events[c]?r(f._events[c])?f._events[c].unshift(n):f._events[c]=[n,f._events[c]]:f.on(c,n)}s(d.prototype,g.prototype),s(d,g),d.prototype.pipe=function(f,c){const n=this;function o(j){f.writable&&f.write(j)===!1&&n.pause&&n.pause()}function u(){n.readable&&n.resume&&n.resume()}n.on("data",o),f.on("drain",u),f._isStdio||c&&c.end===!1||(n.on("end",y),n.on("close",w));let b=!1;function y(){b||(b=!0,f.end())}function w(){b||(b=!0,typeof f.destroy=="function"&&f.destroy())}function S(j){k(),g.listenerCount(this,"error")===0&&this.emit("error",j)}function k(){n.removeListener("data",o),f.removeListener("drain",u),n.removeListener("end",y),n.removeListener("close",w),n.removeListener("error",S),f.removeListener("error",S),n.removeListener("end",k),n.removeListener("close",k),f.removeListener("close",k)}return i(n,"error",S),i(f,"error",S),n.on("end",k),n.on("close",k),f.on("close",k),f.emit("pipe",n),f},l.exports={Stream:d,prependListener:i}},{"../../ours/primordials":127,events:49}],116:[function(t,l,h){const r=globalThis.AbortController||t("abort-controller").AbortController,{codes:{ERR_INVALID_ARG_VALUE:s,ERR_INVALID_ARG_TYPE:g,ERR_MISSING_ARGS:d,ERR_OUT_OF_RANGE:i},AbortError:f}=t("../../ours/errors"),{validateAbortSignal:c,validateInteger:n,validateObject:o}=t("../validators"),u=t("../../ours/primordials").Symbol("kWeak"),{finished:b}=t("./end-of-stream"),y=t("./compose"),{addAbortSignalNoValidate:w}=t("./add-abort-signal"),{isWritable:S,isNodeStream:k}=t("./utils"),{ArrayPrototypePush:j,MathFloor:L,Number:I,NumberIsNaN:A,Promise:E,PromiseReject:N,PromisePrototypeThen:G,Symbol:W}=t("../../ours/primordials"),_=W("kEmpty"),R=W("kEof");function T(C,x){if(typeof C!="function")throw new g("fn",["Function","AsyncFunction"],C);x!=null&&o(x,"options"),(x==null?void 0:x.signal)!=null&&c(x.signal,"options.signal");let z=1;return(x==null?void 0:x.concurrency)!=null&&(z=L(x.concurrency)),n(z,"concurrency",1),(async function*(){var B,V;const $=new r,H=this,Z=[],X=$.signal,tt={signal:X},O=()=>$.abort();let p,m;x!=null&&(B=x.signal)!==null&&B!==void 0&&B.aborted&&O(),x==null||(V=x.signal)===null||V===void 0||V.addEventListener("abort",O);let v=!1;function P(){v=!0}(async function(){try{for await(let D of H){var F;if(v)return;if(X.aborted)throw new f;try{D=C(D,tt)}catch(Q){D=N(Q)}D!==_&&(typeof((F=D)===null||F===void 0?void 0:F.catch)=="function"&&D.catch(P),Z.push(D),p&&(p(),p=null),!v&&Z.length&&Z.length>=z&&await new E(Q=>{m=Q}))}Z.push(R)}catch(D){const Q=N(D);G(Q,void 0,P),Z.push(Q)}finally{var K;v=!0,p&&(p(),p=null),x==null||(K=x.signal)===null||K===void 0||K.removeEventListener("abort",O)}})();try{for(;;){for(;Z.length>0;){const F=await Z[0];if(F===R)return;if(X.aborted)throw new f;F!==_&&(yield F),Z.shift(),m&&(m(),m=null)}await new E(F=>{p=F})}}finally{$.abort(),v=!0,m&&(m(),m=null)}}).call(this)}async function Y(C,x=void 0){for await(const z of J.call(this,C,x))return!0;return!1}function J(C,x){if(typeof C!="function")throw new g("fn",["Function","AsyncFunction"],C);return T.call(this,async function(z,B){return await C(z,B)?z:_},x)}class et extends d{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function M(C){if(C=I(C),A(C))return 0;if(C<0)throw new i("number",">= 0",C);return C}l.exports.streamReturningOperators={asIndexedPairs:function(C=void 0){return C!=null&&o(C,"options"),(C==null?void 0:C.signal)!=null&&c(C.signal,"options.signal"),(async function*(){let x=0;for await(const B of this){var z;if(C!=null&&(z=C.signal)!==null&&z!==void 0&&z.aborted)throw new f({cause:C.signal.reason});yield[x++,B]}}).call(this)},drop:function(C,x=void 0){return x!=null&&o(x,"options"),(x==null?void 0:x.signal)!=null&&c(x.signal,"options.signal"),C=M(C),(async function*(){var z;if(x!=null&&(z=x.signal)!==null&&z!==void 0&&z.aborted)throw new f;for await(const V of this){var B;if(x!=null&&(B=x.signal)!==null&&B!==void 0&&B.aborted)throw new f;C--<=0&&(yield V)}}).call(this)},filter:J,flatMap:function(C,x){const z=T.call(this,C,x);return(async function*(){for await(const B of z)yield*B}).call(this)},map:T,take:function(C,x=void 0){return x!=null&&o(x,"options"),(x==null?void 0:x.signal)!=null&&c(x.signal,"options.signal"),C=M(C),(async function*(){var z;if(x!=null&&(z=x.signal)!==null&&z!==void 0&&z.aborted)throw new f;for await(const V of this){var B;if(x!=null&&(B=x.signal)!==null&&B!==void 0&&B.aborted)throw new f;if(!(C-- >0))return;yield V}}).call(this)},compose:function(C,x){if(x!=null&&o(x,"options"),(x==null?void 0:x.signal)!=null&&c(x.signal,"options.signal"),k(C)&&!S(C))throw new s("stream",C,"must be writable");const z=y(this,C);return x!=null&&x.signal&&w(x.signal,z),z}},l.exports.promiseReturningOperators={every:async function(C,x=void 0){if(typeof C!="function")throw new g("fn",["Function","AsyncFunction"],C);return!await Y.call(this,async(...z)=>!await C(...z),x)},forEach:async function(C,x){if(typeof C!="function")throw new g("fn",["Function","AsyncFunction"],C);for await(const z of T.call(this,async function(B,V){return await C(B,V),_},x));},reduce:async function(C,x,z){var B;if(typeof C!="function")throw new g("reducer",["Function","AsyncFunction"],C);z!=null&&o(z,"options"),(z==null?void 0:z.signal)!=null&&c(z.signal,"options.signal");let V=arguments.length>1;if(z!=null&&(B=z.signal)!==null&&B!==void 0&&B.aborted){const tt=new f(void 0,{cause:z.signal.reason});throw this.once("error",()=>{}),await b(this.destroy(tt)),tt}const $=new r,H=$.signal;if(z!=null&&z.signal){const tt={once:!0,[u]:this};z.signal.addEventListener("abort",()=>$.abort(),tt)}let Z=!1;try{for await(const tt of this){var X;if(Z=!0,z!=null&&(X=z.signal)!==null&&X!==void 0&&X.aborted)throw new f;V?x=await C(x,tt,{signal:H}):(x=tt,V=!0)}if(!Z&&!V)throw new et}finally{$.abort()}return x},toArray:async function(C){C!=null&&o(C,"options"),(C==null?void 0:C.signal)!=null&&c(C.signal,"options.signal");const x=[];for await(const B of this){var z;if(C!=null&&(z=C.signal)!==null&&z!==void 0&&z.aborted)throw new f(void 0,{cause:C.signal.reason});j(x,B)}return x},some:Y,find:async function(C,x){for await(const z of J.call(this,C,x))return z}}},{"../../ours/errors":126,"../../ours/primordials":127,"../validators":124,"./add-abort-signal":107,"./compose":109,"./end-of-stream":113,"./utils":122,"abort-controller":24}],117:[function(t,l,h){const{ObjectSetPrototypeOf:r}=t("../../ours/primordials");l.exports=g;const s=t("./transform");function g(d){if(!(this instanceof g))return new g(d);s.call(this,d)}r(g.prototype,s.prototype),r(g,s),g.prototype._transform=function(d,i,f){f(null,d)}},{"../../ours/primordials":127,"./transform":121}],118:[function(t,l,h){const r=t("process/"),{ArrayIsArray:s,Promise:g,SymbolAsyncIterator:d}=t("../../ours/primordials"),i=t("./end-of-stream"),{once:f}=t("../../ours/util"),c=t("./destroy"),n=t("./duplex"),{aggregateTwoErrors:o,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:b,ERR_MISSING_ARGS:y,ERR_STREAM_DESTROYED:w,ERR_STREAM_PREMATURE_CLOSE:S},AbortError:k}=t("../../ours/errors"),{validateFunction:j,validateAbortSignal:L}=t("../validators"),{isIterable:I,isReadable:A,isReadableNodeStream:E,isNodeStream:N,isTransformStream:G,isWebStream:W,isReadableStream:_,isReadableEnded:R}=t("./utils"),T=globalThis.AbortController||t("abort-controller").AbortController;let Y,J;function et(V,$,H){let Z=!1;return V.on("close",()=>{Z=!0}),{destroy:X=>{Z||(Z=!0,c.destroyer(V,X||new w("pipe")))},cleanup:i(V,{readable:$,writable:H},X=>{Z=!X})}}function M(V){if(I(V))return V;if(E(V))return async function*($){J||(J=t("./readable")),yield*J.prototype[d].call($)}(V);throw new u("val",["Readable","Iterable","AsyncIterable"],V)}async function C(V,$,H,{end:Z}){let X,tt=null;const O=v=>{if(v&&(X=v),tt){const P=tt;tt=null,P()}},p=()=>new g((v,P)=>{X?P(X):tt=()=>{X?P(X):v()}});$.on("drain",O);const m=i($,{readable:!1},O);try{$.writableNeedDrain&&await p();for await(const v of V)$.write(v)||await p();Z&&$.end(),await p(),H()}catch(v){H(X!==v?o(X,v):v)}finally{m(),$.off("drain",O)}}async function x(V,$,H,{end:Z}){G($)&&($=$.writable);const X=$.getWriter();try{for await(const tt of V)await X.ready,X.write(tt).catch(()=>{});await X.ready,Z&&await X.close(),H()}catch(tt){try{await X.abort(tt),H(tt)}catch(O){H(O)}}}function z(V,$,H){if(V.length===1&&s(V[0])&&(V=V[0]),V.length<2)throw new y("streams");const Z=new T,X=Z.signal,tt=H==null?void 0:H.signal,O=[];function p(){Q(new k)}let m,v;L(tt,"options.signal"),tt==null||tt.addEventListener("abort",p);const P=[];let F,K=0;function D(dt){Q(dt,--K==0)}function Q(dt,ct){if(!dt||m&&m.code!=="ERR_STREAM_PREMATURE_CLOSE"||(m=dt),m||ct){for(;P.length;)P.shift()(m);tt==null||tt.removeEventListener("abort",p),Z.abort(),ct&&(m||O.forEach(ut=>ut()),r.nextTick($,m,v))}}for(let dt=0;dt<V.length;dt++){const ct=V[dt],ut=dt<V.length-1,U=dt>0,q=ut||(H==null?void 0:H.end)!==!1,lt=dt===V.length-1;if(N(ct)){let at=function(ht){ht&&ht.name!=="AbortError"&&ht.code!=="ERR_STREAM_PREMATURE_CLOSE"&&D(ht)};var st=at;if(q){const{destroy:ht,cleanup:pt}=et(ct,ut,U);P.push(ht),A(ct)&&lt&&O.push(pt)}ct.on("error",at),A(ct)&&lt&&O.push(()=>{ct.removeListener("error",at)})}if(dt===0)if(typeof ct=="function"){if(F=ct({signal:X}),!I(F))throw new b("Iterable, AsyncIterable or Stream","source",F)}else F=I(ct)||E(ct)||G(ct)?ct:n.from(ct);else if(typeof ct=="function"){var rt;if(G(F)?F=M((rt=F)===null||rt===void 0?void 0:rt.readable):F=M(F),F=ct(F,{signal:X}),ut){if(!I(F,!0))throw new b("AsyncIterable",`transform[${dt-1}]`,F)}else{var nt;Y||(Y=t("./passthrough"));const at=new Y({objectMode:!0}),ht=(nt=F)===null||nt===void 0?void 0:nt.then;if(typeof ht=="function")K++,ht.call(F,mt=>{v=mt,mt!=null&&at.write(mt),q&&at.end(),r.nextTick(D)},mt=>{at.destroy(mt),r.nextTick(D,mt)});else if(I(F,!0))K++,C(F,at,D,{end:q});else{if(!_(F)&&!G(F))throw new b("AsyncIterable or Promise","destination",F);{const mt=F.readable||F;K++,C(mt,at,D,{end:q})}}F=at;const{destroy:pt,cleanup:Ct}=et(F,!1,!0);P.push(pt),lt&&O.push(Ct)}}else if(N(ct)){if(E(F)){K+=2;const at=B(F,ct,D,{end:q});A(ct)&&lt&&O.push(at)}else if(G(F)||_(F)){const at=F.readable||F;K++,C(at,ct,D,{end:q})}else{if(!I(F))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],F);K++,C(F,ct,D,{end:q})}F=ct}else if(W(ct)){if(E(F))K++,x(M(F),ct,D,{end:q});else if(_(F)||I(F))K++,x(F,ct,D,{end:q});else{if(!G(F))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],F);K++,x(F.readable,ct,D,{end:q})}F=ct}else F=n.from(ct)}return(X!=null&&X.aborted||tt!=null&&tt.aborted)&&r.nextTick(p),F}function B(V,$,H,{end:Z}){let X=!1;if($.on("close",()=>{X||H(new S)}),V.pipe($,{end:!1}),Z){let O=function(){X=!0,$.end()};var tt=O;R(V)?r.nextTick(O):V.once("end",O)}else H();return i(V,{readable:!0,writable:!1},O=>{const p=V._readableState;O&&O.code==="ERR_STREAM_PREMATURE_CLOSE"&&p&&p.ended&&!p.errored&&!p.errorEmitted?V.once("end",H).once("error",H):H(O)}),i($,{readable:!1,writable:!0},H)}l.exports={pipelineImpl:z,pipeline:function(...V){return z(V,f(function($){return j($[$.length-1],"streams[stream.length - 1]"),$.pop()}(V)))}}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./passthrough":117,"./readable":119,"./utils":122,"abort-controller":24,"process/":102}],119:[function(t,l,h){const r=t("process/"),{ArrayPrototypeIndexOf:s,NumberIsInteger:g,NumberIsNaN:d,NumberParseInt:i,ObjectDefineProperties:f,ObjectKeys:c,ObjectSetPrototypeOf:n,Promise:o,SafeSet:u,SymbolAsyncIterator:b,Symbol:y}=t("../../ours/primordials");l.exports=H,H.ReadableState=$;const{EventEmitter:w}=t("events"),{Stream:S,prependListener:k}=t("./legacy"),{Buffer:j}=t("buffer"),{addAbortSignal:L}=t("./add-abort-signal"),I=t("./end-of-stream");let A=t("../../ours/util").debuglog("stream",U=>{A=U});const E=t("./buffer_list"),N=t("./destroy"),{getHighWaterMark:G,getDefaultHighWaterMark:W}=t("./state"),{aggregateTwoErrors:_,codes:{ERR_INVALID_ARG_TYPE:R,ERR_METHOD_NOT_IMPLEMENTED:T,ERR_OUT_OF_RANGE:Y,ERR_STREAM_PUSH_AFTER_EOF:J,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:et}}=t("../../ours/errors"),{validateObject:M}=t("../validators"),C=y("kPaused"),{StringDecoder:x}=t("string_decoder"),z=t("./from");n(H.prototype,S.prototype),n(H,S);const B=()=>{},{errorOrDestroy:V}=N;function $(U,q,lt){typeof lt!="boolean"&&(lt=q instanceof t("./duplex")),this.objectMode=!(!U||!U.objectMode),lt&&(this.objectMode=this.objectMode||!(!U||!U.readableObjectMode)),this.highWaterMark=U?G(this,U,"readableHighWaterMark",lt):W(!1),this.buffer=new E,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[C]=null,this.errorEmitted=!1,this.emitClose=!U||U.emitClose!==!1,this.autoDestroy=!U||U.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=U&&U.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,U&&U.encoding&&(this.decoder=new x(U.encoding),this.encoding=U.encoding)}function H(U){if(!(this instanceof H))return new H(U);const q=this instanceof t("./duplex");this._readableState=new $(U,this,q),U&&(typeof U.read=="function"&&(this._read=U.read),typeof U.destroy=="function"&&(this._destroy=U.destroy),typeof U.construct=="function"&&(this._construct=U.construct),U.signal&&!q&&L(U.signal,this)),S.call(this,U),N.construct(this,()=>{this._readableState.needReadable&&m(this,this._readableState)})}function Z(U,q,lt,at){A("readableAddChunk",q);const ht=U._readableState;let pt;if(ht.objectMode||(typeof q=="string"?(lt=lt||ht.defaultEncoding,ht.encoding!==lt&&(at&&ht.encoding?q=j.from(q,lt).toString(ht.encoding):(q=j.from(q,lt),lt=""))):q instanceof j?lt="":S._isUint8Array(q)?(q=S._uint8ArrayToBuffer(q),lt=""):q!=null&&(pt=new R("chunk",["string","Buffer","Uint8Array"],q))),pt)V(U,pt);else if(q===null)ht.reading=!1,function(Ct,mt){if(A("onEofChunk"),!mt.ended){if(mt.decoder){const Nt=mt.decoder.end();Nt&&Nt.length&&(mt.buffer.push(Nt),mt.length+=mt.objectMode?1:Nt.length)}mt.ended=!0,mt.sync?O(Ct):(mt.needReadable=!1,mt.emittedReadable=!0,p(Ct))}}(U,ht);else if(ht.objectMode||q&&q.length>0)if(at)if(ht.endEmitted)V(U,new et);else{if(ht.destroyed||ht.errored)return!1;X(U,ht,q,!0)}else if(ht.ended)V(U,new J);else{if(ht.destroyed||ht.errored)return!1;ht.reading=!1,ht.decoder&&!lt?(q=ht.decoder.write(q),ht.objectMode||q.length!==0?X(U,ht,q,!1):m(U,ht)):X(U,ht,q,!1)}else at||(ht.reading=!1,m(U,ht));return!ht.ended&&(ht.length<ht.highWaterMark||ht.length===0)}function X(U,q,lt,at){q.flowing&&q.length===0&&!q.sync&&U.listenerCount("data")>0?(q.multiAwaitDrain?q.awaitDrainWriters.clear():q.awaitDrainWriters=null,q.dataEmitted=!0,U.emit("data",lt)):(q.length+=q.objectMode?1:lt.length,at?q.buffer.unshift(lt):q.buffer.push(lt),q.needReadable&&O(U)),m(U,q)}H.prototype.destroy=N.destroy,H.prototype._undestroy=N.undestroy,H.prototype._destroy=function(U,q){q(U)},H.prototype[w.captureRejectionSymbol]=function(U){this.destroy(U)},H.prototype.push=function(U,q){return Z(this,U,q,!1)},H.prototype.unshift=function(U,q){return Z(this,U,q,!0)},H.prototype.isPaused=function(){const U=this._readableState;return U[C]===!0||U.flowing===!1},H.prototype.setEncoding=function(U){const q=new x(U);this._readableState.decoder=q,this._readableState.encoding=this._readableState.decoder.encoding;const lt=this._readableState.buffer;let at="";for(const ht of lt)at+=q.write(ht);return lt.clear(),at!==""&&lt.push(at),this._readableState.length=at.length,this};function tt(U,q){return U<=0||q.length===0&&q.ended?0:q.objectMode?1:d(U)?q.flowing&&q.length?q.buffer.first().length:q.length:U<=q.length?U:q.ended?q.length:0}function O(U){const q=U._readableState;A("emitReadable",q.needReadable,q.emittedReadable),q.needReadable=!1,q.emittedReadable||(A("emitReadable",q.flowing),q.emittedReadable=!0,r.nextTick(p,U))}function p(U){const q=U._readableState;A("emitReadable_",q.destroyed,q.length,q.ended),q.destroyed||q.errored||!q.length&&!q.ended||(U.emit("readable"),q.emittedReadable=!1),q.needReadable=!q.flowing&&!q.ended&&q.length<=q.highWaterMark,D(U)}function m(U,q){!q.readingMore&&q.constructed&&(q.readingMore=!0,r.nextTick(v,U,q))}function v(U,q){for(;!q.reading&&!q.ended&&(q.length<q.highWaterMark||q.flowing&&q.length===0);){const lt=q.length;if(A("maybeReadMore read 0"),U.read(0),lt===q.length)break}q.readingMore=!1}function P(U){const q=U._readableState;q.readableListening=U.listenerCount("readable")>0,q.resumeScheduled&&q[C]===!1?q.flowing=!0:U.listenerCount("data")>0?U.resume():q.readableListening||(q.flowing=null)}function F(U){A("readable nexttick read 0"),U.read(0)}function K(U,q){A("resume",q.reading),q.reading||U.read(0),q.resumeScheduled=!1,U.emit("resume"),D(U),q.flowing&&!q.reading&&U.read(0)}function D(U){const q=U._readableState;for(A("flow",q.flowing);q.flowing&&U.read()!==null;);}function Q(U,q){typeof U.read!="function"&&(U=H.wrap(U,{objectMode:!0}));const lt=async function*(at,ht){let pt,Ct=B;function mt(It){this===at?(Ct(),Ct=B):Ct=It}at.on("readable",mt);const Nt=I(at,{writable:!1},It=>{pt=It?_(pt,It):null,Ct(),Ct=B});try{for(;;){const It=at.destroyed?null:at.read();if(It!==null)yield It;else{if(pt)throw pt;if(pt===null)return;await new o(mt)}}}catch(It){throw pt=_(pt,It),pt}finally{!pt&&(ht==null?void 0:ht.destroyOnReturn)===!1||pt!==void 0&&!at._readableState.autoDestroy?(at.off("readable",mt),Nt()):N.destroyer(at,null)}}(U,q);return lt.stream=U,lt}function rt(U,q){if(q.length===0)return null;let lt;return q.objectMode?lt=q.buffer.shift():!U||U>=q.length?(lt=q.decoder?q.buffer.join(""):q.buffer.length===1?q.buffer.first():q.buffer.concat(q.length),q.buffer.clear()):lt=q.buffer.consume(U,q.decoder),lt}function nt(U){const q=U._readableState;A("endReadable",q.endEmitted),q.endEmitted||(q.ended=!0,r.nextTick(st,q,U))}function st(U,q){if(A("endReadableNT",U.endEmitted,U.length),!U.errored&&!U.closeEmitted&&!U.endEmitted&&U.length===0){if(U.endEmitted=!0,q.emit("end"),q.writable&&q.allowHalfOpen===!1)r.nextTick(dt,q);else if(U.autoDestroy){const lt=q._writableState;(!lt||lt.autoDestroy&&(lt.finished||lt.writable===!1))&&q.destroy()}}}function dt(U){U.writable&&!U.writableEnded&&!U.destroyed&&U.end()}let ct;function ut(){return ct===void 0&&(ct={}),ct}H.prototype.read=function(U){A("read",U),U===void 0?U=NaN:g(U)||(U=i(U,10));const q=this._readableState,lt=U;if(U>q.highWaterMark&&(q.highWaterMark=function(pt){if(pt>1073741824)throw new Y("size","<= 1GiB",pt);return pt--,pt|=pt>>>1,pt|=pt>>>2,pt|=pt>>>4,pt|=pt>>>8,pt|=pt>>>16,++pt}(U)),U!==0&&(q.emittedReadable=!1),U===0&&q.needReadable&&((q.highWaterMark!==0?q.length>=q.highWaterMark:q.length>0)||q.ended))return A("read: emitReadable",q.length,q.ended),q.length===0&&q.ended?nt(this):O(this),null;if((U=tt(U,q))===0&&q.ended)return q.length===0&&nt(this),null;let at,ht=q.needReadable;if(A("need readable",ht),(q.length===0||q.length-U<q.highWaterMark)&&(ht=!0,A("length less than watermark",ht)),q.ended||q.reading||q.destroyed||q.errored||!q.constructed)ht=!1,A("reading, ended or constructing",ht);else if(ht){A("do read"),q.reading=!0,q.sync=!0,q.length===0&&(q.needReadable=!0);try{this._read(q.highWaterMark)}catch(pt){V(this,pt)}q.sync=!1,q.reading||(U=tt(lt,q))}return at=U>0?rt(U,q):null,at===null?(q.needReadable=q.length<=q.highWaterMark,U=0):(q.length-=U,q.multiAwaitDrain?q.awaitDrainWriters.clear():q.awaitDrainWriters=null),q.length===0&&(q.ended||(q.needReadable=!0),lt!==U&&q.ended&&nt(this)),at===null||q.errorEmitted||q.closeEmitted||(q.dataEmitted=!0,this.emit("data",at)),at},H.prototype._read=function(U){throw new T("_read()")},H.prototype.pipe=function(U,q){const lt=this,at=this._readableState;at.pipes.length===1&&(at.multiAwaitDrain||(at.multiAwaitDrain=!0,at.awaitDrainWriters=new u(at.awaitDrainWriters?[at.awaitDrainWriters]:[]))),at.pipes.push(U),A("pipe count=%d opts=%j",at.pipes.length,q);const ht=(!q||q.end!==!1)&&U!==r.stdout&&U!==r.stderr?Ct:Yt;function pt(Pt,Rt){A("onunpipe"),Pt===lt&&Rt&&Rt.hasUnpiped===!1&&(Rt.hasUnpiped=!0,function(){A("cleanup"),U.removeListener("close",Fe),U.removeListener("finish",We),mt&&U.removeListener("drain",mt),U.removeListener("error",Ue),U.removeListener("unpipe",pt),lt.removeListener("end",Ct),lt.removeListener("end",Yt),lt.removeListener("data",yr),Nt=!0,mt&&at.awaitDrainWriters&&(!U._writableState||U._writableState.needDrain)&&mt()}())}function Ct(){A("onend"),U.end()}let mt;at.endEmitted?r.nextTick(ht):lt.once("end",ht),U.on("unpipe",pt);let Nt=!1;function It(){Nt||(at.pipes.length===1&&at.pipes[0]===U?(A("false write response, pause",0),at.awaitDrainWriters=U,at.multiAwaitDrain=!1):at.pipes.length>1&&at.pipes.includes(U)&&(A("false write response, pause",at.awaitDrainWriters.size),at.awaitDrainWriters.add(U)),lt.pause()),mt||(mt=function(Pt,Rt){return function(){const Wt=Pt._readableState;Wt.awaitDrainWriters===Rt?(A("pipeOnDrain",1),Wt.awaitDrainWriters=null):Wt.multiAwaitDrain&&(A("pipeOnDrain",Wt.awaitDrainWriters.size),Wt.awaitDrainWriters.delete(Rt)),Wt.awaitDrainWriters&&Wt.awaitDrainWriters.size!==0||!Pt.listenerCount("data")||Pt.resume()}}(lt,U),U.on("drain",mt))}function yr(Pt){A("ondata");const Rt=U.write(Pt);A("dest.write",Rt),Rt===!1&&It()}function Ue(Pt){if(A("onerror",Pt),Yt(),U.removeListener("error",Ue),U.listenerCount("error")===0){const Rt=U._writableState||U._readableState;Rt&&!Rt.errorEmitted?V(U,Pt):U.emit("error",Pt)}}function Fe(){U.removeListener("finish",We),Yt()}function We(){A("onfinish"),U.removeListener("close",Fe),Yt()}function Yt(){A("unpipe"),lt.unpipe(U)}return lt.on("data",yr),k(U,"error",Ue),U.once("close",Fe),U.once("finish",We),U.emit("pipe",lt),U.writableNeedDrain===!0?at.flowing&&It():at.flowing||(A("pipe resume"),lt.resume()),U},H.prototype.unpipe=function(U){const q=this._readableState;if(q.pipes.length===0)return this;if(!U){const at=q.pipes;q.pipes=[],this.pause();for(let ht=0;ht<at.length;ht++)at[ht].emit("unpipe",this,{hasUnpiped:!1});return this}const lt=s(q.pipes,U);return lt===-1||(q.pipes.splice(lt,1),q.pipes.length===0&&this.pause(),U.emit("unpipe",this,{hasUnpiped:!1})),this},H.prototype.on=function(U,q){const lt=S.prototype.on.call(this,U,q),at=this._readableState;return U==="data"?(at.readableListening=this.listenerCount("readable")>0,at.flowing!==!1&&this.resume()):U==="readable"&&(at.endEmitted||at.readableListening||(at.readableListening=at.needReadable=!0,at.flowing=!1,at.emittedReadable=!1,A("on readable",at.length,at.reading),at.length?O(this):at.reading||r.nextTick(F,this))),lt},H.prototype.addListener=H.prototype.on,H.prototype.removeListener=function(U,q){const lt=S.prototype.removeListener.call(this,U,q);return U==="readable"&&r.nextTick(P,this),lt},H.prototype.off=H.prototype.removeListener,H.prototype.removeAllListeners=function(U){const q=S.prototype.removeAllListeners.apply(this,arguments);return U!=="readable"&&U!==void 0||r.nextTick(P,this),q},H.prototype.resume=function(){const U=this._readableState;return U.flowing||(A("resume"),U.flowing=!U.readableListening,function(q,lt){lt.resumeScheduled||(lt.resumeScheduled=!0,r.nextTick(K,q,lt))}(this,U)),U[C]=!1,this},H.prototype.pause=function(){return A("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(A("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[C]=!0,this},H.prototype.wrap=function(U){let q=!1;U.on("data",at=>{!this.push(at)&&U.pause&&(q=!0,U.pause())}),U.on("end",()=>{this.push(null)}),U.on("error",at=>{V(this,at)}),U.on("close",()=>{this.destroy()}),U.on("destroy",()=>{this.destroy()}),this._read=()=>{q&&U.resume&&(q=!1,U.resume())};const lt=c(U);for(let at=1;at<lt.length;at++){const ht=lt[at];this[ht]===void 0&&typeof U[ht]=="function"&&(this[ht]=U[ht].bind(U))}return this},H.prototype[b]=function(){return Q(this)},H.prototype.iterator=function(U){return U!==void 0&&M(U,"options"),Q(this,U)},f(H.prototype,{readable:{__proto__:null,get(){const U=this._readableState;return!(!U||U.readable===!1||U.destroyed||U.errorEmitted||U.endEmitted)},set(U){this._readableState&&(this._readableState.readable=!!U)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(this._readableState.readable===!1||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(U){this._readableState&&(this._readableState.flowing=U)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(U){this._readableState&&(this._readableState.destroyed=U)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),f($.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[C]!==!1},set(U){this[C]=!!U}}}),H._fromList=rt,H.from=function(U,q){return z(H,U,q)},H.fromWeb=function(U,q){return ut().newStreamReadableFromReadableStream(U,q)},H.toWeb=function(U,q){return ut().newReadableStreamFromStreamReadable(U,q)},H.wrap=function(U,q){var lt,at;return new H({objectMode:(lt=(at=U.readableObjectMode)!==null&&at!==void 0?at:U.objectMode)===null||lt===void 0||lt,...q,destroy(ht,pt){N.destroyer(U,ht),pt(ht)}}).wrap(U)}},{"../../ours/errors":126,"../../ours/primordials":127,"../../ours/util":128,"../validators":124,"./add-abort-signal":107,"./buffer_list":108,"./destroy":110,"./duplex":111,"./end-of-stream":113,"./from":114,"./legacy":115,"./state":120,buffer:29,events:49,"process/":102,string_decoder:28}],120:[function(t,l,h){const{MathFloor:r,NumberIsInteger:s}=t("../../ours/primordials"),{ERR_INVALID_ARG_VALUE:g}=t("../../ours/errors").codes;function d(i){return i?16:16384}l.exports={getHighWaterMark:function(i,f,c,n){const o=function(u,b,y){return u.highWaterMark!=null?u.highWaterMark:b?u[y]:null}(f,n,c);if(o!=null){if(!s(o)||o<0)throw new g(n?`options.${c}`:"options.highWaterMark",o);return r(o)}return d(i.objectMode)},getDefaultHighWaterMark:d}},{"../../ours/errors":126,"../../ours/primordials":127}],121:[function(t,l,h){const{ObjectSetPrototypeOf:r,Symbol:s}=t("../../ours/primordials");l.exports=c;const{ERR_METHOD_NOT_IMPLEMENTED:g}=t("../../ours/errors").codes,d=t("./duplex"),{getHighWaterMark:i}=t("./state");r(c.prototype,d.prototype),r(c,d);const f=s("kCallback");function c(u){if(!(this instanceof c))return new c(u);const b=u?i(this,u,"readableHighWaterMark",!0):null;b===0&&(u={...u,highWaterMark:null,readableHighWaterMark:b,writableHighWaterMark:u.writableHighWaterMark||0}),d.call(this,u),this._readableState.sync=!1,this[f]=null,u&&(typeof u.transform=="function"&&(this._transform=u.transform),typeof u.flush=="function"&&(this._flush=u.flush)),this.on("prefinish",o)}function n(u){typeof this._flush!="function"||this.destroyed?(this.push(null),u&&u()):this._flush((b,y)=>{b?u?u(b):this.destroy(b):(y!=null&&this.push(y),this.push(null),u&&u())})}function o(){this._final!==n&&n.call(this)}c.prototype._final=n,c.prototype._transform=function(u,b,y){throw new g("_transform()")},c.prototype._write=function(u,b,y){const w=this._readableState,S=this._writableState,k=w.length;this._transform(u,b,(j,L)=>{j?y(j):(L!=null&&this.push(L),S.ended||k===w.length||w.length<w.highWaterMark?y():this[f]=y)})},c.prototype._read=function(){if(this[f]){const u=this[f];this[f]=null,u()}}},{"../../ours/errors":126,"../../ours/primordials":127,"./duplex":111,"./state":120}],122:[function(t,l,h){const{Symbol:r,SymbolAsyncIterator:s,SymbolIterator:g,SymbolFor:d}=t("../../ours/primordials"),i=r("kDestroyed"),f=r("kIsErrored"),c=r("kIsReadable"),n=r("kIsDisturbed"),o=d("nodejs.webstream.isClosedPromise"),u=d("nodejs.webstream.controllerErrorFunction");function b(_,R=!1){var T;return!(!_||typeof _.pipe!="function"||typeof _.on!="function"||R&&(typeof _.pause!="function"||typeof _.resume!="function")||_._writableState&&((T=_._readableState)===null||T===void 0?void 0:T.readable)===!1||_._writableState&&!_._readableState)}function y(_){var R;return!(!_||typeof _.write!="function"||typeof _.on!="function"||_._readableState&&((R=_._writableState)===null||R===void 0?void 0:R.writable)===!1)}function w(_){return _&&(_._readableState||_._writableState||typeof _.write=="function"&&typeof _.on=="function"||typeof _.pipe=="function"&&typeof _.on=="function")}function S(_){return!(!_||w(_)||typeof _.pipeThrough!="function"||typeof _.getReader!="function"||typeof _.cancel!="function")}function k(_){return!(!_||w(_)||typeof _.getWriter!="function"||typeof _.abort!="function")}function j(_){return!(!_||w(_)||typeof _.readable!="object"||typeof _.writable!="object")}function L(_){if(!w(_))return null;const R=_._writableState,T=_._readableState,Y=R||T;return!!(_.destroyed||_[i]||Y!=null&&Y.destroyed)}function I(_){if(!y(_))return null;if(_.writableEnded===!0)return!0;const R=_._writableState;return(R==null||!R.errored)&&(typeof(R==null?void 0:R.ended)!="boolean"?null:R.ended)}function A(_,R){if(!b(_))return null;const T=_._readableState;return(T==null||!T.errored)&&(typeof(T==null?void 0:T.endEmitted)!="boolean"?null:!!(T.endEmitted||R===!1&&T.ended===!0&&T.length===0))}function E(_){return _&&_[c]!=null?_[c]:typeof(_==null?void 0:_.readable)!="boolean"?null:!L(_)&&b(_)&&_.readable&&!A(_)}function N(_){return typeof(_==null?void 0:_.writable)!="boolean"?null:!L(_)&&y(_)&&_.writable&&!I(_)}function G(_){return typeof _._closed=="boolean"&&typeof _._defaultKeepAlive=="boolean"&&typeof _._removedConnection=="boolean"&&typeof _._removedContLen=="boolean"}function W(_){return typeof _._sent100=="boolean"&&G(_)}l.exports={kDestroyed:i,isDisturbed:function(_){var R;return!(!_||!((R=_[n])!==null&&R!==void 0?R:_.readableDidRead||_.readableAborted))},kIsDisturbed:n,isErrored:function(_){var R,T,Y,J,et,M,C,x,z,B;return!(!_||!((R=(T=(Y=(J=(et=(M=_[f])!==null&&M!==void 0?M:_.readableErrored)!==null&&et!==void 0?et:_.writableErrored)!==null&&J!==void 0?J:(C=_._readableState)===null||C===void 0?void 0:C.errorEmitted)!==null&&Y!==void 0?Y:(x=_._writableState)===null||x===void 0?void 0:x.errorEmitted)!==null&&T!==void 0?T:(z=_._readableState)===null||z===void 0?void 0:z.errored)!==null&&R!==void 0?R:!((B=_._writableState)===null||B===void 0)&&B.errored))},kIsErrored:f,isReadable:E,kIsReadable:c,kIsClosedPromise:o,kControllerErrorFunction:u,isClosed:function(_){if(!w(_))return null;if(typeof _.closed=="boolean")return _.closed;const R=_._writableState,T=_._readableState;return typeof(R==null?void 0:R.closed)=="boolean"||typeof(T==null?void 0:T.closed)=="boolean"?(R==null?void 0:R.closed)||(T==null?void 0:T.closed):typeof _._closed=="boolean"&&G(_)?_._closed:null},isDestroyed:L,isDuplexNodeStream:function(_){return!(!_||typeof _.pipe!="function"||!_._readableState||typeof _.on!="function"||typeof _.write!="function")},isFinished:function(_,R){return w(_)?!!L(_)||((R==null?void 0:R.readable)===!1||!E(_))&&((R==null?void 0:R.writable)===!1||!N(_)):null},isIterable:function(_,R){return _!=null&&(R===!0?typeof _[s]=="function":R===!1?typeof _[g]=="function":typeof _[s]=="function"||typeof _[g]=="function")},isReadableNodeStream:b,isReadableStream:S,isReadableEnded:function(_){if(!b(_))return null;if(_.readableEnded===!0)return!0;const R=_._readableState;return!(!R||R.errored)&&(typeof(R==null?void 0:R.ended)!="boolean"?null:R.ended)},isReadableFinished:A,isReadableErrored:function(_){var R,T;return w(_)?_.readableErrored?_.readableErrored:(R=(T=_._readableState)===null||T===void 0?void 0:T.errored)!==null&&R!==void 0?R:null:null},isNodeStream:w,isWebStream:function(_){return S(_)||k(_)||j(_)},isWritable:N,isWritableNodeStream:y,isWritableStream:k,isWritableEnded:I,isWritableFinished:function(_,R){if(!y(_))return null;if(_.writableFinished===!0)return!0;const T=_._writableState;return(T==null||!T.errored)&&(typeof(T==null?void 0:T.finished)!="boolean"?null:!!(T.finished||R===!1&&T.ended===!0&&T.length===0))},isWritableErrored:function(_){var R,T;return w(_)?_.writableErrored?_.writableErrored:(R=(T=_._writableState)===null||T===void 0?void 0:T.errored)!==null&&R!==void 0?R:null:null},isServerRequest:function(_){var R;return typeof _._consuming=="boolean"&&typeof _._dumped=="boolean"&&((R=_.req)===null||R===void 0?void 0:R.upgradeOrConnect)===void 0},isServerResponse:W,willEmitClose:function(_){if(!w(_))return null;const R=_._writableState,T=_._readableState,Y=R||T;return!Y&&W(_)||!!(Y&&Y.autoDestroy&&Y.emitClose&&Y.closed===!1)},isTransformStream:j}},{"../../ours/primordials":127}],123:[function(t,l,h){const r=t("process/"),{ArrayPrototypeSlice:s,Error:g,FunctionPrototypeSymbolHasInstance:d,ObjectDefineProperty:i,ObjectDefineProperties:f,ObjectSetPrototypeOf:c,StringPrototypeToLowerCase:n,Symbol:o,SymbolHasInstance:u}=t("../../ours/primordials");l.exports=x,x.WritableState=M;const{EventEmitter:b}=t("events"),y=t("./legacy").Stream,{Buffer:w}=t("buffer"),S=t("./destroy"),{addAbortSignal:k}=t("./add-abort-signal"),{getHighWaterMark:j,getDefaultHighWaterMark:L}=t("./state"),{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:A,ERR_MULTIPLE_CALLBACK:E,ERR_STREAM_CANNOT_PIPE:N,ERR_STREAM_DESTROYED:G,ERR_STREAM_ALREADY_FINISHED:W,ERR_STREAM_NULL_VALUES:_,ERR_STREAM_WRITE_AFTER_END:R,ERR_UNKNOWN_ENCODING:T}=t("../../ours/errors").codes,{errorOrDestroy:Y}=S;function J(){}c(x.prototype,y.prototype),c(x,y);const et=o("kOnFinished");function M(D,Q,rt){typeof rt!="boolean"&&(rt=Q instanceof t("./duplex")),this.objectMode=!(!D||!D.objectMode),rt&&(this.objectMode=this.objectMode||!(!D||!D.writableObjectMode)),this.highWaterMark=D?j(this,D,"writableHighWaterMark",rt):L(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const nt=!(!D||D.decodeStrings!==!1);this.decodeStrings=!nt,this.defaultEncoding=D&&D.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=$.bind(void 0,Q),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,C(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!D||D.emitClose!==!1,this.autoDestroy=!D||D.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[et]=[]}function C(D){D.buffered=[],D.bufferedIndex=0,D.allBuffers=!0,D.allNoop=!0}function x(D){const Q=this instanceof t("./duplex");if(!Q&&!d(x,this))return new x(D);this._writableState=new M(D,this,Q),D&&(typeof D.write=="function"&&(this._write=D.write),typeof D.writev=="function"&&(this._writev=D.writev),typeof D.destroy=="function"&&(this._destroy=D.destroy),typeof D.final=="function"&&(this._final=D.final),typeof D.construct=="function"&&(this._construct=D.construct),D.signal&&k(D.signal,this)),y.call(this,D),S.construct(this,()=>{const rt=this._writableState;rt.writing||tt(this,rt),m(this,rt)})}function z(D,Q,rt,nt){const st=D._writableState;if(typeof rt=="function")nt=rt,rt=st.defaultEncoding;else{if(rt){if(rt!=="buffer"&&!w.isEncoding(rt))throw new T(rt)}else rt=st.defaultEncoding;typeof nt!="function"&&(nt=J)}if(Q===null)throw new _;if(!st.objectMode)if(typeof Q=="string")st.decodeStrings!==!1&&(Q=w.from(Q,rt),rt="buffer");else if(Q instanceof w)rt="buffer";else{if(!y._isUint8Array(Q))throw new I("chunk",["string","Buffer","Uint8Array"],Q);Q=y._uint8ArrayToBuffer(Q),rt="buffer"}let dt;return st.ending?dt=new R:st.destroyed&&(dt=new G("write")),dt?(r.nextTick(nt,dt),Y(D,dt,!0),dt):(st.pendingcb++,function(ct,ut,U,q,lt){const at=ut.objectMode?1:U.length;ut.length+=at;const ht=ut.length<ut.highWaterMark;return ht||(ut.needDrain=!0),ut.writing||ut.corked||ut.errored||!ut.constructed?(ut.buffered.push({chunk:U,encoding:q,callback:lt}),ut.allBuffers&&q!=="buffer"&&(ut.allBuffers=!1),ut.allNoop&&lt!==J&&(ut.allNoop=!1)):(ut.writelen=at,ut.writecb=lt,ut.writing=!0,ut.sync=!0,ct._write(U,q,ut.onwrite),ut.sync=!1),ht&&!ut.errored&&!ut.destroyed}(D,st,Q,rt,nt))}function B(D,Q,rt,nt,st,dt,ct){Q.writelen=nt,Q.writecb=ct,Q.writing=!0,Q.sync=!0,Q.destroyed?Q.onwrite(new G("write")):rt?D._writev(st,Q.onwrite):D._write(st,dt,Q.onwrite),Q.sync=!1}function V(D,Q,rt,nt){--Q.pendingcb,nt(rt),X(Q),Y(D,rt)}function $(D,Q){const rt=D._writableState,nt=rt.sync,st=rt.writecb;typeof st=="function"?(rt.writing=!1,rt.writecb=null,rt.length-=rt.writelen,rt.writelen=0,Q?(Q.stack,rt.errored||(rt.errored=Q),D._readableState&&!D._readableState.errored&&(D._readableState.errored=Q),nt?r.nextTick(V,D,rt,Q,st):V(D,rt,Q,st)):(rt.buffered.length>rt.bufferedIndex&&tt(D,rt),nt?rt.afterWriteTickInfo!==null&&rt.afterWriteTickInfo.cb===st?rt.afterWriteTickInfo.count++:(rt.afterWriteTickInfo={count:1,cb:st,stream:D,state:rt},r.nextTick(H,rt.afterWriteTickInfo)):Z(D,rt,1,st))):Y(D,new E)}function H({stream:D,state:Q,count:rt,cb:nt}){return Q.afterWriteTickInfo=null,Z(D,Q,rt,nt)}function Z(D,Q,rt,nt){for(!Q.ending&&!D.destroyed&&Q.length===0&&Q.needDrain&&(Q.needDrain=!1,D.emit("drain"));rt-- >0;)Q.pendingcb--,nt();Q.destroyed&&X(Q),m(D,Q)}function X(D){if(D.writing)return;for(let st=D.bufferedIndex;st<D.buffered.length;++st){var Q;const{chunk:dt,callback:ct}=D.buffered[st],ut=D.objectMode?1:dt.length;D.length-=ut,ct((Q=D.errored)!==null&&Q!==void 0?Q:new G("write"))}const rt=D[et].splice(0);for(let st=0;st<rt.length;st++){var nt;rt[st]((nt=D.errored)!==null&&nt!==void 0?nt:new G("end"))}C(D)}function tt(D,Q){if(Q.corked||Q.bufferProcessing||Q.destroyed||!Q.constructed)return;const{buffered:rt,bufferedIndex:nt,objectMode:st}=Q,dt=rt.length-nt;if(!dt)return;let ct=nt;if(Q.bufferProcessing=!0,dt>1&&D._writev){Q.pendingcb-=dt-1;const ut=Q.allNoop?J:q=>{for(let lt=ct;lt<rt.length;++lt)rt[lt].callback(q)},U=Q.allNoop&&ct===0?rt:s(rt,ct);U.allBuffers=Q.allBuffers,B(D,Q,!0,Q.length,U,"",ut),C(Q)}else{do{const{chunk:ut,encoding:U,callback:q}=rt[ct];rt[ct++]=null,B(D,Q,!1,st?1:ut.length,ut,U,q)}while(ct<rt.length&&!Q.writing);ct===rt.length?C(Q):ct>256?(rt.splice(0,ct),Q.bufferedIndex=0):Q.bufferedIndex=ct}Q.bufferProcessing=!1}function O(D){return D.ending&&!D.destroyed&&D.constructed&&D.length===0&&!D.errored&&D.buffered.length===0&&!D.finished&&!D.writing&&!D.errorEmitted&&!D.closeEmitted}function p(D,Q){Q.prefinished||Q.finalCalled||(typeof D._final!="function"||Q.destroyed?(Q.prefinished=!0,D.emit("prefinish")):(Q.finalCalled=!0,function(rt,nt){let st=!1;function dt(ct){if(st)Y(rt,ct??E());else if(st=!0,nt.pendingcb--,ct){const ut=nt[et].splice(0);for(let U=0;U<ut.length;U++)ut[U](ct);Y(rt,ct,nt.sync)}else O(nt)&&(nt.prefinished=!0,rt.emit("prefinish"),nt.pendingcb++,r.nextTick(v,rt,nt))}nt.sync=!0,nt.pendingcb++;try{rt._final(dt)}catch(ct){dt(ct)}nt.sync=!1}(D,Q)))}function m(D,Q,rt){O(Q)&&(p(D,Q),Q.pendingcb===0&&(rt?(Q.pendingcb++,r.nextTick((nt,st)=>{O(st)?v(nt,st):st.pendingcb--},D,Q)):O(Q)&&(Q.pendingcb++,v(D,Q))))}function v(D,Q){Q.pendingcb--,Q.finished=!0;const rt=Q[et].splice(0);for(let nt=0;nt<rt.length;nt++)rt[nt]();if(D.emit("finish"),Q.autoDestroy){const nt=D._readableState;(!nt||nt.autoDestroy&&(nt.endEmitted||nt.readable===!1))&&D.destroy()}}M.prototype.getBuffer=function(){return s(this.buffered,this.bufferedIndex)},i(M.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),i(x,u,{__proto__:null,value:function(D){return!!d(this,D)||this===x&&D&&D._writableState instanceof M}}),x.prototype.pipe=function(){Y(this,new N)},x.prototype.write=function(D,Q,rt){return z(this,D,Q,rt)===!0},x.prototype.cork=function(){this._writableState.corked++},x.prototype.uncork=function(){const D=this._writableState;D.corked&&(D.corked--,D.writing||tt(this,D))},x.prototype.setDefaultEncoding=function(D){if(typeof D=="string"&&(D=n(D)),!w.isEncoding(D))throw new T(D);return this._writableState.defaultEncoding=D,this},x.prototype._write=function(D,Q,rt){if(!this._writev)throw new A("_write()");this._writev([{chunk:D,encoding:Q}],rt)},x.prototype._writev=null,x.prototype.end=function(D,Q,rt){const nt=this._writableState;let st;if(typeof D=="function"?(rt=D,D=null,Q=null):typeof Q=="function"&&(rt=Q,Q=null),D!=null){const dt=z(this,D,Q);dt instanceof g&&(st=dt)}return nt.corked&&(nt.corked=1,this.uncork()),st||(nt.errored||nt.ending?nt.finished?st=new W("end"):nt.destroyed&&(st=new G("end")):(nt.ending=!0,m(this,nt,!0),nt.ended=!0)),typeof rt=="function"&&(st||nt.finished?r.nextTick(rt,st):nt[et].push(rt)),this},f(x.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(D){this._writableState&&(this._writableState.destroyed=D)}},writable:{__proto__:null,get(){const D=this._writableState;return!(!D||D.writable===!1||D.destroyed||D.errored||D.ending||D.ended)},set(D){this._writableState&&(this._writableState.writable=!!D)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const D=this._writableState;return!!D&&!D.destroyed&&!D.ending&&D.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(this._writableState.writable===!1||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const P=S.destroy;let F;function K(){return F===void 0&&(F={}),F}x.prototype.destroy=function(D,Q){const rt=this._writableState;return!rt.destroyed&&(rt.bufferedIndex<rt.buffered.length||rt[et].length)&&r.nextTick(X,rt),P.call(this,D,Q),this},x.prototype._undestroy=S.undestroy,x.prototype._destroy=function(D,Q){Q(D)},x.prototype[b.captureRejectionSymbol]=function(D){this.destroy(D)},x.fromWeb=function(D,Q){return K().newStreamWritableFromWritableStream(D,Q)},x.toWeb=function(D){return K().newWritableStreamFromStreamWritable(D)}},{"../../ours/errors":126,"../../ours/primordials":127,"./add-abort-signal":107,"./destroy":110,"./duplex":111,"./legacy":115,"./state":120,buffer:29,events:49,"process/":102}],124:[function(t,l,h){const{ArrayIsArray:r,ArrayPrototypeIncludes:s,ArrayPrototypeJoin:g,ArrayPrototypeMap:d,NumberIsInteger:i,NumberIsNaN:f,NumberMAX_SAFE_INTEGER:c,NumberMIN_SAFE_INTEGER:n,NumberParseInt:o,ObjectPrototypeHasOwnProperty:u,RegExpPrototypeExec:b,String:y,StringPrototypeToUpperCase:w,StringPrototypeTrim:S}=t("../ours/primordials"),{hideStackFrames:k,codes:{ERR_SOCKET_BAD_PORT:j,ERR_INVALID_ARG_TYPE:L,ERR_INVALID_ARG_VALUE:I,ERR_OUT_OF_RANGE:A,ERR_UNKNOWN_SIGNAL:E}}=t("../ours/errors"),{normalizeEncoding:N}=t("../ours/util"),{isAsyncFunction:G,isArrayBufferView:W}=t("../ours/util").types,_={},R=/^[0-7]+$/,T=k((m,v,P=n,F=c)=>{if(typeof m!="number")throw new L(v,"number",m);if(!i(m))throw new A(v,"an integer",m);if(m<P||m>F)throw new A(v,`>= ${P} && <= ${F}`,m)}),Y=k((m,v,P=-2147483648,F=2147483647)=>{if(typeof m!="number")throw new L(v,"number",m);if(!i(m))throw new A(v,"an integer",m);if(m<P||m>F)throw new A(v,`>= ${P} && <= ${F}`,m)}),J=k((m,v,P=!1)=>{if(typeof m!="number")throw new L(v,"number",m);if(!i(m))throw new A(v,"an integer",m);const F=P?1:0,K=4294967295;if(m<F||m>K)throw new A(v,`>= ${F} && <= ${K}`,m)});function et(m,v){if(typeof m!="string")throw new L(v,"string",m)}const M=k((m,v,P)=>{if(!s(P,m)){const F=g(d(P,K=>typeof K=="string"?`'${K}'`:y(K)),", ");throw new I(v,m,"must be one of: "+F)}});function C(m,v){if(typeof m!="boolean")throw new L(v,"boolean",m)}function x(m,v,P){return m!=null&&u(m,v)?m[v]:P}const z=k((m,v,P=null)=>{const F=x(P,"allowArray",!1),K=x(P,"allowFunction",!1);if(!x(P,"nullable",!1)&&m===null||!F&&r(m)||typeof m!="object"&&(!K||typeof m!="function"))throw new L(v,"Object",m)}),B=k((m,v)=>{if(m!=null&&typeof m!="object"&&typeof m!="function")throw new L(v,"a dictionary",m)}),V=k((m,v,P=0)=>{if(!r(m))throw new L(v,"Array",m);if(m.length<P)throw new I(v,m,`must be longer than ${P}`)}),$=k((m,v="buffer")=>{if(!W(m))throw new L(v,["Buffer","TypedArray","DataView"],m)}),H=k((m,v)=>{if(m!==void 0&&(m===null||typeof m!="object"||!("aborted"in m)))throw new L(v,"AbortSignal",m)}),Z=k((m,v)=>{if(typeof m!="function")throw new L(v,"Function",m)}),X=k((m,v)=>{if(typeof m!="function"||G(m))throw new L(v,"Function",m)}),tt=k((m,v)=>{if(m!==void 0)throw new L(v,"undefined",m)}),O=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function p(m,v){if(m===void 0||!b(O,m))throw new I(v,m,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}l.exports={isInt32:function(m){return m===(0|m)},isUint32:function(m){return m===m>>>0},parseFileMode:function(m,v,P){if(m===void 0&&(m=P),typeof m=="string"){if(b(R,m)===null)throw new I(v,m,"must be a 32-bit unsigned integer or an octal string");m=o(m,8)}return J(m,v),m},validateArray:V,validateStringArray:function(m,v){V(m,v);for(let P=0;P<m.length;P++)et(m[P],`${v}[${P}]`)},validateBooleanArray:function(m,v){V(m,v);for(let P=0;P<m.length;P++)C(m[P],`${v}[${P}]`)},validateBoolean:C,validateBuffer:$,validateDictionary:B,validateEncoding:function(m,v){const P=N(v),F=m.length;if(P==="hex"&&F%2!=0)throw new I("encoding",v,`is invalid for data of length ${F}`)},validateFunction:Z,validateInt32:Y,validateInteger:T,validateNumber:function(m,v,P=void 0,F){if(typeof m!="number")throw new L(v,"number",m);if(P!=null&&m<P||F!=null&&m>F||(P!=null||F!=null)&&f(m))throw new A(v,`${P!=null?`>= ${P}`:""}${P!=null&&F!=null?" && ":""}${F!=null?`<= ${F}`:""}`,m)},validateObject:z,validateOneOf:M,validatePlainFunction:X,validatePort:function(m,v="Port",P=!0){if(typeof m!="number"&&typeof m!="string"||typeof m=="string"&&S(m).length===0||+m!=+m>>>0||m>65535||m===0&&!P)throw new j(v,m,P);return 0|m},validateSignalName:function(m,v="signal"){if(et(m,v),_[m]===void 0)throw _[w(m)]!==void 0?new E(m+" (signals must use all capital letters)"):new E(m)},validateString:et,validateUint32:J,validateUndefined:tt,validateUnion:function(m,v,P){if(!s(P,m))throw new L(v,`('${g(P,"|")}')`,m)},validateAbortSignal:H,validateLinkHeaderValue:function(m){if(typeof m=="string")return p(m,"hints"),m;if(r(m)){const v=m.length;let P="";if(v===0)return P;for(let F=0;F<v;F++){const K=m[F];p(K,"hints"),P+=K,F!==v-1&&(P+=", ")}return P}throw new I("hints",m,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}},{"../ours/errors":126,"../ours/primordials":127,"../ours/util":128}],125:[function(t,l,h){const r=t("../stream"),s=t("../stream/promises"),g=r.Readable.destroy;l.exports=r.Readable,l.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,l.exports._isUint8Array=r._isUint8Array,l.exports.isDisturbed=r.isDisturbed,l.exports.isErrored=r.isErrored,l.exports.isReadable=r.isReadable,l.exports.Readable=r.Readable,l.exports.Writable=r.Writable,l.exports.Duplex=r.Duplex,l.exports.Transform=r.Transform,l.exports.PassThrough=r.PassThrough,l.exports.addAbortSignal=r.addAbortSignal,l.exports.finished=r.finished,l.exports.destroy=r.destroy,l.exports.destroy=g,l.exports.pipeline=r.pipeline,l.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get:()=>s}),l.exports.Stream=r.Stream,l.exports.default=l.exports},{"../stream":129,"../stream/promises":130}],126:[function(t,l,h){const{format:r,inspect:s,AggregateError:g}=t("./util"),d=globalThis.AggregateError||g,i=Symbol("kIsNodeError"),f=["string","function","number","object","Function","Object","boolean","bigint","symbol"],c=/^([A-Z][a-z0-9]*)+$/,n={};function o(S,k){if(!S)throw new n.ERR_INTERNAL_ASSERTION(k)}function u(S){let k="",j=S.length;const L=S[0]==="-"?1:0;for(;j>=L+4;j-=3)k=`_${S.slice(j-3,j)}${k}`;return`${S.slice(0,j)}${k}`}function b(S,k,j){j||(j=Error);class L extends j{constructor(...A){super(function(E,N,G){if(typeof N=="function")return o(N.length<=G.length,`Code: ${E}; The provided arguments length (${G.length}) does not match the required ones (${N.length}).`),N(...G);const W=(N.match(/%[dfijoOs]/g)||[]).length;return o(W===G.length,`Code: ${E}; The provided arguments length (${G.length}) does not match the required ones (${W}).`),G.length===0?N:r(N,...G)}(S,k,A))}toString(){return`${this.name} [${S}]: ${this.message}`}}Object.defineProperties(L.prototype,{name:{value:j.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${S}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),L.prototype.code=S,L.prototype[i]=!0,n[S]=L}function y(S){const k="__node_internal_"+S.name;return Object.defineProperty(S,"name",{value:k}),S}class w extends Error{constructor(k="The operation was aborted",j=void 0){if(j!==void 0&&typeof j!="object")throw new n.ERR_INVALID_ARG_TYPE("options","Object",j);super(k,j),this.code="ABORT_ERR",this.name="AbortError"}}b("ERR_ASSERTION","%s",Error),b("ERR_INVALID_ARG_TYPE",(S,k,j)=>{o(typeof S=="string","'name' must be a string"),Array.isArray(k)||(k=[k]);let L="The ";S.endsWith(" argument")?L+=`${S} `:L+=`"${S}" ${S.includes(".")?"property":"argument"} `,L+="must be ";const I=[],A=[],E=[];for(const G of k)o(typeof G=="string","All expected entries have to be of type string"),f.includes(G)?I.push(G.toLowerCase()):c.test(G)?A.push(G):(o(G!=="object",'The value "object" should be written as "Object"'),E.push(G));if(A.length>0){const G=I.indexOf("object");G!==-1&&(I.splice(I,G,1),A.push("Object"))}if(I.length>0){switch(I.length){case 1:L+=`of type ${I[0]}`;break;case 2:L+=`one of type ${I[0]} or ${I[1]}`;break;default:{const G=I.pop();L+=`one of type ${I.join(", ")}, or ${G}`}}(A.length>0||E.length>0)&&(L+=" or ")}if(A.length>0){switch(A.length){case 1:L+=`an instance of ${A[0]}`;break;case 2:L+=`an instance of ${A[0]} or ${A[1]}`;break;default:{const G=A.pop();L+=`an instance of ${A.join(", ")}, or ${G}`}}E.length>0&&(L+=" or ")}switch(E.length){case 0:break;case 1:E[0].toLowerCase()!==E[0]&&(L+="an "),L+=`${E[0]}`;break;case 2:L+=`one of ${E[0]} or ${E[1]}`;break;default:{const G=E.pop();L+=`one of ${E.join(", ")}, or ${G}`}}if(j==null)L+=`. Received ${j}`;else if(typeof j=="function"&&j.name)L+=`. Received function ${j.name}`;else if(typeof j=="object"){var N;(N=j.constructor)!==null&&N!==void 0&&N.name?L+=`. Received an instance of ${j.constructor.name}`:L+=`. Received ${s(j,{depth:-1})}`}else{let G=s(j,{colors:!1});G.length>25&&(G=`${G.slice(0,25)}...`),L+=`. Received type ${typeof j} (${G})`}return L},TypeError),b("ERR_INVALID_ARG_VALUE",(S,k,j="is invalid")=>{let L=s(k);return L.length>128&&(L=L.slice(0,128)+"..."),`The ${S.includes(".")?"property":"argument"} '${S}' ${j}. Received ${L}`},TypeError),b("ERR_INVALID_RETURN_VALUE",(S,k,j)=>{var L;return`Expected ${S} to be returned from the "${k}" function but got ${j!=null&&(L=j.constructor)!==null&&L!==void 0&&L.name?`instance of ${j.constructor.name}`:"type "+typeof j}.`},TypeError),b("ERR_MISSING_ARGS",(...S)=>{let k;o(S.length>0,"At least one arg needs to be specified");const j=S.length;switch(S=(Array.isArray(S)?S:[S]).map(L=>`"${L}"`).join(" or "),j){case 1:k+=`The ${S[0]} argument`;break;case 2:k+=`The ${S[0]} and ${S[1]} arguments`;break;default:{const L=S.pop();k+=`The ${S.join(", ")}, and ${L} arguments`}}return`${k} must be specified`},TypeError),b("ERR_OUT_OF_RANGE",(S,k,j)=>{let L;return o(k,'Missing "range" argument'),Number.isInteger(j)&&Math.abs(j)>2**32?L=u(String(j)):typeof j=="bigint"?(L=String(j),(j>2n**32n||j<-(2n**32n))&&(L=u(L)),L+="n"):L=s(j),`The value of "${S}" is out of range. It must be ${k}. Received ${L}`},RangeError),b("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),b("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),b("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),b("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),b("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),b("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),b("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),b("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),b("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),b("ERR_STREAM_WRITE_AFTER_END","write after end",Error),b("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),l.exports={AbortError:w,aggregateTwoErrors:y(function(S,k){if(S&&k&&S!==k){if(Array.isArray(k.errors))return k.errors.push(S),k;const j=new d([k,S],k.message);return j.code=k.code,j}return S||k}),hideStackFrames:y,codes:n}},{"./util":128}],127:[function(t,l,h){l.exports={ArrayIsArray:r=>Array.isArray(r),ArrayPrototypeIncludes:(r,s)=>r.includes(s),ArrayPrototypeIndexOf:(r,s)=>r.indexOf(s),ArrayPrototypeJoin:(r,s)=>r.join(s),ArrayPrototypeMap:(r,s)=>r.map(s),ArrayPrototypePop:(r,s)=>r.pop(s),ArrayPrototypePush:(r,s)=>r.push(s),ArrayPrototypeSlice:(r,s,g)=>r.slice(s,g),Error,FunctionPrototypeCall:(r,s,...g)=>r.call(s,...g),FunctionPrototypeSymbolHasInstance:(r,s)=>Function.prototype[Symbol.hasInstance].call(r,s),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(r,s)=>Object.defineProperties(r,s),ObjectDefineProperty:(r,s,g)=>Object.defineProperty(r,s,g),ObjectGetOwnPropertyDescriptor:(r,s)=>Object.getOwnPropertyDescriptor(r,s),ObjectKeys:r=>Object.keys(r),ObjectSetPrototypeOf:(r,s)=>Object.setPrototypeOf(r,s),Promise,PromisePrototypeCatch:(r,s)=>r.catch(s),PromisePrototypeThen:(r,s,g)=>r.then(s,g),PromiseReject:r=>Promise.reject(r),ReflectApply:Reflect.apply,RegExpPrototypeTest:(r,s)=>r.test(s),SafeSet:Set,String,StringPrototypeSlice:(r,s,g)=>r.slice(s,g),StringPrototypeToLowerCase:r=>r.toLowerCase(),StringPrototypeToUpperCase:r=>r.toUpperCase(),StringPrototypeTrim:r=>r.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet:(r,s,g)=>r.set(s,g),Uint8Array}},{}],128:[function(t,l,h){const r=t("buffer"),s=Object.getPrototypeOf(async function(){}).constructor,g=globalThis.Blob||r.Blob,d=g!==void 0?function(f){return f instanceof g}:function(f){return!1};class i extends Error{constructor(c){if(!Array.isArray(c))throw new TypeError("Expected input to be an Array, got "+typeof c);let n="";for(let o=0;o<c.length;o++)n+=`    ${c[o].stack}
`;super(n),this.name="AggregateError",this.errors=c}}l.exports={AggregateError:i,kEmptyObject:Object.freeze({}),once(f){let c=!1;return function(...n){c||(c=!0,f.apply(this,n))}},createDeferredPromise:function(){let f,c;return{promise:new Promise((n,o)=>{f=n,c=o}),resolve:f,reject:c}},promisify:f=>new Promise((c,n)=>{f((o,...u)=>o?n(o):c(...u))}),debuglog:()=>function(){},format:(f,...c)=>f.replace(/%([sdifj])/g,function(...[n,o]){const u=c.shift();return o==="f"?u.toFixed(6):o==="j"?JSON.stringify(u):o==="s"&&typeof u=="object"?`${u.constructor!==Object?u.constructor.name:""} {}`.trim():u.toString()}),inspect(f){switch(typeof f){case"string":if(f.includes("'")){if(!f.includes('"'))return`"${f}"`;if(!f.includes("`")&&!f.includes("${"))return`\`${f}\``}return`'${f}'`;case"number":return isNaN(f)?"NaN":Object.is(f,-0)?String(f):f;case"bigint":return`${String(f)}n`;case"boolean":case"undefined":return String(f);case"object":return"{}"}},types:{isAsyncFunction:f=>f instanceof s,isArrayBufferView:f=>ArrayBuffer.isView(f)},isBlob:d},l.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")},{buffer:29}],129:[function(t,l,h){const{Buffer:r}=t("buffer"),{ObjectDefineProperty:s,ObjectKeys:g,ReflectApply:d}=t("./ours/primordials"),{promisify:{custom:i}}=t("./ours/util"),{streamReturningOperators:f,promiseReturningOperators:c}=t("./internal/streams/operators"),{codes:{ERR_ILLEGAL_CONSTRUCTOR:n}}=t("./ours/errors"),o=t("./internal/streams/compose"),{pipeline:u}=t("./internal/streams/pipeline"),{destroyer:b}=t("./internal/streams/destroy"),y=t("./internal/streams/end-of-stream"),w=t("./stream/promises"),S=t("./internal/streams/utils"),k=l.exports=t("./internal/streams/legacy").Stream;k.isDisturbed=S.isDisturbed,k.isErrored=S.isErrored,k.isReadable=S.isReadable,k.Readable=t("./internal/streams/readable");for(const I of g(f)){let E=function(...N){if(new.target)throw n();return k.Readable.from(d(A,this,N))};var L=E;const A=f[I];s(E,"name",{__proto__:null,value:A.name}),s(E,"length",{__proto__:null,value:A.length}),s(k.Readable.prototype,I,{__proto__:null,value:E,enumerable:!1,configurable:!0,writable:!0})}for(const I of g(c)){let E=function(...G){if(new.target)throw n();return d(A,this,G)};var L=E;const A=c[I];s(E,"name",{__proto__:null,value:A.name}),s(E,"length",{__proto__:null,value:A.length}),s(k.Readable.prototype,I,{__proto__:null,value:E,enumerable:!1,configurable:!0,writable:!0})}k.Writable=t("./internal/streams/writable"),k.Duplex=t("./internal/streams/duplex"),k.Transform=t("./internal/streams/transform"),k.PassThrough=t("./internal/streams/passthrough"),k.pipeline=u;const{addAbortSignal:j}=t("./internal/streams/add-abort-signal");k.addAbortSignal=j,k.finished=y,k.destroy=b,k.compose=o,s(k,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>w}),s(u,i,{__proto__:null,enumerable:!0,get:()=>w.pipeline}),s(y,i,{__proto__:null,enumerable:!0,get:()=>w.finished}),k.Stream=k,k._isUint8Array=function(I){return I instanceof Uint8Array},k._uint8ArrayToBuffer=function(I){return r.from(I.buffer,I.byteOffset,I.byteLength)}},{"./internal/streams/add-abort-signal":107,"./internal/streams/compose":109,"./internal/streams/destroy":110,"./internal/streams/duplex":111,"./internal/streams/end-of-stream":113,"./internal/streams/legacy":115,"./internal/streams/operators":116,"./internal/streams/passthrough":117,"./internal/streams/pipeline":118,"./internal/streams/readable":119,"./internal/streams/transform":121,"./internal/streams/utils":122,"./internal/streams/writable":123,"./ours/errors":126,"./ours/primordials":127,"./ours/util":128,"./stream/promises":130,buffer:29}],130:[function(t,l,h){const{ArrayPrototypePop:r,Promise:s}=t("../ours/primordials"),{isIterable:g,isNodeStream:d,isWebStream:i}=t("../internal/streams/utils"),{pipelineImpl:f}=t("../internal/streams/pipeline"),{finished:c}=t("../internal/streams/end-of-stream");t("../../lib/stream.js"),l.exports={finished:c,pipeline:function(...n){return new s((o,u)=>{let b,y;const w=n[n.length-1];if(w&&typeof w=="object"&&!d(w)&&!g(w)&&!i(w)){const S=r(n);b=S.signal,y=S.end}f(n,(S,k)=>{S?u(S):o(k)},{signal:b,end:y})})}}},{"../../lib/stream.js":129,"../internal/streams/end-of-stream":113,"../internal/streams/pipeline":118,"../internal/streams/utils":122,"../ours/primordials":127}],131:[function(t,l,h){function r(s,g,d){var i=this;this._callback=s,this._args=d,this._interval=setInterval(s,g,this._args),this.reschedule=function(f){f||(f=i._interval),i._interval&&clearInterval(i._interval),i._interval=setInterval(i._callback,f,i._args)},this.clear=function(){i._interval&&(clearInterval(i._interval),i._interval=void 0)},this.destroy=function(){i._interval&&clearInterval(i._interval),i._callback=void 0,i._interval=void 0,i._args=void 0}}l.exports=function(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("interval needed");var s;if(arguments.length>0){s=new Array(arguments.length-2);for(var g=0;g<s.length;g++)s[g]=arguments[g+2]}return new r(arguments[0],arguments[1],s)}},{}],132:[function(t,l,h){l.exports=t("./index.js")()},{"./index.js":133}],133:[function(t,l,h){(function(r){(function(){function s(g){return g instanceof r?r.from(g):new g.constructor(g.buffer.slice(),g.byteOffset,g.length)}l.exports=function(g){return(g=g||{}).circles?function(i){var f=[],c=[];return i.proto?function o(u){if(typeof u!="object"||u===null)return u;if(u instanceof Date)return new Date(u);if(Array.isArray(u))return n(u,o);if(u instanceof Map)return new Map(n(Array.from(u),o));if(u instanceof Set)return new Set(n(Array.from(u),o));var b={};for(var y in f.push(u),c.push(b),u){var w=u[y];if(typeof w!="object"||w===null)b[y]=w;else if(w instanceof Date)b[y]=new Date(w);else if(w instanceof Map)b[y]=new Map(n(Array.from(w),o));else if(w instanceof Set)b[y]=new Set(n(Array.from(w),o));else if(ArrayBuffer.isView(w))b[y]=s(w);else{var S=f.indexOf(w);b[y]=S!==-1?c[S]:o(w)}}return f.pop(),c.pop(),b}:function o(u){if(typeof u!="object"||u===null)return u;if(u instanceof Date)return new Date(u);if(Array.isArray(u))return n(u,o);if(u instanceof Map)return new Map(n(Array.from(u),o));if(u instanceof Set)return new Set(n(Array.from(u),o));var b={};for(var y in f.push(u),c.push(b),u)if(Object.hasOwnProperty.call(u,y)!==!1){var w=u[y];if(typeof w!="object"||w===null)b[y]=w;else if(w instanceof Date)b[y]=new Date(w);else if(w instanceof Map)b[y]=new Map(n(Array.from(w),o));else if(w instanceof Set)b[y]=new Set(n(Array.from(w),o));else if(ArrayBuffer.isView(w))b[y]=s(w);else{var S=f.indexOf(w);b[y]=S!==-1?c[S]:o(w)}}return f.pop(),c.pop(),b};function n(o,u){for(var b=Object.keys(o),y=new Array(b.length),w=0;w<b.length;w++){var S=b[w],k=o[S];if(typeof k!="object"||k===null)y[S]=k;else if(k instanceof Date)y[S]=new Date(k);else if(ArrayBuffer.isView(k))y[S]=s(k);else{var j=f.indexOf(k);y[S]=j!==-1?c[j]:u(k)}}return y}}(g):g.proto?function i(f){if(typeof f!="object"||f===null)return f;if(f instanceof Date)return new Date(f);if(Array.isArray(f))return d(f,i);if(f instanceof Map)return new Map(d(Array.from(f),i));if(f instanceof Set)return new Set(d(Array.from(f),i));var c={};for(var n in f){var o=f[n];typeof o!="object"||o===null?c[n]=o:o instanceof Date?c[n]=new Date(o):o instanceof Map?c[n]=new Map(d(Array.from(o),i)):o instanceof Set?c[n]=new Set(d(Array.from(o),i)):ArrayBuffer.isView(o)?c[n]=s(o):c[n]=i(o)}return c}:function i(f){if(typeof f!="object"||f===null)return f;if(f instanceof Date)return new Date(f);if(Array.isArray(f))return d(f,i);if(f instanceof Map)return new Map(d(Array.from(f),i));if(f instanceof Set)return new Set(d(Array.from(f),i));var c={};for(var n in f)if(Object.hasOwnProperty.call(f,n)!==!1){var o=f[n];typeof o!="object"||o===null?c[n]=o:o instanceof Date?c[n]=new Date(o):o instanceof Map?c[n]=new Map(d(Array.from(o),i)):o instanceof Set?c[n]=new Set(d(Array.from(o),i)):ArrayBuffer.isView(o)?c[n]=s(o):c[n]=i(o)}return c};function d(i,f){for(var c=Object.keys(i),n=new Array(c.length),o=0;o<c.length;o++){var u=c[o],b=i[u];typeof b!="object"||b===null?n[u]=b:b instanceof Date?n[u]=new Date(b):ArrayBuffer.isView(b)?n[u]=s(b):n[u]=f(b)}return n}}}).call(this)}).call(this,t("buffer").Buffer)},{buffer:29}],134:[function(t,l,h){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var r=t("buffer"),s=r.Buffer;function g(i,f){for(var c in i)f[c]=i[c]}function d(i,f,c){return s(i,f,c)}s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?l.exports=r:(g(r,h),h.Buffer=d),d.prototype=Object.create(s.prototype),g(s,d),d.from=function(i,f,c){if(typeof i=="number")throw new TypeError("Argument must not be a number");return s(i,f,c)},d.alloc=function(i,f,c){if(typeof i!="number")throw new TypeError("Argument must be a number");var n=s(i);return f!==void 0?typeof c=="string"?n.fill(f,c):n.fill(f):n.fill(0),n},d.allocUnsafe=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return s(i)},d.allocUnsafeSlow=function(i){if(typeof i!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(i)}},{buffer:29}],135:[function(t,l,h){l.exports=function(r){var s=r._readableState;return s?s.objectMode||typeof r._duplexState=="number"?r.read():r.read(function(g){return g.buffer.length?g.buffer.head?g.buffer.head.data.length:g.buffer[0].length:g.length}(s)):null}},{}],136:[function(t,l,h){arguments[4][28][0].apply(h,arguments)},{dup:28,"safe-buffer":134}],137:[function(t,l,h){var r=t("punycode"),s=t("./util");function g(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}h.parse=L,h.resolve=function(I,A){return L(I,!1,!0).resolve(A)},h.resolveObject=function(I,A){return I?L(I,!1,!0).resolveObject(A):A},h.format=function(I){return s.isString(I)&&(I=L(I)),I instanceof g?I.format():g.prototype.format.call(I)},h.Url=g;var d=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),n=["'"].concat(c),o=["%","/","?",";","#"].concat(n),u=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,y=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,w={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},k={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=t("querystring");function L(I,A,E){if(I&&s.isObject(I)&&I instanceof g)return I;var N=new g;return N.parse(I,A,E),N}g.prototype.parse=function(I,A,E){if(!s.isString(I))throw new TypeError("Parameter 'url' must be a string, not "+typeof I);var N=I.indexOf("?"),G=N!==-1&&N<I.indexOf("#")?"?":"#",W=I.split(G);W[0]=W[0].replace(/\\/g,"/");var _=I=W.join(G);if(_=_.trim(),!E&&I.split("#").length===1){var R=f.exec(_);if(R)return this.path=_,this.href=_,this.pathname=R[1],R[2]?(this.search=R[2],this.query=A?j.parse(this.search.substr(1)):this.search.substr(1)):A&&(this.search="",this.query={}),this}var T=d.exec(_);if(T){var Y=(T=T[0]).toLowerCase();this.protocol=Y,_=_.substr(T.length)}if(E||T||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var J=_.substr(0,2)==="//";!J||T&&S[T]||(_=_.substr(2),this.slashes=!0)}if(!S[T]&&(J||T&&!k[T])){for(var et,M,C=-1,x=0;x<u.length;x++)(z=_.indexOf(u[x]))!==-1&&(C===-1||z<C)&&(C=z);for((M=C===-1?_.lastIndexOf("@"):_.lastIndexOf("@",C))!==-1&&(et=_.slice(0,M),_=_.slice(M+1),this.auth=decodeURIComponent(et)),C=-1,x=0;x<o.length;x++){var z;(z=_.indexOf(o[x]))!==-1&&(C===-1||z<C)&&(C=z)}C===-1&&(C=_.length),this.host=_.slice(0,C),_=_.slice(C),this.parseHost(),this.hostname=this.hostname||"";var B=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!B)for(var V=this.hostname.split(/\./),$=(x=0,V.length);x<$;x++){var H=V[x];if(H&&!H.match(b)){for(var Z="",X=0,tt=H.length;X<tt;X++)H.charCodeAt(X)>127?Z+="x":Z+=H[X];if(!Z.match(b)){var O=V.slice(0,x),p=V.slice(x+1),m=H.match(y);m&&(O.push(m[1]),p.unshift(m[2])),p.length&&(_="/"+p.join(".")+_),this.hostname=O.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),B||(this.hostname=r.toASCII(this.hostname));var v=this.port?":"+this.port:"",P=this.hostname||"";this.host=P+v,this.href+=this.host,B&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),_[0]!=="/"&&(_="/"+_))}if(!w[Y])for(x=0,$=n.length;x<$;x++){var F=n[x];if(_.indexOf(F)!==-1){var K=encodeURIComponent(F);K===F&&(K=escape(F)),_=_.split(F).join(K)}}var D=_.indexOf("#");D!==-1&&(this.hash=_.substr(D),_=_.slice(0,D));var Q=_.indexOf("?");if(Q!==-1?(this.search=_.substr(Q),this.query=_.substr(Q+1),A&&(this.query=j.parse(this.query)),_=_.slice(0,Q)):A&&(this.search="",this.query={}),_&&(this.pathname=_),k[Y]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){v=this.pathname||"";var rt=this.search||"";this.path=v+rt}return this.href=this.format(),this},g.prototype.format=function(){var I=this.auth||"";I&&(I=(I=encodeURIComponent(I)).replace(/%3A/i,":"),I+="@");var A=this.protocol||"",E=this.pathname||"",N=this.hash||"",G=!1,W="";this.host?G=I+this.host:this.hostname&&(G=I+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(G+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(W=j.stringify(this.query));var _=this.search||W&&"?"+W||"";return A&&A.substr(-1)!==":"&&(A+=":"),this.slashes||(!A||k[A])&&G!==!1?(G="//"+(G||""),E&&E.charAt(0)!=="/"&&(E="/"+E)):G||(G=""),N&&N.charAt(0)!=="#"&&(N="#"+N),_&&_.charAt(0)!=="?"&&(_="?"+_),A+G+(E=E.replace(/[?#]/g,function(R){return encodeURIComponent(R)}))+(_=_.replace("#","%23"))+N},g.prototype.resolve=function(I){return this.resolveObject(L(I,!1,!0)).format()},g.prototype.resolveObject=function(I){if(s.isString(I)){var A=new g;A.parse(I,!1,!0),I=A}for(var E=new g,N=Object.keys(this),G=0;G<N.length;G++){var W=N[G];E[W]=this[W]}if(E.hash=I.hash,I.href==="")return E.href=E.format(),E;if(I.slashes&&!I.protocol){for(var _=Object.keys(I),R=0;R<_.length;R++){var T=_[R];T!=="protocol"&&(E[T]=I[T])}return k[E.protocol]&&E.hostname&&!E.pathname&&(E.path=E.pathname="/"),E.href=E.format(),E}if(I.protocol&&I.protocol!==E.protocol){if(!k[I.protocol]){for(var Y=Object.keys(I),J=0;J<Y.length;J++){var et=Y[J];E[et]=I[et]}return E.href=E.format(),E}if(E.protocol=I.protocol,I.host||S[I.protocol])E.pathname=I.pathname;else{for(var M=(I.pathname||"").split("/");M.length&&!(I.host=M.shift()););I.host||(I.host=""),I.hostname||(I.hostname=""),M[0]!==""&&M.unshift(""),M.length<2&&M.unshift(""),E.pathname=M.join("/")}if(E.search=I.search,E.query=I.query,E.host=I.host||"",E.auth=I.auth,E.hostname=I.hostname||I.host,E.port=I.port,E.pathname||E.search){var C=E.pathname||"",x=E.search||"";E.path=C+x}return E.slashes=E.slashes||I.slashes,E.href=E.format(),E}var z=E.pathname&&E.pathname.charAt(0)==="/",B=I.host||I.pathname&&I.pathname.charAt(0)==="/",V=B||z||E.host&&I.pathname,$=V,H=E.pathname&&E.pathname.split("/")||[],Z=(M=I.pathname&&I.pathname.split("/")||[],E.protocol&&!k[E.protocol]);if(Z&&(E.hostname="",E.port=null,E.host&&(H[0]===""?H[0]=E.host:H.unshift(E.host)),E.host="",I.protocol&&(I.hostname=null,I.port=null,I.host&&(M[0]===""?M[0]=I.host:M.unshift(I.host)),I.host=null),V=V&&(M[0]===""||H[0]==="")),B)E.host=I.host||I.host===""?I.host:E.host,E.hostname=I.hostname||I.hostname===""?I.hostname:E.hostname,E.search=I.search,E.query=I.query,H=M;else if(M.length)H||(H=[]),H.pop(),H=H.concat(M),E.search=I.search,E.query=I.query;else if(!s.isNullOrUndefined(I.search))return Z&&(E.hostname=E.host=H.shift(),(m=!!(E.host&&E.host.indexOf("@")>0)&&E.host.split("@"))&&(E.auth=m.shift(),E.host=E.hostname=m.shift())),E.search=I.search,E.query=I.query,s.isNull(E.pathname)&&s.isNull(E.search)||(E.path=(E.pathname?E.pathname:"")+(E.search?E.search:"")),E.href=E.format(),E;if(!H.length)return E.pathname=null,E.search?E.path="/"+E.search:E.path=null,E.href=E.format(),E;for(var X=H.slice(-1)[0],tt=(E.host||I.host||H.length>1)&&(X==="."||X==="..")||X==="",O=0,p=H.length;p>=0;p--)(X=H[p])==="."?H.splice(p,1):X===".."?(H.splice(p,1),O++):O&&(H.splice(p,1),O--);if(!V&&!$)for(;O--;O)H.unshift("..");!V||H[0]===""||H[0]&&H[0].charAt(0)==="/"||H.unshift(""),tt&&H.join("/").substr(-1)!=="/"&&H.push("");var m,v=H[0]===""||H[0]&&H[0].charAt(0)==="/";return Z&&(E.hostname=E.host=v?"":H.length?H.shift():"",(m=!!(E.host&&E.host.indexOf("@")>0)&&E.host.split("@"))&&(E.auth=m.shift(),E.host=E.hostname=m.shift())),(V=V||E.host&&H.length)&&!v&&H.unshift(""),H.length?E.pathname=H.join("/"):(E.pathname=null,E.path=null),s.isNull(E.pathname)&&s.isNull(E.search)||(E.path=(E.pathname?E.pathname:"")+(E.search?E.search:"")),E.auth=I.auth||E.auth,E.slashes=E.slashes||I.slashes,E.href=E.format(),E},g.prototype.parseHost=function(){var I=this.host,A=i.exec(I);A&&((A=A[0])!==":"&&(this.port=A.substr(1)),I=I.substr(0,I.length-A.length)),I&&(this.hostname=I)}},{"./util":138,punycode:103,querystring:106}],138:[function(t,l,h){l.exports={isString:function(r){return typeof r=="string"},isObject:function(r){return typeof r=="object"&&r!==null},isNull:function(r){return r===null},isNullOrUndefined:function(r){return r==null}}},{}],139:[function(t,l,h){(function(r){(function(){function s(g){try{if(!r.localStorage)return!1}catch{return!1}var d=r.localStorage[g];return d!=null&&String(d).toLowerCase()==="true"}l.exports=function(g,d){if(s("noDeprecation"))return g;var i=!1;return function(){if(!i){if(s("throwDeprecation"))throw new Error(d);s("traceDeprecation")?console.trace(d):console.warn(d),i=!0}return g.apply(this,arguments)}}}).call(this)}).call(this,typeof xt<"u"?xt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],140:[function(t,l,h){l.exports=function r(s,g){if(s&&g)return r(s)(g);if(typeof s!="function")throw new TypeError("need wrapper function");return Object.keys(s).forEach(function(i){d[i]=s[i]}),d;function d(){for(var i=new Array(arguments.length),f=0;f<i.length;f++)i[f]=arguments[f];var c=s.apply(this,i),n=i[i.length-1];return typeof c=="function"&&c!==n&&Object.keys(n).forEach(function(o){c[o]=n[o]}),c}}},{}],141:[function(t,l,h){l.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},{}]},{},[23])(23)})})(gn);var zi=gn.exports;class ge extends Error{constructor(t,l,h,r,s,g){super(h[0]);ft(this,"errorType");ft(this,"errors");ft(this,"validationMessages");ft(this,"innerError");ft(this,"logKey");ft(this,"command");this.command=t,this.errorType=l?"ValidationError":r?"CommunicationError":"ExecutionError",this.innerError=r,this.errors=h,this.validationMessages=s,this.logKey=g}}var Ee;const Ae=class Ae{constructor(e){ft(this,"sliderValue");ft(this,"_brand");this.sliderValue=e??0,gt["CK.Observable.ServerSample.App.ISliderCommand"].set(this)}get commandModel(){return qt(Ae,Ee)}};Ee=new WeakMap,Vt(Ae,Ee,{applyAmbientValues(e,t,l){}});let be=Ae;var ke;const Ce=class Ce{constructor(e,t,l){ft(this,"mqttClientId");ft(this,"domainName");ft(this,"transactionNumber");ft(this,"_brand");this.mqttClientId=e??"",this.domainName=t??"",this.transactionNumber=l??0,gt["CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand"].set(this)}get commandModel(){return qt(Ce,ke)}};ke=new WeakMap,Vt(Ce,ke,{applyAmbientValues(e,t,l){}});let me=Ce;var Te;const Ie=class Ie{constructor(e,t,l){ft(this,"clientId");ft(this,"domainName");ft(this,"transactionNumber");ft(this,"_brand");this.clientId=e??"",this.domainName=t??"",this.transactionNumber=l??0,gt["CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand"].set(this)}get commandModel(){return qt(Ie,Te)}};Te=new WeakMap,Vt(Ie,Te,{applyAmbientValues(e,t,l){}});let ye=Ie;class Ki{constructor(e,t,l){ft(this,"result");ft(this,"validationMessages");ft(this,"correlationId");ft(this,"_brand");this.result=e,this.validationMessages=t,this.correlationId=l,gt.AspNetResult.set(this)}}class bn{constructor(e,t,l){ft(this,"isValidationError");ft(this,"errors");ft(this,"logKey");ft(this,"_brand");this.isValidationError=e??!1,this.errors=t??[],this.logKey=l,gt.AspNetCrisResultError.set(this)}}class Gi{constructor(e,t,l,h){ft(this,"currentCultureName");ft(this,"actorId");ft(this,"actualActorId");ft(this,"deviceId");ft(this,"_brand");this.currentCultureName=e??"",this.actorId=t??0,this.actualActorId=l??0,this.deviceId=h??"",gt["CK.Cris.AmbientValues.IAmbientValues"].set(this)}}var Ft;(function(a){a[a.None=0]="None",a[a.Info=4]="Info",a[a.Warn=8]="Warn",a[a.Error=16]="Error"})(Ft||(Ft={}));var Re;const Lt=class Lt{constructor(e,t,l=0){ft(this,"level");ft(this,"message");ft(this,"depth");this.level=e,this.message=t,this.depth=l,gt.SimpleUserMessage.set(this)}static get invalid(){return qt(Lt,Re)??wr(Lt,Re,new Lt(Ft.None,"",0))}toString(){return"["+Ft[this.level]+"] "+this.message}toJSON(){return this.level!==Ft.None?[this.level,this.message,this.depth]:[0]}static parse(e){if(e instanceof Array){if(e.length===1){if(e[0]===0)return Lt.invalid}else if(e.length==3){const t=e[0];if(t===Ft.Info||t===Ft.Warn||t===Ft.Error){const l=e[1];if(typeof l=="string"){const h=e[2];if(typeof h=="number"&&h>=0&&h<=255)return new Lt(t,l,h)}}}}throw new Error("Unable to parse '{{o}}' as SimpleUserMessage.")}};Re=new WeakMap,Vt(Lt,Re,void 0);let tr=Lt;const gt={toTypedJson(a){if(a==null)return null;const e=a[kt];if(!e)throw new Error("Untyped object. A type must be specified with CTSType.");return[e.name,e.json(a)]},fromTypedJson(a){if(a==null)return;if(!(a instanceof Array&&a.length===2))throw new Error("Expected 2-cells array.");var e=gt[a[0]];if(!e)throw new Error(`Invalid type name: ${a[0]}.`);if(!e.set)throw new Error(`Type name '${a[0]}' is not serializable.`);const t=e.nosj(a[1]);return t!==null&&typeof t=="object"?e.set(t):t},stringify(a,e=!0){var t=gt.toTypedJson(a);return JSON.stringify(e?t:t[1])},parse(a){return gt.fromTypedJson(JSON.parse(a))},"CK.Observable.ServerSample.App.ISliderCommand":{name:"CK.Observable.ServerSample.App.ISliderCommand",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new be(gt.float.nosj(a.sliderValue))}},"CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand":{name:"CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new me(gt.string.nosj(a.mqttClientId),gt.string.nosj(a.domainName),gt.int.nosj(a.transactionNumber))}},"CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand":{name:"CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new ye(gt.string.nosj(a.clientId),gt.string.nosj(a.domainName),gt.int.nosj(a.transactionNumber))}},AspNetResult:{name:"AspNetResult",set(a){return a[kt]=this,a},json(a){if(!a)return null;let e={};return e.result=gt.toTypedJson(a.result),e.validationMessages=a.validationMessages,e.correlationId=a.correlationId,e},nosj(a){if(a!=null)return new Ki(gt.fromTypedJson(a.result),gt["L(SimpleUserMessage)"].nosj(a.validationMessages),gt.string.nosj(a.correlationId))}},AspNetCrisResultError:{name:"AspNetCrisResultError",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new bn(gt.bool.nosj(a.isValidationError),gt["L(string)"].nosj(a.errors),gt.string.nosj(a.logKey))}},"CK.Cris.AmbientValues.IAmbientValues":{name:"CK.Cris.AmbientValues.IAmbientValues",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new Gi(gt.string.nosj(a.currentCultureName),gt.int.nosj(a.actorId),gt.int.nosj(a.actualActorId),gt.string.nosj(a.deviceId))}},"CK.Cris.AmbientValues.IAmbientValuesCollectCommand":{name:"CK.Cris.AmbientValues.IAmbientValuesCollectCommand",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a!=null)return new _e}},"CK.Cris.ICommand<CK.Cris.AmbientValues.IAmbientValues>":{name:"CK.Cris.ICommand<CK.Cris.AmbientValues.IAmbientValues>"},string:{name:"string",set(a){return a=Object(a),a[kt]=this,a},json(a){return a},nosj(a){return a??void 0}},"CK.Cris.ICommand<string>":{name:"CK.Cris.ICommand<string>"},"CK.Cris.ICommand":{name:"CK.Cris.ICommand"},"CK.Cris.IAbstractCommand":{name:"CK.Cris.IAbstractCommand"},"CK.Cris.ICrisPoco":{name:"CK.Cris.ICrisPoco"},"CK.Core.IPoco":{name:"CK.Core.IPoco"},int:{name:"int",set(a){return a=Object(a),a[kt]=this,a},json(a){return a},nosj(a){return a??void 0}},bool:{name:"bool",set(a){return a=Object(a),a[kt]=this,a},json(a){return a},nosj(a){return a??void 0}},object:{name:"object"},SimpleUserMessage:{name:"SimpleUserMessage",set(a){return a[kt]=this,a},json(a){return a},nosj(a){return a!=null?tr.parse(a):void 0}},"L(SimpleUserMessage)":{name:"L(SimpleUserMessage)",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a==null)return;if(!(a instanceof Array))throw new Error("Expected Array.");const e=gt.SimpleUserMessage;return a.map(e.nosj)}},"L(string?)":{name:"L(string?)",set(a){return a[kt]=this,a},json(a){return a},nosj(a){if(a==null)return;if(!(a instanceof Array))throw new Error("Expected Array.");const e=gt.string;return a.map(e.nosj)}},"L(string)":{name:"L(string)",json(a){return a},nosj(a){if(a==null)return;if(!(a instanceof Array))throw new Error("Expected Array.");const e=gt.string;return a.map(e.nosj)}},float:{name:"float",set(a){return a=Object(a),a[kt]=this,a},json(a){return a},nosj(a){return a??void 0}}},kt=Symbol.for("CK.CTSType");var Oe;const Pe=class Pe{constructor(){ft(this,"_brand");gt["CK.Cris.AmbientValues.IAmbientValuesCollectCommand"].set(this)}get commandModel(){return qt(Pe,Oe)}};Oe=new WeakMap,Vt(Pe,Oe,{applyAmbientValues(e,t,l){}});let _e=Pe;class Qi{constructor(){ft(this,"currentCultureName");ft(this,"actorId");ft(this,"actualActorId");ft(this,"deviceId");this.currentCultureName=null,this.actorId=null,this.actualActorId=null,this.deviceId=null}}class Yi{constructor(){ft(this,"_ambientValuesRequest");ft(this,"_ambientValues");ft(this,"_subscribers");ft(this,"_isConnected");ft(this,"ambientValuesOverride");this.ambientValuesOverride=new Qi,this._isConnected=!1,this._subscribers=new Set}get isConnected(){return this._isConnected}addOnIsConnectedChanged(e){e&&this._subscribers.add(e)}removeOnIsConnectedChange(e){return this._subscribers.delete(e)}setIsConnected(e){this._isConnected!==e&&(this._isConnected=e,e||this.updateAmbientValuesAsync(),this._subscribers.forEach(t=>t(this)))}updateAmbientValuesAsync(){return this._ambientValuesRequest?this._ambientValuesRequest:(this._ambientValues=void 0,this._ambientValuesRequest=this.waitForAmbientValuesAsync())}async sendAsync(e){let t=this._ambientValues;return t===void 0&&(t=await this.updateAmbientValuesAsync()),e.commandModel.applyAmbientValues(e,t,this.ambientValuesOverride),await this.doSendAsync(e)}async sendOrThrowAsync(e){const t=await this.sendAsync(e);if(t.result instanceof ge)throw t.result;return t.result}async waitForAmbientValuesAsync(){for(;;){var e=await this.doSendAsync(new _e);if(e.result instanceof ge)console.error("Error while getting AmbientValues. Retrying.",e.result),this.setIsConnected(!1);else return this._ambientValuesRequest=void 0,this._ambientValues=e.result,this.setIsConnected(!0),this._ambientValues}}}const Ji={responseType:"text",headers:{common:new Vi({"Content-Type":"application/json"})}};class Xi extends Yi{constructor(t,l){super();ft(this,"axios");ft(this,"crisEndpointUrl");ft(this,"axiosConfig");this.axios=t,this.crisEndpointUrl=l,this.axiosConfig=Ji}async doSendAsync(t){try{const h=JSON.stringify(gt.toTypedJson(t)),r=await this.axios.post(this.crisEndpointUrl,h,this.axiosConfig),s=gt.AspNetResult.nosj(JSON.parse(r.data));let g=s.result;return g instanceof bn&&(g=new ge(t,g.isValidationError,g.errors,void 0,s.validationMessages,g.logKey)),{command:t,result:g,validationMessages:s.validationMessages,correlationId:s.correlationId}}catch(h){var l;return h instanceof Error?l=h:(console.error(h),l=new Error(`Unhandled error ${h}.`)),this.setIsConnected(!1),{command:t,result:new ge(t,!1,["Communication error"],l)}}}}class Zi{constructor(e,t,l){ft(this,"serverUrl");ft(this,"crisEndpoint");ft(this,"mqttTopic");ft(this,"client");ft(this,"clientId");ft(this,"messageHandlers",[]);ft(this,"closeHandlers",[e=>console.log("mqtt disconnected: "+e)]);this.serverUrl=e,this.crisEndpoint=t,this.mqttTopic=l,this.clientId="od-watcher-"+crypto.randomUUID()}async startListeningAsync(e){const t={},l=e.map(async h=>{const r=new me(this.clientId,h.domainName,h.transactionCount),s=await this.crisEndpoint.sendOrThrowAsync(r);s?t[h.domainName]=JSON.parse(s):(console.warn(`Domain ${h.domainName} doesn't exists.`),t[h.domainName]="")});return await Promise.all(l),t}async startAsync(){try{return console.log(`connecting to mqtt with client id ${this.clientId}...`),this.client=await zi.connectAsync(this.serverUrl,{clean:!0,clientId:this.clientId}),this.client.on("message",(e,t,l)=>this.handleMessages(e,t,l)),this.client.on("disconnect",e=>this.handleClose(void 0)),console.log("connected"),!0}catch(e){return console.log("not connected"),console.error(e),!1}}handleMessages(e,t,l){if(console.log("Received MQTT message."),!e.startsWith(this.mqttTopic))return;const h=t.readInt32LE(),r=t.toString("utf-8",4,h+4),s=t.readInt32LE(4+h),g=t.toString("utf-8",4+4+h,4+4+h+s);this.messageHandlers.forEach(d=>{d(r,JSON.parse(g))})}handleClose(e){this.closeHandlers.forEach(t=>{t(e)})}onMessage(e){this.messageHandlers.push(e)}onClose(e){this.closeHandlers.push(e)}stopAsync(){return this.client.endAsync(!0)}}function xr(a,e){const{prefix:t,activator:l}=Object.assign({prefix:"~$£€"},e),h=t+">",r=t+"°",s=t+"þ";let g=null,d=null;const i=[];function f(u,b){let y=null;if(b instanceof Array)if(b.length>0&&b[0]!=null&&(y=b[0][s])!==void 0){switch(b.splice(0,1),y[1]){case"A":break;case"M":b=Object.assign(new Map,{v:b});break;case"S":b=Object.assign(new Set,{v:b});break;default:throw new Error("Expecting typed array to be 'A', 'M' or 'S'.")}i[y[0]]=b}else d===null&&(d=new Set),d.add(b);else if(b!==null){const w=b[r];w!==void 0?(delete b[r],(y=b[s])!==void 0&&(delete b[s],l&&(b=l(b,y),b&&(g===null&&(g=new Set),g.add(b)))),i[w]=b):(d===null&&(d=new Set),d.add(b))}return b}function c(u){if(u){if(u instanceof Array)for(let b=0;b<u.length;++b){const y=u[b];c(y),u[b]=f(b,y)}else if(typeof u=="object")for(const b in u){const y=u[b];c(y),u[b]=f(b,y)}}return u}const n=typeof a=="string"?JSON.parse(a,f):f(void 0,c(a));function o(u,b){const y=b.length;for(let w=0;w<y;++w){const S=b[w];if(S){const k=S[h];k!==void 0&&(b[w]=u[k])}}}for(let u of i)if(g===null||!g.has(u))if(u instanceof Array)o(i,u);else if(u instanceof Map)u.v.forEach(b=>o(i,b)),u.v.forEach(b=>u.set(b[0],b[1])),delete u.v;else if(u instanceof Set)o(i,u.v),u.v.forEach(b=>u.add(b)),delete u.v;else for(const b in u){const y=u[b];if(y!==null){const w=y[h];w!==void 0&&(u[b]=i[w])}}if(d!==null)for(let u of d)if(u instanceof Array)o(i,u);else for(const b in u){const y=u[b];if(y!==null){const w=y[h];w!==void 0&&(u[b]=i[w])}}return n}var to=globalThis&&globalThis.__generator||function(a,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},l,h,r,s;return s={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function g(i){return function(f){return d([i,f])}}function d(i){if(l)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(t=0)),t;)try{if(l=1,h&&(r=i[0]&2?h.return:i[0]?h.throw||((r=h.return)&&r.call(h),0):h.next)&&!(r=r.call(h,i[1])).done)return r;switch(h=0,r&&(i=[i[0]&2,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return t.label++,{value:i[1],done:!1};case 5:t.label++,h=i[1],i=[0];continue;case 7:i=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(i[0]===6||i[0]===2)){t=0;continue}if(i[0]===3&&(!r||i[1]>r[0]&&i[1]<r[3])){t.label=i[1];break}if(i[0]===6&&t.label<r[1]){t.label=r[1],r=i;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(i);break}r[2]&&t.ops.pop(),t.trys.pop();continue}i=e.call(a,t)}catch(f){i=[6,f],h=0}finally{l=r=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},se=function(){function a(e){var t=this;if(this._isInitialExport=!0,e===void 0)this._props=[],this._tranNum=0,this._objCount=0,this._graph=[],this._roots=[];else{var l=typeof e=="string"?xr(e,{prefix:""}):e;this._props=l.P,this._tranNum=l.N,this._objCount=l.C,this._graph=l.O,this._roots=l.R.map(function(h){return t._graph[h]})}}return Object.defineProperty(a.prototype,"transactionNumber",{get:function(){return this._tranNum},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"allObjectsCount",{get:function(){return this._objCount},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"allObjects",{get:function(){function e(t){var l,h,r;return to(this,function(s){switch(s.label){case 0:l=0,h=t,s.label=1;case 1:return l<h.length?(r=h[l],r===null?[3,3]:[4,r]):[3,4];case 2:s.sent(),s.label=3;case 3:return l++,[3,1];case 4:return[2]}})}return e(this._graph)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"roots",{get:function(){return this._roots},enumerable:!1,configurable:!0}),a.isTransactionSetEvent=function(e){return e===""?!1:"E"in e},a.isDomainExportEvent=function(e){return e===""?!1:"P"in e},a.isErrorEvent=function(e){return e===""?!1:"Error"in e},a.prototype.applyWatchEvent=function(e){if(e===""){this._props.length=0,this._objCount=0,this._graph.length=0,this._roots.length=0,console.warn("Empty OD watch event.");return}if(e=xr(e,{prefix:""}),a.isTransactionSetEvent(e)){var t=e.N-e.E.length+1;if(e.L)if(e.L!==this._tranNum)if(this._tranNum>e.L&&this._tranNum<e.N&&this._isInitialExport)console.warn("Event claims last event was TN ".concat(e.L,", current TN is ").concat(this._tranNum,". Accepting partial event.")),this._tranNum=t-1;else throw new Error("Event claims last event was TN ".concat(e.L,", current TN is ").concat(this._tranNum));else this._tranNum=t-1;for(var l=0;l<e.E.length;l++)this.applyEvent(t+l,e.E[l])}else if(a.isDomainExportEvent(e))this.applyDomainExport(e);else throw e===""?new Error("The watch event received is empty. The domain doesn't exist (or has been destroyed)."):a.isErrorEvent(e)?new Error("Domain error: "+e.Error):new Error("Unknown WatchEvent: "+JSON.stringify(e,void 0,4))},a.prototype.applyDomainExport=function(e){this._props.splice(0,this._props.length);for(var t=0;t<e.P.length;t++)this._props.push(e.P[t]);this._tranNum=e.N,this._objCount=e.C,this._graph.splice(0,this._graph.length);for(var t=0;t<e.O.length;t++)this._graph.push(e.O[t]);this._roots.splice(0,this._roots.length);for(var t=0;t<e.R.length;t++)this._roots.push(this._graph[e.R[t]]);this._isInitialExport=!0},a.prototype.applyEvent=function(e,t){var l=this;if(this._tranNum+1!==e)throw new Error("Invalid transaction number. Expected: ".concat(this._tranNum+1,", got ").concat(e,"."));for(var h=new Set,r=t,s=0;s<r.length;++s){var g=r[s],d=g[0];switch(d){case"N":{var i=void 0;switch(g[2]){case"":i={};break;case"A":i=[];break;case"M":i=new Map;break;case"S":i=new Set;break;default:throw new Error("Unexpected Object type; ".concat(g[2],". Must be A, M, S or empty string."))}h.delete(g[1]),this._graph[g[1]]=i,this._objCount++;break}case"D":{h.add(g[1]),this._objCount--;break}case"P":{if(g[2]!=this._props.length)throw new Error("Invalid property creation event for '".concat(g[1],"': index must be ").concat(this._props.length,", got ").concat(g[2],"."));this._props.push(g[1]);break}case"C":{this._graph[g[1]][this._props[g[2]]]=this.getValue(g[3]);break}case"I":{var f=this._graph[g[1]],c=g[2],n=this.getValue(g[3]);c===f.length?f[c]=n:f.splice(c,0,n);break}case"CL":{var o=this._graph[g[1]];o instanceof Array?o.length=0:o.clear();break}case"R":{this._graph[g[1]].splice(g[2],1);break}case"S":{this._graph[g[1]].splice(g[2],1,this.getValue(g[3]));break}case"K":{this._graph[g[1]].delete(this.getValue(g[2]));break}case"M":{this._graph[g[1]].set(this.getValue(g[2]),this.getValue(g[3]));break}case"A":{this._graph[g[1]].add(this.getValue(g[2]));break}default:throw new Error("Unexpected Event code: '".concat(g[0],"'."))}}h.forEach(function(u){return l._graph[u]=null}),this._tranNum=e,this._isInitialExport=!1},a.prototype.getValue=function(e){if(e!=null){var t=e["="];if(t!==void 0)return this._graph[t]}return e},a}(),er=function(a,e){return er=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,l){t.__proto__=l}||function(t,l){for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(t[h]=l[h])},er(a,e)};function ie(a,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");er(a,e);function t(){this.constructor=a}a.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function rr(a){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&a[e],l=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&l>=a.length&&(a=void 0),{value:a&&a[l++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function we(a,e){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var l=t.call(a),h,r=[],s;try{for(;(e===void 0||e-- >0)&&!(h=l.next()).done;)r.push(h.value)}catch(g){s={error:g}}finally{try{h&&!h.done&&(t=l.return)&&t.call(l)}finally{if(s)throw s.error}}return r}function ve(a,e,t){if(t||arguments.length===2)for(var l=0,h=e.length,r;l<h;l++)(r||!(l in e))&&(r||(r=Array.prototype.slice.call(e,0,l)),r[l]=e[l]);return a.concat(r||Array.prototype.slice.call(e))}function Dt(a){return typeof a=="function"}function mn(a){var e=function(l){Error.call(l),l.stack=new Error().stack},t=a(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var ze=mn(function(a){return function(t){a(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(l,h){return h+1+") "+l.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function nr(a,e){if(a){var t=a.indexOf(e);0<=t&&a.splice(t,1)}}var De=function(){function a(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return a.prototype.unsubscribe=function(){var e,t,l,h,r;if(!this.closed){this.closed=!0;var s=this._parentage;if(s)if(this._parentage=null,Array.isArray(s))try{for(var g=rr(s),d=g.next();!d.done;d=g.next()){var i=d.value;i.remove(this)}}catch(b){e={error:b}}finally{try{d&&!d.done&&(t=g.return)&&t.call(g)}finally{if(e)throw e.error}}else s.remove(this);var f=this.initialTeardown;if(Dt(f))try{f()}catch(b){r=b instanceof ze?b.errors:[b]}var c=this._finalizers;if(c){this._finalizers=null;try{for(var n=rr(c),o=n.next();!o.done;o=n.next()){var u=o.value;try{jr(u)}catch(b){r=r??[],b instanceof ze?r=ve(ve([],we(r)),we(b.errors)):r.push(b)}}}catch(b){l={error:b}}finally{try{o&&!o.done&&(h=n.return)&&h.call(n)}finally{if(l)throw l.error}}}if(r)throw new ze(r)}},a.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)jr(e);else{if(e instanceof a){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},a.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},a.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},a.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&nr(t,e)},a.prototype.remove=function(e){var t=this._finalizers;t&&nr(t,e),e instanceof a&&e._removeParent(this)},a.EMPTY=function(){var e=new a;return e.closed=!0,e}(),a}(),yn=De.EMPTY;function _n(a){return a instanceof De||a&&"closed"in a&&Dt(a.remove)&&Dt(a.add)&&Dt(a.unsubscribe)}function jr(a){Dt(a)?a():a.unsubscribe()}var wn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ir={setTimeout:function(a,e){for(var t=[],l=2;l<arguments.length;l++)t[l-2]=arguments[l];var h=ir.delegate;return h!=null&&h.setTimeout?h.setTimeout.apply(h,ve([a,e],we(t))):setTimeout.apply(void 0,ve([a,e],we(t)))},clearTimeout:function(a){var e=ir.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(a)},delegate:void 0};function eo(a){ir.setTimeout(function(){throw a})}function Mr(){}function de(a){a()}var vn=function(a){ie(e,a);function e(t){var l=a.call(this)||this;return l.isStopped=!1,t?(l.destination=t,_n(t)&&t.add(l)):l.destination=oo,l}return e.create=function(t,l,h){return new or(t,l,h)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,a.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(De),ro=Function.prototype.bind;function Ke(a,e){return ro.call(a,e)}var no=function(){function a(e){this.partialObserver=e}return a.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(l){ae(l)}},a.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(l){ae(l)}else ae(e)},a.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){ae(t)}},a}(),or=function(a){ie(e,a);function e(t,l,h){var r=a.call(this)||this,s;if(Dt(t)||!t)s={next:t??void 0,error:l??void 0,complete:h??void 0};else{var g;r&&wn.useDeprecatedNextContext?(g=Object.create(t),g.unsubscribe=function(){return r.unsubscribe()},s={next:t.next&&Ke(t.next,g),error:t.error&&Ke(t.error,g),complete:t.complete&&Ke(t.complete,g)}):s=t}return r.destination=new no(s),r}return e}(vn);function ae(a){eo(a)}function io(a){throw a}var oo={closed:!0,next:Mr,error:io,complete:Mr},so=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ao(a){return a}function lo(a){return a.length===0?ao:a.length===1?a[0]:function(t){return a.reduce(function(l,h){return h(l)},t)}}var Nr=function(){function a(e){e&&(this._subscribe=e)}return a.prototype.lift=function(e){var t=new a;return t.source=this,t.operator=e,t},a.prototype.subscribe=function(e,t,l){var h=this,r=uo(e)?e:new or(e,t,l);return de(function(){var s=h,g=s.operator,d=s.source;r.add(g?g.call(r,d):d?h._subscribe(r):h._trySubscribe(r))}),r},a.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},a.prototype.forEach=function(e,t){var l=this;return t=Lr(t),new t(function(h,r){var s=new or({next:function(g){try{e(g)}catch(d){r(d),s.unsubscribe()}},error:r,complete:h});l.subscribe(s)})},a.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},a.prototype[so]=function(){return this},a.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return lo(e)(this)},a.prototype.toPromise=function(e){var t=this;return e=Lr(e),new e(function(l,h){var r;t.subscribe(function(s){return r=s},function(s){return h(s)},function(){return l(r)})})},a.create=function(e){return new a(e)},a}();function Lr(a){var e;return(e=a??wn.Promise)!==null&&e!==void 0?e:Promise}function co(a){return a&&Dt(a.next)&&Dt(a.error)&&Dt(a.complete)}function uo(a){return a&&a instanceof vn||co(a)&&_n(a)}var ho=mn(function(a){return function(){a(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Sn=function(a){ie(e,a);function e(){var t=a.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var l=new Br(this,this);return l.operator=t,l},e.prototype._throwIfClosed=function(){if(this.closed)throw new ho},e.prototype.next=function(t){var l=this;de(function(){var h,r;if(l._throwIfClosed(),!l.isStopped){l.currentObservers||(l.currentObservers=Array.from(l.observers));try{for(var s=rr(l.currentObservers),g=s.next();!g.done;g=s.next()){var d=g.value;d.next(t)}}catch(i){h={error:i}}finally{try{g&&!g.done&&(r=s.return)&&r.call(s)}finally{if(h)throw h.error}}}})},e.prototype.error=function(t){var l=this;de(function(){if(l._throwIfClosed(),!l.isStopped){l.hasError=l.isStopped=!0,l.thrownError=t;for(var h=l.observers;h.length;)h.shift().error(t)}})},e.prototype.complete=function(){var t=this;de(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var l=t.observers;l.length;)l.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),a.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var l=this,h=this,r=h.hasError,s=h.isStopped,g=h.observers;return r||s?yn:(this.currentObservers=null,g.push(t),new De(function(){l.currentObservers=null,nr(g,t)}))},e.prototype._checkFinalizedStatuses=function(t){var l=this,h=l.hasError,r=l.thrownError,s=l.isStopped;h?t.error(r):s&&t.complete()},e.prototype.asObservable=function(){var t=new Nr;return t.source=this,t},e.create=function(t,l){return new Br(t,l)},e}(Nr),Br=function(a){ie(e,a);function e(t,l){var h=a.call(this)||this;return h.destination=t,h.source=l,h}return e.prototype.next=function(t){var l,h;(h=(l=this.destination)===null||l===void 0?void 0:l.next)===null||h===void 0||h.call(l,t)},e.prototype.error=function(t){var l,h;(h=(l=this.destination)===null||l===void 0?void 0:l.error)===null||h===void 0||h.call(l,t)},e.prototype.complete=function(){var t,l;(l=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||l===void 0||l.call(t)},e.prototype._subscribe=function(t){var l,h;return(h=(l=this.source)===null||l===void 0?void 0:l.subscribe(t))!==null&&h!==void 0?h:yn},e}(Sn),Dr=function(a){ie(e,a);function e(t){var l=a.call(this)||this;return l._value=t,l}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var l=a.prototype._subscribe.call(this,t);return!l.closed&&t.next(this._value),l},e.prototype.getValue=function(){var t=this,l=t.hasError,h=t.thrownError,r=t._value;if(l)throw h;return this._throwIfClosed(),r},e.prototype.next=function(t){a.prototype.next.call(this,this._value=t)},e}(Sn),Ge=globalThis&&globalThis.__awaiter||function(a,e,t,l){function h(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function g(f){try{i(l.next(f))}catch(c){s(c)}}function d(f){try{i(l.throw(f))}catch(c){s(c)}}function i(f){f.done?r(f.value):h(f.value).then(g,d)}i((l=l.apply(a,e||[])).next())})},le=globalThis&&globalThis.__generator||function(a,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},l,h,r,s;return s={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function g(i){return function(f){return d([i,f])}}function d(i){if(l)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(t=0)),t;)try{if(l=1,h&&(r=i[0]&2?h.return:i[0]?h.throw||((r=h.return)&&r.call(h),0):h.next)&&!(r=r.call(h,i[1])).done)return r;switch(h=0,r&&(i=[i[0]&2,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return t.label++,{value:i[1],done:!1};case 5:t.label++,h=i[1],i=[0];continue;case 7:i=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(i[0]===6||i[0]===2)){t=0;continue}if(i[0]===3&&(!r||i[1]>r[0]&&i[1]<r[3])){t.label=i[1];break}if(i[0]===6&&t.label<r[1]){t.label=r[1],r=i;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(i);break}r[2]&&t.ops.pop(),t.trys.pop();continue}i=e.call(a,t)}catch(f){i=[6,f],h=0}finally{l=r=0}if(i[0]&5)throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},$t;(function(a){a[a.Disconnected=0]="Disconnected",a[a.Connected=1]="Connected",a[a.CatchingUp=2]="CatchingUp"})($t||($t={}));var Ur=function(){function a(e){var t=this;this.driver=e,this.connectionState=new Dr($t.Disconnected),this.connectionState$=this.connectionState.asObservable(),this.stopping=!1,this.buffering=!1,this.bufferedEvents=[],this.domains={},this.onClose=function(l){t.onCloseHandler!=null&&t.onCloseHandler(l)},this.onMessage=function(l,h){var r=t.domains[l];if(r===void 0){console.log("Received event for unknown domain ".concat(l,", ignoring this event."));return}if(t.buffering){console.log("OD Client is starting, buffering an event for "+l),t.bufferedEvents.push({domainName:l,watchEvent:h});return}try{if(se.isTransactionSetEvent(h)){if(h.N<=r.domain.transactionNumber){console.warn("Ignoring received past event. Current TN: ".concat(r.domain.transactionNumber,". New TN: ").concat(h.N));return}console.log("Received OD event for domain ".concat(l,". Current TN: ").concat(r.domain.transactionNumber,". New TN: ").concat(h.N))}else se.isDomainExportEvent(h)&&console.log("Received domain export for domain ".concat(l,". New TN: ").concat(h.N));r.domain.applyWatchEvent(h),r.obs.next(r.domain.roots)}catch(s){console.error(s),r.domain=new se,t.driver.stopAsync();return}},this.driver.onMessage(this.onMessage),this.driver.onClose(this.onClose)}return Object.defineProperty(a.prototype,"domainsRoots",{get:function(){var e=this,t={};return Object.keys(this.domains).forEach(function(l){t[l]=e.domains[l].domain.roots}),t},enumerable:!1,configurable:!0}),a.prototype.start=function(){this.loopReconnectAsync()},a.prototype.listenToDomainAsync=function(e){return Ge(this,void 0,void 0,function(){var t,l,h;return le(this,function(r){switch(r.label){case 0:return this.domains[e]!==void 0?[3,2]:(t=new se,l=new Dr(t.roots),this.domains[e]={domain:t,obs:l},this.connectionState.value==$t.Disconnected?[3,2]:[4,this.driver.startListeningAsync([{domainName:e,transactionCount:0}])]);case 1:h=r.sent()[e],t.applyWatchEvent(h),r.label=2;case 2:return[2,this.domains[e].obs]}})})},a.prototype.loopReconnectAsync=function(){return Ge(this,void 0,void 0,function(){var e,t,l=this;return le(this,function(h){switch(h.label){case 0:e=function(){var r,s,g,d,i;return le(this,function(f){switch(f.label){case 0:return f.trys.push([0,4,5,6]),t.buffering=!0,t.bufferedEvents=[],[4,t.driver.startAsync()];case 1:return f.sent()?(t.connectionState.next($t.CatchingUp),[4,t.driver.startListeningAsync(Object.keys(t.domains).map(function(c){var n,o;return{domainName:c,transactionCount:(o=(n=l.domains[c])===null||n===void 0?void 0:n.domain.transactionNumber)!==null&&o!==void 0?o:0}}))]):[2,"continue"];case 2:for(r=f.sent(),t.buffering=!1,Object.keys(r).forEach(function(c){l.onMessage(c,r[c]);var n=l.domains[c];console.log("Domain ".concat(c,": ").concat(n.domain.allObjectsCount," objects. ")+"".concat(n.domain.roots.length," root(s). Current Transaction Number: ").concat(n.domain.transactionNumber))}),s=0,g=t.bufferedEvents;s<g.length;s++)d=g[s],t.onMessage(d.domainName,d.watchEvent);return t.connectionState.next($t.Connected),[4,new Promise(function(c){l.onCloseHandler=function(n){n!=null?console.log("OD driver Disconnected due to : "+n):console.log("OD driver Disconnected for an unknown reason"),c()}})];case 3:return f.sent(),[3,6];case 4:return i=f.sent(),console.error("Error in OD reconnect loop:",i),[3,6];case 5:return t.connectionState.next($t.Disconnected),t.driver.stopAsync(),[7];case 6:return[2]}})},t=this,h.label=1;case 1:return this.stopping?[3,3]:[5,e()];case 2:return h.sent(),[3,1];case 3:return[2]}})})},a.prototype.stopAsync=function(){return Ge(this,void 0,void 0,function(){return le(this,function(e){switch(e.label){case 0:return this.stopping=!0,[4,this.driver.stopAsync()];case 1:return e.sent(),this.connectionState.complete(),[2]}})})},a}();class Kt extends Error{constructor(e,t){const l=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=l}}class dr extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class Zt extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class fo extends Error{constructor(e,t){const l=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=l}}class po extends Error{constructor(e,t){const l=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=l}}class go extends Error{constructor(e,t){const l=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=l}}class bo extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class mo extends Error{constructor(e,t){const l=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=l}}class En{constructor(e,t,l){this.statusCode=e,this.statusText=t,this.content=l}}class pr{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}var ot;(function(a){a[a.Trace=0]="Trace",a[a.Debug=1]="Debug",a[a.Information=2]="Information",a[a.Warning=3]="Warning",a[a.Error=4]="Error",a[a.Critical=5]="Critical",a[a.None=6]="None"})(ot||(ot={}));class te{constructor(){}log(e,t){}}te.instance=new te;const yo="6.0.23";class St{static isRequired(e,t){if(e==null)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,l){if(!(e in t))throw new Error(`Unknown ${l} value: ${e}.`)}}class Et{static get isBrowser(){return typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return typeof self=="object"&&"importScripts"in self}static get isReactNative(){return typeof window=="object"&&typeof window.document>"u"}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function ee(a,e){let t="";return gr(a)?(t=`Binary data of length ${a.byteLength}`,e&&(t+=`. Content: '${_o(a)}'`)):typeof a=="string"&&(t=`String data of length ${a.length}`,e&&(t+=`. Content: '${a}'`)),t}function _o(a){const e=new Uint8Array(a);let t="";return e.forEach(l=>{const h=l<16?"0":"";t+=`0x${h}${l.toString(16)} `}),t.substr(0,t.length-1)}function gr(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}async function An(a,e,t,l,h,r,s){let g={};if(h){const n=await h();n&&(g={Authorization:`Bearer ${n}`})}const[d,i]=Gt();g[d]=i,a.log(ot.Trace,`(${e} transport) sending data. ${ee(r,s.logMessageContent)}.`);const f=gr(r)?"arraybuffer":"text",c=await t.post(l,{content:r,headers:{...g,...s.headers},responseType:f,timeout:s.timeout,withCredentials:s.withCredentials});a.log(ot.Trace,`(${e} transport) request complete. Response status: ${c.statusCode}.`)}function wo(a){return a===void 0?new Se(ot.Information):a===null?te.instance:a.log!==void 0?a:new Se(a)}class vo{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(t=>{})}}class Se{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const l=`[${new Date().toISOString()}] ${ot[e]}: ${t}`;switch(e){case ot.Critical:case ot.Error:this.out.error(l);break;case ot.Warning:this.out.warn(l);break;case ot.Information:this.out.info(l);break;default:this.out.log(l);break}}}}function Gt(){let a="X-SignalR-User-Agent";return Et.isNode&&(a="User-Agent"),[a,So(yo,Eo(),ko(),Ao())]}function So(a,e,t,l){let h="Microsoft SignalR/";const r=a.split(".");return h+=`${r[0]}.${r[1]}`,h+=` (${a}; `,e&&e!==""?h+=`${e}; `:h+="Unknown OS; ",h+=`${t}`,l?h+=`; ${l}`:h+="; Unknown Runtime Version",h+=")",h}function Eo(){if(Et.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function Ao(){if(Et.isNode)return process.versions.node}function ko(){return Et.isNode?"NodeJS":"Browser"}function Fr(a){return a.stack?a.stack:a.message?a.message:`${a}`}function Co(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}class To extends pr{constructor(e){if(super(),this._logger=e,typeof fetch>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._jar=new(t("tough-cookie")).CookieJar,this._fetchType=t("node-fetch"),this._fetchType=t("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(Co());if(typeof AbortController>"u"){const t=typeof __webpack_require__=="function"?__non_webpack_require__:require;this._abortControllerType=t("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new Zt;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let l;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),l=new Zt});let h=null;if(e.timeout){const d=e.timeout;h=setTimeout(()=>{t.abort(),this._logger.log(ot.Warning,"Timeout from HTTP request."),l=new dr},d)}let r;try{r=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:e.withCredentials===!0?"include":"same-origin",headers:{"Content-Type":"text/plain;charset=UTF-8","X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(d){throw l||(this._logger.log(ot.Warning,`Error from HTTP request. ${d}.`),d)}finally{h&&clearTimeout(h),e.abortSignal&&(e.abortSignal.onabort=null)}if(!r.ok){const d=await Wr(r,"text");throw new Kt(d||r.statusText,r.status)}const g=await Wr(r,e.responseType);return new En(r.status,r.statusText,g)}getCookieString(e){let t="";return Et.isNode&&this._jar&&this._jar.getCookies(e,(l,h)=>t=h.join("; ")),t}}function Wr(a,e){let t;switch(e){case"arraybuffer":t=a.arrayBuffer();break;case"text":t=a.text();break;case"blob":case"document":case"json":throw new Error(`${e} is not supported.`);default:t=a.text();break}return t}class Io extends pr{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Zt):e.method?e.url?new Promise((t,l)=>{const h=new XMLHttpRequest;h.open(e.method,e.url,!0),h.withCredentials=e.withCredentials===void 0?!0:e.withCredentials,h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.setRequestHeader("Content-Type","text/plain;charset=UTF-8");const r=e.headers;r&&Object.keys(r).forEach(s=>{h.setRequestHeader(s,r[s])}),e.responseType&&(h.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{h.abort(),l(new Zt)}),e.timeout&&(h.timeout=e.timeout),h.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),h.status>=200&&h.status<300?t(new En(h.status,h.statusText,h.response||h.responseText)):l(new Kt(h.response||h.responseText||h.statusText,h.status))},h.onerror=()=>{this._logger.log(ot.Warning,`Error from HTTP request. ${h.status}: ${h.statusText}.`),l(new Kt(h.statusText,h.status))},h.ontimeout=()=>{this._logger.log(ot.Warning,"Timeout from HTTP request."),l(new dr)},h.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Ro extends pr{constructor(e){if(super(),typeof fetch<"u"||Et.isNode)this._httpClient=new To(e);else if(typeof XMLHttpRequest<"u")this._httpClient=new Io(e);else throw new Error("No usable HttpClient found.")}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new Zt):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class Tt{static write(e){return`${e}${Tt.RecordSeparator}`}static parse(e){if(e[e.length-1]!==Tt.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(Tt.RecordSeparator);return t.pop(),t}}Tt.RecordSeparatorCode=30;Tt.RecordSeparator=String.fromCharCode(Tt.RecordSeparatorCode);class Oo{writeHandshakeRequest(e){return Tt.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,l;if(gr(e)){const g=new Uint8Array(e),d=g.indexOf(Tt.RecordSeparatorCode);if(d===-1)throw new Error("Message is incomplete.");const i=d+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(g.slice(0,i))),l=g.byteLength>i?g.slice(i).buffer:null}else{const g=e,d=g.indexOf(Tt.RecordSeparator);if(d===-1)throw new Error("Message is incomplete.");const i=d+1;t=g.substring(0,i),l=g.length>i?g.substring(i):null}const h=Tt.parse(t),r=JSON.parse(h[0]);if(r.type)throw new Error("Expected a handshake response from the server.");return[l,r]}}var yt;(function(a){a[a.Invocation=1]="Invocation",a[a.StreamItem=2]="StreamItem",a[a.Completion=3]="Completion",a[a.StreamInvocation=4]="StreamInvocation",a[a.CancelInvocation=5]="CancelInvocation",a[a.Ping=6]="Ping",a[a.Close=7]="Close"})(yt||(yt={}));class Po{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new vo(this,e)}}const xo=30*1e3,jo=15*1e3;var _t;(function(a){a.Disconnected="Disconnected",a.Connecting="Connecting",a.Connected="Connected",a.Disconnecting="Disconnecting",a.Reconnecting="Reconnecting"})(_t||(_t={}));class br{constructor(e,t,l,h){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(ot.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},St.isRequired(e,"connection"),St.isRequired(t,"logger"),St.isRequired(l,"protocol"),this.serverTimeoutInMilliseconds=xo,this.keepAliveIntervalInMilliseconds=jo,this._logger=t,this._protocol=l,this.connection=e,this._reconnectPolicy=h,this._handshakeProtocol=new Oo,this.connection.onreceive=r=>this._processIncomingData(r),this.connection.onclose=r=>this._connectionClosed(r),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=_t.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:yt.Ping})}static create(e,t,l,h){return new br(e,t,l,h)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==_t.Disconnected&&this._connectionState!==_t.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==_t.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=_t.Connecting,this._logger.log(ot.Debug,"Starting HubConnection.");try{await this._startInternal(),Et.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=_t.Connected,this._connectionStarted=!0,this._logger.log(ot.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=_t.Disconnected,this._logger.log(ot.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise((t,l)=>{this._handshakeResolver=t,this._handshakeRejecter=l});await this.connection.start(this._protocol.transferFormat);try{const t={protocol:this._protocol.name,version:this._protocol.version};if(this._logger.log(ot.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(t)),this._logger.log(ot.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError}catch(t){throw this._logger.log(ot.Debug,`Hub handshake failed with error '${t}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(t),t}}async stop(){const e=this._startPromise;this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch{}}_stopInternal(e){return this._connectionState===_t.Disconnected?(this._logger.log(ot.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===_t.Disconnecting?(this._logger.log(ot.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=_t.Disconnecting,this._logger.log(ot.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(ot.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new Error("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[l,h]=this._replaceStreamingParams(t),r=this._createStreamInvocation(e,t,h);let s;const g=new Po;return g.cancelCallback=()=>{const d=this._createCancelInvocation(r.invocationId);return delete this._callbacks[r.invocationId],s.then(()=>this._sendWithProtocol(d))},this._callbacks[r.invocationId]=(d,i)=>{if(i){g.error(i);return}else d&&(d.type===yt.Completion?d.error?g.error(new Error(d.error)):g.complete():g.next(d.item))},s=this._sendWithProtocol(r).catch(d=>{g.error(d),delete this._callbacks[r.invocationId]}),this._launchStreams(l,s),g}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[l,h]=this._replaceStreamingParams(t),r=this._sendWithProtocol(this._createInvocation(e,t,!0,h));return this._launchStreams(l,r),r}invoke(e,...t){const[l,h]=this._replaceStreamingParams(t),r=this._createInvocation(e,t,!1,h);return new Promise((g,d)=>{this._callbacks[r.invocationId]=(f,c)=>{if(c){d(c);return}else f&&(f.type===yt.Completion?f.error?d(new Error(f.error)):g(f.result):d(new Error(`Unexpected message type: ${f.type}`)))};const i=this._sendWithProtocol(r).catch(f=>{d(f),delete this._callbacks[r.invocationId]});this._launchStreams(l,i)})}on(e,t){!e||!t||(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),this._methods[e].indexOf(t)===-1&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const l=this._methods[e];if(l)if(t){const h=l.indexOf(t);h!==-1&&(l.splice(h,1),l.length===0&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const l of t)switch(l.type){case yt.Invocation:this._invokeClientMethod(l);break;case yt.StreamItem:case yt.Completion:{const h=this._callbacks[l.invocationId];if(h){l.type===yt.Completion&&delete this._callbacks[l.invocationId];try{h(l)}catch(r){this._logger.log(ot.Error,`Stream callback threw error: ${Fr(r)}`)}}break}case yt.Ping:break;case yt.Close:{this._logger.log(ot.Information,"Close message received from server.");const h=l.error?new Error("Server returned an error on close: "+l.error):void 0;l.allowReconnect===!0?this.connection.stop(h):this._stopPromise=this._stopInternal(h);break}default:this._logger.log(ot.Warning,`Invalid message type: ${l.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,l;try{[l,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(h){const r="Error parsing handshake response: "+h;this._logger.log(ot.Error,r);const s=new Error(r);throw this._handshakeRejecter(s),s}if(t.error){const h="Server returned handshake error: "+t.error;this._logger.log(ot.Error,h);const r=new Error(h);throw this._handshakeRejecter(r),r}else this._logger.log(ot.Debug,"Server handshake complete.");return this._handshakeResolver(),l}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let e=this._nextKeepAlive-new Date().getTime();e<0&&(e=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===_t.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}_invokeClientMethod(e){const t=this._methods[e.target.toLowerCase()];if(t){try{t.forEach(l=>l.apply(this,e.arguments))}catch(l){this._logger.log(ot.Error,`A callback for the method ${e.target.toLowerCase()} threw error '${l}'.`)}if(e.invocationId){const l="Server requested a response, which is not supported in this version of the client.";this._logger.log(ot.Error,l),this._stopPromise=this._stopInternal(new Error(l))}}else this._logger.log(ot.Warning,`No client method with the name '${e.target}' found.`)}_connectionClosed(e){this._logger.log(ot.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new Error("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===_t.Disconnecting?this._completeClose(e):this._connectionState===_t.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===_t.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=_t.Disconnected,this._connectionStarted=!1,Et.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(t=>t.apply(this,[e]))}catch(t){this._logger.log(ot.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let l=0,h=e!==void 0?e:new Error("Attempting to reconnect due to a unknown error."),r=this._getNextRetryDelay(l++,0,h);if(r===null){this._logger.log(ot.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(e);return}if(this._connectionState=_t.Reconnecting,e?this._logger.log(ot.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(ot.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(s=>s.apply(this,[e]))}catch(s){this._logger.log(ot.Error,`An onreconnecting callback called with error '${e}' threw error '${s}'.`)}if(this._connectionState!==_t.Reconnecting){this._logger.log(ot.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;r!==null;){if(this._logger.log(ot.Information,`Reconnect attempt number ${l} will start in ${r} ms.`),await new Promise(s=>{this._reconnectDelayHandle=setTimeout(s,r)}),this._reconnectDelayHandle=void 0,this._connectionState!==_t.Reconnecting){this._logger.log(ot.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=_t.Connected,this._logger.log(ot.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(s=>s.apply(this,[this.connection.connectionId]))}catch(s){this._logger.log(ot.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${s}'.`)}return}catch(s){if(this._logger.log(ot.Information,`Reconnect attempt failed because of error '${s}'.`),this._connectionState!==_t.Reconnecting){this._logger.log(ot.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===_t.Disconnecting&&this._completeClose();return}h=s instanceof Error?s:new Error(s.toString()),r=this._getNextRetryDelay(l++,Date.now()-t,h)}}this._logger.log(ot.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${l} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,l){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:l})}catch(h){return this._logger.log(ot.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${h}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach(l=>{const h=t[l];try{h(null,e)}catch(r){this._logger.log(ot.Error,`Stream 'error' callback called with '${e}' threw error: ${Fr(r)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,l,h){if(l)return h.length!==0?{arguments:t,streamIds:h,target:e,type:yt.Invocation}:{arguments:t,target:e,type:yt.Invocation};{const r=this._invocationId;return this._invocationId++,h.length!==0?{arguments:t,invocationId:r.toString(),streamIds:h,target:e,type:yt.Invocation}:{arguments:t,invocationId:r.toString(),target:e,type:yt.Invocation}}}_launchStreams(e,t){if(e.length!==0){t||(t=Promise.resolve());for(const l in e)e[l].subscribe({complete:()=>{t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(l)))},error:h=>{let r;h instanceof Error?r=h.message:h&&h.toString?r=h.toString():r="Unknown error",t=t.then(()=>this._sendWithProtocol(this._createCompletionMessage(l,r)))},next:h=>{t=t.then(()=>this._sendWithProtocol(this._createStreamItemMessage(l,h)))}})}}_replaceStreamingParams(e){const t=[],l=[];for(let h=0;h<e.length;h++){const r=e[h];if(this._isObservable(r)){const s=this._invocationId;this._invocationId++,t[s]=r,l.push(s.toString()),e.splice(h,1)}}return[t,l]}_isObservable(e){return e&&e.subscribe&&typeof e.subscribe=="function"}_createStreamInvocation(e,t,l){const h=this._invocationId;return this._invocationId++,l.length!==0?{arguments:t,invocationId:h.toString(),streamIds:l,target:e,type:yt.StreamInvocation}:{arguments:t,invocationId:h.toString(),target:e,type:yt.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:yt.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:yt.StreamItem}}_createCompletionMessage(e,t,l){return t?{error:t,invocationId:e,type:yt.Completion}:{invocationId:e,result:l,type:yt.Completion}}}const Mo=[0,2e3,1e4,3e4,null];class $r{constructor(e){this._retryDelays=e!==void 0?[...e,null]:Mo}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class Ht{}Ht.Authorization="Authorization";Ht.Cookie="Cookie";var vt;(function(a){a[a.None=0]="None",a[a.WebSockets=1]="WebSockets",a[a.ServerSentEvents=2]="ServerSentEvents",a[a.LongPolling=4]="LongPolling"})(vt||(vt={}));var At;(function(a){a[a.Text=1]="Text",a[a.Binary=2]="Binary"})(At||(At={}));let No=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class Hr{constructor(e,t,l,h){this._httpClient=e,this._accessTokenFactory=t,this._logger=l,this._pollAbort=new No,this._options=h,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}async connect(e,t){if(St.isRequired(e,"url"),St.isRequired(t,"transferFormat"),St.isIn(t,At,"transferFormat"),this._url=e,this._logger.log(ot.Trace,"(LongPolling transport) Connecting."),t===At.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[l,h]=Gt(),r={[l]:h,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:r,timeout:1e5,withCredentials:this._options.withCredentials};t===At.Binary&&(s.responseType="arraybuffer");const g=await this._getAccessToken();this._updateHeaderToken(s,g);const d=`${e}&_=${Date.now()}`;this._logger.log(ot.Trace,`(LongPolling transport) polling: ${d}.`);const i=await this._httpClient.get(d,s);i.statusCode!==200?(this._logger.log(ot.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this._closeError=new Kt(i.statusText||"",i.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _getAccessToken(){return this._accessTokenFactory?await this._accessTokenFactory():null}_updateHeaderToken(e,t){if(e.headers||(e.headers={}),t){e.headers[Ht.Authorization]=`Bearer ${t}`;return}e.headers[Ht.Authorization]&&delete e.headers[Ht.Authorization]}async _poll(e,t){try{for(;this._running;){const l=await this._getAccessToken();this._updateHeaderToken(t,l);try{const h=`${e}&_=${Date.now()}`;this._logger.log(ot.Trace,`(LongPolling transport) polling: ${h}.`);const r=await this._httpClient.get(h,t);r.statusCode===204?(this._logger.log(ot.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):r.statusCode!==200?(this._logger.log(ot.Error,`(LongPolling transport) Unexpected response code: ${r.statusCode}.`),this._closeError=new Kt(r.statusText||"",r.statusCode),this._running=!1):r.content?(this._logger.log(ot.Trace,`(LongPolling transport) data received. ${ee(r.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(r.content)):this._logger.log(ot.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(h){this._running?h instanceof dr?this._logger.log(ot.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=h,this._running=!1):this._logger.log(ot.Trace,`(LongPolling transport) Poll errored after shutdown: ${h.message}`)}}}finally{this._logger.log(ot.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?An(this._logger,"LongPolling",this._httpClient,this._url,this._accessTokenFactory,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(ot.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(ot.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,l]=Gt();e[t]=l;const h={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials},r=await this._getAccessToken();this._updateHeaderToken(h,r),await this._httpClient.delete(this._url,h),this._logger.log(ot.Trace,"(LongPolling transport) DELETE request sent.")}finally{this._logger.log(ot.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(ot.Trace,e),this.onclose(this._closeError)}}}class Lo{constructor(e,t,l,h){this._httpClient=e,this._accessTokenFactory=t,this._logger=l,this._options=h,this.onreceive=null,this.onclose=null}async connect(e,t){if(St.isRequired(e,"url"),St.isRequired(t,"transferFormat"),St.isIn(t,At,"transferFormat"),this._logger.log(ot.Trace,"(SSE transport) Connecting."),this._url=e,this._accessTokenFactory){const l=await this._accessTokenFactory();l&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(l)}`)}return new Promise((l,h)=>{let r=!1;if(t!==At.Text){h(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let s;if(Et.isBrowser||Et.isWebWorker)s=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const g=this._httpClient.getCookieString(e),d={};d.Cookie=g;const[i,f]=Gt();d[i]=f,s=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...d,...this._options.headers}})}try{s.onmessage=g=>{if(this.onreceive)try{this._logger.log(ot.Trace,`(SSE transport) data received. ${ee(g.data,this._options.logMessageContent)}.`),this.onreceive(g.data)}catch(d){this._close(d);return}},s.onerror=g=>{r?this._close():h(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},s.onopen=()=>{this._logger.log(ot.Information,`SSE connected to ${this._url}`),this._eventSource=s,r=!0,l()}}catch(g){h(g);return}})}async send(e){return this._eventSource?An(this._logger,"SSE",this._httpClient,this._url,this._accessTokenFactory,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class Bo{constructor(e,t,l,h,r,s){this._logger=l,this._accessTokenFactory=t,this._logMessageContent=h,this._webSocketConstructor=r,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){if(St.isRequired(e,"url"),St.isRequired(t,"transferFormat"),St.isIn(t,At,"transferFormat"),this._logger.log(ot.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory){const l=await this._accessTokenFactory();l&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(l)}`)}return new Promise((l,h)=>{e=e.replace(/^http/,"ws");let r;const s=this._httpClient.getCookieString(e);let g=!1;if(Et.isNode){const d={},[i,f]=Gt();d[i]=f,s&&(d[Ht.Cookie]=`${s}`),r=new this._webSocketConstructor(e,void 0,{headers:{...d,...this._headers}})}r||(r=new this._webSocketConstructor(e)),t===At.Binary&&(r.binaryType="arraybuffer"),r.onopen=d=>{this._logger.log(ot.Information,`WebSocket connected to ${e}.`),this._webSocket=r,g=!0,l()},r.onerror=d=>{let i=null;typeof ErrorEvent<"u"&&d instanceof ErrorEvent?i=d.error:i="There was an error with the transport",this._logger.log(ot.Information,`(WebSockets transport) ${i}.`)},r.onmessage=d=>{if(this._logger.log(ot.Trace,`(WebSockets transport) data received. ${ee(d.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(d.data)}catch(i){this._close(i);return}},r.onclose=d=>{if(g)this._close(d);else{let i=null;typeof ErrorEvent<"u"&&d instanceof ErrorEvent?i=d.error:i="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",h(new Error(i))}}})}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(ot.Trace,`(WebSockets transport) sending data. ${ee(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(ot.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(e)&&(e.wasClean===!1||e.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)):e instanceof Error?this.onclose(e):this.onclose())}_isCloseEvent(e){return e&&typeof e.wasClean=="boolean"&&typeof e.code=="number"}}const qr=100;class Do{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,St.isRequired(e,"url"),this._logger=wo(t.logger),this.baseUrl=this._resolveUrl(e),t=t||{},t.logMessageContent=t.logMessageContent===void 0?!1:t.logMessageContent,typeof t.withCredentials=="boolean"||t.withCredentials===void 0)t.withCredentials=t.withCredentials===void 0?!0:t.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.timeout=t.timeout===void 0?100*1e3:t.timeout;let l=null,h=null;if(Et.isNode&&typeof require<"u"){const r=typeof __webpack_require__=="function"?__non_webpack_require__:require;l=r("ws"),h=r("eventsource")}!Et.isNode&&typeof WebSocket<"u"&&!t.WebSocket?t.WebSocket=WebSocket:Et.isNode&&!t.WebSocket&&l&&(t.WebSocket=l),!Et.isNode&&typeof EventSource<"u"&&!t.EventSource?t.EventSource=EventSource:Et.isNode&&!t.EventSource&&typeof h<"u"&&(t.EventSource=h),this._httpClient=t.httpClient||new Ro(this._logger),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||At.Binary,St.isIn(e,At,"transferFormat"),this._logger.log(ot.Debug,`Starting connection with transfer format '${At[e]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,this._connectionState==="Disconnecting"){const t="Failed to start the HttpConnection before stop() was called.";return this._logger.log(ot.Error,t),await this._stopPromise,Promise.reject(new Error(t))}else if(this._connectionState!=="Connected"){const t="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(ot.Error,t),Promise.reject(new Error(t))}this._connectionStarted=!0}send(e){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new mr(this.transport)),this._sendQueue.send(e))}async stop(e){if(this._connectionState==="Disconnected")return this._logger.log(ot.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(ot.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(t=>{this._stopPromiseResolver=t}),await this._stopInternal(e),await this._stopPromise}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(t){this._logger.log(ot.Error,`HttpConnection.transport.stop() threw error '${t}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(ot.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===vt.WebSockets)this.transport=this._constructTransport(vt.WebSockets),await this._startTransport(t,e);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let l=null,h=0;do{if(l=await this._getNegotiationResponse(t),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new Error("The connection was stopped during negotiation.");if(l.error)throw new Error(l.error);if(l.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(l.url&&(t=l.url),l.accessToken){const r=l.accessToken;this._accessTokenFactory=()=>r}h++}while(l.url&&h<qr);if(h===qr&&l.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,l,e)}this.transport instanceof Hr&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(ot.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(l){return this._logger.log(ot.Error,"Failed to start the connection: "+l),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(l)}}async _getNegotiationResponse(e){const t={};if(this._accessTokenFactory){const s=await this._accessTokenFactory();s&&(t[Ht.Authorization]=`Bearer ${s}`)}const[l,h]=Gt();t[l]=h;const r=this._resolveNegotiateUrl(e);this._logger.log(ot.Debug,`Sending negotiation request: ${r}.`);try{const s=await this._httpClient.post(r,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(s.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${s.statusCode}'`));const g=JSON.parse(s.content);return(!g.negotiateVersion||g.negotiateVersion<1)&&(g.connectionToken=g.connectionId),g}catch(s){let g="Failed to complete negotiation with the server: "+s;return s instanceof Kt&&s.statusCode===404&&(g=g+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(ot.Error,g),Promise.reject(new bo(g))}}_createConnectUrl(e,t){return t?e+(e.indexOf("?")===-1?"?":"&")+`id=${t}`:e}async _createTransport(e,t,l,h){let r=this._createConnectUrl(e,l.connectionToken);if(this._isITransport(t)){this._logger.log(ot.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(r,h),this.connectionId=l.connectionId;return}const s=[],g=l.availableTransports||[];let d=l;for(const i of g){const f=this._resolveTransportOrError(i,t,h);if(f instanceof Error)s.push(`${i.transport} failed:`),s.push(f);else if(this._isITransport(f)){if(this.transport=f,!d){try{d=await this._getNegotiationResponse(e)}catch(c){return Promise.reject(c)}r=this._createConnectUrl(e,d.connectionToken)}try{await this._startTransport(r,h),this.connectionId=d.connectionId;return}catch(c){if(this._logger.log(ot.Error,`Failed to start the transport '${i.transport}': ${c}`),d=void 0,s.push(new go(`${i.transport} failed: ${c}`,vt[i.transport])),this._connectionState!=="Connecting"){const n="Failed to select transport before stop() was called.";return this._logger.log(ot.Debug,n),Promise.reject(new Error(n))}}}}return s.length>0?Promise.reject(new mo(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case vt.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new Bo(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case vt.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new Lo(this._httpClient,this._accessTokenFactory,this._logger,this._options);case vt.LongPolling:return new Hr(this._httpClient,this._accessTokenFactory,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=l=>this._stopConnection(l),this.transport.connect(e,t)}_resolveTransportOrError(e,t,l){const h=vt[e.transport];if(h==null)return this._logger.log(ot.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(Uo(t,h))if(e.transferFormats.map(s=>At[s]).indexOf(l)>=0){if(h===vt.WebSockets&&!this._options.WebSocket||h===vt.ServerSentEvents&&!this._options.EventSource)return this._logger.log(ot.Debug,`Skipping transport '${vt[h]}' because it is not supported in your environment.'`),new fo(`'${vt[h]}' is not supported in your environment.`,h);this._logger.log(ot.Debug,`Selecting transport '${vt[h]}'.`);try{return this._constructTransport(h)}catch(s){return s}}else return this._logger.log(ot.Debug,`Skipping transport '${vt[h]}' because it does not support the requested transfer format '${At[l]}'.`),new Error(`'${vt[h]}' does not support ${At[l]}.`);else return this._logger.log(ot.Debug,`Skipping transport '${vt[h]}' because it was disabled by the client.`),new po(`'${vt[h]}' is disabled by the client.`,h)}_isITransport(e){return e&&typeof e=="object"&&"connect"in e}_stopConnection(e){if(this._logger.log(ot.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(ot.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(ot.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),e?this._logger.log(ot.Error,`Connection disconnected with error '${e}'.`):this._logger.log(ot.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(t=>{this._logger.log(ot.Error,`TransportSendQueue.stop() threw error '${t}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(ot.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}_resolveUrl(e){if(e.lastIndexOf("https://",0)===0||e.lastIndexOf("http://",0)===0)return e;if(!Et.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(ot.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let l=e.substring(0,t===-1?e.length:t);return l[l.length-1]!=="/"&&(l+="/"),l+="negotiate",l+=t===-1?"":e.substring(t),l.indexOf("negotiateVersion")===-1&&(l+=t===-1?"?":"&",l+="negotiateVersion="+this._negotiateVersion),l}}function Uo(a,e){return!a||(e&a)!==0}class mr{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new ce,this._transportResult=new ce,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new ce),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new ce;const e=this._transportResult;this._transportResult=void 0;const t=typeof this._buffer[0]=="string"?this._buffer.join(""):mr._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(l){e.reject(l)}}}static _concatBuffers(e){const t=e.map(r=>r.byteLength).reduce((r,s)=>r+s),l=new Uint8Array(t);let h=0;for(const r of e)l.set(new Uint8Array(r),h),h+=r.byteLength;return l.buffer}}class ce{constructor(){this.promise=new Promise((e,t)=>[this._resolver,this._rejecter]=[e,t])}resolve(){this._resolver()}reject(e){this._rejecter(e)}}const Fo="json";class Wo{constructor(){this.name=Fo,this.version=1,this.transferFormat=At.Text}parseMessages(e,t){if(typeof e!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];t===null&&(t=te.instance);const l=Tt.parse(e),h=[];for(const r of l){const s=JSON.parse(r);if(typeof s.type!="number")throw new Error("Invalid payload.");switch(s.type){case yt.Invocation:this._isInvocationMessage(s);break;case yt.StreamItem:this._isStreamItemMessage(s);break;case yt.Completion:this._isCompletionMessage(s);break;case yt.Ping:break;case yt.Close:break;default:t.log(ot.Information,"Unknown message type '"+s.type+"' ignored.");continue}h.push(s)}return h}writeMessage(e){return Tt.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),e.invocationId!==void 0&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),e.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if(typeof e!="string"||e==="")throw new Error(t)}}const $o={trace:ot.Trace,debug:ot.Debug,info:ot.Information,information:ot.Information,warn:ot.Warning,warning:ot.Warning,error:ot.Error,critical:ot.Critical,none:ot.None};function Ho(a){const e=$o[a.toLowerCase()];if(typeof e<"u")return e;throw new Error(`Unknown log level: ${a}`)}class qo{configureLogging(e){if(St.isRequired(e,"logging"),Vo(e))this.logger=e;else if(typeof e=="string"){const t=Ho(e);this.logger=new Se(t)}else this.logger=new Se(e);return this}withUrl(e,t){return St.isRequired(e,"url"),St.isNotEmpty(e,"url"),this.url=e,typeof t=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...t}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return St.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new $r(e):this.reconnectPolicy=e:this.reconnectPolicy=new $r,this}build(){const e=this.httpConnectionOptions||{};if(e.logger===void 0&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new Do(this.url,e);return br.create(t,this.logger||te.instance,this.protocol||new Wo,this.reconnectPolicy)}}function Vo(a){return a.log!==void 0}class zo{nextRetryDelayInMilliseconds(e){return null}}const xe=class xe{constructor(e,t){ft(this,"crisEndpoint");ft(this,"connection");this.crisEndpoint=t,this.connection=new qo().withUrl(e,vt.None).withAutomaticReconnect(xe.noRetryPolicy).build()}async startAsync(){try{return await this.connection.start(),!0}catch(e){return console.log(e),!1}}async startListeningAsync(e){const t={},l=e.map(async h=>{const r=new ye(this.connection.connectionId,h.domainName,h.transactionCount),s=await this.crisEndpoint.sendOrThrowAsync(r);s?t[h.domainName]=JSON.parse(s):(console.warn(`Domain ${h.domainName} doesn't exists.`),t[h.domainName]="")});return await Promise.all(l),t}onMessage(e){this.connection.on("OnStateEventsAsync",(t,l)=>{e(t,JSON.parse(l))})}onClose(e){this.connection.onclose(e)}async stopAsync(){await this.connection.stop()}};ft(xe,"noRetryPolicy",new zo);let sr=xe;const Ko=pn.create(),ar=new Xi(Ko,"http://localhost:5000/.cris");(async function(){const a=new Zi("ws://localhost:8080/mqtt/",ar,"CK-OD"),e=new sr("http://localhost:5000/hub/league",ar),t=new Ur(a);t.start();const l=new Ur(e);l.start();const h=await t.listenToDomainAsync("Test-Domain"),r=await l.listenToDomainAsync("Test-Domain"),s=document.getElementById("slider-left"),g=document.getElementById("slider-right");h.forEach(d=>{d.length<1||(console.log("Mqtt value: "+d[0].Slider),s.value=d[0].Slider)}),r.forEach(d=>{d.length<1||(console.log("SignalR value: "+d[0].Slider),g.value=d[0].Slider)})})();async function Go(a){await ar.sendOrThrowAsync(new be(Number(a)))}window.sliderUpdate=Go;
