var Yh=Object.defineProperty;var Ql=u=>{throw TypeError(u)};var Gh=(u,t,l)=>t in u?Yh(u,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):u[t]=l;var Be=(u,t,l)=>Gh(u,typeof t!="symbol"?t+"":t,l),es=(u,t,l)=>t.has(u)||Ql("Cannot "+l);var D=(u,t,l)=>(es(u,t,"read from private field"),l?l.call(u):t.get(u)),Qe=(u,t,l)=>t.has(u)?Ql("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(u):t.set(u,l),Ue=(u,t,l,m)=>(es(u,t,"write to private field"),m?m.call(u,l):t.set(u,l),l),je=(u,t,l)=>(es(u,t,"access private method"),l);var Bn=(u,t,l,m)=>({set _(w){Ue(u,t,w,l)},get _(){return D(u,t,m)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const w of document.querySelectorAll('link[rel="modulepreload"]'))m(w);new MutationObserver(w=>{for(const E of w)if(E.type==="childList")for(const A of E.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&m(A)}).observe(document,{childList:!0,subtree:!0});function l(w){const E={};return w.integrity&&(E.integrity=w.integrity),w.referrerPolicy&&(E.referrerPolicy=w.referrerPolicy),w.crossOrigin==="use-credentials"?E.credentials="include":w.crossOrigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function m(w){if(w.ep)return;w.ep=!0;const E=l(w);fetch(w.href,E)}})();function Ac(u,t){return function(){return u.apply(t,arguments)}}const{toString:Xh}=Object.prototype,{getPrototypeOf:ks}=Object,oi=(u=>t=>{const l=Xh.call(t);return u[l]||(u[l]=l.slice(8,-1).toLowerCase())})(Object.create(null)),Dt=u=>(u=u.toLowerCase(),t=>oi(t)===u),si=u=>t=>typeof t===u,{isArray:Hr}=Array,nn=si("undefined");function Zh(u){return u!==null&&!nn(u)&&u.constructor!==null&&!nn(u.constructor)&&Pt(u.constructor.isBuffer)&&u.constructor.isBuffer(u)}const Cc=Dt("ArrayBuffer");function ef(u){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(u):t=u&&u.buffer&&Cc(u.buffer),t}const tf=si("string"),Pt=si("function"),Ic=si("number"),ai=u=>u!==null&&typeof u=="object",rf=u=>u===!0||u===!1,jn=u=>{if(oi(u)!=="object")return!1;const t=ks(u);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in u)&&!(Symbol.iterator in u)},nf=Dt("Date"),of=Dt("File"),sf=Dt("Blob"),af=Dt("FileList"),lf=u=>ai(u)&&Pt(u.pipe),cf=u=>{let t;return u&&(typeof FormData=="function"&&u instanceof FormData||Pt(u.append)&&((t=oi(u))==="formdata"||t==="object"&&Pt(u.toString)&&u.toString()==="[object FormData]"))},uf=Dt("URLSearchParams"),[hf,ff,df,pf]=["ReadableStream","Request","Response","Headers"].map(Dt),gf=u=>u.trim?u.trim():u.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function an(u,t,{allOwnKeys:l=!1}={}){if(u===null||typeof u>"u")return;let m,w;if(typeof u!="object"&&(u=[u]),Hr(u))for(m=0,w=u.length;m<w;m++)t.call(null,u[m],m,u);else{const E=l?Object.getOwnPropertyNames(u):Object.keys(u),A=E.length;let W;for(m=0;m<A;m++)W=E[m],t.call(null,u[W],W,u)}}function Tc(u,t){t=t.toLowerCase();const l=Object.keys(u);let m=l.length,w;for(;m-- >0;)if(w=l[m],t===w.toLowerCase())return w;return null}const kc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Rc=u=>!nn(u)&&u!==kc;function as(){const{caseless:u}=Rc(this)&&this||{},t={},l=(m,w)=>{const E=u&&Tc(t,w)||w;jn(t[E])&&jn(m)?t[E]=as(t[E],m):jn(m)?t[E]=as({},m):Hr(m)?t[E]=m.slice():t[E]=m};for(let m=0,w=arguments.length;m<w;m++)arguments[m]&&an(arguments[m],l);return t}const mf=(u,t,l,{allOwnKeys:m}={})=>(an(t,(w,E)=>{l&&Pt(w)?u[E]=Ac(w,l):u[E]=w},{allOwnKeys:m}),u),bf=u=>(u.charCodeAt(0)===65279&&(u=u.slice(1)),u),yf=(u,t,l,m)=>{u.prototype=Object.create(t.prototype,m),u.prototype.constructor=u,Object.defineProperty(u,"super",{value:t.prototype}),l&&Object.assign(u.prototype,l)},_f=(u,t,l,m)=>{let w,E,A;const W={};if(t=t||{},u==null)return t;do{for(w=Object.getOwnPropertyNames(u),E=w.length;E-- >0;)A=w[E],(!m||m(A,u,t))&&!W[A]&&(t[A]=u[A],W[A]=!0);u=l!==!1&&ks(u)}while(u&&(!l||l(u,t))&&u!==Object.prototype);return t},wf=(u,t,l)=>{u=String(u),(l===void 0||l>u.length)&&(l=u.length),l-=t.length;const m=u.indexOf(t,l);return m!==-1&&m===l},vf=u=>{if(!u)return null;if(Hr(u))return u;let t=u.length;if(!Ic(t))return null;const l=new Array(t);for(;t-- >0;)l[t]=u[t];return l},Ef=(u=>t=>u&&t instanceof u)(typeof Uint8Array<"u"&&ks(Uint8Array)),Sf=(u,t)=>{const m=(u&&u[Symbol.iterator]).call(u);let w;for(;(w=m.next())&&!w.done;){const E=w.value;t.call(u,E[0],E[1])}},Af=(u,t)=>{let l;const m=[];for(;(l=u.exec(t))!==null;)m.push(l);return m},Cf=Dt("HTMLFormElement"),If=u=>u.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(l,m,w){return m.toUpperCase()+w}),Yl=(({hasOwnProperty:u})=>(t,l)=>u.call(t,l))(Object.prototype),Tf=Dt("RegExp"),Oc=(u,t)=>{const l=Object.getOwnPropertyDescriptors(u),m={};an(l,(w,E)=>{let A;(A=t(w,E,u))!==!1&&(m[E]=A||w)}),Object.defineProperties(u,m)},kf=u=>{Oc(u,(t,l)=>{if(Pt(u)&&["arguments","caller","callee"].indexOf(l)!==-1)return!1;const m=u[l];if(Pt(m)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+l+"'")})}})},Rf=(u,t)=>{const l={},m=w=>{w.forEach(E=>{l[E]=!0})};return Hr(u)?m(u):m(String(u).split(t)),l},Of=()=>{},Pf=(u,t)=>u!=null&&Number.isFinite(u=+u)?u:t,ts="abcdefghijklmnopqrstuvwxyz",Gl="0123456789",Pc={DIGIT:Gl,ALPHA:ts,ALPHA_DIGIT:ts+ts.toUpperCase()+Gl},xf=(u=16,t=Pc.ALPHA_DIGIT)=>{let l="";const{length:m}=t;for(;u--;)l+=t[Math.random()*m|0];return l};function Bf(u){return!!(u&&Pt(u.append)&&u[Symbol.toStringTag]==="FormData"&&u[Symbol.iterator])}const Nf=u=>{const t=new Array(10),l=(m,w)=>{if(ai(m)){if(t.indexOf(m)>=0)return;if(!("toJSON"in m)){t[w]=m;const E=Hr(m)?[]:{};return an(m,(A,W)=>{const V=l(A,w+1);!nn(V)&&(E[W]=V)}),t[w]=void 0,E}}return m};return l(u,0)},Mf=Dt("AsyncFunction"),jf=u=>u&&(ai(u)||Pt(u))&&Pt(u.then)&&Pt(u.catch),le={isArray:Hr,isArrayBuffer:Cc,isBuffer:Zh,isFormData:cf,isArrayBufferView:ef,isString:tf,isNumber:Ic,isBoolean:rf,isObject:ai,isPlainObject:jn,isReadableStream:hf,isRequest:ff,isResponse:df,isHeaders:pf,isUndefined:nn,isDate:nf,isFile:of,isBlob:sf,isRegExp:Tf,isFunction:Pt,isStream:lf,isURLSearchParams:uf,isTypedArray:Ef,isFileList:af,forEach:an,merge:as,extend:mf,trim:gf,stripBOM:bf,inherits:yf,toFlatObject:_f,kindOf:oi,kindOfTest:Dt,endsWith:wf,toArray:vf,forEachEntry:Sf,matchAll:Af,isHTMLForm:Cf,hasOwnProperty:Yl,hasOwnProp:Yl,reduceDescriptors:Oc,freezeMethods:kf,toObjectSet:Rf,toCamelCase:If,noop:Of,toFiniteNumber:Pf,findKey:Tc,global:kc,isContextDefined:Rc,ALPHABET:Pc,generateString:xf,isSpecCompliantForm:Bf,toJSONObject:Nf,isAsyncFn:Mf,isThenable:jf};function He(u,t,l,m,w){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=u,this.name="AxiosError",t&&(this.code=t),l&&(this.config=l),m&&(this.request=m),w&&(this.response=w)}le.inherits(He,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:le.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const xc=He.prototype,Bc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(u=>{Bc[u]={value:u}});Object.defineProperties(He,Bc);Object.defineProperty(xc,"isAxiosError",{value:!0});He.from=(u,t,l,m,w,E)=>{const A=Object.create(xc);return le.toFlatObject(u,A,function(V){return V!==Error.prototype},W=>W!=="isAxiosError"),He.call(A,u.message,t,l,m,w),A.cause=u,A.name=u.name,E&&Object.assign(A,E),A};const Uf=null;function ls(u){return le.isPlainObject(u)||le.isArray(u)}function Nc(u){return le.endsWith(u,"[]")?u.slice(0,-2):u}function Xl(u,t,l){return u?u.concat(t).map(function(w,E){return w=Nc(w),!l&&E?"["+w+"]":w}).join(l?".":""):t}function Lf(u){return le.isArray(u)&&!u.some(ls)}const Df=le.toFlatObject(le,{},null,function(t){return/^is[A-Z]/.test(t)});function li(u,t,l){if(!le.isObject(u))throw new TypeError("target must be an object");t=t||new FormData,l=le.toFlatObject(l,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Ce,Ve){return!le.isUndefined(Ve[Ce])});const m=l.metaTokens,w=l.visitor||M,E=l.dots,A=l.indexes,V=(l.Blob||typeof Blob<"u"&&Blob)&&le.isSpecCompliantForm(t);if(!le.isFunction(w))throw new TypeError("visitor must be a function");function se(xe){if(xe===null)return"";if(le.isDate(xe))return xe.toISOString();if(!V&&le.isBlob(xe))throw new He("Blob is not supported. Use a Buffer instead.");return le.isArrayBuffer(xe)||le.isTypedArray(xe)?V&&typeof Blob=="function"?new Blob([xe]):Buffer.from(xe):xe}function M(xe,Ce,Ve){let Fe=xe;if(xe&&!Ve&&typeof xe=="object"){if(le.endsWith(Ce,"{}"))Ce=m?Ce:Ce.slice(0,-2),xe=JSON.stringify(xe);else if(le.isArray(xe)&&Lf(xe)||(le.isFileList(xe)||le.endsWith(Ce,"[]"))&&(Fe=le.toArray(xe)))return Ce=Nc(Ce),Fe.forEach(function(Xe,ar){!(le.isUndefined(Xe)||Xe===null)&&t.append(A===!0?Xl([Ce],ar,E):A===null?Ce:Ce+"[]",se(Xe))}),!1}return ls(xe)?!0:(t.append(Xl(Ve,Ce,E),se(xe)),!1)}const Re=[],Ye=Object.assign(Df,{defaultVisitor:M,convertValue:se,isVisitable:ls});function Je(xe,Ce){if(!le.isUndefined(xe)){if(Re.indexOf(xe)!==-1)throw Error("Circular reference detected in "+Ce.join("."));Re.push(xe),le.forEach(xe,function(Fe,vt){(!(le.isUndefined(Fe)||Fe===null)&&w.call(t,Fe,le.isString(vt)?vt.trim():vt,Ce,Ye))===!0&&Je(Fe,Ce?Ce.concat(vt):[vt])}),Re.pop()}}if(!le.isObject(u))throw new TypeError("data must be an object");return Je(u),t}function Zl(u){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(u).replace(/[!'()~]|%20|%00/g,function(m){return t[m]})}function Rs(u,t){this._pairs=[],u&&li(u,this,t)}const Mc=Rs.prototype;Mc.append=function(t,l){this._pairs.push([t,l])};Mc.toString=function(t){const l=t?function(m){return t.call(this,m,Zl)}:Zl;return this._pairs.map(function(w){return l(w[0])+"="+l(w[1])},"").join("&")};function Ff(u){return encodeURIComponent(u).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function jc(u,t,l){if(!t)return u;const m=l&&l.encode||Ff,w=l&&l.serialize;let E;if(w?E=w(t,l):E=le.isURLSearchParams(t)?t.toString():new Rs(t,l).toString(m),E){const A=u.indexOf("#");A!==-1&&(u=u.slice(0,A)),u+=(u.indexOf("?")===-1?"?":"&")+E}return u}class ec{constructor(){this.handlers=[]}use(t,l,m){return this.handlers.push({fulfilled:t,rejected:l,synchronous:m?m.synchronous:!1,runWhen:m?m.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){le.forEach(this.handlers,function(m){m!==null&&t(m)})}}const Uc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$f=typeof URLSearchParams<"u"?URLSearchParams:Rs,Wf=typeof FormData<"u"?FormData:null,Hf=typeof Blob<"u"?Blob:null,qf={isBrowser:!0,classes:{URLSearchParams:$f,FormData:Wf,Blob:Hf},protocols:["http","https","file","blob","url","data"]},Os=typeof window<"u"&&typeof document<"u",Vf=(u=>Os&&["ReactNative","NativeScript","NS"].indexOf(u)<0)(typeof navigator<"u"&&navigator.product),zf=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Kf=Os&&window.location.href||"http://localhost",Jf=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Os,hasStandardBrowserEnv:Vf,hasStandardBrowserWebWorkerEnv:zf,origin:Kf},Symbol.toStringTag,{value:"Module"})),Lt={...Jf,...qf};function Qf(u,t){return li(u,new Lt.classes.URLSearchParams,Object.assign({visitor:function(l,m,w,E){return Lt.isNode&&le.isBuffer(l)?(this.append(m,l.toString("base64")),!1):E.defaultVisitor.apply(this,arguments)}},t))}function Yf(u){return le.matchAll(/\w+|\[(\w*)]/g,u).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Gf(u){const t={},l=Object.keys(u);let m;const w=l.length;let E;for(m=0;m<w;m++)E=l[m],t[E]=u[E];return t}function Lc(u){function t(l,m,w,E){let A=l[E++];if(A==="__proto__")return!0;const W=Number.isFinite(+A),V=E>=l.length;return A=!A&&le.isArray(w)?w.length:A,V?(le.hasOwnProp(w,A)?w[A]=[w[A],m]:w[A]=m,!W):((!w[A]||!le.isObject(w[A]))&&(w[A]=[]),t(l,m,w[A],E)&&le.isArray(w[A])&&(w[A]=Gf(w[A])),!W)}if(le.isFormData(u)&&le.isFunction(u.entries)){const l={};return le.forEachEntry(u,(m,w)=>{t(Yf(m),w,l,0)}),l}return null}function Xf(u,t,l){if(le.isString(u))try{return(t||JSON.parse)(u),le.trim(u)}catch(m){if(m.name!=="SyntaxError")throw m}return(l||JSON.stringify)(u)}const ln={transitional:Uc,adapter:["xhr","http","fetch"],transformRequest:[function(t,l){const m=l.getContentType()||"",w=m.indexOf("application/json")>-1,E=le.isObject(t);if(E&&le.isHTMLForm(t)&&(t=new FormData(t)),le.isFormData(t))return w?JSON.stringify(Lc(t)):t;if(le.isArrayBuffer(t)||le.isBuffer(t)||le.isStream(t)||le.isFile(t)||le.isBlob(t)||le.isReadableStream(t))return t;if(le.isArrayBufferView(t))return t.buffer;if(le.isURLSearchParams(t))return l.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let W;if(E){if(m.indexOf("application/x-www-form-urlencoded")>-1)return Qf(t,this.formSerializer).toString();if((W=le.isFileList(t))||m.indexOf("multipart/form-data")>-1){const V=this.env&&this.env.FormData;return li(W?{"files[]":t}:t,V&&new V,this.formSerializer)}}return E||w?(l.setContentType("application/json",!1),Xf(t)):t}],transformResponse:[function(t){const l=this.transitional||ln.transitional,m=l&&l.forcedJSONParsing,w=this.responseType==="json";if(le.isResponse(t)||le.isReadableStream(t))return t;if(t&&le.isString(t)&&(m&&!this.responseType||w)){const A=!(l&&l.silentJSONParsing)&&w;try{return JSON.parse(t)}catch(W){if(A)throw W.name==="SyntaxError"?He.from(W,He.ERR_BAD_RESPONSE,this,null,this.response):W}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Lt.classes.FormData,Blob:Lt.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};le.forEach(["delete","get","head","post","put","patch"],u=>{ln.headers[u]={}});const Zf=le.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ed=u=>{const t={};let l,m,w;return u&&u.split(`
`).forEach(function(A){w=A.indexOf(":"),l=A.substring(0,w).trim().toLowerCase(),m=A.substring(w+1).trim(),!(!l||t[l]&&Zf[l])&&(l==="set-cookie"?t[l]?t[l].push(m):t[l]=[m]:t[l]=t[l]?t[l]+", "+m:m)}),t},tc=Symbol("internals");function tn(u){return u&&String(u).trim().toLowerCase()}function Un(u){return u===!1||u==null?u:le.isArray(u)?u.map(Un):String(u)}function td(u){const t=Object.create(null),l=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let m;for(;m=l.exec(u);)t[m[1]]=m[2];return t}const rd=u=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(u.trim());function rs(u,t,l,m,w){if(le.isFunction(m))return m.call(this,t,l);if(w&&(t=l),!!le.isString(t)){if(le.isString(m))return t.indexOf(m)!==-1;if(le.isRegExp(m))return m.test(t)}}function nd(u){return u.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,l,m)=>l.toUpperCase()+m)}function id(u,t){const l=le.toCamelCase(" "+t);["get","set","has"].forEach(m=>{Object.defineProperty(u,m+l,{value:function(w,E,A){return this[m].call(this,t,w,E,A)},configurable:!0})})}let It=class{constructor(t){t&&this.set(t)}set(t,l,m){const w=this;function E(W,V,se){const M=tn(V);if(!M)throw new Error("header name must be a non-empty string");const Re=le.findKey(w,M);(!Re||w[Re]===void 0||se===!0||se===void 0&&w[Re]!==!1)&&(w[Re||V]=Un(W))}const A=(W,V)=>le.forEach(W,(se,M)=>E(se,M,V));if(le.isPlainObject(t)||t instanceof this.constructor)A(t,l);else if(le.isString(t)&&(t=t.trim())&&!rd(t))A(ed(t),l);else if(le.isHeaders(t))for(const[W,V]of t.entries())E(V,W,m);else t!=null&&E(l,t,m);return this}get(t,l){if(t=tn(t),t){const m=le.findKey(this,t);if(m){const w=this[m];if(!l)return w;if(l===!0)return td(w);if(le.isFunction(l))return l.call(this,w,m);if(le.isRegExp(l))return l.exec(w);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,l){if(t=tn(t),t){const m=le.findKey(this,t);return!!(m&&this[m]!==void 0&&(!l||rs(this,this[m],m,l)))}return!1}delete(t,l){const m=this;let w=!1;function E(A){if(A=tn(A),A){const W=le.findKey(m,A);W&&(!l||rs(m,m[W],W,l))&&(delete m[W],w=!0)}}return le.isArray(t)?t.forEach(E):E(t),w}clear(t){const l=Object.keys(this);let m=l.length,w=!1;for(;m--;){const E=l[m];(!t||rs(this,this[E],E,t,!0))&&(delete this[E],w=!0)}return w}normalize(t){const l=this,m={};return le.forEach(this,(w,E)=>{const A=le.findKey(m,E);if(A){l[A]=Un(w),delete l[E];return}const W=t?nd(E):String(E).trim();W!==E&&delete l[E],l[W]=Un(w),m[W]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const l=Object.create(null);return le.forEach(this,(m,w)=>{m!=null&&m!==!1&&(l[w]=t&&le.isArray(m)?m.join(", "):m)}),l}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,l])=>t+": "+l).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...l){const m=new this(t);return l.forEach(w=>m.set(w)),m}static accessor(t){const m=(this[tc]=this[tc]={accessors:{}}).accessors,w=this.prototype;function E(A){const W=tn(A);m[W]||(id(w,A),m[W]=!0)}return le.isArray(t)?t.forEach(E):E(t),this}};It.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);le.reduceDescriptors(It.prototype,({value:u},t)=>{let l=t[0].toUpperCase()+t.slice(1);return{get:()=>u,set(m){this[l]=m}}});le.freezeMethods(It);function ns(u,t){const l=this||ln,m=t||l,w=It.from(m.headers);let E=m.data;return le.forEach(u,function(W){E=W.call(l,E,w.normalize(),t?t.status:void 0)}),w.normalize(),E}function Dc(u){return!!(u&&u.__CANCEL__)}function qr(u,t,l){He.call(this,u??"canceled",He.ERR_CANCELED,t,l),this.name="CanceledError"}le.inherits(qr,He,{__CANCEL__:!0});function Fc(u,t,l){const m=l.config.validateStatus;!l.status||!m||m(l.status)?u(l):t(new He("Request failed with status code "+l.status,[He.ERR_BAD_REQUEST,He.ERR_BAD_RESPONSE][Math.floor(l.status/100)-4],l.config,l.request,l))}function od(u){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(u);return t&&t[1]||""}function sd(u,t){u=u||10;const l=new Array(u),m=new Array(u);let w=0,E=0,A;return t=t!==void 0?t:1e3,function(V){const se=Date.now(),M=m[E];A||(A=se),l[w]=V,m[w]=se;let Re=E,Ye=0;for(;Re!==w;)Ye+=l[Re++],Re=Re%u;if(w=(w+1)%u,w===E&&(E=(E+1)%u),se-A<t)return;const Je=M&&se-M;return Je?Math.round(Ye*1e3/Je):void 0}}function ad(u,t){let l=0;const m=1e3/t;let w=null;return function(){const A=this===!0,W=Date.now();if(A||W-l>m)return w&&(clearTimeout(w),w=null),l=W,u.apply(null,arguments);w||(w=setTimeout(()=>(w=null,l=Date.now(),u.apply(null,arguments)),m-(W-l)))}}const $n=(u,t,l=3)=>{let m=0;const w=sd(50,250);return ad(E=>{const A=E.loaded,W=E.lengthComputable?E.total:void 0,V=A-m,se=w(V),M=A<=W;m=A;const Re={loaded:A,total:W,progress:W?A/W:void 0,bytes:V,rate:se||void 0,estimated:se&&W&&M?(W-A)/se:void 0,event:E,lengthComputable:W!=null};Re[t?"download":"upload"]=!0,u(Re)},l)},ld=Lt.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),l=document.createElement("a");let m;function w(E){let A=E;return t&&(l.setAttribute("href",A),A=l.href),l.setAttribute("href",A),{href:l.href,protocol:l.protocol?l.protocol.replace(/:$/,""):"",host:l.host,search:l.search?l.search.replace(/^\?/,""):"",hash:l.hash?l.hash.replace(/^#/,""):"",hostname:l.hostname,port:l.port,pathname:l.pathname.charAt(0)==="/"?l.pathname:"/"+l.pathname}}return m=w(window.location.href),function(A){const W=le.isString(A)?w(A):A;return W.protocol===m.protocol&&W.host===m.host}}():function(){return function(){return!0}}(),cd=Lt.hasStandardBrowserEnv?{write(u,t,l,m,w,E){const A=[u+"="+encodeURIComponent(t)];le.isNumber(l)&&A.push("expires="+new Date(l).toGMTString()),le.isString(m)&&A.push("path="+m),le.isString(w)&&A.push("domain="+w),E===!0&&A.push("secure"),document.cookie=A.join("; ")},read(u){const t=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(u){this.write(u,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function ud(u){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(u)}function hd(u,t){return t?u.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):u}function $c(u,t){return u&&!ud(t)?hd(u,t):t}const rc=u=>u instanceof It?{...u}:u;function Mr(u,t){t=t||{};const l={};function m(se,M,Re){return le.isPlainObject(se)&&le.isPlainObject(M)?le.merge.call({caseless:Re},se,M):le.isPlainObject(M)?le.merge({},M):le.isArray(M)?M.slice():M}function w(se,M,Re){if(le.isUndefined(M)){if(!le.isUndefined(se))return m(void 0,se,Re)}else return m(se,M,Re)}function E(se,M){if(!le.isUndefined(M))return m(void 0,M)}function A(se,M){if(le.isUndefined(M)){if(!le.isUndefined(se))return m(void 0,se)}else return m(void 0,M)}function W(se,M,Re){if(Re in t)return m(se,M);if(Re in u)return m(void 0,se)}const V={url:E,method:E,data:E,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:W,headers:(se,M)=>w(rc(se),rc(M),!0)};return le.forEach(Object.keys(Object.assign({},u,t)),function(M){const Re=V[M]||w,Ye=Re(u[M],t[M],M);le.isUndefined(Ye)&&Re!==W||(l[M]=Ye)}),l}const Wc=u=>{const t=Mr({},u);let{data:l,withXSRFToken:m,xsrfHeaderName:w,xsrfCookieName:E,headers:A,auth:W}=t;t.headers=A=It.from(A),t.url=jc($c(t.baseURL,t.url),u.params,u.paramsSerializer),W&&A.set("Authorization","Basic "+btoa((W.username||"")+":"+(W.password?unescape(encodeURIComponent(W.password)):"")));let V;if(le.isFormData(l)){if(Lt.hasStandardBrowserEnv||Lt.hasStandardBrowserWebWorkerEnv)A.setContentType(void 0);else if((V=A.getContentType())!==!1){const[se,...M]=V?V.split(";").map(Re=>Re.trim()).filter(Boolean):[];A.setContentType([se||"multipart/form-data",...M].join("; "))}}if(Lt.hasStandardBrowserEnv&&(m&&le.isFunction(m)&&(m=m(t)),m||m!==!1&&ld(t.url))){const se=w&&E&&cd.read(E);se&&A.set(w,se)}return t},fd=typeof XMLHttpRequest<"u",dd=fd&&function(u){return new Promise(function(l,m){const w=Wc(u);let E=w.data;const A=It.from(w.headers).normalize();let{responseType:W}=w,V;function se(){w.cancelToken&&w.cancelToken.unsubscribe(V),w.signal&&w.signal.removeEventListener("abort",V)}let M=new XMLHttpRequest;M.open(w.method.toUpperCase(),w.url,!0),M.timeout=w.timeout;function Re(){if(!M)return;const Je=It.from("getAllResponseHeaders"in M&&M.getAllResponseHeaders()),Ce={data:!W||W==="text"||W==="json"?M.responseText:M.response,status:M.status,statusText:M.statusText,headers:Je,config:u,request:M};Fc(function(Fe){l(Fe),se()},function(Fe){m(Fe),se()},Ce),M=null}"onloadend"in M?M.onloadend=Re:M.onreadystatechange=function(){!M||M.readyState!==4||M.status===0&&!(M.responseURL&&M.responseURL.indexOf("file:")===0)||setTimeout(Re)},M.onabort=function(){M&&(m(new He("Request aborted",He.ECONNABORTED,w,M)),M=null)},M.onerror=function(){m(new He("Network Error",He.ERR_NETWORK,w,M)),M=null},M.ontimeout=function(){let xe=w.timeout?"timeout of "+w.timeout+"ms exceeded":"timeout exceeded";const Ce=w.transitional||Uc;w.timeoutErrorMessage&&(xe=w.timeoutErrorMessage),m(new He(xe,Ce.clarifyTimeoutError?He.ETIMEDOUT:He.ECONNABORTED,w,M)),M=null},E===void 0&&A.setContentType(null),"setRequestHeader"in M&&le.forEach(A.toJSON(),function(xe,Ce){M.setRequestHeader(Ce,xe)}),le.isUndefined(w.withCredentials)||(M.withCredentials=!!w.withCredentials),W&&W!=="json"&&(M.responseType=w.responseType),typeof w.onDownloadProgress=="function"&&M.addEventListener("progress",$n(w.onDownloadProgress,!0)),typeof w.onUploadProgress=="function"&&M.upload&&M.upload.addEventListener("progress",$n(w.onUploadProgress)),(w.cancelToken||w.signal)&&(V=Je=>{M&&(m(!Je||Je.type?new qr(null,u,M):Je),M.abort(),M=null)},w.cancelToken&&w.cancelToken.subscribe(V),w.signal&&(w.signal.aborted?V():w.signal.addEventListener("abort",V)));const Ye=od(w.url);if(Ye&&Lt.protocols.indexOf(Ye)===-1){m(new He("Unsupported protocol "+Ye+":",He.ERR_BAD_REQUEST,u));return}M.send(E||null)})},pd=(u,t)=>{let l=new AbortController,m;const w=function(V){if(!m){m=!0,A();const se=V instanceof Error?V:this.reason;l.abort(se instanceof He?se:new qr(se instanceof Error?se.message:se))}};let E=t&&setTimeout(()=>{w(new He(`timeout ${t} of ms exceeded`,He.ETIMEDOUT))},t);const A=()=>{u&&(E&&clearTimeout(E),E=null,u.forEach(V=>{V&&(V.removeEventListener?V.removeEventListener("abort",w):V.unsubscribe(w))}),u=null)};u.forEach(V=>V&&V.addEventListener&&V.addEventListener("abort",w));const{signal:W}=l;return W.unsubscribe=A,[W,()=>{E&&clearTimeout(E),E=null}]},gd=function*(u,t){let l=u.byteLength;if(!t||l<t){yield u;return}let m=0,w;for(;m<l;)w=m+t,yield u.slice(m,w),m=w},md=async function*(u,t,l){for await(const m of u)yield*gd(ArrayBuffer.isView(m)?m:await l(String(m)),t)},nc=(u,t,l,m,w)=>{const E=md(u,t,w);let A=0;return new ReadableStream({type:"bytes",async pull(W){const{done:V,value:se}=await E.next();if(V){W.close(),m();return}let M=se.byteLength;l&&l(A+=M),W.enqueue(new Uint8Array(se))},cancel(W){return m(W),E.return()}},{highWaterMark:2})},ic=(u,t)=>{const l=u!=null;return m=>setTimeout(()=>t({lengthComputable:l,total:u,loaded:m}))},ci=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Hc=ci&&typeof ReadableStream=="function",cs=ci&&(typeof TextEncoder=="function"?(u=>t=>u.encode(t))(new TextEncoder):async u=>new Uint8Array(await new Response(u).arrayBuffer())),bd=Hc&&(()=>{let u=!1;const t=new Request(Lt.origin,{body:new ReadableStream,method:"POST",get duplex(){return u=!0,"half"}}).headers.has("Content-Type");return u&&!t})(),oc=64*1024,us=Hc&&!!(()=>{try{return le.isReadableStream(new Response("").body)}catch{}})(),Wn={stream:us&&(u=>u.body)};ci&&(u=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Wn[t]&&(Wn[t]=le.isFunction(u[t])?l=>l[t]():(l,m)=>{throw new He(`Response type '${t}' is not supported`,He.ERR_NOT_SUPPORT,m)})})})(new Response);const yd=async u=>{if(u==null)return 0;if(le.isBlob(u))return u.size;if(le.isSpecCompliantForm(u))return(await new Request(u).arrayBuffer()).byteLength;if(le.isArrayBufferView(u))return u.byteLength;if(le.isURLSearchParams(u)&&(u=u+""),le.isString(u))return(await cs(u)).byteLength},_d=async(u,t)=>{const l=le.toFiniteNumber(u.getContentLength());return l??yd(t)},wd=ci&&(async u=>{let{url:t,method:l,data:m,signal:w,cancelToken:E,timeout:A,onDownloadProgress:W,onUploadProgress:V,responseType:se,headers:M,withCredentials:Re="same-origin",fetchOptions:Ye}=Wc(u);se=se?(se+"").toLowerCase():"text";let[Je,xe]=w||E||A?pd([w,E],A):[],Ce,Ve;const Fe=()=>{!Ce&&setTimeout(()=>{Je&&Je.unsubscribe()}),Ce=!0};let vt;try{if(V&&bd&&l!=="get"&&l!=="head"&&(vt=await _d(M,m))!==0){let xt=new Request(t,{method:"POST",body:m,duplex:"half"}),qt;le.isFormData(m)&&(qt=xt.headers.get("content-type"))&&M.setContentType(qt),xt.body&&(m=nc(xt.body,oc,ic(vt,$n(V)),null,cs))}le.isString(Re)||(Re=Re?"cors":"omit"),Ve=new Request(t,{...Ye,signal:Je,method:l.toUpperCase(),headers:M.normalize().toJSON(),body:m,duplex:"half",withCredentials:Re});let Xe=await fetch(Ve);const ar=us&&(se==="stream"||se==="response");if(us&&(W||ar)){const xt={};["status","statusText","headers"].forEach(Vr=>{xt[Vr]=Xe[Vr]});const qt=le.toFiniteNumber(Xe.headers.get("content-length"));Xe=new Response(nc(Xe.body,oc,W&&ic(qt,$n(W,!0)),ar&&Fe,cs),xt)}se=se||"text";let un=await Wn[le.findKey(Wn,se)||"text"](Xe,u);return!ar&&Fe(),xe&&xe(),await new Promise((xt,qt)=>{Fc(xt,qt,{data:un,headers:It.from(Xe.headers),status:Xe.status,statusText:Xe.statusText,config:u,request:Ve})})}catch(Xe){throw Fe(),Xe&&Xe.name==="TypeError"&&/fetch/i.test(Xe.message)?Object.assign(new He("Network Error",He.ERR_NETWORK,u,Ve),{cause:Xe.cause||Xe}):He.from(Xe,Xe&&Xe.code,u,Ve)}}),hs={http:Uf,xhr:dd,fetch:wd};le.forEach(hs,(u,t)=>{if(u){try{Object.defineProperty(u,"name",{value:t})}catch{}Object.defineProperty(u,"adapterName",{value:t})}});const sc=u=>`- ${u}`,vd=u=>le.isFunction(u)||u===null||u===!1,qc={getAdapter:u=>{u=le.isArray(u)?u:[u];const{length:t}=u;let l,m;const w={};for(let E=0;E<t;E++){l=u[E];let A;if(m=l,!vd(l)&&(m=hs[(A=String(l)).toLowerCase()],m===void 0))throw new He(`Unknown adapter '${A}'`);if(m)break;w[A||"#"+E]=m}if(!m){const E=Object.entries(w).map(([W,V])=>`adapter ${W} `+(V===!1?"is not supported by the environment":"is not available in the build"));let A=t?E.length>1?`since :
`+E.map(sc).join(`
`):" "+sc(E[0]):"as no adapter specified";throw new He("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return m},adapters:hs};function is(u){if(u.cancelToken&&u.cancelToken.throwIfRequested(),u.signal&&u.signal.aborted)throw new qr(null,u)}function ac(u){return is(u),u.headers=It.from(u.headers),u.data=ns.call(u,u.transformRequest),["post","put","patch"].indexOf(u.method)!==-1&&u.headers.setContentType("application/x-www-form-urlencoded",!1),qc.getAdapter(u.adapter||ln.adapter)(u).then(function(m){return is(u),m.data=ns.call(u,u.transformResponse,m),m.headers=It.from(m.headers),m},function(m){return Dc(m)||(is(u),m&&m.response&&(m.response.data=ns.call(u,u.transformResponse,m.response),m.response.headers=It.from(m.response.headers))),Promise.reject(m)})}const Vc="1.7.2",Ps={};["object","boolean","number","function","string","symbol"].forEach((u,t)=>{Ps[u]=function(m){return typeof m===u||"a"+(t<1?"n ":" ")+u}});const lc={};Ps.transitional=function(t,l,m){function w(E,A){return"[Axios v"+Vc+"] Transitional option '"+E+"'"+A+(m?". "+m:"")}return(E,A,W)=>{if(t===!1)throw new He(w(A," has been removed"+(l?" in "+l:"")),He.ERR_DEPRECATED);return l&&!lc[A]&&(lc[A]=!0,console.warn(w(A," has been deprecated since v"+l+" and will be removed in the near future"))),t?t(E,A,W):!0}};function Ed(u,t,l){if(typeof u!="object")throw new He("options must be an object",He.ERR_BAD_OPTION_VALUE);const m=Object.keys(u);let w=m.length;for(;w-- >0;){const E=m[w],A=t[E];if(A){const W=u[E],V=W===void 0||A(W,E,u);if(V!==!0)throw new He("option "+E+" must be "+V,He.ERR_BAD_OPTION_VALUE);continue}if(l!==!0)throw new He("Unknown option "+E,He.ERR_BAD_OPTION)}}const fs={assertOptions:Ed,validators:Ps},hr=fs.validators;let xr=class{constructor(t){this.defaults=t,this.interceptors={request:new ec,response:new ec}}async request(t,l){try{return await this._request(t,l)}catch(m){if(m instanceof Error){let w;Error.captureStackTrace?Error.captureStackTrace(w={}):w=new Error;const E=w.stack?w.stack.replace(/^.+\n/,""):"";try{m.stack?E&&!String(m.stack).endsWith(E.replace(/^.+\n.+\n/,""))&&(m.stack+=`
`+E):m.stack=E}catch{}}throw m}}_request(t,l){typeof t=="string"?(l=l||{},l.url=t):l=t||{},l=Mr(this.defaults,l);const{transitional:m,paramsSerializer:w,headers:E}=l;m!==void 0&&fs.assertOptions(m,{silentJSONParsing:hr.transitional(hr.boolean),forcedJSONParsing:hr.transitional(hr.boolean),clarifyTimeoutError:hr.transitional(hr.boolean)},!1),w!=null&&(le.isFunction(w)?l.paramsSerializer={serialize:w}:fs.assertOptions(w,{encode:hr.function,serialize:hr.function},!0)),l.method=(l.method||this.defaults.method||"get").toLowerCase();let A=E&&le.merge(E.common,E[l.method]);E&&le.forEach(["delete","get","head","post","put","patch","common"],xe=>{delete E[xe]}),l.headers=It.concat(A,E);const W=[];let V=!0;this.interceptors.request.forEach(function(Ce){typeof Ce.runWhen=="function"&&Ce.runWhen(l)===!1||(V=V&&Ce.synchronous,W.unshift(Ce.fulfilled,Ce.rejected))});const se=[];this.interceptors.response.forEach(function(Ce){se.push(Ce.fulfilled,Ce.rejected)});let M,Re=0,Ye;if(!V){const xe=[ac.bind(this),void 0];for(xe.unshift.apply(xe,W),xe.push.apply(xe,se),Ye=xe.length,M=Promise.resolve(l);Re<Ye;)M=M.then(xe[Re++],xe[Re++]);return M}Ye=W.length;let Je=l;for(Re=0;Re<Ye;){const xe=W[Re++],Ce=W[Re++];try{Je=xe(Je)}catch(Ve){Ce.call(this,Ve);break}}try{M=ac.call(this,Je)}catch(xe){return Promise.reject(xe)}for(Re=0,Ye=se.length;Re<Ye;)M=M.then(se[Re++],se[Re++]);return M}getUri(t){t=Mr(this.defaults,t);const l=$c(t.baseURL,t.url);return jc(l,t.params,t.paramsSerializer)}};le.forEach(["delete","get","head","options"],function(t){xr.prototype[t]=function(l,m){return this.request(Mr(m||{},{method:t,url:l,data:(m||{}).data}))}});le.forEach(["post","put","patch"],function(t){function l(m){return function(E,A,W){return this.request(Mr(W||{},{method:t,headers:m?{"Content-Type":"multipart/form-data"}:{},url:E,data:A}))}}xr.prototype[t]=l(),xr.prototype[t+"Form"]=l(!0)});let Sd=class zc{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let l;this.promise=new Promise(function(E){l=E});const m=this;this.promise.then(w=>{if(!m._listeners)return;let E=m._listeners.length;for(;E-- >0;)m._listeners[E](w);m._listeners=null}),this.promise.then=w=>{let E;const A=new Promise(W=>{m.subscribe(W),E=W}).then(w);return A.cancel=function(){m.unsubscribe(E)},A},t(function(E,A,W){m.reason||(m.reason=new qr(E,A,W),l(m.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const l=this._listeners.indexOf(t);l!==-1&&this._listeners.splice(l,1)}static source(){let t;return{token:new zc(function(w){t=w}),cancel:t}}};function Ad(u){return function(l){return u.apply(null,l)}}function Cd(u){return le.isObject(u)&&u.isAxiosError===!0}const ds={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ds).forEach(([u,t])=>{ds[t]=u});function Kc(u){const t=new xr(u),l=Ac(xr.prototype.request,t);return le.extend(l,xr.prototype,t,{allOwnKeys:!0}),le.extend(l,t,null,{allOwnKeys:!0}),l.create=function(w){return Kc(Mr(u,w))},l}const ut=Kc(ln);ut.Axios=xr;ut.CanceledError=qr;ut.CancelToken=Sd;ut.isCancel=Dc;ut.VERSION=Vc;ut.toFormData=li;ut.AxiosError=He;ut.Cancel=ut.CanceledError;ut.all=function(t){return Promise.all(t)};ut.spread=Ad;ut.isAxiosError=Cd;ut.mergeConfig=Mr;ut.AxiosHeaders=It;ut.formToJSON=u=>Lc(le.isHTMLForm(u)?new FormData(u):u);ut.getAdapter=qc.getAdapter;ut.HttpStatusCode=ds;ut.default=ut;const{Axios:Lp,AxiosError:Dp,CanceledError:Fp,isCancel:$p,CancelToken:Wp,VERSION:Hp,all:qp,Cancel:Vp,isAxiosError:zp,spread:Kp,toFormData:Jp,AxiosHeaders:Id,HttpStatusCode:Qp,formToJSON:Yp,getAdapter:Gp,mergeConfig:Xp}=ut;class Hn extends Error{constructor(l,m,w,E,A,W){super(w[0]);Be(this,"errorType");Be(this,"errors");Be(this,"validationMessages");Be(this,"innerError");Be(this,"logKey");Be(this,"command");this.command=l,this.errorType=m?"ValidationError":E?"CommunicationError":"ExecutionError",this.innerError=E,this.errors=w,this.validationMessages=A,this.logKey=W}}var Qn;const Yn=class Yn{constructor(t){Be(this,"sliderValue");Be(this,"_brand");this.sliderValue=t??0,Ge["CK.Observable.ServerSample.App.ISliderCommand"].set(this)}get commandModel(){return D(Yn,Qn)}};Qn=new WeakMap,Qe(Yn,Qn,{applyAmbientValues(t,l,m){}});let qn=Yn;var Gn;const Xn=class Xn{constructor(t,l,m){Be(this,"mqttClientId");Be(this,"domainName");Be(this,"transactionNumber");Be(this,"_brand");this.mqttClientId=t??"",this.domainName=l??"",this.transactionNumber=m??0,Ge["CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand"].set(this)}get commandModel(){return D(Xn,Gn)}};Gn=new WeakMap,Qe(Xn,Gn,{applyAmbientValues(t,l,m){}});let Vn=Xn;var Zn;const ei=class ei{constructor(t,l,m){Be(this,"clientId");Be(this,"domainName");Be(this,"transactionNumber");Be(this,"_brand");this.clientId=t??"",this.domainName=l??"",this.transactionNumber=m??0,Ge["CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand"].set(this)}get commandModel(){return D(ei,Zn)}};Zn=new WeakMap,Qe(ei,Zn,{applyAmbientValues(t,l,m){}});let zn=ei;class Td{constructor(t,l,m){Be(this,"result");Be(this,"validationMessages");Be(this,"correlationId");Be(this,"_brand");this.result=t,this.validationMessages=l,this.correlationId=m,Ge.AspNetResult.set(this)}}class Jc{constructor(t,l,m){Be(this,"isValidationError");Be(this,"errors");Be(this,"logKey");Be(this,"_brand");this.isValidationError=t??!1,this.errors=l??[],this.logKey=m,Ge.AspNetCrisResultError.set(this)}}class kd{constructor(t,l,m,w){Be(this,"currentCultureName");Be(this,"actorId");Be(this,"actualActorId");Be(this,"deviceId");Be(this,"_brand");this.currentCultureName=t??"",this.actorId=l??0,this.actualActorId=m??0,this.deviceId=w??"",Ge["CK.Cris.AmbientValues.IAmbientValues"].set(this)}}var Pr=(u=>(u[u.None=0]="None",u[u.Info=4]="Info",u[u.Warn=8]="Warn",u[u.Error=16]="Error",u))(Pr||{}),ti;const or=class or{constructor(t,l,m=0){this.level=t,this.message=l,this.depth=m,Ge.SimpleUserMessage.set(this)}static get invalid(){return D(or,ti)??Ue(or,ti,new or(Pr.None,"",0))}toString(){return"["+Pr[this.level]+"] "+this.message}toJSON(){return this.level!==Pr.None?[this.level,this.message,this.depth]:[0]}static parse(t){if(t instanceof Array){if(t.length===1){if(t[0]===0)return or.invalid}else if(t.length==3){const l=t[0];if(l===Pr.Info||l===Pr.Warn||l===Pr.Error){const m=t[1];if(typeof m=="string"){const w=t[2];if(typeof w=="number"&&w>=0&&w<=255)return new or(l,m,w)}}}}throw new Error("Unable to parse '{{o}}' as SimpleUserMessage.")}};ti=new WeakMap,Qe(or,ti);let ps=or;const Ge={toTypedJson(u){if(u==null)return null;const t=u[St];if(!t)throw new Error("Untyped object. A type must be specified with CTSType.");return[t.name,t.json(u)]},fromTypedJson(u){if(u==null)return;if(!(u instanceof Array&&u.length===2))throw new Error("Expected 2-cells array.");var t=Ge[u[0]];if(!t)throw new Error(`Invalid type name: ${u[0]}.`);if(!t.set)throw new Error(`Type name '${u[0]}' is not serializable.`);const l=t.nosj(u[1]);return l!==null&&typeof l=="object"?t.set(l):l},stringify(u,t=!0){var l=Ge.toTypedJson(u);return JSON.stringify(t?l:l[1])},parse(u){return Ge.fromTypedJson(JSON.parse(u))},"CK.Observable.ServerSample.App.ISliderCommand":{name:"CK.Observable.ServerSample.App.ISliderCommand",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new qn(Ge.float.nosj(u.sliderValue))}},"CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand":{name:"CK.Observable.MQTTWatcher.IMQTTObservableWatcherStartOrRestartCommand",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new Vn(Ge.string.nosj(u.mqttClientId),Ge.string.nosj(u.domainName),Ge.int.nosj(u.transactionNumber))}},"CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand":{name:"CK.Observable.SignalRWatcher.ISignalRObservableWatcherStartOrRestartCommand",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new zn(Ge.string.nosj(u.clientId),Ge.string.nosj(u.domainName),Ge.int.nosj(u.transactionNumber))}},AspNetResult:{name:"AspNetResult",set(u){return u[St]=this,u},json(u){if(!u)return null;let t={};return t.result=Ge.toTypedJson(u.result),t.validationMessages=u.validationMessages,t.correlationId=u.correlationId,t},nosj(u){if(u!=null)return new Td(Ge.fromTypedJson(u.result),Ge["L(SimpleUserMessage)"].nosj(u.validationMessages),Ge.string.nosj(u.correlationId))}},AspNetCrisResultError:{name:"AspNetCrisResultError",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new Jc(Ge.bool.nosj(u.isValidationError),Ge["L(string)"].nosj(u.errors),Ge.string.nosj(u.logKey))}},"CK.Cris.AmbientValues.IAmbientValues":{name:"CK.Cris.AmbientValues.IAmbientValues",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new kd(Ge.string.nosj(u.currentCultureName),Ge.int.nosj(u.actorId),Ge.int.nosj(u.actualActorId),Ge.string.nosj(u.deviceId))}},"CK.Cris.AmbientValues.IAmbientValuesCollectCommand":{name:"CK.Cris.AmbientValues.IAmbientValuesCollectCommand",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u!=null)return new Kn}},"CK.Cris.ICommand<CK.Cris.AmbientValues.IAmbientValues>":{name:"CK.Cris.ICommand<CK.Cris.AmbientValues.IAmbientValues>"},string:{name:"string",set(u){return u=Object(u),u[St]=this,u},json(u){return u},nosj(u){return u??void 0}},"CK.Cris.ICommand<string>":{name:"CK.Cris.ICommand<string>"},"CK.Cris.ICommand":{name:"CK.Cris.ICommand"},"CK.Cris.IAbstractCommand":{name:"CK.Cris.IAbstractCommand"},"CK.Cris.ICrisPoco":{name:"CK.Cris.ICrisPoco"},"CK.Core.IPoco":{name:"CK.Core.IPoco"},int:{name:"int",set(u){return u=Object(u),u[St]=this,u},json(u){return u},nosj(u){return u??void 0}},bool:{name:"bool",set(u){return u=Object(u),u[St]=this,u},json(u){return u},nosj(u){return u??void 0}},object:{name:"object"},SimpleUserMessage:{name:"SimpleUserMessage",set(u){return u[St]=this,u},json(u){return u},nosj(u){return u!=null?ps.parse(u):void 0}},"L(SimpleUserMessage)":{name:"L(SimpleUserMessage)",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u==null)return;if(!(u instanceof Array))throw new Error("Expected Array.");const t=Ge.SimpleUserMessage;return u.map(t.nosj)}},"L(string?)":{name:"L(string?)",set(u){return u[St]=this,u},json(u){return u},nosj(u){if(u==null)return;if(!(u instanceof Array))throw new Error("Expected Array.");const t=Ge.string;return u.map(t.nosj)}},"L(string)":{name:"L(string)",json(u){return u},nosj(u){if(u==null)return;if(!(u instanceof Array))throw new Error("Expected Array.");const t=Ge.string;return u.map(t.nosj)}},float:{name:"float",set(u){return u=Object(u),u[St]=this,u},json(u){return u},nosj(u){return u??void 0}}},St=Symbol.for("CK.CTSType");var ri;const ni=class ni{constructor(){Be(this,"_brand");Ge["CK.Cris.AmbientValues.IAmbientValuesCollectCommand"].set(this)}get commandModel(){return D(ni,ri)}};ri=new WeakMap,Qe(ni,ri,{applyAmbientValues(t,l,m){}});let Kn=ni;class Rd{constructor(){Be(this,"currentCultureName");Be(this,"actorId");Be(this,"actualActorId");Be(this,"deviceId");this.currentCultureName=null,this.actorId=null,this.actualActorId=null,this.deviceId=null}}class Od{constructor(){Be(this,"_ambientValuesRequest");Be(this,"_ambientValues");Be(this,"_subscribers");Be(this,"_isConnected");Be(this,"ambientValuesOverride");this.ambientValuesOverride=new Rd,this._isConnected=!1,this._subscribers=new Set}get isConnected(){return this._isConnected}addOnIsConnectedChanged(t){t&&this._subscribers.add(t)}removeOnIsConnectedChange(t){return this._subscribers.delete(t)}setIsConnected(t){this._isConnected!==t&&(this._isConnected=t,t||this.updateAmbientValuesAsync(),this._subscribers.forEach(l=>l(this)))}updateAmbientValuesAsync(){return this._ambientValuesRequest?this._ambientValuesRequest:(this._ambientValues=void 0,this._ambientValuesRequest=this.waitForAmbientValuesAsync())}async sendAsync(t){let l=this._ambientValues;return l===void 0&&(l=await this.updateAmbientValuesAsync()),t.commandModel.applyAmbientValues(t,l,this.ambientValuesOverride),await this.doSendAsync(t)}async sendOrThrowAsync(t){const l=await this.sendAsync(t);if(l.result instanceof Hn)throw l.result;return l.result}async waitForAmbientValuesAsync(){for(;;){var t=await this.doSendAsync(new Kn);if(t.result instanceof Hn)console.error("Error while getting AmbientValues. Retrying.",t.result),this.setIsConnected(!1);else return this._ambientValuesRequest=void 0,this._ambientValues=t.result,this.setIsConnected(!0),this._ambientValues}}}const Pd={responseType:"text",headers:{common:new Id({"Content-Type":"application/json"})}};class xd extends Od{constructor(l,m){super();Be(this,"axiosConfig");this.axios=l,this.crisEndpointUrl=m,this.axiosConfig=Pd}async doSendAsync(l){try{const w=JSON.stringify(Ge.toTypedJson(l)),E=await this.axios.post(this.crisEndpointUrl,w,this.axiosConfig),A=Ge.AspNetResult.nosj(JSON.parse(E.data));let W=A.result;return W instanceof Jc&&(W=new Hn(l,W.isValidationError,W.errors,void 0,A.validationMessages,W.logKey)),{command:l,result:W,validationMessages:A.validationMessages,correlationId:A.correlationId}}catch(w){var m;return w instanceof Error?m=w:(console.error(w),m=new Error(`Unhandled error ${w}.`)),this.setIsConnected(!1),{command:l,result:new Hn(l,!1,["Communication error"],m)}}}}class Br extends Error{constructor(t,l){const m=new.target.prototype;super(`${t}: Status code '${l}'`),this.statusCode=l,this.__proto__=m}}class xs extends Error{constructor(t="A timeout occurred."){const l=new.target.prototype;super(t),this.__proto__=l}}class Ut extends Error{constructor(t="An abort occurred."){const l=new.target.prototype;super(t),this.__proto__=l}}class Bd extends Error{constructor(t,l){const m=new.target.prototype;super(t),this.transport=l,this.errorType="UnsupportedTransportError",this.__proto__=m}}class Nd extends Error{constructor(t,l){const m=new.target.prototype;super(t),this.transport=l,this.errorType="DisabledTransportError",this.__proto__=m}}class Md extends Error{constructor(t,l){const m=new.target.prototype;super(t),this.transport=l,this.errorType="FailedToStartTransportError",this.__proto__=m}}class cc extends Error{constructor(t){const l=new.target.prototype;super(t),this.errorType="FailedToNegotiateWithServerError",this.__proto__=l}}class jd extends Error{constructor(t,l){const m=new.target.prototype;super(t),this.innerErrors=l,this.__proto__=m}}class Qc{constructor(t,l,m){this.statusCode=t,this.statusText=l,this.content=m}}class ui{get(t,l){return this.send({...l,method:"GET",url:t})}post(t,l){return this.send({...l,method:"POST",url:t})}delete(t,l){return this.send({...l,method:"DELETE",url:t})}getCookieString(t){return""}}var ge;(function(u){u[u.Trace=0]="Trace",u[u.Debug=1]="Debug",u[u.Information=2]="Information",u[u.Warning=3]="Warning",u[u.Error=4]="Error",u[u.Critical=5]="Critical",u[u.None=6]="None"})(ge||(ge={}));class on{constructor(){}log(t,l){}}on.instance=new on;const Ud="8.0.0";class ft{static isRequired(t,l){if(t==null)throw new Error(`The '${l}' argument is required.`)}static isNotEmpty(t,l){if(!t||t.match(/^\s*$/))throw new Error(`The '${l}' argument should not be empty.`)}static isIn(t,l,m){if(!(t in l))throw new Error(`Unknown ${m} value: ${t}.`)}}class at{static get isBrowser(){return!at.isNode&&typeof window=="object"&&typeof window.document=="object"}static get isWebWorker(){return!at.isNode&&typeof self=="object"&&"importScripts"in self}static get isReactNative(){return!at.isNode&&typeof window=="object"&&typeof window.document>"u"}static get isNode(){return typeof process<"u"&&process.release&&process.release.name==="node"}}function sn(u,t){let l="";return jr(u)?(l=`Binary data of length ${u.byteLength}`,t&&(l+=`. Content: '${Ld(u)}'`)):typeof u=="string"&&(l=`String data of length ${u.length}`,t&&(l+=`. Content: '${u}'`)),l}function Ld(u){const t=new Uint8Array(u);let l="";return t.forEach(m=>{const w=m<16?"0":"";l+=`0x${w}${m.toString(16)} `}),l.substr(0,l.length-1)}function jr(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}async function Yc(u,t,l,m,w,E){const A={},[W,V]=Wr();A[W]=V,u.log(ge.Trace,`(${t} transport) sending data. ${sn(w,E.logMessageContent)}.`);const se=jr(w)?"arraybuffer":"text",M=await l.post(m,{content:w,headers:{...A,...E.headers},responseType:se,timeout:E.timeout,withCredentials:E.withCredentials});u.log(ge.Trace,`(${t} transport) request complete. Response status: ${M.statusCode}.`)}function Dd(u){return u===void 0?new Jn(ge.Information):u===null?on.instance:u.log!==void 0?u:new Jn(u)}class Fd{constructor(t,l){this._subject=t,this._observer=l}dispose(){const t=this._subject.observers.indexOf(this._observer);t>-1&&this._subject.observers.splice(t,1),this._subject.observers.length===0&&this._subject.cancelCallback&&this._subject.cancelCallback().catch(l=>{})}}class Jn{constructor(t){this._minLevel=t,this.out=console}log(t,l){if(t>=this._minLevel){const m=`[${new Date().toISOString()}] ${ge[t]}: ${l}`;switch(t){case ge.Critical:case ge.Error:this.out.error(m);break;case ge.Warning:this.out.warn(m);break;case ge.Information:this.out.info(m);break;default:this.out.log(m);break}}}}function Wr(){let u="X-SignalR-User-Agent";return at.isNode&&(u="User-Agent"),[u,$d(Ud,Wd(),qd(),Hd())]}function $d(u,t,l,m){let w="Microsoft SignalR/";const E=u.split(".");return w+=`${E[0]}.${E[1]}`,w+=` (${u}; `,t&&t!==""?w+=`${t}; `:w+="Unknown OS; ",w+=`${l}`,m?w+=`; ${m}`:w+="; Unknown Runtime Version",w+=")",w}function Wd(){if(at.isNode)switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}else return""}function Hd(){if(at.isNode)return process.versions.node}function qd(){return at.isNode?"NodeJS":"Browser"}function uc(u){return u.stack?u.stack:u.message?u.message:`${u}`}function Vd(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("could not find global")}function zd(u){return typeof fetch>"u"||at.isNode?(u._jar=new(require("tough-cookie")).CookieJar,typeof fetch>"u"?u._fetchType=require("node-fetch"):u._fetchType=fetch,u._fetchType=require("fetch-cookie")(u._fetchType,u._jar),!0):!1}function Kd(u){return typeof AbortController>"u"?(u._abortControllerType=require("abort-controller"),!0):!1}function Jd(){return require("ws")}function Qd(){return require("eventsource")}class Yd extends ui{constructor(t){super(),this._logger=t;const l={_fetchType:void 0,_jar:void 0};zd(l)?(this._fetchType=l._fetchType,this._jar=l._jar):this._fetchType=fetch.bind(Vd()),this._abortControllerType=AbortController;const m={_abortControllerType:this._abortControllerType};Kd(m)&&(this._abortControllerType=m._abortControllerType)}async send(t){if(t.abortSignal&&t.abortSignal.aborted)throw new Ut;if(!t.method)throw new Error("No method defined.");if(!t.url)throw new Error("No url defined.");const l=new this._abortControllerType;let m;t.abortSignal&&(t.abortSignal.onabort=()=>{l.abort(),m=new Ut});let w=null;if(t.timeout){const V=t.timeout;w=setTimeout(()=>{l.abort(),this._logger.log(ge.Warning,"Timeout from HTTP request."),m=new xs},V)}t.content===""&&(t.content=void 0),t.content&&(t.headers=t.headers||{},jr(t.content)?t.headers["Content-Type"]="application/octet-stream":t.headers["Content-Type"]="text/plain;charset=UTF-8");let E;try{E=await this._fetchType(t.url,{body:t.content,cache:"no-cache",credentials:t.withCredentials===!0?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...t.headers},method:t.method,mode:"cors",redirect:"follow",signal:l.signal})}catch(V){throw m||(this._logger.log(ge.Warning,`Error from HTTP request. ${V}.`),V)}finally{w&&clearTimeout(w),t.abortSignal&&(t.abortSignal.onabort=null)}if(!E.ok){const V=await hc(E,"text");throw new Br(V||E.statusText,E.status)}const W=await hc(E,t.responseType);return new Qc(E.status,E.statusText,W)}getCookieString(t){let l="";return at.isNode&&this._jar&&this._jar.getCookies(t,(m,w)=>l=w.join("; ")),l}}function hc(u,t){let l;switch(t){case"arraybuffer":l=u.arrayBuffer();break;case"text":l=u.text();break;case"blob":case"document":case"json":throw new Error(`${t} is not supported.`);default:l=u.text();break}return l}class Gd extends ui{constructor(t){super(),this._logger=t}send(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new Ut):t.method?t.url?new Promise((l,m)=>{const w=new XMLHttpRequest;w.open(t.method,t.url,!0),w.withCredentials=t.withCredentials===void 0?!0:t.withCredentials,w.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.content===""&&(t.content=void 0),t.content&&(jr(t.content)?w.setRequestHeader("Content-Type","application/octet-stream"):w.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const E=t.headers;E&&Object.keys(E).forEach(A=>{w.setRequestHeader(A,E[A])}),t.responseType&&(w.responseType=t.responseType),t.abortSignal&&(t.abortSignal.onabort=()=>{w.abort(),m(new Ut)}),t.timeout&&(w.timeout=t.timeout),w.onload=()=>{t.abortSignal&&(t.abortSignal.onabort=null),w.status>=200&&w.status<300?l(new Qc(w.status,w.statusText,w.response||w.responseText)):m(new Br(w.response||w.responseText||w.statusText,w.status))},w.onerror=()=>{this._logger.log(ge.Warning,`Error from HTTP request. ${w.status}: ${w.statusText}.`),m(new Br(w.statusText,w.status))},w.ontimeout=()=>{this._logger.log(ge.Warning,"Timeout from HTTP request."),m(new xs)},w.send(t.content)}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class Xd extends ui{constructor(t){if(super(),typeof fetch<"u"||at.isNode)this._httpClient=new Yd(t);else if(typeof XMLHttpRequest<"u")this._httpClient=new Gd(t);else throw new Error("No usable HttpClient found.")}send(t){return t.abortSignal&&t.abortSignal.aborted?Promise.reject(new Ut):t.method?t.url?this._httpClient.send(t):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(t){return this._httpClient.getCookieString(t)}}class Rt{static write(t){return`${t}${Rt.RecordSeparator}`}static parse(t){if(t[t.length-1]!==Rt.RecordSeparator)throw new Error("Message is incomplete.");const l=t.split(Rt.RecordSeparator);return l.pop(),l}}Rt.RecordSeparatorCode=30;Rt.RecordSeparator=String.fromCharCode(Rt.RecordSeparatorCode);class Zd{writeHandshakeRequest(t){return Rt.write(JSON.stringify(t))}parseHandshakeResponse(t){let l,m;if(jr(t)){const W=new Uint8Array(t),V=W.indexOf(Rt.RecordSeparatorCode);if(V===-1)throw new Error("Message is incomplete.");const se=V+1;l=String.fromCharCode.apply(null,Array.prototype.slice.call(W.slice(0,se))),m=W.byteLength>se?W.slice(se).buffer:null}else{const W=t,V=W.indexOf(Rt.RecordSeparator);if(V===-1)throw new Error("Message is incomplete.");const se=V+1;l=W.substring(0,se),m=W.length>se?W.substring(se):null}const w=Rt.parse(l),E=JSON.parse(w[0]);if(E.type)throw new Error("Expected a handshake response from the server.");return[m,E]}}var We;(function(u){u[u.Invocation=1]="Invocation",u[u.StreamItem=2]="StreamItem",u[u.Completion=3]="Completion",u[u.StreamInvocation=4]="StreamInvocation",u[u.CancelInvocation=5]="CancelInvocation",u[u.Ping=6]="Ping",u[u.Close=7]="Close",u[u.Ack=8]="Ack",u[u.Sequence=9]="Sequence"})(We||(We={}));let ep=class{constructor(){this.observers=[]}next(t){for(const l of this.observers)l.next(t)}error(t){for(const l of this.observers)l.error&&l.error(t)}complete(){for(const t of this.observers)t.complete&&t.complete()}subscribe(t){return this.observers.push(t),new Fd(this,t)}};class tp{constructor(t,l,m){this._bufferSize=1e5,this._messages=[],this._totalMessageCount=0,this._waitForSequenceMessage=!1,this._nextReceivingSequenceId=1,this._latestReceivedSequenceId=0,this._bufferedByteCount=0,this._reconnectInProgress=!1,this._protocol=t,this._connection=l,this._bufferSize=m}async _send(t){const l=this._protocol.writeMessage(t);let m=Promise.resolve();if(this._isInvocationMessage(t)){this._totalMessageCount++;let w=()=>{},E=()=>{};jr(l)?this._bufferedByteCount+=l.byteLength:this._bufferedByteCount+=l.length,this._bufferedByteCount>=this._bufferSize&&(m=new Promise((A,W)=>{w=A,E=W})),this._messages.push(new rp(l,this._totalMessageCount,w,E))}try{this._reconnectInProgress||await this._connection.send(l)}catch{this._disconnected()}await m}_ack(t){let l=-1;for(let m=0;m<this._messages.length;m++){const w=this._messages[m];if(w._id<=t.sequenceId)l=m,jr(w._message)?this._bufferedByteCount-=w._message.byteLength:this._bufferedByteCount-=w._message.length,w._resolver();else if(this._bufferedByteCount<this._bufferSize)w._resolver();else break}l!==-1&&(this._messages=this._messages.slice(l+1))}_shouldProcessMessage(t){if(this._waitForSequenceMessage)return t.type!==We.Sequence?!1:(this._waitForSequenceMessage=!1,!0);if(!this._isInvocationMessage(t))return!0;const l=this._nextReceivingSequenceId;return this._nextReceivingSequenceId++,l<=this._latestReceivedSequenceId?(l===this._latestReceivedSequenceId&&this._ackTimer(),!1):(this._latestReceivedSequenceId=l,this._ackTimer(),!0)}_resetSequence(t){if(t.sequenceId>this._nextReceivingSequenceId){this._connection.stop(new Error("Sequence ID greater than amount of messages we've received."));return}this._nextReceivingSequenceId=t.sequenceId}_disconnected(){this._reconnectInProgress=!0,this._waitForSequenceMessage=!0}async _resend(){const t=this._messages.length!==0?this._messages[0]._id:this._totalMessageCount+1;await this._connection.send(this._protocol.writeMessage({type:We.Sequence,sequenceId:t}));const l=this._messages;for(const m of l)await this._connection.send(m._message);this._reconnectInProgress=!1}_dispose(t){t??(t=new Error("Unable to reconnect to server."));for(const l of this._messages)l._rejector(t)}_isInvocationMessage(t){switch(t.type){case We.Invocation:case We.StreamItem:case We.Completion:case We.StreamInvocation:case We.CancelInvocation:return!0;case We.Close:case We.Sequence:case We.Ping:case We.Ack:return!1}}_ackTimer(){this._ackTimerHandle===void 0&&(this._ackTimerHandle=setTimeout(async()=>{try{this._reconnectInProgress||await this._connection.send(this._protocol.writeMessage({type:We.Ack,sequenceId:this._latestReceivedSequenceId}))}catch{}clearTimeout(this._ackTimerHandle),this._ackTimerHandle=void 0},1e3))}}class rp{constructor(t,l,m,w){this._message=t,this._id=l,this._resolver=m,this._rejector=w}}const np=30*1e3,ip=15*1e3,op=1e5;var ot;(function(u){u.Disconnected="Disconnected",u.Connecting="Connecting",u.Connected="Connected",u.Disconnecting="Disconnecting",u.Reconnecting="Reconnecting"})(ot||(ot={}));class Bs{static create(t,l,m,w,E,A,W){return new Bs(t,l,m,w,E,A,W)}constructor(t,l,m,w,E,A,W){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(ge.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://learn.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},ft.isRequired(t,"connection"),ft.isRequired(l,"logger"),ft.isRequired(m,"protocol"),this.serverTimeoutInMilliseconds=E??np,this.keepAliveIntervalInMilliseconds=A??ip,this._statefulReconnectBufferSize=W??op,this._logger=l,this._protocol=m,this.connection=t,this._reconnectPolicy=w,this._handshakeProtocol=new Zd,this.connection.onreceive=V=>this._processIncomingData(V),this.connection.onclose=V=>this._connectionClosed(V),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=ot.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:We.Ping})}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(t){if(this._connectionState!==ot.Disconnected&&this._connectionState!==ot.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!t)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=t}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==ot.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=ot.Connecting,this._logger.log(ge.Debug,"Starting HubConnection.");try{await this._startInternal(),at.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=ot.Connected,this._connectionStarted=!0,this._logger.log(ge.Debug,"HubConnection connected successfully.")}catch(t){return this._connectionState=ot.Disconnected,this._logger.log(ge.Debug,`HubConnection failed to start successfully because of error '${t}'.`),Promise.reject(t)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const t=new Promise((l,m)=>{this._handshakeResolver=l,this._handshakeRejecter=m});await this.connection.start(this._protocol.transferFormat);try{let l=this._protocol.version;this.connection.features.reconnect||(l=1);const m={protocol:this._protocol.name,version:l};if(this._logger.log(ge.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(m)),this._logger.log(ge.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await t,this._stopDuringStartError)throw this._stopDuringStartError;(this.connection.features.reconnect||!1)&&(this._messageBuffer=new tp(this._protocol,this.connection,this._statefulReconnectBufferSize),this.connection.features.disconnected=this._messageBuffer._disconnected.bind(this._messageBuffer),this.connection.features.resend=()=>{if(this._messageBuffer)return this._messageBuffer._resend()}),this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(l){throw this._logger.log(ge.Debug,`Hub handshake failed with error '${l}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(l),l}}async stop(){const t=this._startPromise;this.connection.features.reconnect=!1,this._stopPromise=this._stopInternal(),await this._stopPromise;try{await t}catch{}}_stopInternal(t){if(this._connectionState===ot.Disconnected)return this._logger.log(ge.Debug,`Call to HubConnection.stop(${t}) ignored because it is already in the disconnected state.`),Promise.resolve();if(this._connectionState===ot.Disconnecting)return this._logger.log(ge.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;const l=this._connectionState;return this._connectionState=ot.Disconnecting,this._logger.log(ge.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(ge.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(l===ot.Connected&&this._sendCloseMessage(),this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=t||new Ut("The connection was stopped before the hub handshake could complete."),this.connection.stop(t))}async _sendCloseMessage(){try{await this._sendWithProtocol(this._createCloseMessage())}catch{}}stream(t,...l){const[m,w]=this._replaceStreamingParams(l),E=this._createStreamInvocation(t,l,w);let A;const W=new ep;return W.cancelCallback=()=>{const V=this._createCancelInvocation(E.invocationId);return delete this._callbacks[E.invocationId],A.then(()=>this._sendWithProtocol(V))},this._callbacks[E.invocationId]=(V,se)=>{if(se){W.error(se);return}else V&&(V.type===We.Completion?V.error?W.error(new Error(V.error)):W.complete():W.next(V.item))},A=this._sendWithProtocol(E).catch(V=>{W.error(V),delete this._callbacks[E.invocationId]}),this._launchStreams(m,A),W}_sendMessage(t){return this._resetKeepAliveInterval(),this.connection.send(t)}_sendWithProtocol(t){return this._messageBuffer?this._messageBuffer._send(t):this._sendMessage(this._protocol.writeMessage(t))}send(t,...l){const[m,w]=this._replaceStreamingParams(l),E=this._sendWithProtocol(this._createInvocation(t,l,!0,w));return this._launchStreams(m,E),E}invoke(t,...l){const[m,w]=this._replaceStreamingParams(l),E=this._createInvocation(t,l,!1,w);return new Promise((W,V)=>{this._callbacks[E.invocationId]=(M,Re)=>{if(Re){V(Re);return}else M&&(M.type===We.Completion?M.error?V(new Error(M.error)):W(M.result):V(new Error(`Unexpected message type: ${M.type}`)))};const se=this._sendWithProtocol(E).catch(M=>{V(M),delete this._callbacks[E.invocationId]});this._launchStreams(m,se)})}on(t,l){!t||!l||(t=t.toLowerCase(),this._methods[t]||(this._methods[t]=[]),this._methods[t].indexOf(l)===-1&&this._methods[t].push(l))}off(t,l){if(!t)return;t=t.toLowerCase();const m=this._methods[t];if(m)if(l){const w=m.indexOf(l);w!==-1&&(m.splice(w,1),m.length===0&&delete this._methods[t])}else delete this._methods[t]}onclose(t){t&&this._closedCallbacks.push(t)}onreconnecting(t){t&&this._reconnectingCallbacks.push(t)}onreconnected(t){t&&this._reconnectedCallbacks.push(t)}_processIncomingData(t){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(t=this._processHandshakeResponse(t),this._receivedHandshakeResponse=!0),t){const l=this._protocol.parseMessages(t,this._logger);for(const m of l)if(!(this._messageBuffer&&!this._messageBuffer._shouldProcessMessage(m)))switch(m.type){case We.Invocation:this._invokeClientMethod(m);break;case We.StreamItem:case We.Completion:{const w=this._callbacks[m.invocationId];if(w){m.type===We.Completion&&delete this._callbacks[m.invocationId];try{w(m)}catch(E){this._logger.log(ge.Error,`Stream callback threw error: ${uc(E)}`)}}break}case We.Ping:break;case We.Close:{this._logger.log(ge.Information,"Close message received from server.");const w=m.error?new Error("Server returned an error on close: "+m.error):void 0;m.allowReconnect===!0?this.connection.stop(w):this._stopPromise=this._stopInternal(w);break}case We.Ack:this._messageBuffer&&this._messageBuffer._ack(m);break;case We.Sequence:this._messageBuffer&&this._messageBuffer._resetSequence(m);break;default:this._logger.log(ge.Warning,`Invalid message type: ${m.type}.`);break}}this._resetTimeoutPeriod()}_processHandshakeResponse(t){let l,m;try{[m,l]=this._handshakeProtocol.parseHandshakeResponse(t)}catch(w){const E="Error parsing handshake response: "+w;this._logger.log(ge.Error,E);const A=new Error(E);throw this._handshakeRejecter(A),A}if(l.error){const w="Server returned handshake error: "+l.error;this._logger.log(ge.Error,w);const E=new Error(w);throw this._handshakeRejecter(E),E}else this._logger.log(ge.Debug,"Server handshake complete.");return this._handshakeResolver(),m}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=new Date().getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if((!this.connection.features||!this.connection.features.inherentKeepAlive)&&(this._timeoutHandle=setTimeout(()=>this.serverTimeout(),this.serverTimeoutInMilliseconds),this._pingServerHandle===void 0)){let t=this._nextKeepAlive-new Date().getTime();t<0&&(t=0),this._pingServerHandle=setTimeout(async()=>{if(this._connectionState===ot.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}},t)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(t){const l=t.target.toLowerCase(),m=this._methods[l];if(!m){this._logger.log(ge.Warning,`No client method with the name '${l}' found.`),t.invocationId&&(this._logger.log(ge.Warning,`No result given for '${l}' method and invocation ID '${t.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(t.invocationId,"Client didn't provide a result.",null)));return}const w=m.slice(),E=!!t.invocationId;let A,W,V;for(const se of w)try{const M=A;A=await se.apply(this,t.arguments),E&&A&&M&&(this._logger.log(ge.Error,`Multiple results provided for '${l}'. Sending error to server.`),V=this._createCompletionMessage(t.invocationId,"Client provided multiple results.",null)),W=void 0}catch(M){W=M,this._logger.log(ge.Error,`A callback for the method '${l}' threw error '${M}'.`)}V?await this._sendWithProtocol(V):E?(W?V=this._createCompletionMessage(t.invocationId,`${W}`,null):A!==void 0?V=this._createCompletionMessage(t.invocationId,null,A):(this._logger.log(ge.Warning,`No result given for '${l}' method and invocation ID '${t.invocationId}'.`),V=this._createCompletionMessage(t.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(V)):A&&this._logger.log(ge.Error,`Result given for '${l}' method but server is not expecting a result.`)}_connectionClosed(t){this._logger.log(ge.Debug,`HubConnection.connectionClosed(${t}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||t||new Ut("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(t||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===ot.Disconnecting?this._completeClose(t):this._connectionState===ot.Connected&&this._reconnectPolicy?this._reconnect(t):this._connectionState===ot.Connected&&this._completeClose(t)}_completeClose(t){if(this._connectionStarted){this._connectionState=ot.Disconnected,this._connectionStarted=!1,this._messageBuffer&&(this._messageBuffer._dispose(t??new Error("Connection closed.")),this._messageBuffer=void 0),at.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach(l=>l.apply(this,[t]))}catch(l){this._logger.log(ge.Error,`An onclose callback called with error '${t}' threw error '${l}'.`)}}}async _reconnect(t){const l=Date.now();let m=0,w=t!==void 0?t:new Error("Attempting to reconnect due to a unknown error."),E=this._getNextRetryDelay(m++,0,w);if(E===null){this._logger.log(ge.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),this._completeClose(t);return}if(this._connectionState=ot.Reconnecting,t?this._logger.log(ge.Information,`Connection reconnecting because of error '${t}'.`):this._logger.log(ge.Information,"Connection reconnecting."),this._reconnectingCallbacks.length!==0){try{this._reconnectingCallbacks.forEach(A=>A.apply(this,[t]))}catch(A){this._logger.log(ge.Error,`An onreconnecting callback called with error '${t}' threw error '${A}'.`)}if(this._connectionState!==ot.Reconnecting){this._logger.log(ge.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.");return}}for(;E!==null;){if(this._logger.log(ge.Information,`Reconnect attempt number ${m} will start in ${E} ms.`),await new Promise(A=>{this._reconnectDelayHandle=setTimeout(A,E)}),this._reconnectDelayHandle=void 0,this._connectionState!==ot.Reconnecting){this._logger.log(ge.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");return}try{if(await this._startInternal(),this._connectionState=ot.Connected,this._logger.log(ge.Information,"HubConnection reconnected successfully."),this._reconnectedCallbacks.length!==0)try{this._reconnectedCallbacks.forEach(A=>A.apply(this,[this.connection.connectionId]))}catch(A){this._logger.log(ge.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${A}'.`)}return}catch(A){if(this._logger.log(ge.Information,`Reconnect attempt failed because of error '${A}'.`),this._connectionState!==ot.Reconnecting){this._logger.log(ge.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),this._connectionState===ot.Disconnecting&&this._completeClose();return}w=A instanceof Error?A:new Error(A.toString()),E=this._getNextRetryDelay(m++,Date.now()-l,w)}}this._logger.log(ge.Information,`Reconnect retries have been exhausted after ${Date.now()-l} ms and ${m} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(t,l,m){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:l,previousRetryCount:t,retryReason:m})}catch(w){return this._logger.log(ge.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${t}, ${l}) threw error '${w}'.`),null}}_cancelCallbacksWithError(t){const l=this._callbacks;this._callbacks={},Object.keys(l).forEach(m=>{const w=l[m];try{w(null,t)}catch(E){this._logger.log(ge.Error,`Stream 'error' callback called with '${t}' threw error: ${uc(E)}`)}})}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(t,l,m,w){if(m)return w.length!==0?{arguments:l,streamIds:w,target:t,type:We.Invocation}:{arguments:l,target:t,type:We.Invocation};{const E=this._invocationId;return this._invocationId++,w.length!==0?{arguments:l,invocationId:E.toString(),streamIds:w,target:t,type:We.Invocation}:{arguments:l,invocationId:E.toString(),target:t,type:We.Invocation}}}_launchStreams(t,l){if(t.length!==0){l||(l=Promise.resolve());for(const m in t)t[m].subscribe({complete:()=>{l=l.then(()=>this._sendWithProtocol(this._createCompletionMessage(m)))},error:w=>{let E;w instanceof Error?E=w.message:w&&w.toString?E=w.toString():E="Unknown error",l=l.then(()=>this._sendWithProtocol(this._createCompletionMessage(m,E)))},next:w=>{l=l.then(()=>this._sendWithProtocol(this._createStreamItemMessage(m,w)))}})}}_replaceStreamingParams(t){const l=[],m=[];for(let w=0;w<t.length;w++){const E=t[w];if(this._isObservable(E)){const A=this._invocationId;this._invocationId++,l[A]=E,m.push(A.toString()),t.splice(w,1)}}return[l,m]}_isObservable(t){return t&&t.subscribe&&typeof t.subscribe=="function"}_createStreamInvocation(t,l,m){const w=this._invocationId;return this._invocationId++,m.length!==0?{arguments:l,invocationId:w.toString(),streamIds:m,target:t,type:We.StreamInvocation}:{arguments:l,invocationId:w.toString(),target:t,type:We.StreamInvocation}}_createCancelInvocation(t){return{invocationId:t,type:We.CancelInvocation}}_createStreamItemMessage(t,l){return{invocationId:t,item:l,type:We.StreamItem}}_createCompletionMessage(t,l,m){return l?{error:l,invocationId:t,type:We.Completion}:{invocationId:t,result:m,type:We.Completion}}_createCloseMessage(){return{type:We.Close}}}const sp=[0,2e3,1e4,3e4,null];class fc{constructor(t){this._retryDelays=t!==void 0?[...t,null]:sp}nextRetryDelayInMilliseconds(t){return this._retryDelays[t.previousRetryCount]}}class Nr{}Nr.Authorization="Authorization";Nr.Cookie="Cookie";class ap extends ui{constructor(t,l){super(),this._innerClient=t,this._accessTokenFactory=l}async send(t){let l=!0;this._accessTokenFactory&&(!this._accessToken||t.url&&t.url.indexOf("/negotiate?")>0)&&(l=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(t);const m=await this._innerClient.send(t);return l&&m.statusCode===401&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(t),await this._innerClient.send(t)):m}_setAuthorizationHeader(t){t.headers||(t.headers={}),this._accessToken?t.headers[Nr.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&t.headers[Nr.Authorization]&&delete t.headers[Nr.Authorization]}getCookieString(t){return this._innerClient.getCookieString(t)}}var ht;(function(u){u[u.None=0]="None",u[u.WebSockets=1]="WebSockets",u[u.ServerSentEvents=2]="ServerSentEvents",u[u.LongPolling=4]="LongPolling"})(ht||(ht={}));var wt;(function(u){u[u.Text=1]="Text",u[u.Binary=2]="Binary"})(wt||(wt={}));let lp=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class dc{get pollAborted(){return this._pollAbort.aborted}constructor(t,l,m){this._httpClient=t,this._logger=l,this._pollAbort=new lp,this._options=m,this._running=!1,this.onreceive=null,this.onclose=null}async connect(t,l){if(ft.isRequired(t,"url"),ft.isRequired(l,"transferFormat"),ft.isIn(l,wt,"transferFormat"),this._url=t,this._logger.log(ge.Trace,"(LongPolling transport) Connecting."),l===wt.Binary&&typeof XMLHttpRequest<"u"&&typeof new XMLHttpRequest().responseType!="string")throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[m,w]=Wr(),E={[m]:w,...this._options.headers},A={abortSignal:this._pollAbort.signal,headers:E,timeout:1e5,withCredentials:this._options.withCredentials};l===wt.Binary&&(A.responseType="arraybuffer");const W=`${t}&_=${Date.now()}`;this._logger.log(ge.Trace,`(LongPolling transport) polling: ${W}.`);const V=await this._httpClient.get(W,A);V.statusCode!==200?(this._logger.log(ge.Error,`(LongPolling transport) Unexpected response code: ${V.statusCode}.`),this._closeError=new Br(V.statusText||"",V.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,A)}async _poll(t,l){try{for(;this._running;)try{const m=`${t}&_=${Date.now()}`;this._logger.log(ge.Trace,`(LongPolling transport) polling: ${m}.`);const w=await this._httpClient.get(m,l);w.statusCode===204?(this._logger.log(ge.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):w.statusCode!==200?(this._logger.log(ge.Error,`(LongPolling transport) Unexpected response code: ${w.statusCode}.`),this._closeError=new Br(w.statusText||"",w.statusCode),this._running=!1):w.content?(this._logger.log(ge.Trace,`(LongPolling transport) data received. ${sn(w.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(w.content)):this._logger.log(ge.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(m){this._running?m instanceof xs?this._logger.log(ge.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=m,this._running=!1):this._logger.log(ge.Trace,`(LongPolling transport) Poll errored after shutdown: ${m.message}`)}}finally{this._logger.log(ge.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(t){return this._running?Yc(this._logger,"LongPolling",this._httpClient,this._url,t,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(ge.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(ge.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const t={},[l,m]=Wr();t[l]=m;const w={headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};let E;try{await this._httpClient.delete(this._url,w)}catch(A){E=A}E?E instanceof Br&&(E.statusCode===404?this._logger.log(ge.Trace,"(LongPolling transport) A 404 response was returned from sending a DELETE request."):this._logger.log(ge.Trace,`(LongPolling transport) Error sending a DELETE request: ${E}`)):this._logger.log(ge.Trace,"(LongPolling transport) DELETE request accepted.")}finally{this._logger.log(ge.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let t="(LongPolling transport) Firing onclose event.";this._closeError&&(t+=" Error: "+this._closeError),this._logger.log(ge.Trace,t),this.onclose(this._closeError)}}}class cp{constructor(t,l,m,w){this._httpClient=t,this._accessToken=l,this._logger=m,this._options=w,this.onreceive=null,this.onclose=null}async connect(t,l){return ft.isRequired(t,"url"),ft.isRequired(l,"transferFormat"),ft.isIn(l,wt,"transferFormat"),this._logger.log(ge.Trace,"(SSE transport) Connecting."),this._url=t,this._accessToken&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise((m,w)=>{let E=!1;if(l!==wt.Text){w(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));return}let A;if(at.isBrowser||at.isWebWorker)A=new this._options.EventSource(t,{withCredentials:this._options.withCredentials});else{const W=this._httpClient.getCookieString(t),V={};V.Cookie=W;const[se,M]=Wr();V[se]=M,A=new this._options.EventSource(t,{withCredentials:this._options.withCredentials,headers:{...V,...this._options.headers}})}try{A.onmessage=W=>{if(this.onreceive)try{this._logger.log(ge.Trace,`(SSE transport) data received. ${sn(W.data,this._options.logMessageContent)}.`),this.onreceive(W.data)}catch(V){this._close(V);return}},A.onerror=W=>{E?this._close():w(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},A.onopen=()=>{this._logger.log(ge.Information,`SSE connected to ${this._url}`),this._eventSource=A,E=!0,m()}}catch(W){w(W);return}})}async send(t){return this._eventSource?Yc(this._logger,"SSE",this._httpClient,this._url,t,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(t){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(t))}}class up{constructor(t,l,m,w,E,A){this._logger=m,this._accessTokenFactory=l,this._logMessageContent=w,this._webSocketConstructor=E,this._httpClient=t,this.onreceive=null,this.onclose=null,this._headers=A}async connect(t,l){ft.isRequired(t,"url"),ft.isRequired(l,"transferFormat"),ft.isIn(l,wt,"transferFormat"),this._logger.log(ge.Trace,"(WebSockets transport) Connecting.");let m;return this._accessTokenFactory&&(m=await this._accessTokenFactory()),new Promise((w,E)=>{t=t.replace(/^http/,"ws");let A;const W=this._httpClient.getCookieString(t);let V=!1;if(at.isNode||at.isReactNative){const se={},[M,Re]=Wr();se[M]=Re,m&&(se[Nr.Authorization]=`Bearer ${m}`),W&&(se[Nr.Cookie]=W),A=new this._webSocketConstructor(t,void 0,{headers:{...se,...this._headers}})}else m&&(t+=(t.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(m)}`);A||(A=new this._webSocketConstructor(t)),l===wt.Binary&&(A.binaryType="arraybuffer"),A.onopen=se=>{this._logger.log(ge.Information,`WebSocket connected to ${t}.`),this._webSocket=A,V=!0,w()},A.onerror=se=>{let M=null;typeof ErrorEvent<"u"&&se instanceof ErrorEvent?M=se.error:M="There was an error with the transport",this._logger.log(ge.Information,`(WebSockets transport) ${M}.`)},A.onmessage=se=>{if(this._logger.log(ge.Trace,`(WebSockets transport) data received. ${sn(se.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(se.data)}catch(M){this._close(M);return}},A.onclose=se=>{if(V)this._close(se);else{let M=null;typeof ErrorEvent<"u"&&se instanceof ErrorEvent?M=se.error:M="WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",E(new Error(M))}}})}send(t){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(ge.Trace,`(WebSockets transport) sending data. ${sn(t,this._logMessageContent)}.`),this._webSocket.send(t),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(t){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(ge.Trace,"(WebSockets transport) socket closed."),this.onclose&&(this._isCloseEvent(t)&&(t.wasClean===!1||t.code!==1e3)?this.onclose(new Error(`WebSocket closed with status code: ${t.code} (${t.reason||"no reason given"}).`)):t instanceof Error?this.onclose(t):this.onclose())}_isCloseEvent(t){return t&&typeof t.wasClean=="boolean"&&typeof t.code=="number"}}const pc=100;class hp{constructor(t,l={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,ft.isRequired(t,"url"),this._logger=Dd(l.logger),this.baseUrl=this._resolveUrl(t),l=l||{},l.logMessageContent=l.logMessageContent===void 0?!1:l.logMessageContent,typeof l.withCredentials=="boolean"||l.withCredentials===void 0)l.withCredentials=l.withCredentials===void 0?!0:l.withCredentials;else throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");l.timeout=l.timeout===void 0?100*1e3:l.timeout;let m=null,w=null;at.isNode&&typeof require<"u"&&(m=Jd(),w=Qd()),!at.isNode&&typeof WebSocket<"u"&&!l.WebSocket?l.WebSocket=WebSocket:at.isNode&&!l.WebSocket&&m&&(l.WebSocket=m),!at.isNode&&typeof EventSource<"u"&&!l.EventSource?l.EventSource=EventSource:at.isNode&&!l.EventSource&&typeof w<"u"&&(l.EventSource=w),this._httpClient=new ap(l.httpClient||new Xd(this._logger),l.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=l,this.onreceive=null,this.onclose=null}async start(t){if(t=t||wt.Binary,ft.isIn(t,wt,"transferFormat"),this._logger.log(ge.Debug,`Starting connection with transfer format '${wt[t]}'.`),this._connectionState!=="Disconnected")return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(t),await this._startInternalPromise,this._connectionState==="Disconnecting"){const l="Failed to start the HttpConnection before stop() was called.";return this._logger.log(ge.Error,l),await this._stopPromise,Promise.reject(new Ut(l))}else if(this._connectionState!=="Connected"){const l="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(ge.Error,l),Promise.reject(new Ut(l))}this._connectionStarted=!0}send(t){return this._connectionState!=="Connected"?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new Ns(this.transport)),this._sendQueue.send(t))}async stop(t){if(this._connectionState==="Disconnected")return this._logger.log(ge.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnected state.`),Promise.resolve();if(this._connectionState==="Disconnecting")return this._logger.log(ge.Debug,`Call to HttpConnection.stop(${t}) ignored because the connection is already in the disconnecting state.`),this._stopPromise;this._connectionState="Disconnecting",this._stopPromise=new Promise(l=>{this._stopPromiseResolver=l}),await this._stopInternal(t),await this._stopPromise}async _stopInternal(t){this._stopError=t;try{await this._startInternalPromise}catch{}if(this.transport){try{await this.transport.stop()}catch(l){this._logger.log(ge.Error,`HttpConnection.transport.stop() threw error '${l}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(ge.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(t){let l=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation)if(this._options.transport===ht.WebSockets)this.transport=this._constructTransport(ht.WebSockets),await this._startTransport(l,t);else throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");else{let m=null,w=0;do{if(m=await this._getNegotiationResponse(l),this._connectionState==="Disconnecting"||this._connectionState==="Disconnected")throw new Ut("The connection was stopped during negotiation.");if(m.error)throw new Error(m.error);if(m.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(m.url&&(l=m.url),m.accessToken){const E=m.accessToken;this._accessTokenFactory=()=>E,this._httpClient._accessToken=E,this._httpClient._accessTokenFactory=void 0}w++}while(m.url&&w<pc);if(w===pc&&m.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(l,this._options.transport,m,t)}this.transport instanceof dc&&(this.features.inherentKeepAlive=!0),this._connectionState==="Connecting"&&(this._logger.log(ge.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(m){return this._logger.log(ge.Error,"Failed to start the connection: "+m),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(m)}}async _getNegotiationResponse(t){const l={},[m,w]=Wr();l[m]=w;const E=this._resolveNegotiateUrl(t);this._logger.log(ge.Debug,`Sending negotiation request: ${E}.`);try{const A=await this._httpClient.post(E,{content:"",headers:{...l,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(A.statusCode!==200)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${A.statusCode}'`));const W=JSON.parse(A.content);return(!W.negotiateVersion||W.negotiateVersion<1)&&(W.connectionToken=W.connectionId),W.useStatefulReconnect&&this._options._useStatefulReconnect!==!0?Promise.reject(new cc("Client didn't negotiate Stateful Reconnect but the server did.")):W}catch(A){let W="Failed to complete negotiation with the server: "+A;return A instanceof Br&&A.statusCode===404&&(W=W+" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(ge.Error,W),Promise.reject(new cc(W))}}_createConnectUrl(t,l){return l?t+(t.indexOf("?")===-1?"?":"&")+`id=${l}`:t}async _createTransport(t,l,m,w){let E=this._createConnectUrl(t,m.connectionToken);if(this._isITransport(l)){this._logger.log(ge.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=l,await this._startTransport(E,w),this.connectionId=m.connectionId;return}const A=[],W=m.availableTransports||[];let V=m;for(const se of W){const M=this._resolveTransportOrError(se,l,w,(V==null?void 0:V.useStatefulReconnect)===!0);if(M instanceof Error)A.push(`${se.transport} failed:`),A.push(M);else if(this._isITransport(M)){if(this.transport=M,!V){try{V=await this._getNegotiationResponse(t)}catch(Re){return Promise.reject(Re)}E=this._createConnectUrl(t,V.connectionToken)}try{await this._startTransport(E,w),this.connectionId=V.connectionId;return}catch(Re){if(this._logger.log(ge.Error,`Failed to start the transport '${se.transport}': ${Re}`),V=void 0,A.push(new Md(`${se.transport} failed: ${Re}`,ht[se.transport])),this._connectionState!=="Connecting"){const Ye="Failed to select transport before stop() was called.";return this._logger.log(ge.Debug,Ye),Promise.reject(new Ut(Ye))}}}}return A.length>0?Promise.reject(new jd(`Unable to connect to the server with any of the available transports. ${A.join(" ")}`,A)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(t){switch(t){case ht.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new up(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case ht.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new cp(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case ht.LongPolling:return new dc(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${t}.`)}}_startTransport(t,l){return this.transport.onreceive=this.onreceive,this.features.reconnect?this.transport.onclose=async m=>{let w=!1;if(this.features.reconnect)try{this.features.disconnected(),await this.transport.connect(t,l),await this.features.resend()}catch{w=!0}else{this._stopConnection(m);return}w&&this._stopConnection(m)}:this.transport.onclose=m=>this._stopConnection(m),this.transport.connect(t,l)}_resolveTransportOrError(t,l,m,w){const E=ht[t.transport];if(E==null)return this._logger.log(ge.Debug,`Skipping transport '${t.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${t.transport}' because it is not supported by this client.`);if(fp(l,E))if(t.transferFormats.map(W=>wt[W]).indexOf(m)>=0){if(E===ht.WebSockets&&!this._options.WebSocket||E===ht.ServerSentEvents&&!this._options.EventSource)return this._logger.log(ge.Debug,`Skipping transport '${ht[E]}' because it is not supported in your environment.'`),new Bd(`'${ht[E]}' is not supported in your environment.`,E);this._logger.log(ge.Debug,`Selecting transport '${ht[E]}'.`);try{return this.features.reconnect=E===ht.WebSockets?w:void 0,this._constructTransport(E)}catch(W){return W}}else return this._logger.log(ge.Debug,`Skipping transport '${ht[E]}' because it does not support the requested transfer format '${wt[m]}'.`),new Error(`'${ht[E]}' does not support ${wt[m]}.`);else return this._logger.log(ge.Debug,`Skipping transport '${ht[E]}' because it was disabled by the client.`),new Nd(`'${ht[E]}' is disabled by the client.`,E)}_isITransport(t){return t&&typeof t=="object"&&"connect"in t}_stopConnection(t){if(this._logger.log(ge.Debug,`HttpConnection.stopConnection(${t}) called while in state ${this._connectionState}.`),this.transport=void 0,t=this._stopError||t,this._stopError=void 0,this._connectionState==="Disconnected"){this._logger.log(ge.Debug,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is already in the disconnected state.`);return}if(this._connectionState==="Connecting")throw this._logger.log(ge.Warning,`Call to HttpConnection.stopConnection(${t}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${t}) was called while the connection is still in the connecting state.`);if(this._connectionState==="Disconnecting"&&this._stopPromiseResolver(),t?this._logger.log(ge.Error,`Connection disconnected with error '${t}'.`):this._logger.log(ge.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch(l=>{this._logger.log(ge.Error,`TransportSendQueue.stop() threw error '${l}'.`)}),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(t)}catch(l){this._logger.log(ge.Error,`HttpConnection.onclose(${t}) threw error '${l}'.`)}}}_resolveUrl(t){if(t.lastIndexOf("https://",0)===0||t.lastIndexOf("http://",0)===0)return t;if(!at.isBrowser)throw new Error(`Cannot resolve '${t}'.`);const l=window.document.createElement("a");return l.href=t,this._logger.log(ge.Information,`Normalizing '${t}' to '${l.href}'.`),l.href}_resolveNegotiateUrl(t){const l=new URL(t);l.pathname.endsWith("/")?l.pathname+="negotiate":l.pathname+="/negotiate";const m=new URLSearchParams(l.searchParams);return m.has("negotiateVersion")||m.append("negotiateVersion",this._negotiateVersion.toString()),m.has("useStatefulReconnect")?m.get("useStatefulReconnect")==="true"&&(this._options._useStatefulReconnect=!0):this._options._useStatefulReconnect===!0&&m.append("useStatefulReconnect","true"),l.search=m.toString(),l.toString()}}function fp(u,t){return!u||(t&u)!==0}class Ns{constructor(t){this._transport=t,this._buffer=[],this._executing=!0,this._sendBufferedData=new Nn,this._transportResult=new Nn,this._sendLoopPromise=this._sendLoop()}send(t){return this._bufferData(t),this._transportResult||(this._transportResult=new Nn),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(t){if(this._buffer.length&&typeof this._buffer[0]!=typeof t)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof t}`);this._buffer.push(t),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new Nn;const t=this._transportResult;this._transportResult=void 0;const l=typeof this._buffer[0]=="string"?this._buffer.join(""):Ns._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(l),t.resolve()}catch(m){t.reject(m)}}}static _concatBuffers(t){const l=t.map(E=>E.byteLength).reduce((E,A)=>E+A),m=new Uint8Array(l);let w=0;for(const E of t)m.set(new Uint8Array(E),w),w+=E.byteLength;return m.buffer}}class Nn{constructor(){this.promise=new Promise((t,l)=>[this._resolver,this._rejecter]=[t,l])}resolve(){this._resolver()}reject(t){this._rejecter(t)}}const dp="json";class pp{constructor(){this.name=dp,this.version=2,this.transferFormat=wt.Text}parseMessages(t,l){if(typeof t!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!t)return[];l===null&&(l=on.instance);const m=Rt.parse(t),w=[];for(const E of m){const A=JSON.parse(E);if(typeof A.type!="number")throw new Error("Invalid payload.");switch(A.type){case We.Invocation:this._isInvocationMessage(A);break;case We.StreamItem:this._isStreamItemMessage(A);break;case We.Completion:this._isCompletionMessage(A);break;case We.Ping:break;case We.Close:break;case We.Ack:this._isAckMessage(A);break;case We.Sequence:this._isSequenceMessage(A);break;default:l.log(ge.Information,"Unknown message type '"+A.type+"' ignored.");continue}w.push(A)}return w}writeMessage(t){return Rt.write(JSON.stringify(t))}_isInvocationMessage(t){this._assertNotEmptyString(t.target,"Invalid payload for Invocation message."),t.invocationId!==void 0&&this._assertNotEmptyString(t.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(t){if(this._assertNotEmptyString(t.invocationId,"Invalid payload for StreamItem message."),t.item===void 0)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(t){if(t.result&&t.error)throw new Error("Invalid payload for Completion message.");!t.result&&t.error&&this._assertNotEmptyString(t.error,"Invalid payload for Completion message."),this._assertNotEmptyString(t.invocationId,"Invalid payload for Completion message.")}_isAckMessage(t){if(typeof t.sequenceId!="number")throw new Error("Invalid SequenceId for Ack message.")}_isSequenceMessage(t){if(typeof t.sequenceId!="number")throw new Error("Invalid SequenceId for Sequence message.")}_assertNotEmptyString(t,l){if(typeof t!="string"||t==="")throw new Error(l)}}const gp={trace:ge.Trace,debug:ge.Debug,info:ge.Information,information:ge.Information,warn:ge.Warning,warning:ge.Warning,error:ge.Error,critical:ge.Critical,none:ge.None};function mp(u){const t=gp[u.toLowerCase()];if(typeof t<"u")return t;throw new Error(`Unknown log level: ${u}`)}class bp{configureLogging(t){if(ft.isRequired(t,"logging"),yp(t))this.logger=t;else if(typeof t=="string"){const l=mp(t);this.logger=new Jn(l)}else this.logger=new Jn(t);return this}withUrl(t,l){return ft.isRequired(t,"url"),ft.isNotEmpty(t,"url"),this.url=t,typeof l=="object"?this.httpConnectionOptions={...this.httpConnectionOptions,...l}:this.httpConnectionOptions={...this.httpConnectionOptions,transport:l},this}withHubProtocol(t){return ft.isRequired(t,"protocol"),this.protocol=t,this}withAutomaticReconnect(t){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return t?Array.isArray(t)?this.reconnectPolicy=new fc(t):this.reconnectPolicy=t:this.reconnectPolicy=new fc,this}withServerTimeout(t){return ft.isRequired(t,"milliseconds"),this._serverTimeoutInMilliseconds=t,this}withKeepAliveInterval(t){return ft.isRequired(t,"milliseconds"),this._keepAliveIntervalInMilliseconds=t,this}withStatefulReconnect(t){return this.httpConnectionOptions===void 0&&(this.httpConnectionOptions={}),this.httpConnectionOptions._useStatefulReconnect=!0,this._statefulReconnectBufferSize=t==null?void 0:t.bufferSize,this}build(){const t=this.httpConnectionOptions||{};if(t.logger===void 0&&(t.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const l=new hp(this.url,t);return Bs.create(l,this.logger||on.instance,this.protocol||new pp,this.reconnectPolicy,this._serverTimeoutInMilliseconds,this._keepAliveIntervalInMilliseconds,this._statefulReconnectBufferSize)}}function yp(u){return u.log!==void 0}class _p{nextRetryDelayInMilliseconds(t){return null}}const ii=class ii{constructor(t,l){Be(this,"connection");this.crisEndpoint=l,this.connection=new bp().withUrl(t,ht.None).withAutomaticReconnect(ii.noRetryPolicy).build()}async startAsync(){try{return await this.connection.start(),!0}catch(t){return console.log(t),!1}}async startListeningAsync(t){const l={},m=t.map(async w=>{const E=new zn(this.connection.connectionId,w.domainName,w.transactionCount),A=await this.crisEndpoint.sendOrThrowAsync(E);A?l[w.domainName]=JSON.parse(A):(console.warn(`Domain ${w.domainName} doesn't exists.`),l[w.domainName]="")});return await Promise.all(m),l}onMessage(t){this.connection.on("OnStateEventsAsync",(l,m)=>{t(l,JSON.parse(m))})}onClose(t){this.connection.onclose(t)}async stopAsync(){await this.connection.stop()}};Be(ii,"noRetryPolicy",new _p);let gs=ii;var gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wp={};(()=>{var u=Object.defineProperty,t=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,m=Object.prototype.hasOwnProperty,w=(e,s)=>()=>(e&&(s=e(e=0)),s),E=(e,s)=>()=>(s||e((s={exports:{}}).exports,s),s.exports),A=(e,s)=>{for(var r in s)u(e,r,{get:s[r],enumerable:!0})},W=(e,s,r,h)=>{if(s&&typeof s=="object"||typeof s=="function")for(let p of l(s))!m.call(e,p)&&p!==r&&u(e,p,{get:()=>s[p],enumerable:!(h=t(s,p))||h.enumerable});return e},V=e=>W(u({},"__esModule",{value:!0}),e),se,M=w(()=>{se={deviceMemory:8,hardwareConcurrency:8,language:"en-US"}}),Re={};A(Re,{_debugEnd:()=>qi,_debugProcess:()=>Hi,_events:()=>so,_eventsCount:()=>ao,_exiting:()=>Ri,_fatalExceptions:()=>Fi,_getActiveHandles:()=>un,_getActiveRequests:()=>ar,_kill:()=>xi,_linkedBinding:()=>vt,_maxListeners:()=>oo,_preload_modules:()=>ro,_rawDebug:()=>Ii,_startProfilerIdleNotifier:()=>Vi,_stopProfilerIdleNotifier:()=>zi,_tickCallback:()=>Wi,abort:()=>Yi,addListener:()=>lo,allowedNodeEnvironmentFlags:()=>Li,arch:()=>di,argv:()=>mi,argv0:()=>to,assert:()=>xt,binding:()=>vi,chdir:()=>Ai,config:()=>Oi,cpuUsage:()=>Kr,cwd:()=>Si,debugPort:()=>eo,default:()=>bo,dlopen:()=>Xe,domain:()=>ki,emit:()=>po,emitWarning:()=>wi,env:()=>gi,execArgv:()=>bi,execPath:()=>Zi,exit:()=>ji,features:()=>Di,hasUncaughtExceptionCaptureCallback:()=>qt,hrtime:()=>hn,kill:()=>Mi,listeners:()=>Ms,memoryUsage:()=>Ni,moduleLoadList:()=>Ti,nextTick:()=>Ce,off:()=>uo,on:()=>Vt,once:()=>co,openStdin:()=>Ui,pid:()=>Gi,platform:()=>pi,ppid:()=>Xi,prependListener:()=>go,prependOnceListener:()=>mo,reallyExit:()=>Pi,release:()=>Ci,removeAllListeners:()=>fo,removeListener:()=>ho,resourceUsage:()=>Bi,setSourceMapsEnabled:()=>no,setUncaughtExceptionCaptureCallback:()=>$i,stderr:()=>Ji,stdin:()=>Qi,stdout:()=>Ki,title:()=>fi,umask:()=>Ei,uptime:()=>Vr,version:()=>yi,versions:()=>_i});function Ye(e){throw new Error("Node.js process "+e+" is not supported by JSPM core outside of Node.js")}function Je(){!gr||!mr||(gr=!1,mr.length?Ft=mr.concat(Ft):zr=-1,Ft.length&&xe())}function xe(){if(!gr){var e=setTimeout(Je,0);gr=!0;for(var s=Ft.length;s;){for(mr=Ft,Ft=[];++zr<s;)mr&&mr[zr].run();zr=-1,s=Ft.length}mr=null,gr=!1,clearTimeout(e)}}function Ce(e){var s=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)s[r-1]=arguments[r];Ft.push(new Ve(e,s)),Ft.length===1&&!gr&&setTimeout(xe,0)}function Ve(e,s){this.fun=e,this.array=s}function Fe(){}function vt(e){Ye("_linkedBinding")}function Xe(e){Ye("dlopen")}function ar(){return[]}function un(){return[]}function xt(e,s){if(!e)throw new Error(s||"assertion error")}function qt(){return!1}function Vr(){return zt.now()/1e3}function hn(e){var s=Math.floor((Date.now()-zt.now())*.001),r=zt.now()*.001,h=Math.floor(r)+s,p=Math.floor(r%1*1e9);return e&&(h=h-e[0],p=p-e[1],p<0&&(h--,p+=fn)),[h,p]}function Vt(){return bo}function Ms(e){return[]}var Ft,gr,mr,zr,fi,di,pi,gi,mi,bi,yi,_i,wi,vi,Ei,Si,Ai,Ci,Ii,Ti,ki,Ri,Oi,Pi,xi,Kr,Bi,Ni,Mi,ji,Ui,Li,Di,Fi,$i,Wi,Hi,qi,Vi,zi,Ki,Ji,Qi,Yi,Gi,Xi,Zi,eo,to,ro,no,zt,io,fn,oo,so,ao,lo,co,uo,ho,fo,po,go,mo,bo,du=w(()=>{we(),_e(),M(),Ft=[],gr=!1,zr=-1,Ve.prototype.run=function(){this.fun.apply(null,this.array)},fi="browser",di="x64",pi="browser",gi={PATH:"/usr/bin",LANG:se.language+".UTF-8",PWD:"/",HOME:"/home",TMP:"/tmp"},mi=["/usr/bin/node"],bi=[],yi="v16.8.0",_i={},wi=function(e,s){console.warn((s?s+": ":"")+e)},vi=function(e){Ye("binding")},Ei=function(e){return 0},Si=function(){return"/"},Ai=function(e){},Ci={name:"node",sourceUrl:"",headersUrl:"",libUrl:""},Ii=Fe,Ti=[],ki={},Ri=!1,Oi={},Pi=Fe,xi=Fe,Kr=function(){return{}},Bi=Kr,Ni=Kr,Mi=Fe,ji=Fe,Ui=Fe,Li={},Di={inspector:!1,debug:!1,uv:!1,ipv6:!1,tls_alpn:!1,tls_sni:!1,tls_ocsp:!1,tls:!1,cached_builtins:!0},Fi=Fe,$i=Fe,Wi=Fe,Hi=Fe,qi=Fe,Vi=Fe,zi=Fe,Ki=void 0,Ji=void 0,Qi=void 0,Yi=Fe,Gi=2,Xi=1,Zi="/bin/usr/node",eo=9229,to="node",ro=[],no=Fe,zt={now:typeof performance<"u"?performance.now.bind(performance):void 0,timing:typeof performance<"u"?performance.timing:void 0},zt.now===void 0&&(io=Date.now(),zt.timing&&zt.timing.navigationStart&&(io=zt.timing.navigationStart),zt.now=()=>Date.now()-io),fn=1e9,hn.bigint=function(e){var s=hn(e);return typeof BigInt>"u"?s[0]*fn+s[1]:BigInt(s[0]*fn)+BigInt(s[1])},oo=10,so={},ao=0,lo=Vt,co=Vt,uo=Vt,ho=Vt,fo=Vt,po=Fe,go=Vt,mo=Vt,bo={version:yi,versions:_i,arch:di,platform:pi,release:Ci,_rawDebug:Ii,moduleLoadList:Ti,binding:vi,_linkedBinding:vt,_events:so,_eventsCount:ao,_maxListeners:oo,on:Vt,addListener:lo,once:co,off:uo,removeListener:ho,removeAllListeners:fo,emit:po,prependListener:go,prependOnceListener:mo,listeners:Ms,domain:ki,_exiting:Ri,config:Oi,dlopen:Xe,uptime:Vr,_getActiveRequests:ar,_getActiveHandles:un,reallyExit:Pi,_kill:xi,cpuUsage:Kr,resourceUsage:Bi,memoryUsage:Ni,kill:Mi,exit:ji,openStdin:Ui,allowedNodeEnvironmentFlags:Li,assert:xt,features:Di,_fatalExceptions:Fi,setUncaughtExceptionCaptureCallback:$i,hasUncaughtExceptionCaptureCallback:qt,emitWarning:wi,nextTick:Ce,_tickCallback:Wi,_debugProcess:Hi,_debugEnd:qi,_startProfilerIdleNotifier:Vi,_stopProfilerIdleNotifier:zi,stdout:Ki,stdin:Qi,stderr:Ji,abort:Yi,umask:Ei,chdir:Ai,cwd:Si,env:gi,title:fi,argv:mi,execArgv:bi,pid:Gi,ppid:Xi,execPath:Zi,debugPort:eo,hrtime:hn,argv0:to,_preload_modules:ro,setSourceMapsEnabled:no}}),_e=w(()=>{du()}),bt={};A(bt,{Buffer:()=>dn,INSPECT_MAX_BYTES:()=>js,default:()=>Kt,kMaxLength:()=>Us});function pu(){if(yo)return Ur;yo=!0,Ur.byteLength=a,Ur.toByteArray=c,Ur.fromByteArray=_;for(var e=[],s=[],r=typeof Uint8Array<"u"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,o=h.length;p<o;++p)e[p]=h[p],s[h.charCodeAt(p)]=p;s[45]=62,s[95]=63;function n(v){var S=v.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=v.indexOf("=");C===-1&&(C=S);var x=C===S?0:4-C%4;return[C,x]}function a(v){var S=n(v),C=S[0],x=S[1];return(C+x)*3/4-x}function i(v,S,C){return(S+C)*3/4-C}function c(v){var S,C=n(v),x=C[0],H=C[1],k=new r(i(v,x,H)),P=0,K=H>0?x-4:x,Q;for(Q=0;Q<K;Q+=4)S=s[v.charCodeAt(Q)]<<18|s[v.charCodeAt(Q+1)]<<12|s[v.charCodeAt(Q+2)]<<6|s[v.charCodeAt(Q+3)],k[P++]=S>>16&255,k[P++]=S>>8&255,k[P++]=S&255;return H===2&&(S=s[v.charCodeAt(Q)]<<2|s[v.charCodeAt(Q+1)]>>4,k[P++]=S&255),H===1&&(S=s[v.charCodeAt(Q)]<<10|s[v.charCodeAt(Q+1)]<<4|s[v.charCodeAt(Q+2)]>>2,k[P++]=S>>8&255,k[P++]=S&255),k}function g(v){return e[v>>18&63]+e[v>>12&63]+e[v>>6&63]+e[v&63]}function y(v,S,C){for(var x,H=[],k=S;k<C;k+=3)x=(v[k]<<16&16711680)+(v[k+1]<<8&65280)+(v[k+2]&255),H.push(g(x));return H.join("")}function _(v){for(var S,C=v.length,x=C%3,H=[],k=16383,P=0,K=C-x;P<K;P+=k)H.push(y(v,P,P+k>K?K:P+k));return x===1?(S=v[C-1],H.push(e[S>>2]+e[S<<4&63]+"==")):x===2&&(S=(v[C-2]<<8)+v[C-1],H.push(e[S>>10]+e[S>>4&63]+e[S<<2&63]+"=")),H.join("")}return Ur}function gu(){return _o?Jr:(_o=!0,Jr.read=function(e,s,r,h,p){var o,n,a=p*8-h-1,i=(1<<a)-1,c=i>>1,g=-7,y=r?p-1:0,_=r?-1:1,v=e[s+y];for(y+=_,o=v&(1<<-g)-1,v>>=-g,g+=a;g>0;o=o*256+e[s+y],y+=_,g-=8);for(n=o&(1<<-g)-1,o>>=-g,g+=h;g>0;n=n*256+e[s+y],y+=_,g-=8);if(o===0)o=1-c;else{if(o===i)return n?NaN:(v?-1:1)*(1/0);n=n+Math.pow(2,h),o=o-c}return(v?-1:1)*n*Math.pow(2,o-h)},Jr.write=function(e,s,r,h,p,o){var n,a,i,c=o*8-p-1,g=(1<<c)-1,y=g>>1,_=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=h?0:o-1,S=h?1:-1,C=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(a=isNaN(s)?1:0,n=g):(n=Math.floor(Math.log(s)/Math.LN2),s*(i=Math.pow(2,-n))<1&&(n--,i*=2),n+y>=1?s+=_/i:s+=_*Math.pow(2,1-y),s*i>=2&&(n++,i/=2),n+y>=g?(a=0,n=g):n+y>=1?(a=(s*i-1)*Math.pow(2,p),n=n+y):(a=s*Math.pow(2,y-1)*Math.pow(2,p),n=0));p>=8;e[r+v]=a&255,v+=S,a/=256,p-=8);for(n=n<<p|a,c+=p;c>0;e[r+v]=n&255,v+=S,n/=256,c-=8);e[r+v-S]|=C*128},Jr)}function mu(){if(wo)return lr;wo=!0;let e=pu(),s=gu(),r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;lr.Buffer=n,lr.SlowBuffer=H,lr.INSPECT_MAX_BYTES=50;let h=2147483647;lr.kMaxLength=h,n.TYPED_ARRAY_SUPPORT=p(),!n.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function p(){try{let d=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(d,f),d.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(n.isBuffer(this))return this.byteOffset}});function o(d){if(d>h)throw new RangeError('The value "'+d+'" is invalid for option "size"');let f=new Uint8Array(d);return Object.setPrototypeOf(f,n.prototype),f}function n(d,f,b){if(typeof d=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(d)}return a(d,f,b)}n.poolSize=8192;function a(d,f,b){if(typeof d=="string")return y(d,f);if(ArrayBuffer.isView(d))return v(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(re(d,ArrayBuffer)||d&&re(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(re(d,SharedArrayBuffer)||d&&re(d.buffer,SharedArrayBuffer)))return S(d,f,b);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let I=d.valueOf&&d.valueOf();if(I!=null&&I!==d)return n.from(I,f,b);let B=C(d);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return n.from(d[Symbol.toPrimitive]("string"),f,b);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}n.from=function(d,f,b){return a(d,f,b)},Object.setPrototypeOf(n.prototype,Uint8Array.prototype),Object.setPrototypeOf(n,Uint8Array);function i(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function c(d,f,b){return i(d),d<=0?o(d):f!==void 0?typeof b=="string"?o(d).fill(f,b):o(d).fill(f):o(d)}n.alloc=function(d,f,b){return c(d,f,b)};function g(d){return i(d),o(d<0?0:x(d)|0)}n.allocUnsafe=function(d){return g(d)},n.allocUnsafeSlow=function(d){return g(d)};function y(d,f){if((typeof f!="string"||f==="")&&(f="utf8"),!n.isEncoding(f))throw new TypeError("Unknown encoding: "+f);let b=k(d,f)|0,I=o(b),B=I.write(d,f);return B!==b&&(I=I.slice(0,B)),I}function _(d){let f=d.length<0?0:x(d.length)|0,b=o(f);for(let I=0;I<f;I+=1)b[I]=d[I]&255;return b}function v(d){if(re(d,Uint8Array)){let f=new Uint8Array(d);return S(f.buffer,f.byteOffset,f.byteLength)}return _(d)}function S(d,f,b){if(f<0||d.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<f+(b||0))throw new RangeError('"length" is outside of buffer bounds');let I;return f===void 0&&b===void 0?I=new Uint8Array(d):b===void 0?I=new Uint8Array(d,f):I=new Uint8Array(d,f,b),Object.setPrototypeOf(I,n.prototype),I}function C(d){if(n.isBuffer(d)){let f=x(d.length)|0,b=o(f);return b.length===0||d.copy(b,0,0,f),b}if(d.length!==void 0)return typeof d.length!="number"||U(d.length)?o(0):_(d);if(d.type==="Buffer"&&Array.isArray(d.data))return _(d.data)}function x(d){if(d>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return d|0}function H(d){return+d!=d&&(d=0),n.alloc(+d)}n.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==n.prototype},n.compare=function(d,f){if(re(d,Uint8Array)&&(d=n.from(d,d.offset,d.byteLength)),re(f,Uint8Array)&&(f=n.from(f,f.offset,f.byteLength)),!n.isBuffer(d)||!n.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===f)return 0;let b=d.length,I=f.length;for(let B=0,G=Math.min(b,I);B<G;++B)if(d[B]!==f[B]){b=d[B],I=f[B];break}return b<I?-1:I<b?1:0},n.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(d,f){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return n.alloc(0);let b;if(f===void 0)for(f=0,b=0;b<d.length;++b)f+=d[b].length;let I=n.allocUnsafe(f),B=0;for(b=0;b<d.length;++b){let G=d[b];if(re(G,Uint8Array))B+G.length>I.length?(n.isBuffer(G)||(G=n.from(G)),G.copy(I,B)):Uint8Array.prototype.set.call(I,G,B);else if(n.isBuffer(G))G.copy(I,B);else throw new TypeError('"list" argument must be an Array of Buffers');B+=G.length}return I};function k(d,f){if(n.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||re(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);let b=d.length,I=arguments.length>2&&arguments[2]===!0;if(!I&&b===0)return 0;let B=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return b;case"utf8":case"utf-8":return J(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b*2;case"hex":return b>>>1;case"base64":return ce(d).length;default:if(B)return I?-1:J(d).length;f=(""+f).toLowerCase(),B=!0}}n.byteLength=k;function P(d,f,b){let I=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((b===void 0||b>this.length)&&(b=this.length),b<=0)||(b>>>=0,f>>>=0,b<=f))return"";for(d||(d="utf8");;)switch(d){case"hex":return ee(this,f,b);case"utf8":case"utf-8":return te(this,f,b);case"ascii":return ke(this,f,b);case"latin1":case"binary":return ye(this,f,b);case"base64":return O(this,f,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,f,b);default:if(I)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),I=!0}}n.prototype._isBuffer=!0;function K(d,f,b){let I=d[f];d[f]=d[b],d[b]=I}n.prototype.swap16=function(){let d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<d;f+=2)K(this,f,f+1);return this},n.prototype.swap32=function(){let d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<d;f+=4)K(this,f,f+3),K(this,f+1,f+2);return this},n.prototype.swap64=function(){let d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<d;f+=8)K(this,f,f+7),K(this,f+1,f+6),K(this,f+2,f+5),K(this,f+3,f+4);return this},n.prototype.toString=function(){let d=this.length;return d===0?"":arguments.length===0?te(this,0,d):P.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(d){if(!n.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:n.compare(this,d)===0},n.prototype.inspect=function(){let d="",f=lr.INSPECT_MAX_BYTES;return d=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(d+=" ... "),"<Buffer "+d+">"},r&&(n.prototype[r]=n.prototype.inspect),n.prototype.compare=function(d,f,b,I,B){if(re(d,Uint8Array)&&(d=n.from(d,d.offset,d.byteLength)),!n.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(f===void 0&&(f=0),b===void 0&&(b=d?d.length:0),I===void 0&&(I=0),B===void 0&&(B=this.length),f<0||b>d.length||I<0||B>this.length)throw new RangeError("out of range index");if(I>=B&&f>=b)return 0;if(I>=B)return-1;if(f>=b)return 1;if(f>>>=0,b>>>=0,I>>>=0,B>>>=0,this===d)return 0;let G=B-I,he=b-f,De=Math.min(G,he),ze=this.slice(I,B),Ke=d.slice(f,b);for(let Le=0;Le<De;++Le)if(ze[Le]!==Ke[Le]){G=ze[Le],he=Ke[Le];break}return G<he?-1:he<G?1:0};function Q(d,f,b,I,B){if(d.length===0)return-1;if(typeof b=="string"?(I=b,b=0):b>2147483647?b=2147483647:b<-2147483648&&(b=-2147483648),b=+b,U(b)&&(b=B?0:d.length-1),b<0&&(b=d.length+b),b>=d.length){if(B)return-1;b=d.length-1}else if(b<0)if(B)b=0;else return-1;if(typeof f=="string"&&(f=n.from(f,I)),n.isBuffer(f))return f.length===0?-1:j(d,f,b,I,B);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(d,f,b):Uint8Array.prototype.lastIndexOf.call(d,f,b):j(d,[f],b,I,B);throw new TypeError("val must be string, number or Buffer")}function j(d,f,b,I,B){let G=1,he=d.length,De=f.length;if(I!==void 0&&(I=String(I).toLowerCase(),I==="ucs2"||I==="ucs-2"||I==="utf16le"||I==="utf-16le")){if(d.length<2||f.length<2)return-1;G=2,he/=2,De/=2,b/=2}function ze(Le,qe){return G===1?Le[qe]:Le.readUInt16BE(qe*G)}let Ke;if(B){let Le=-1;for(Ke=b;Ke<he;Ke++)if(ze(d,Ke)===ze(f,Le===-1?0:Ke-Le)){if(Le===-1&&(Le=Ke),Ke-Le+1===De)return Le*G}else Le!==-1&&(Ke-=Ke-Le),Le=-1}else for(b+De>he&&(b=he-De),Ke=b;Ke>=0;Ke--){let Le=!0;for(let qe=0;qe<De;qe++)if(ze(d,Ke+qe)!==ze(f,qe)){Le=!1;break}if(Le)return Ke}return-1}n.prototype.includes=function(d,f,b){return this.indexOf(d,f,b)!==-1},n.prototype.indexOf=function(d,f,b){return Q(this,d,f,b,!0)},n.prototype.lastIndexOf=function(d,f,b){return Q(this,d,f,b,!1)};function N(d,f,b,I){b=Number(b)||0;let B=d.length-b;I?(I=Number(I),I>B&&(I=B)):I=B;let G=f.length;I>G/2&&(I=G/2);let he;for(he=0;he<I;++he){let De=parseInt(f.substr(he*2,2),16);if(U(De))return he;d[b+he]=De}return he}function $(d,f,b,I){return q(J(f,d.length-b),d,b,I)}function X(d,f,b,I){return q(Y(f),d,b,I)}function ae(d,f,b,I){return q(ce(f),d,b,I)}function pe(d,f,b,I){return q(me(f,d.length-b),d,b,I)}n.prototype.write=function(d,f,b,I){if(f===void 0)I="utf8",b=this.length,f=0;else if(b===void 0&&typeof f=="string")I=f,b=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(b)?(b=b>>>0,I===void 0&&(I="utf8")):(I=b,b=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let B=this.length-f;if((b===void 0||b>B)&&(b=B),d.length>0&&(b<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");I||(I="utf8");let G=!1;for(;;)switch(I){case"hex":return N(this,d,f,b);case"utf8":case"utf-8":return $(this,d,f,b);case"ascii":case"latin1":case"binary":return X(this,d,f,b);case"base64":return ae(this,d,f,b);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pe(this,d,f,b);default:if(G)throw new TypeError("Unknown encoding: "+I);I=(""+I).toLowerCase(),G=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(d,f,b){return f===0&&b===d.length?e.fromByteArray(d):e.fromByteArray(d.slice(f,b))}function te(d,f,b){b=Math.min(d.length,b);let I=[],B=f;for(;B<b;){let G=d[B],he=null,De=G>239?4:G>223?3:G>191?2:1;if(B+De<=b){let ze,Ke,Le,qe;switch(De){case 1:G<128&&(he=G);break;case 2:ze=d[B+1],(ze&192)===128&&(qe=(G&31)<<6|ze&63,qe>127&&(he=qe));break;case 3:ze=d[B+1],Ke=d[B+2],(ze&192)===128&&(Ke&192)===128&&(qe=(G&15)<<12|(ze&63)<<6|Ke&63,qe>2047&&(qe<55296||qe>57343)&&(he=qe));break;case 4:ze=d[B+1],Ke=d[B+2],Le=d[B+3],(ze&192)===128&&(Ke&192)===128&&(Le&192)===128&&(qe=(G&15)<<18|(ze&63)<<12|(Ke&63)<<6|Le&63,qe>65535&&qe<1114112&&(he=qe))}}he===null?(he=65533,De=1):he>65535&&(he-=65536,I.push(he>>>10&1023|55296),he=56320|he&1023),I.push(he),B+=De}return ie(I)}let de=4096;function ie(d){let f=d.length;if(f<=de)return String.fromCharCode.apply(String,d);let b="",I=0;for(;I<f;)b+=String.fromCharCode.apply(String,d.slice(I,I+=de));return b}function ke(d,f,b){let I="";b=Math.min(d.length,b);for(let B=f;B<b;++B)I+=String.fromCharCode(d[B]&127);return I}function ye(d,f,b){let I="";b=Math.min(d.length,b);for(let B=f;B<b;++B)I+=String.fromCharCode(d[B]);return I}function ee(d,f,b){let I=d.length;(!f||f<0)&&(f=0),(!b||b<0||b>I)&&(b=I);let B="";for(let G=f;G<b;++G)B+=z[d[G]];return B}function Oe(d,f,b){let I=d.slice(f,b),B="";for(let G=0;G<I.length-1;G+=2)B+=String.fromCharCode(I[G]+I[G+1]*256);return B}n.prototype.slice=function(d,f){let b=this.length;d=~~d,f=f===void 0?b:~~f,d<0?(d+=b,d<0&&(d=0)):d>b&&(d=b),f<0?(f+=b,f<0&&(f=0)):f>b&&(f=b),f<d&&(f=d);let I=this.subarray(d,f);return Object.setPrototypeOf(I,n.prototype),I};function be(d,f,b){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+f>b)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUintLE=n.prototype.readUIntLE=function(d,f,b){d=d>>>0,f=f>>>0,b||be(d,f,this.length);let I=this[d],B=1,G=0;for(;++G<f&&(B*=256);)I+=this[d+G]*B;return I},n.prototype.readUintBE=n.prototype.readUIntBE=function(d,f,b){d=d>>>0,f=f>>>0,b||be(d,f,this.length);let I=this[d+--f],B=1;for(;f>0&&(B*=256);)I+=this[d+--f]*B;return I},n.prototype.readUint8=n.prototype.readUInt8=function(d,f){return d=d>>>0,f||be(d,1,this.length),this[d]},n.prototype.readUint16LE=n.prototype.readUInt16LE=function(d,f){return d=d>>>0,f||be(d,2,this.length),this[d]|this[d+1]<<8},n.prototype.readUint16BE=n.prototype.readUInt16BE=function(d,f){return d=d>>>0,f||be(d,2,this.length),this[d]<<8|this[d+1]},n.prototype.readUint32LE=n.prototype.readUInt32LE=function(d,f){return d=d>>>0,f||be(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},n.prototype.readUint32BE=n.prototype.readUInt32BE=function(d,f){return d=d>>>0,f||be(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},n.prototype.readBigUInt64LE=Z(function(d){d=d>>>0,ue(d,"offset");let f=this[d],b=this[d+7];(f===void 0||b===void 0)&&Pe(d,this.length-8);let I=f+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,B=this[++d]+this[++d]*2**8+this[++d]*2**16+b*2**24;return BigInt(I)+(BigInt(B)<<BigInt(32))}),n.prototype.readBigUInt64BE=Z(function(d){d=d>>>0,ue(d,"offset");let f=this[d],b=this[d+7];(f===void 0||b===void 0)&&Pe(d,this.length-8);let I=f*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],B=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+b;return(BigInt(I)<<BigInt(32))+BigInt(B)}),n.prototype.readIntLE=function(d,f,b){d=d>>>0,f=f>>>0,b||be(d,f,this.length);let I=this[d],B=1,G=0;for(;++G<f&&(B*=256);)I+=this[d+G]*B;return B*=128,I>=B&&(I-=Math.pow(2,8*f)),I},n.prototype.readIntBE=function(d,f,b){d=d>>>0,f=f>>>0,b||be(d,f,this.length);let I=f,B=1,G=this[d+--I];for(;I>0&&(B*=256);)G+=this[d+--I]*B;return B*=128,G>=B&&(G-=Math.pow(2,8*f)),G},n.prototype.readInt8=function(d,f){return d=d>>>0,f||be(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},n.prototype.readInt16LE=function(d,f){d=d>>>0,f||be(d,2,this.length);let b=this[d]|this[d+1]<<8;return b&32768?b|4294901760:b},n.prototype.readInt16BE=function(d,f){d=d>>>0,f||be(d,2,this.length);let b=this[d+1]|this[d]<<8;return b&32768?b|4294901760:b},n.prototype.readInt32LE=function(d,f){return d=d>>>0,f||be(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},n.prototype.readInt32BE=function(d,f){return d=d>>>0,f||be(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},n.prototype.readBigInt64LE=Z(function(d){d=d>>>0,ue(d,"offset");let f=this[d],b=this[d+7];(f===void 0||b===void 0)&&Pe(d,this.length-8);let I=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(b<<24);return(BigInt(I)<<BigInt(32))+BigInt(f+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),n.prototype.readBigInt64BE=Z(function(d){d=d>>>0,ue(d,"offset");let f=this[d],b=this[d+7];(f===void 0||b===void 0)&&Pe(d,this.length-8);let I=(f<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(I)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+b)}),n.prototype.readFloatLE=function(d,f){return d=d>>>0,f||be(d,4,this.length),s.read(this,d,!0,23,4)},n.prototype.readFloatBE=function(d,f){return d=d>>>0,f||be(d,4,this.length),s.read(this,d,!1,23,4)},n.prototype.readDoubleLE=function(d,f){return d=d>>>0,f||be(d,8,this.length),s.read(this,d,!0,52,8)},n.prototype.readDoubleBE=function(d,f){return d=d>>>0,f||be(d,8,this.length),s.read(this,d,!1,52,8)};function Ne(d,f,b,I,B,G){if(!n.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>B||f<G)throw new RangeError('"value" argument is out of bounds');if(b+I>d.length)throw new RangeError("Index out of range")}n.prototype.writeUintLE=n.prototype.writeUIntLE=function(d,f,b,I){if(d=+d,f=f>>>0,b=b>>>0,!I){let he=Math.pow(2,8*b)-1;Ne(this,d,f,b,he,0)}let B=1,G=0;for(this[f]=d&255;++G<b&&(B*=256);)this[f+G]=d/B&255;return f+b},n.prototype.writeUintBE=n.prototype.writeUIntBE=function(d,f,b,I){if(d=+d,f=f>>>0,b=b>>>0,!I){let he=Math.pow(2,8*b)-1;Ne(this,d,f,b,he,0)}let B=b-1,G=1;for(this[f+B]=d&255;--B>=0&&(G*=256);)this[f+B]=d/G&255;return f+b},n.prototype.writeUint8=n.prototype.writeUInt8=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,1,255,0),this[f]=d&255,f+1},n.prototype.writeUint16LE=n.prototype.writeUInt16LE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,2,65535,0),this[f]=d&255,this[f+1]=d>>>8,f+2},n.prototype.writeUint16BE=n.prototype.writeUInt16BE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,2,65535,0),this[f]=d>>>8,this[f+1]=d&255,f+2},n.prototype.writeUint32LE=n.prototype.writeUInt32LE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,4,4294967295,0),this[f+3]=d>>>24,this[f+2]=d>>>16,this[f+1]=d>>>8,this[f]=d&255,f+4},n.prototype.writeUint32BE=n.prototype.writeUInt32BE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,4,4294967295,0),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4};function T(d,f,b,I,B){fe(f,I,B,d,b,7);let G=Number(f&BigInt(4294967295));d[b++]=G,G=G>>8,d[b++]=G,G=G>>8,d[b++]=G,G=G>>8,d[b++]=G;let he=Number(f>>BigInt(32)&BigInt(4294967295));return d[b++]=he,he=he>>8,d[b++]=he,he=he>>8,d[b++]=he,he=he>>8,d[b++]=he,b}function oe(d,f,b,I,B){fe(f,I,B,d,b,7);let G=Number(f&BigInt(4294967295));d[b+7]=G,G=G>>8,d[b+6]=G,G=G>>8,d[b+5]=G,G=G>>8,d[b+4]=G;let he=Number(f>>BigInt(32)&BigInt(4294967295));return d[b+3]=he,he=he>>8,d[b+2]=he,he=he>>8,d[b+1]=he,he=he>>8,d[b]=he,b+8}n.prototype.writeBigUInt64LE=Z(function(d,f=0){return T(this,d,f,BigInt(0),BigInt("0xffffffffffffffff"))}),n.prototype.writeBigUInt64BE=Z(function(d,f=0){return oe(this,d,f,BigInt(0),BigInt("0xffffffffffffffff"))}),n.prototype.writeIntLE=function(d,f,b,I){if(d=+d,f=f>>>0,!I){let De=Math.pow(2,8*b-1);Ne(this,d,f,b,De-1,-De)}let B=0,G=1,he=0;for(this[f]=d&255;++B<b&&(G*=256);)d<0&&he===0&&this[f+B-1]!==0&&(he=1),this[f+B]=(d/G>>0)-he&255;return f+b},n.prototype.writeIntBE=function(d,f,b,I){if(d=+d,f=f>>>0,!I){let De=Math.pow(2,8*b-1);Ne(this,d,f,b,De-1,-De)}let B=b-1,G=1,he=0;for(this[f+B]=d&255;--B>=0&&(G*=256);)d<0&&he===0&&this[f+B+1]!==0&&(he=1),this[f+B]=(d/G>>0)-he&255;return f+b},n.prototype.writeInt8=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,1,127,-128),d<0&&(d=255+d+1),this[f]=d&255,f+1},n.prototype.writeInt16LE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,2,32767,-32768),this[f]=d&255,this[f+1]=d>>>8,f+2},n.prototype.writeInt16BE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,2,32767,-32768),this[f]=d>>>8,this[f+1]=d&255,f+2},n.prototype.writeInt32LE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,4,2147483647,-2147483648),this[f]=d&255,this[f+1]=d>>>8,this[f+2]=d>>>16,this[f+3]=d>>>24,f+4},n.prototype.writeInt32BE=function(d,f,b){return d=+d,f=f>>>0,b||Ne(this,d,f,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4},n.prototype.writeBigInt64LE=Z(function(d,f=0){return T(this,d,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),n.prototype.writeBigInt64BE=Z(function(d,f=0){return oe(this,d,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ae(d,f,b,I,B,G){if(b+I>d.length)throw new RangeError("Index out of range");if(b<0)throw new RangeError("Index out of range")}function Me(d,f,b,I,B){return f=+f,b=b>>>0,B||Ae(d,f,b,4),s.write(d,f,b,I,23,4),b+4}n.prototype.writeFloatLE=function(d,f,b){return Me(this,d,f,!0,b)},n.prototype.writeFloatBE=function(d,f,b){return Me(this,d,f,!1,b)};function Ee(d,f,b,I,B){return f=+f,b=b>>>0,B||Ae(d,f,b,8),s.write(d,f,b,I,52,8),b+8}n.prototype.writeDoubleLE=function(d,f,b){return Ee(this,d,f,!0,b)},n.prototype.writeDoubleBE=function(d,f,b){return Ee(this,d,f,!1,b)},n.prototype.copy=function(d,f,b,I){if(!n.isBuffer(d))throw new TypeError("argument should be a Buffer");if(b||(b=0),!I&&I!==0&&(I=this.length),f>=d.length&&(f=d.length),f||(f=0),I>0&&I<b&&(I=b),I===b||d.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(b<0||b>=this.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("sourceEnd out of bounds");I>this.length&&(I=this.length),d.length-f<I-b&&(I=d.length-f+b);let B=I-b;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,b,I):Uint8Array.prototype.set.call(d,this.subarray(b,I),f),B},n.prototype.fill=function(d,f,b,I){if(typeof d=="string"){if(typeof f=="string"?(I=f,f=0,b=this.length):typeof b=="string"&&(I=b,b=this.length),I!==void 0&&typeof I!="string")throw new TypeError("encoding must be a string");if(typeof I=="string"&&!n.isEncoding(I))throw new TypeError("Unknown encoding: "+I);if(d.length===1){let G=d.charCodeAt(0);(I==="utf8"&&G<128||I==="latin1")&&(d=G)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(f<0||this.length<f||this.length<b)throw new RangeError("Out of range index");if(b<=f)return this;f=f>>>0,b=b===void 0?this.length:b>>>0,d||(d=0);let B;if(typeof d=="number")for(B=f;B<b;++B)this[B]=d;else{let G=n.isBuffer(d)?d:n.from(d,I),he=G.length;if(he===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(B=0;B<b-f;++B)this[B+f]=G[B%he]}return this};let F={};function R(d,f,b){F[d]=class extends b{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(I){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:I,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}R("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),R("ERR_INVALID_ARG_TYPE",function(d,f){return`The "${d}" argument must be of type number. Received type ${typeof f}`},TypeError),R("ERR_OUT_OF_RANGE",function(d,f,b){let I=`The value of "${d}" is out of range.`,B=b;return Number.isInteger(b)&&Math.abs(b)>2**32?B=ne(String(b)):typeof b=="bigint"&&(B=String(b),(b>BigInt(2)**BigInt(32)||b<-(BigInt(2)**BigInt(32)))&&(B=ne(B)),B+="n"),I+=` It must be ${f}. Received ${B}`,I},RangeError);function ne(d){let f="",b=d.length,I=d[0]==="-"?1:0;for(;b>=I+4;b-=3)f=`_${d.slice(b-3,b)}${f}`;return`${d.slice(0,b)}${f}`}function Se(d,f,b){ue(f,"offset"),(d[f]===void 0||d[f+b]===void 0)&&Pe(f,d.length-(b+1))}function fe(d,f,b,I,B,G){if(d>b||d<f){let he=typeof f=="bigint"?"n":"",De;throw f===0||f===BigInt(0)?De=`>= 0${he} and < 2${he} ** ${(G+1)*8}${he}`:De=`>= -(2${he} ** ${(G+1)*8-1}${he}) and < 2 ** ${(G+1)*8-1}${he}`,new F.ERR_OUT_OF_RANGE("value",De,d)}Se(I,B,G)}function ue(d,f){if(typeof d!="number")throw new F.ERR_INVALID_ARG_TYPE(f,"number",d)}function Pe(d,f,b){throw Math.floor(d)!==d?(ue(d,b),new F.ERR_OUT_OF_RANGE("offset","an integer",d)):f<0?new F.ERR_BUFFER_OUT_OF_BOUNDS:new F.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${f}`,d)}let Te=/[^+/0-9A-Za-z-_]/g;function L(d){if(d=d.split("=")[0],d=d.trim().replace(Te,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function J(d,f){f=f||1/0;let b,I=d.length,B=null,G=[];for(let he=0;he<I;++he){if(b=d.charCodeAt(he),b>55295&&b<57344){if(!B){if(b>56319){(f-=3)>-1&&G.push(239,191,189);continue}else if(he+1===I){(f-=3)>-1&&G.push(239,191,189);continue}B=b;continue}if(b<56320){(f-=3)>-1&&G.push(239,191,189),B=b;continue}b=(B-55296<<10|b-56320)+65536}else B&&(f-=3)>-1&&G.push(239,191,189);if(B=null,b<128){if((f-=1)<0)break;G.push(b)}else if(b<2048){if((f-=2)<0)break;G.push(b>>6|192,b&63|128)}else if(b<65536){if((f-=3)<0)break;G.push(b>>12|224,b>>6&63|128,b&63|128)}else if(b<1114112){if((f-=4)<0)break;G.push(b>>18|240,b>>12&63|128,b>>6&63|128,b&63|128)}else throw new Error("Invalid code point")}return G}function Y(d){let f=[];for(let b=0;b<d.length;++b)f.push(d.charCodeAt(b)&255);return f}function me(d,f){let b,I,B,G=[];for(let he=0;he<d.length&&!((f-=2)<0);++he)b=d.charCodeAt(he),I=b>>8,B=b%256,G.push(B),G.push(I);return G}function ce(d){return e.toByteArray(L(d))}function q(d,f,b,I){let B;for(B=0;B<I&&!(B+b>=f.length||B>=d.length);++B)f[B+b]=d[B];return B}function re(d,f){return d instanceof f||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===f.name}function U(d){return d!==d}let z=function(){let d="0123456789abcdef",f=new Array(256);for(let b=0;b<16;++b){let I=b*16;for(let B=0;B<16;++B)f[I+B]=d[b]+d[B]}return f}();function Z(d){return typeof BigInt>"u"?ve:d}function ve(){throw new Error("BigInt not supported")}return lr}var Ur,yo,Jr,_o,lr,wo,Kt,dn,js,Us,yt=w(()=>{we(),_e(),M(),Ur={},yo=!1,Jr={},_o=!1,lr={},wo=!1,Kt=mu(),Kt.Buffer,Kt.SlowBuffer,Kt.INSPECT_MAX_BYTES,Kt.kMaxLength,dn=Kt.Buffer,js=Kt.INSPECT_MAX_BYTES,Us=Kt.kMaxLength}),we=w(()=>{yt()}),bu=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=class{constructor(r){this.aliasToTopic={},this.max=r}put(r,h){return h===0||h>this.max?!1:(this.aliasToTopic[h]=r,this.length=Object.keys(this.aliasToTopic).length,!0)}getTopicByAlias(r){return this.aliasToTopic[r]}clear(){this.aliasToTopic={}}};e.default=s}),dt=E((e,s)=>{we(),_e(),M(),s.exports={ArrayIsArray(r){return Array.isArray(r)},ArrayPrototypeIncludes(r,h){return r.includes(h)},ArrayPrototypeIndexOf(r,h){return r.indexOf(h)},ArrayPrototypeJoin(r,h){return r.join(h)},ArrayPrototypeMap(r,h){return r.map(h)},ArrayPrototypePop(r,h){return r.pop(h)},ArrayPrototypePush(r,h){return r.push(h)},ArrayPrototypeSlice(r,h,p){return r.slice(h,p)},Error,FunctionPrototypeCall(r,h,...p){return r.call(h,...p)},FunctionPrototypeSymbolHasInstance(r,h){return Function.prototype[Symbol.hasInstance].call(r,h)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(r,h){return Object.defineProperties(r,h)},ObjectDefineProperty(r,h,p){return Object.defineProperty(r,h,p)},ObjectGetOwnPropertyDescriptor(r,h){return Object.getOwnPropertyDescriptor(r,h)},ObjectKeys(r){return Object.keys(r)},ObjectSetPrototypeOf(r,h){return Object.setPrototypeOf(r,h)},Promise,PromisePrototypeCatch(r,h){return r.catch(h)},PromisePrototypeThen(r,h,p){return r.then(h,p)},PromiseReject(r){return Promise.reject(r)},ReflectApply:Reflect.apply,RegExpPrototypeTest(r,h){return r.test(h)},SafeSet:Set,String,StringPrototypeSlice(r,h,p){return r.slice(h,p)},StringPrototypeToLowerCase(r){return r.toLowerCase()},StringPrototypeToUpperCase(r){return r.toUpperCase()},StringPrototypeTrim(r){return r.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(r,h,p){return r.set(h,p)},Uint8Array}}),Jt=E((e,s)=>{we(),_e(),M();var r=(yt(),V(bt)),h=Object.getPrototypeOf(async function(){}).constructor,p=globalThis.Blob||r.Blob,o=typeof p<"u"?function(a){return a instanceof p}:function(a){return!1},n=class extends Error{constructor(a){if(!Array.isArray(a))throw new TypeError(`Expected input to be an Array, got ${typeof a}`);let i="";for(let c=0;c<a.length;c++)i+=`    ${a[c].stack}
`;super(i),this.name="AggregateError",this.errors=a}};s.exports={AggregateError:n,kEmptyObject:Object.freeze({}),once(a){let i=!1;return function(...c){i||(i=!0,a.apply(this,c))}},createDeferredPromise:function(){let a,i;return{promise:new Promise((c,g)=>{a=c,i=g}),resolve:a,reject:i}},promisify(a){return new Promise((i,c)=>{a((g,...y)=>g?c(g):i(...y))})},debuglog(){return function(){}},format(a,...i){return a.replace(/%([sdifj])/g,function(...[c,g]){let y=i.shift();return g==="f"?y.toFixed(6):g==="j"?JSON.stringify(y):g==="s"&&typeof y=="object"?`${y.constructor!==Object?y.constructor.name:""} {}`.trim():y.toString()})},inspect(a){switch(typeof a){case"string":if(a.includes("'"))if(a.includes('"')){if(!a.includes("`")&&!a.includes("${"))return`\`${a}\``}else return`"${a}"`;return`'${a}'`;case"number":return isNaN(a)?"NaN":Object.is(a,-0)?String(a):a;case"bigint":return`${String(a)}n`;case"boolean":case"undefined":return String(a);case"object":return"{}"}},types:{isAsyncFunction(a){return a instanceof h},isArrayBufferView(a){return ArrayBuffer.isView(a)}},isBlob:o},s.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}),vo=E((e,s)=>{we(),_e(),M();var{AbortController:r,AbortSignal:h}=typeof self<"u"?self:typeof window<"u"?window:void 0;s.exports=r,s.exports.AbortSignal=h,s.exports.default=r}),At=E((e,s)=>{we(),_e(),M();var{format:r,inspect:h,AggregateError:p}=Jt(),o=globalThis.AggregateError||p,n=Symbol("kIsNodeError"),a=["string","function","number","object","Function","Object","boolean","bigint","symbol"],i=/^([A-Z][a-z0-9]*)+$/,c="__node_internal_",g={};function y(k,P){if(!k)throw new g.ERR_INTERNAL_ASSERTION(P)}function _(k){let P="",K=k.length,Q=k[0]==="-"?1:0;for(;K>=Q+4;K-=3)P=`_${k.slice(K-3,K)}${P}`;return`${k.slice(0,K)}${P}`}function v(k,P,K){if(typeof P=="function")return y(P.length<=K.length,`Code: ${k}; The provided arguments length (${K.length}) does not match the required ones (${P.length}).`),P(...K);let Q=(P.match(/%[dfijoOs]/g)||[]).length;return y(Q===K.length,`Code: ${k}; The provided arguments length (${K.length}) does not match the required ones (${Q}).`),K.length===0?P:r(P,...K)}function S(k,P,K){K||(K=Error);class Q extends K{constructor(...N){super(v(k,P,N))}toString(){return`${this.name} [${k}]: ${this.message}`}}Object.defineProperties(Q.prototype,{name:{value:K.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${k}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),Q.prototype.code=k,Q.prototype[n]=!0,g[k]=Q}function C(k){let P=c+k.name;return Object.defineProperty(k,"name",{value:P}),k}function x(k,P){if(k&&P&&k!==P){if(Array.isArray(P.errors))return P.errors.push(k),P;let K=new o([P,k],P.message);return K.code=P.code,K}return k||P}var H=class extends Error{constructor(k="The operation was aborted",P=void 0){if(P!==void 0&&typeof P!="object")throw new g.ERR_INVALID_ARG_TYPE("options","Object",P);super(k,P),this.code="ABORT_ERR",this.name="AbortError"}};S("ERR_ASSERTION","%s",Error),S("ERR_INVALID_ARG_TYPE",(k,P,K)=>{y(typeof k=="string","'name' must be a string"),Array.isArray(P)||(P=[P]);let Q="The ";k.endsWith(" argument")?Q+=`${k} `:Q+=`"${k}" ${k.includes(".")?"property":"argument"} `,Q+="must be ";let j=[],N=[],$=[];for(let ae of P)y(typeof ae=="string","All expected entries have to be of type string"),a.includes(ae)?j.push(ae.toLowerCase()):i.test(ae)?N.push(ae):(y(ae!=="object",'The value "object" should be written as "Object"'),$.push(ae));if(N.length>0){let ae=j.indexOf("object");ae!==-1&&(j.splice(j,ae,1),N.push("Object"))}if(j.length>0){switch(j.length){case 1:Q+=`of type ${j[0]}`;break;case 2:Q+=`one of type ${j[0]} or ${j[1]}`;break;default:{let ae=j.pop();Q+=`one of type ${j.join(", ")}, or ${ae}`}}(N.length>0||$.length>0)&&(Q+=" or ")}if(N.length>0){switch(N.length){case 1:Q+=`an instance of ${N[0]}`;break;case 2:Q+=`an instance of ${N[0]} or ${N[1]}`;break;default:{let ae=N.pop();Q+=`an instance of ${N.join(", ")}, or ${ae}`}}$.length>0&&(Q+=" or ")}switch($.length){case 0:break;case 1:$[0].toLowerCase()!==$[0]&&(Q+="an "),Q+=`${$[0]}`;break;case 2:Q+=`one of ${$[0]} or ${$[1]}`;break;default:{let ae=$.pop();Q+=`one of ${$.join(", ")}, or ${ae}`}}if(K==null)Q+=`. Received ${K}`;else if(typeof K=="function"&&K.name)Q+=`. Received function ${K.name}`;else if(typeof K=="object"){var X;if((X=K.constructor)!==null&&X!==void 0&&X.name)Q+=`. Received an instance of ${K.constructor.name}`;else{let ae=h(K,{depth:-1});Q+=`. Received ${ae}`}}else{let ae=h(K,{colors:!1});ae.length>25&&(ae=`${ae.slice(0,25)}...`),Q+=`. Received type ${typeof K} (${ae})`}return Q},TypeError),S("ERR_INVALID_ARG_VALUE",(k,P,K="is invalid")=>{let Q=h(P);return Q.length>128&&(Q=Q.slice(0,128)+"..."),`The ${k.includes(".")?"property":"argument"} '${k}' ${K}. Received ${Q}`},TypeError),S("ERR_INVALID_RETURN_VALUE",(k,P,K)=>{var Q;let j=K!=null&&(Q=K.constructor)!==null&&Q!==void 0&&Q.name?`instance of ${K.constructor.name}`:`type ${typeof K}`;return`Expected ${k} to be returned from the "${P}" function but got ${j}.`},TypeError),S("ERR_MISSING_ARGS",(...k)=>{y(k.length>0,"At least one arg needs to be specified");let P,K=k.length;switch(k=(Array.isArray(k)?k:[k]).map(Q=>`"${Q}"`).join(" or "),K){case 1:P+=`The ${k[0]} argument`;break;case 2:P+=`The ${k[0]} and ${k[1]} arguments`;break;default:{let Q=k.pop();P+=`The ${k.join(", ")}, and ${Q} arguments`}break}return`${P} must be specified`},TypeError),S("ERR_OUT_OF_RANGE",(k,P,K)=>{y(P,'Missing "range" argument');let Q;return Number.isInteger(K)&&Math.abs(K)>2**32?Q=_(String(K)):typeof K=="bigint"?(Q=String(K),(K>2n**32n||K<-(2n**32n))&&(Q=_(Q)),Q+="n"):Q=h(K),`The value of "${k}" is out of range. It must be ${P}. Received ${Q}`},RangeError),S("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),S("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),S("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),S("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),S("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),S("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),S("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),S("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),S("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),S("ERR_STREAM_WRITE_AFTER_END","write after end",Error),S("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),s.exports={AbortError:H,aggregateTwoErrors:C(x),hideStackFrames:C,codes:g}}),pn=E((e,s)=>{we(),_e(),M();var{ArrayIsArray:r,ArrayPrototypeIncludes:h,ArrayPrototypeJoin:p,ArrayPrototypeMap:o,NumberIsInteger:n,NumberIsNaN:a,NumberMAX_SAFE_INTEGER:i,NumberMIN_SAFE_INTEGER:c,NumberParseInt:g,ObjectPrototypeHasOwnProperty:y,RegExpPrototypeExec:_,String:v,StringPrototypeToUpperCase:S,StringPrototypeTrim:C}=dt(),{hideStackFrames:x,codes:{ERR_SOCKET_BAD_PORT:H,ERR_INVALID_ARG_TYPE:k,ERR_INVALID_ARG_VALUE:P,ERR_OUT_OF_RANGE:K,ERR_UNKNOWN_SIGNAL:Q}}=At(),{normalizeEncoding:j}=Jt(),{isAsyncFunction:N,isArrayBufferView:$}=Jt().types,X={};function ae(q){return q===(q|0)}function pe(q){return q===q>>>0}var O=/^[0-7]+$/,te="must be a 32-bit unsigned integer or an octal string";function de(q,re,U){if(typeof q>"u"&&(q=U),typeof q=="string"){if(_(O,q)===null)throw new P(re,q,te);q=g(q,8)}return ye(q,re),q}var ie=x((q,re,U=c,z=i)=>{if(typeof q!="number")throw new k(re,"number",q);if(!n(q))throw new K(re,"an integer",q);if(q<U||q>z)throw new K(re,`>= ${U} && <= ${z}`,q)}),ke=x((q,re,U=-2147483648,z=2147483647)=>{if(typeof q!="number")throw new k(re,"number",q);if(!n(q))throw new K(re,"an integer",q);if(q<U||q>z)throw new K(re,`>= ${U} && <= ${z}`,q)}),ye=x((q,re,U=!1)=>{if(typeof q!="number")throw new k(re,"number",q);if(!n(q))throw new K(re,"an integer",q);let z=U?1:0,Z=4294967295;if(q<z||q>Z)throw new K(re,`>= ${z} && <= ${Z}`,q)});function ee(q,re){if(typeof q!="string")throw new k(re,"string",q)}function Oe(q,re,U=void 0,z){if(typeof q!="number")throw new k(re,"number",q);if(U!=null&&q<U||z!=null&&q>z||(U!=null||z!=null)&&a(q))throw new K(re,`${U!=null?`>= ${U}`:""}${U!=null&&z!=null?" && ":""}${z!=null?`<= ${z}`:""}`,q)}var be=x((q,re,U)=>{if(!h(U,q)){let z="must be one of: "+p(o(U,Z=>typeof Z=="string"?`'${Z}'`:v(Z)),", ");throw new P(re,q,z)}});function Ne(q,re){if(typeof q!="boolean")throw new k(re,"boolean",q)}function T(q,re,U){return q==null||!y(q,re)?U:q[re]}var oe=x((q,re,U=null)=>{let z=T(U,"allowArray",!1),Z=T(U,"allowFunction",!1);if(!T(U,"nullable",!1)&&q===null||!z&&r(q)||typeof q!="object"&&(!Z||typeof q!="function"))throw new k(re,"Object",q)}),Ae=x((q,re)=>{if(q!=null&&typeof q!="object"&&typeof q!="function")throw new k(re,"a dictionary",q)}),Me=x((q,re,U=0)=>{if(!r(q))throw new k(re,"Array",q);if(q.length<U){let z=`must be longer than ${U}`;throw new P(re,q,z)}});function Ee(q,re){Me(q,re);for(let U=0;U<q.length;U++)ee(q[U],`${re}[${U}]`)}function F(q,re){Me(q,re);for(let U=0;U<q.length;U++)Ne(q[U],`${re}[${U}]`)}function R(q,re="signal"){if(ee(q,re),X[q]===void 0)throw X[S(q)]!==void 0?new Q(q+" (signals must use all capital letters)"):new Q(q)}var ne=x((q,re="buffer")=>{if(!$(q))throw new k(re,["Buffer","TypedArray","DataView"],q)});function Se(q,re){let U=j(re),z=q.length;if(U==="hex"&&z%2!==0)throw new P("encoding",re,`is invalid for data of length ${z}`)}function fe(q,re="Port",U=!0){if(typeof q!="number"&&typeof q!="string"||typeof q=="string"&&C(q).length===0||+q!==+q>>>0||q>65535||q===0&&!U)throw new H(re,q,U);return q|0}var ue=x((q,re)=>{if(q!==void 0&&(q===null||typeof q!="object"||!("aborted"in q)))throw new k(re,"AbortSignal",q)}),Pe=x((q,re)=>{if(typeof q!="function")throw new k(re,"Function",q)}),Te=x((q,re)=>{if(typeof q!="function"||N(q))throw new k(re,"Function",q)}),L=x((q,re)=>{if(q!==void 0)throw new k(re,"undefined",q)});function J(q,re,U){if(!h(U,q))throw new k(re,`('${p(U,"|")}')`,q)}var Y=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function me(q,re){if(typeof q>"u"||!_(Y,q))throw new P(re,q,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ce(q){if(typeof q=="string")return me(q,"hints"),q;if(r(q)){let re=q.length,U="";if(re===0)return U;for(let z=0;z<re;z++){let Z=q[z];me(Z,"hints"),U+=Z,z!==re-1&&(U+=", ")}return U}throw new P("hints",q,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}s.exports={isInt32:ae,isUint32:pe,parseFileMode:de,validateArray:Me,validateStringArray:Ee,validateBooleanArray:F,validateBoolean:Ne,validateBuffer:ne,validateDictionary:Ae,validateEncoding:Se,validateFunction:Pe,validateInt32:ke,validateInteger:ie,validateNumber:Oe,validateObject:oe,validateOneOf:be,validatePlainFunction:Te,validatePort:fe,validateSignalName:R,validateString:ee,validateUint32:ye,validateUndefined:L,validateUnion:J,validateAbortSignal:ue,validateLinkHeaderValue:ce}}),br=E((e,s)=>{we(),_e(),M();var r=s.exports={},h,p;function o(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?h=setTimeout:h=o}catch{h=o}try{typeof clearTimeout=="function"?p=clearTimeout:p=n}catch{p=n}})();function a(H){if(h===setTimeout)return setTimeout(H,0);if((h===o||!h)&&setTimeout)return h=setTimeout,setTimeout(H,0);try{return h(H,0)}catch{try{return h.call(null,H,0)}catch{return h.call(this,H,0)}}}function i(H){if(p===clearTimeout)return clearTimeout(H);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(H);try{return p(H)}catch{try{return p.call(null,H)}catch{return p.call(this,H)}}}var c=[],g=!1,y,_=-1;function v(){!g||!y||(g=!1,y.length?c=y.concat(c):_=-1,c.length&&S())}function S(){if(!g){var H=a(v);g=!0;for(var k=c.length;k;){for(y=c,c=[];++_<k;)y&&y[_].run();_=-1,k=c.length}y=null,g=!1,i(H)}}r.nextTick=function(H){var k=new Array(arguments.length-1);if(arguments.length>1)for(var P=1;P<arguments.length;P++)k[P-1]=arguments[P];c.push(new C(H,k)),c.length===1&&!g&&a(S)};function C(H,k){this.fun=H,this.array=k}C.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(H){return[]},r.binding=function(H){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(H){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}}),Qt=E((e,s)=>{we(),_e(),M();var{Symbol:r,SymbolAsyncIterator:h,SymbolIterator:p,SymbolFor:o}=dt(),n=r("kDestroyed"),a=r("kIsErrored"),i=r("kIsReadable"),c=r("kIsDisturbed"),g=o("nodejs.webstream.isClosedPromise"),y=o("nodejs.webstream.controllerErrorFunction");function _(T,oe=!1){var Ae;return!!(T&&typeof T.pipe=="function"&&typeof T.on=="function"&&(!oe||typeof T.pause=="function"&&typeof T.resume=="function")&&(!T._writableState||((Ae=T._readableState)===null||Ae===void 0?void 0:Ae.readable)!==!1)&&(!T._writableState||T._readableState))}function v(T){var oe;return!!(T&&typeof T.write=="function"&&typeof T.on=="function"&&(!T._readableState||((oe=T._writableState)===null||oe===void 0?void 0:oe.writable)!==!1))}function S(T){return!!(T&&typeof T.pipe=="function"&&T._readableState&&typeof T.on=="function"&&typeof T.write=="function")}function C(T){return T&&(T._readableState||T._writableState||typeof T.write=="function"&&typeof T.on=="function"||typeof T.pipe=="function"&&typeof T.on=="function")}function x(T){return!!(T&&!C(T)&&typeof T.pipeThrough=="function"&&typeof T.getReader=="function"&&typeof T.cancel=="function")}function H(T){return!!(T&&!C(T)&&typeof T.getWriter=="function"&&typeof T.abort=="function")}function k(T){return!!(T&&!C(T)&&typeof T.readable=="object"&&typeof T.writable=="object")}function P(T){return x(T)||H(T)||k(T)}function K(T,oe){return T==null?!1:oe===!0?typeof T[h]=="function":oe===!1?typeof T[p]=="function":typeof T[h]=="function"||typeof T[p]=="function"}function Q(T){if(!C(T))return null;let oe=T._writableState,Ae=T._readableState,Me=oe||Ae;return!!(T.destroyed||T[n]||Me!=null&&Me.destroyed)}function j(T){if(!v(T))return null;if(T.writableEnded===!0)return!0;let oe=T._writableState;return oe!=null&&oe.errored?!1:typeof(oe==null?void 0:oe.ended)!="boolean"?null:oe.ended}function N(T,oe){if(!v(T))return null;if(T.writableFinished===!0)return!0;let Ae=T._writableState;return Ae!=null&&Ae.errored?!1:typeof(Ae==null?void 0:Ae.finished)!="boolean"?null:!!(Ae.finished||oe===!1&&Ae.ended===!0&&Ae.length===0)}function $(T){if(!_(T))return null;if(T.readableEnded===!0)return!0;let oe=T._readableState;return!oe||oe.errored?!1:typeof(oe==null?void 0:oe.ended)!="boolean"?null:oe.ended}function X(T,oe){if(!_(T))return null;let Ae=T._readableState;return Ae!=null&&Ae.errored?!1:typeof(Ae==null?void 0:Ae.endEmitted)!="boolean"?null:!!(Ae.endEmitted||oe===!1&&Ae.ended===!0&&Ae.length===0)}function ae(T){return T&&T[i]!=null?T[i]:typeof(T==null?void 0:T.readable)!="boolean"?null:Q(T)?!1:_(T)&&T.readable&&!X(T)}function pe(T){return typeof(T==null?void 0:T.writable)!="boolean"?null:Q(T)?!1:v(T)&&T.writable&&!j(T)}function O(T,oe){return C(T)?Q(T)?!0:!((oe==null?void 0:oe.readable)!==!1&&ae(T)||(oe==null?void 0:oe.writable)!==!1&&pe(T)):null}function te(T){var oe,Ae;return C(T)?T.writableErrored?T.writableErrored:(oe=(Ae=T._writableState)===null||Ae===void 0?void 0:Ae.errored)!==null&&oe!==void 0?oe:null:null}function de(T){var oe,Ae;return C(T)?T.readableErrored?T.readableErrored:(oe=(Ae=T._readableState)===null||Ae===void 0?void 0:Ae.errored)!==null&&oe!==void 0?oe:null:null}function ie(T){if(!C(T))return null;if(typeof T.closed=="boolean")return T.closed;let oe=T._writableState,Ae=T._readableState;return typeof(oe==null?void 0:oe.closed)=="boolean"||typeof(Ae==null?void 0:Ae.closed)=="boolean"?(oe==null?void 0:oe.closed)||(Ae==null?void 0:Ae.closed):typeof T._closed=="boolean"&&ke(T)?T._closed:null}function ke(T){return typeof T._closed=="boolean"&&typeof T._defaultKeepAlive=="boolean"&&typeof T._removedConnection=="boolean"&&typeof T._removedContLen=="boolean"}function ye(T){return typeof T._sent100=="boolean"&&ke(T)}function ee(T){var oe;return typeof T._consuming=="boolean"&&typeof T._dumped=="boolean"&&((oe=T.req)===null||oe===void 0?void 0:oe.upgradeOrConnect)===void 0}function Oe(T){if(!C(T))return null;let oe=T._writableState,Ae=T._readableState,Me=oe||Ae;return!Me&&ye(T)||!!(Me&&Me.autoDestroy&&Me.emitClose&&Me.closed===!1)}function be(T){var oe;return!!(T&&((oe=T[c])!==null&&oe!==void 0?oe:T.readableDidRead||T.readableAborted))}function Ne(T){var oe,Ae,Me,Ee,F,R,ne,Se,fe,ue;return!!(T&&((oe=(Ae=(Me=(Ee=(F=(R=T[a])!==null&&R!==void 0?R:T.readableErrored)!==null&&F!==void 0?F:T.writableErrored)!==null&&Ee!==void 0?Ee:(ne=T._readableState)===null||ne===void 0?void 0:ne.errorEmitted)!==null&&Me!==void 0?Me:(Se=T._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&Ae!==void 0?Ae:(fe=T._readableState)===null||fe===void 0?void 0:fe.errored)!==null&&oe!==void 0?oe:!((ue=T._writableState)===null||ue===void 0)&&ue.errored))}s.exports={kDestroyed:n,isDisturbed:be,kIsDisturbed:c,isErrored:Ne,kIsErrored:a,isReadable:ae,kIsReadable:i,kIsClosedPromise:g,kControllerErrorFunction:y,isClosed:ie,isDestroyed:Q,isDuplexNodeStream:S,isFinished:O,isIterable:K,isReadableNodeStream:_,isReadableStream:x,isReadableEnded:$,isReadableFinished:X,isReadableErrored:de,isNodeStream:C,isWebStream:P,isWritable:pe,isWritableNodeStream:v,isWritableStream:H,isWritableEnded:j,isWritableFinished:N,isWritableErrored:te,isServerRequest:ee,isServerResponse:ye,willEmitClose:Oe,isTransformStream:k}}),cr=E((e,s)=>{we(),_e(),M();var r=br(),{AbortError:h,codes:p}=At(),{ERR_INVALID_ARG_TYPE:o,ERR_STREAM_PREMATURE_CLOSE:n}=p,{kEmptyObject:a,once:i}=Jt(),{validateAbortSignal:c,validateFunction:g,validateObject:y,validateBoolean:_}=pn(),{Promise:v,PromisePrototypeThen:S}=dt(),{isClosed:C,isReadable:x,isReadableNodeStream:H,isReadableStream:k,isReadableFinished:P,isReadableErrored:K,isWritable:Q,isWritableNodeStream:j,isWritableStream:N,isWritableFinished:$,isWritableErrored:X,isNodeStream:ae,willEmitClose:pe,kIsClosedPromise:O}=Qt();function te(ee){return ee.setHeader&&typeof ee.abort=="function"}var de=()=>{};function ie(ee,Oe,be){var Ne,T;if(arguments.length===2?(be=Oe,Oe=a):Oe==null?Oe=a:y(Oe,"options"),g(be,"callback"),c(Oe.signal,"options.signal"),be=i(be),k(ee)||N(ee))return ke(ee,Oe,be);if(!ae(ee))throw new o("stream",["ReadableStream","WritableStream","Stream"],ee);let oe=(Ne=Oe.readable)!==null&&Ne!==void 0?Ne:H(ee),Ae=(T=Oe.writable)!==null&&T!==void 0?T:j(ee),Me=ee._writableState,Ee=ee._readableState,F=()=>{ee.writable||Se()},R=pe(ee)&&H(ee)===oe&&j(ee)===Ae,ne=$(ee,!1),Se=()=>{ne=!0,ee.destroyed&&(R=!1),!(R&&(!ee.readable||oe))&&(!oe||fe)&&be.call(ee)},fe=P(ee,!1),ue=()=>{fe=!0,ee.destroyed&&(R=!1),!(R&&(!ee.writable||Ae))&&(!Ae||ne)&&be.call(ee)},Pe=ce=>{be.call(ee,ce)},Te=C(ee),L=()=>{Te=!0;let ce=X(ee)||K(ee);if(ce&&typeof ce!="boolean")return be.call(ee,ce);if(oe&&!fe&&H(ee,!0)&&!P(ee,!1))return be.call(ee,new n);if(Ae&&!ne&&!$(ee,!1))return be.call(ee,new n);be.call(ee)},J=()=>{Te=!0;let ce=X(ee)||K(ee);if(ce&&typeof ce!="boolean")return be.call(ee,ce);be.call(ee)},Y=()=>{ee.req.on("finish",Se)};te(ee)?(ee.on("complete",Se),R||ee.on("abort",L),ee.req?Y():ee.on("request",Y)):Ae&&!Me&&(ee.on("end",F),ee.on("close",F)),!R&&typeof ee.aborted=="boolean"&&ee.on("aborted",L),ee.on("end",ue),ee.on("finish",Se),Oe.error!==!1&&ee.on("error",Pe),ee.on("close",L),Te?r.nextTick(L):Me!=null&&Me.errorEmitted||Ee!=null&&Ee.errorEmitted?R||r.nextTick(J):(!oe&&(!R||x(ee))&&(ne||Q(ee)===!1)||!Ae&&(!R||Q(ee))&&(fe||x(ee)===!1)||Ee&&ee.req&&ee.aborted)&&r.nextTick(J);let me=()=>{be=de,ee.removeListener("aborted",L),ee.removeListener("complete",Se),ee.removeListener("abort",L),ee.removeListener("request",Y),ee.req&&ee.req.removeListener("finish",Se),ee.removeListener("end",F),ee.removeListener("close",F),ee.removeListener("finish",Se),ee.removeListener("end",ue),ee.removeListener("error",Pe),ee.removeListener("close",L)};if(Oe.signal&&!Te){let ce=()=>{let q=be;me(),q.call(ee,new h(void 0,{cause:Oe.signal.reason}))};if(Oe.signal.aborted)r.nextTick(ce);else{let q=be;be=i((...re)=>{Oe.signal.removeEventListener("abort",ce),q.apply(ee,re)}),Oe.signal.addEventListener("abort",ce)}}return me}function ke(ee,Oe,be){let Ne=!1,T=de;if(Oe.signal)if(T=()=>{Ne=!0,be.call(ee,new h(void 0,{cause:Oe.signal.reason}))},Oe.signal.aborted)r.nextTick(T);else{let Ae=be;be=i((...Me)=>{Oe.signal.removeEventListener("abort",T),Ae.apply(ee,Me)}),Oe.signal.addEventListener("abort",T)}let oe=(...Ae)=>{Ne||r.nextTick(()=>be.apply(ee,Ae))};return S(ee[O].promise,oe,oe),de}function ye(ee,Oe){var be;let Ne=!1;return Oe===null&&(Oe=a),(be=Oe)!==null&&be!==void 0&&be.cleanup&&(_(Oe.cleanup,"cleanup"),Ne=Oe.cleanup),new v((T,oe)=>{let Ae=ie(ee,Oe,Me=>{Ne&&Ae(),Me?oe(Me):T()})})}s.exports=ie,s.exports.finished=ye}),Lr=E((e,s)=>{we(),_e(),M();var r=br(),{aggregateTwoErrors:h,codes:{ERR_MULTIPLE_CALLBACK:p},AbortError:o}=At(),{Symbol:n}=dt(),{kDestroyed:a,isDestroyed:i,isFinished:c,isServerRequest:g}=Qt(),y=n("kDestroy"),_=n("kConstruct");function v(O,te,de){O&&(O.stack,te&&!te.errored&&(te.errored=O),de&&!de.errored&&(de.errored=O))}function S(O,te){let de=this._readableState,ie=this._writableState,ke=ie||de;return ie!=null&&ie.destroyed||de!=null&&de.destroyed?(typeof te=="function"&&te(),this):(v(O,ie,de),ie&&(ie.destroyed=!0),de&&(de.destroyed=!0),ke.constructed?C(this,O,te):this.once(y,function(ye){C(this,h(ye,O),te)}),this)}function C(O,te,de){let ie=!1;function ke(ye){if(ie)return;ie=!0;let ee=O._readableState,Oe=O._writableState;v(ye,Oe,ee),Oe&&(Oe.closed=!0),ee&&(ee.closed=!0),typeof de=="function"&&de(ye),ye?r.nextTick(x,O,ye):r.nextTick(H,O)}try{O._destroy(te||null,ke)}catch(ye){ke(ye)}}function x(O,te){k(O,te),H(O)}function H(O){let te=O._readableState,de=O._writableState;de&&(de.closeEmitted=!0),te&&(te.closeEmitted=!0),(de!=null&&de.emitClose||te!=null&&te.emitClose)&&O.emit("close")}function k(O,te){let de=O._readableState,ie=O._writableState;ie!=null&&ie.errorEmitted||de!=null&&de.errorEmitted||(ie&&(ie.errorEmitted=!0),de&&(de.errorEmitted=!0),O.emit("error",te))}function P(){let O=this._readableState,te=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),te&&(te.constructed=!0,te.destroyed=!1,te.closed=!1,te.closeEmitted=!1,te.errored=null,te.errorEmitted=!1,te.finalCalled=!1,te.prefinished=!1,te.ended=te.writable===!1,te.ending=te.writable===!1,te.finished=te.writable===!1)}function K(O,te,de){let ie=O._readableState,ke=O._writableState;if(ke!=null&&ke.destroyed||ie!=null&&ie.destroyed)return this;ie!=null&&ie.autoDestroy||ke!=null&&ke.autoDestroy?O.destroy(te):te&&(te.stack,ke&&!ke.errored&&(ke.errored=te),ie&&!ie.errored&&(ie.errored=te),de?r.nextTick(k,O,te):k(O,te))}function Q(O,te){if(typeof O._construct!="function")return;let de=O._readableState,ie=O._writableState;de&&(de.constructed=!1),ie&&(ie.constructed=!1),O.once(_,te),!(O.listenerCount(_)>1)&&r.nextTick(j,O)}function j(O){let te=!1;function de(ie){if(te){K(O,ie??new p);return}te=!0;let ke=O._readableState,ye=O._writableState,ee=ye||ke;ke&&(ke.constructed=!0),ye&&(ye.constructed=!0),ee.destroyed?O.emit(y,ie):ie?K(O,ie,!0):r.nextTick(N,O)}try{O._construct(ie=>{r.nextTick(de,ie)})}catch(ie){r.nextTick(de,ie)}}function N(O){O.emit(_)}function $(O){return(O==null?void 0:O.setHeader)&&typeof O.abort=="function"}function X(O){O.emit("close")}function ae(O,te){O.emit("error",te),r.nextTick(X,O)}function pe(O,te){!O||i(O)||(!te&&!c(O)&&(te=new o),g(O)?(O.socket=null,O.destroy(te)):$(O)?O.abort():$(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(te):typeof O.close=="function"?O.close():te?r.nextTick(ae,O,te):r.nextTick(X,O),O.destroyed||(O[a]=!0))}s.exports={construct:Q,destroyer:pe,destroy:S,undestroy:P,errorOrDestroy:K}});function Ze(){Ze.init.call(this)}function gn(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Ls(e){return e._maxListeners===void 0?Ze.defaultMaxListeners:e._maxListeners}function Ds(e,s,r,h){var p,o,n,a;if(gn(r),(o=e._events)===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",s,r.listener?r.listener:r),o=e._events),n=o[s]),n===void 0)n=o[s]=r,++e._eventsCount;else if(typeof n=="function"?n=o[s]=h?[r,n]:[n,r]:h?n.unshift(r):n.push(r),(p=Ls(e))>0&&n.length>p&&!n.warned){n.warned=!0;var i=new Error("Possible EventEmitter memory leak detected. "+n.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=e,i.type=s,i.count=n.length,a=i,console&&console.warn&&console.warn(a)}return e}function yu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Fs(e,s,r){var h={fired:!1,wrapFn:void 0,target:e,type:s,listener:r},p=yu.bind(h);return p.listener=r,h.wrapFn=p,p}function $s(e,s,r){var h=e._events;if(h===void 0)return[];var p=h[s];return p===void 0?[]:typeof p=="function"?r?[p.listener||p]:[p]:r?function(o){for(var n=new Array(o.length),a=0;a<n.length;++a)n[a]=o[a].listener||o[a];return n}(p):Hs(p,p.length)}function Ws(e){var s=this._events;if(s!==void 0){var r=s[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}function Hs(e,s){for(var r=new Array(s),h=0;h<s;++h)r[h]=e[h];return r}var qs,Vs,yr,Eo,So,Ao,Tt,zs=w(()=>{we(),_e(),M(),yr=typeof Reflect=="object"?Reflect:null,Eo=yr&&typeof yr.apply=="function"?yr.apply:function(e,s,r){return Function.prototype.apply.call(e,s,r)},Vs=yr&&typeof yr.ownKeys=="function"?yr.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},So=Number.isNaN||function(e){return e!=e},qs=Ze,Ze.EventEmitter=Ze,Ze.prototype._events=void 0,Ze.prototype._eventsCount=0,Ze.prototype._maxListeners=void 0,Ao=10,Object.defineProperty(Ze,"defaultMaxListeners",{enumerable:!0,get:function(){return Ao},set:function(e){if(typeof e!="number"||e<0||So(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Ao=e}}),Ze.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ze.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||So(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Ze.prototype.getMaxListeners=function(){return Ls(this)},Ze.prototype.emit=function(e){for(var s=[],r=1;r<arguments.length;r++)s.push(arguments[r]);var h=e==="error",p=this._events;if(p!==void 0)h=h&&p.error===void 0;else if(!h)return!1;if(h){var o;if(s.length>0&&(o=s[0]),o instanceof Error)throw o;var n=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw n.context=o,n}var a=p[e];if(a===void 0)return!1;if(typeof a=="function")Eo(a,this,s);else{var i=a.length,c=Hs(a,i);for(r=0;r<i;++r)Eo(c[r],this,s)}return!0},Ze.prototype.addListener=function(e,s){return Ds(this,e,s,!1)},Ze.prototype.on=Ze.prototype.addListener,Ze.prototype.prependListener=function(e,s){return Ds(this,e,s,!0)},Ze.prototype.once=function(e,s){return gn(s),this.on(e,Fs(this,e,s)),this},Ze.prototype.prependOnceListener=function(e,s){return gn(s),this.prependListener(e,Fs(this,e,s)),this},Ze.prototype.removeListener=function(e,s){var r,h,p,o,n;if(gn(s),(h=this._events)===void 0)return this;if((r=h[e])===void 0)return this;if(r===s||r.listener===s)--this._eventsCount==0?this._events=Object.create(null):(delete h[e],h.removeListener&&this.emit("removeListener",e,r.listener||s));else if(typeof r!="function"){for(p=-1,o=r.length-1;o>=0;o--)if(r[o]===s||r[o].listener===s){n=r[o].listener,p=o;break}if(p<0)return this;p===0?r.shift():function(a,i){for(;i+1<a.length;i++)a[i]=a[i+1];a.pop()}(r,p),r.length===1&&(h[e]=r[0]),h.removeListener!==void 0&&this.emit("removeListener",e,n||s)}return this},Ze.prototype.off=Ze.prototype.removeListener,Ze.prototype.removeAllListeners=function(e){var s,r,h;if((r=this._events)===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var p,o=Object.keys(r);for(h=0;h<o.length;++h)(p=o[h])!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(s=r[e])=="function")this.removeListener(e,s);else if(s!==void 0)for(h=s.length-1;h>=0;h--)this.removeListener(e,s[h]);return this},Ze.prototype.listeners=function(e){return $s(this,e,!0)},Ze.prototype.rawListeners=function(e){return $s(this,e,!1)},Ze.listenerCount=function(e,s){return typeof e.listenerCount=="function"?e.listenerCount(s):Ws.call(e,s)},Ze.prototype.listenerCount=Ws,Ze.prototype.eventNames=function(){return this._eventsCount>0?Vs(this._events):[]},Tt=qs,Tt.EventEmitter,Tt.defaultMaxListeners,Tt.init,Tt.listenerCount,Tt.EventEmitter,Tt.defaultMaxListeners,Tt.init,Tt.listenerCount}),_r={};A(_r,{EventEmitter:()=>Ks,default:()=>Tt,defaultMaxListeners:()=>Js,init:()=>Qs,listenerCount:()=>Ys,on:()=>Gs,once:()=>Xs});var Ks,Js,Qs,Ys,Gs,Xs,Dr=w(()=>{we(),_e(),M(),zs(),zs(),Tt.once=function(e,s){return new Promise((r,h)=>{function p(...n){o!==void 0&&e.removeListener("error",o),r(n)}let o;s!=="error"&&(o=n=>{e.removeListener(name,p),h(n)},e.once("error",o)),e.once(s,p)})},Tt.on=function(e,s){let r=[],h=[],p=null,o=!1,n={async next(){let c=r.shift();if(c)return createIterResult(c,!1);if(p){let g=Promise.reject(p);return p=null,g}return o?createIterResult(void 0,!0):new Promise((g,y)=>h.push({resolve:g,reject:y}))},async return(){e.removeListener(s,a),e.removeListener("error",i),o=!0;for(let c of h)c.resolve(createIterResult(void 0,!0));return createIterResult(void 0,!0)},throw(c){p=c,e.removeListener(s,a),e.removeListener("error",i)},[Symbol.asyncIterator](){return this}};return e.on(s,a),e.on("error",i),n;function a(...c){let g=h.shift();g?g.resolve(createIterResult(c,!1)):r.push(c)}function i(c){o=!0;let g=h.shift();g?g.reject(c):p=c,n.return()}},{EventEmitter:Ks,defaultMaxListeners:Js,init:Qs,listenerCount:Ys,on:Gs,once:Xs}=Tt}),Co=E((e,s)=>{we(),_e(),M();var{ArrayIsArray:r,ObjectSetPrototypeOf:h}=dt(),{EventEmitter:p}=(Dr(),V(_r));function o(a){p.call(this,a)}h(o.prototype,p.prototype),h(o,p),o.prototype.pipe=function(a,i){let c=this;function g(H){a.writable&&a.write(H)===!1&&c.pause&&c.pause()}c.on("data",g);function y(){c.readable&&c.resume&&c.resume()}a.on("drain",y),!a._isStdio&&(!i||i.end!==!1)&&(c.on("end",v),c.on("close",S));let _=!1;function v(){_||(_=!0,a.end())}function S(){_||(_=!0,typeof a.destroy=="function"&&a.destroy())}function C(H){x(),p.listenerCount(this,"error")===0&&this.emit("error",H)}n(c,"error",C),n(a,"error",C);function x(){c.removeListener("data",g),a.removeListener("drain",y),c.removeListener("end",v),c.removeListener("close",S),c.removeListener("error",C),a.removeListener("error",C),c.removeListener("end",x),c.removeListener("close",x),a.removeListener("close",x)}return c.on("end",x),c.on("close",x),a.on("close",x),a.emit("pipe",c),a};function n(a,i,c){if(typeof a.prependListener=="function")return a.prependListener(i,c);!a._events||!a._events[i]?a.on(i,c):r(a._events[i])?a._events[i].unshift(c):a._events[i]=[c,a._events[i]]}s.exports={Stream:o,prependListener:n}}),mn=E((e,s)=>{we(),_e(),M();var{AbortError:r,codes:h}=At(),{isNodeStream:p,isWebStream:o,kControllerErrorFunction:n}=Qt(),a=cr(),{ERR_INVALID_ARG_TYPE:i}=h,c=(g,y)=>{if(typeof g!="object"||!("aborted"in g))throw new i(y,"AbortSignal",g)};s.exports.addAbortSignal=function(g,y){if(c(g,"signal"),!p(y)&&!o(y))throw new i("stream",["ReadableStream","WritableStream","Stream"],y);return s.exports.addAbortSignalNoValidate(g,y)},s.exports.addAbortSignalNoValidate=function(g,y){if(typeof g!="object"||!("aborted"in g))return y;let _=p(y)?()=>{y.destroy(new r(void 0,{cause:g.reason}))}:()=>{y[n](new r(void 0,{cause:g.reason}))};return g.aborted?_():(g.addEventListener("abort",_),a(y,()=>g.removeEventListener("abort",_))),y}}),_u=E((e,s)=>{we(),_e(),M();var{StringPrototypeSlice:r,SymbolIterator:h,TypedArrayPrototypeSet:p,Uint8Array:o}=dt(),{Buffer:n}=(yt(),V(bt)),{inspect:a}=Jt();s.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(i){let c={data:i,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length}unshift(i){let c={data:i,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length}shift(){if(this.length===0)return;let i=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,i}clear(){this.head=this.tail=null,this.length=0}join(i){if(this.length===0)return"";let c=this.head,g=""+c.data;for(;(c=c.next)!==null;)g+=i+c.data;return g}concat(i){if(this.length===0)return n.alloc(0);let c=n.allocUnsafe(i>>>0),g=this.head,y=0;for(;g;)p(c,g.data,y),y+=g.data.length,g=g.next;return c}consume(i,c){let g=this.head.data;if(i<g.length){let y=g.slice(0,i);return this.head.data=g.slice(i),y}return i===g.length?this.shift():c?this._getString(i):this._getBuffer(i)}first(){return this.head.data}*[h](){for(let i=this.head;i;i=i.next)yield i.data}_getString(i){let c="",g=this.head,y=0;do{let _=g.data;if(i>_.length)c+=_,i-=_.length;else{i===_.length?(c+=_,++y,g.next?this.head=g.next:this.head=this.tail=null):(c+=r(_,0,i),this.head=g,g.data=r(_,i));break}++y}while((g=g.next)!==null);return this.length-=y,c}_getBuffer(i){let c=n.allocUnsafe(i),g=i,y=this.head,_=0;do{let v=y.data;if(i>v.length)p(c,v,g-i),i-=v.length;else{i===v.length?(p(c,v,g-i),++_,y.next?this.head=y.next:this.head=this.tail=null):(p(c,new o(v.buffer,v.byteOffset,i),g-i),this.head=y,y.data=v.slice(i));break}++_}while((y=y.next)!==null);return this.length-=_,c}[Symbol.for("nodejs.util.inspect.custom")](i,c){return a(this,{...c,depth:0,customInspect:!1})}}}),Io=E((e,s)=>{we(),_e(),M();var{MathFloor:r,NumberIsInteger:h}=dt(),{ERR_INVALID_ARG_VALUE:p}=At().codes;function o(i,c,g){return i.highWaterMark!=null?i.highWaterMark:c?i[g]:null}function n(i){return i?16:16*1024}function a(i,c,g,y){let _=o(c,y,g);if(_!=null){if(!h(_)||_<0){let v=y?`options.${g}`:"options.highWaterMark";throw new p(v,_)}return r(_)}return n(i.objectMode)}s.exports={getHighWaterMark:a,getDefaultHighWaterMark:n}});function Zs(e){var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return r===-1&&(r=s),[r,r===s?0:4-r%4]}function wu(e,s,r){for(var h,p,o=[],n=s;n<r;n+=3)h=(e[n]<<16&16711680)+(e[n+1]<<8&65280)+(255&e[n+2]),o.push(Bt[(p=h)>>18&63]+Bt[p>>12&63]+Bt[p>>6&63]+Bt[63&p]);return o.join("")}function Yt(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var s=new Uint8Array(e);return Object.setPrototypeOf(s,Ie.prototype),s}function Ie(e,s,r){if(typeof e=="number"){if(typeof s=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return To(e)}return ea(e,s,r)}function ea(e,s,r){if(typeof e=="string")return function(o,n){if(typeof n=="string"&&n!==""||(n="utf8"),!Ie.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var a=0|ra(o,n),i=Yt(a),c=i.write(o,n);return c!==a&&(i=i.slice(0,c)),i}(e,s);if(ArrayBuffer.isView(e))return ko(e);if(e==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Gt(e,ArrayBuffer)||e&&Gt(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Gt(e,SharedArrayBuffer)||e&&Gt(e.buffer,SharedArrayBuffer)))return vu(e,s,r);if(typeof e=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var h=e.valueOf&&e.valueOf();if(h!=null&&h!==e)return Ie.from(h,s,r);var p=function(o){if(Ie.isBuffer(o)){var n=0|Ro(o.length),a=Yt(n);return a.length===0||o.copy(a,0,0,n),a}if(o.length!==void 0)return typeof o.length!="number"||Po(o.length)?Yt(0):ko(o);if(o.type==="Buffer"&&Array.isArray(o.data))return ko(o.data)}(e);if(p)return p;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof e[Symbol.toPrimitive]=="function")return Ie.from(e[Symbol.toPrimitive]("string"),s,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function ta(e){if(typeof e!="number")throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function To(e){return ta(e),Yt(e<0?0:0|Ro(e))}function ko(e){for(var s=e.length<0?0:0|Ro(e.length),r=Yt(s),h=0;h<s;h+=1)r[h]=255&e[h];return r}function vu(e,s,r){if(s<0||e.byteLength<s)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<s+(r||0))throw new RangeError('"length" is outside of buffer bounds');var h;return h=s===void 0&&r===void 0?new Uint8Array(e):r===void 0?new Uint8Array(e,s):new Uint8Array(e,s,r),Object.setPrototypeOf(h,Ie.prototype),h}function Ro(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function ra(e,s){if(Ie.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Gt(e,ArrayBuffer))return e.byteLength;if(typeof e!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,h=arguments.length>2&&arguments[2]===!0;if(!h&&r===0)return 0;for(var p=!1;;)switch(s){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Oo(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return ua(e).length;default:if(p)return h?-1:Oo(e).length;s=(""+s).toLowerCase(),p=!0}}function Eu(e,s,r){var h=!1;if((s===void 0||s<0)&&(s=0),s>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0)<=(s>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Pu(this,s,r);case"utf8":case"utf-8":return sa(this,s,r);case"ascii":return Ru(this,s,r);case"latin1":case"binary":return Ou(this,s,r);case"base64":return ku(this,s,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xu(this,s,r);default:if(h)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),h=!0}}function wr(e,s,r){var h=e[s];e[s]=e[r],e[r]=h}function na(e,s,r,h,p){if(e.length===0)return-1;if(typeof r=="string"?(h=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Po(r=+r)&&(r=p?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(p)return-1;r=e.length-1}else if(r<0){if(!p)return-1;r=0}if(typeof s=="string"&&(s=Ie.from(s,h)),Ie.isBuffer(s))return s.length===0?-1:ia(e,s,r,h,p);if(typeof s=="number")return s&=255,typeof Uint8Array.prototype.indexOf=="function"?p?Uint8Array.prototype.indexOf.call(e,s,r):Uint8Array.prototype.lastIndexOf.call(e,s,r):ia(e,[s],r,h,p);throw new TypeError("val must be string, number or Buffer")}function ia(e,s,r,h,p){var o,n=1,a=e.length,i=s.length;if(h!==void 0&&((h=String(h).toLowerCase())==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(e.length<2||s.length<2)return-1;n=2,a/=2,i/=2,r/=2}function c(v,S){return n===1?v[S]:v.readUInt16BE(S*n)}if(p){var g=-1;for(o=r;o<a;o++)if(c(e,o)===c(s,g===-1?0:o-g)){if(g===-1&&(g=o),o-g+1===i)return g*n}else g!==-1&&(o-=o-g),g=-1}else for(r+i>a&&(r=a-i),o=r;o>=0;o--){for(var y=!0,_=0;_<i;_++)if(c(e,o+_)!==c(s,_)){y=!1;break}if(y)return o}return-1}function Su(e,s,r,h){r=Number(r)||0;var p=e.length-r;h?(h=Number(h))>p&&(h=p):h=p;var o=s.length;h>o/2&&(h=o/2);for(var n=0;n<h;++n){var a=parseInt(s.substr(2*n,2),16);if(Po(a))return n;e[r+n]=a}return n}function Au(e,s,r,h){return bn(Oo(s,e.length-r),e,r,h)}function oa(e,s,r,h){return bn(function(p){for(var o=[],n=0;n<p.length;++n)o.push(255&p.charCodeAt(n));return o}(s),e,r,h)}function Cu(e,s,r,h){return oa(e,s,r,h)}function Iu(e,s,r,h){return bn(ua(s),e,r,h)}function Tu(e,s,r,h){return bn(function(p,o){for(var n,a,i,c=[],g=0;g<p.length&&!((o-=2)<0);++g)n=p.charCodeAt(g),a=n>>8,i=n%256,c.push(i),c.push(a);return c}(s,e.length-r),e,r,h)}function ku(e,s,r){return s===0&&r===e.length?_n.fromByteArray(e):_n.fromByteArray(e.slice(s,r))}function sa(e,s,r){r=Math.min(e.length,r);for(var h=[],p=s;p<r;){var o,n,a,i,c=e[p],g=null,y=c>239?4:c>223?3:c>191?2:1;if(p+y<=r)switch(y){case 1:c<128&&(g=c);break;case 2:(192&(o=e[p+1]))==128&&(i=(31&c)<<6|63&o)>127&&(g=i);break;case 3:o=e[p+1],n=e[p+2],(192&o)==128&&(192&n)==128&&(i=(15&c)<<12|(63&o)<<6|63&n)>2047&&(i<55296||i>57343)&&(g=i);break;case 4:o=e[p+1],n=e[p+2],a=e[p+3],(192&o)==128&&(192&n)==128&&(192&a)==128&&(i=(15&c)<<18|(63&o)<<12|(63&n)<<6|63&a)>65535&&i<1114112&&(g=i)}g===null?(g=65533,y=1):g>65535&&(g-=65536,h.push(g>>>10&1023|55296),g=56320|1023&g),h.push(g),p+=y}return function(_){var v=_.length;if(v<=4096)return String.fromCharCode.apply(String,_);for(var S="",C=0;C<v;)S+=String.fromCharCode.apply(String,_.slice(C,C+=4096));return S}(h)}function Ru(e,s,r){var h="";r=Math.min(e.length,r);for(var p=s;p<r;++p)h+=String.fromCharCode(127&e[p]);return h}function Ou(e,s,r){var h="";r=Math.min(e.length,r);for(var p=s;p<r;++p)h+=String.fromCharCode(e[p]);return h}function Pu(e,s,r){var h=e.length;(!s||s<0)&&(s=0),(!r||r<0||r>h)&&(r=h);for(var p="",o=s;o<r;++o)p+=ba[e[o]];return p}function xu(e,s,r){for(var h=e.slice(s,r),p="",o=0;o<h.length;o+=2)p+=String.fromCharCode(h[o]+256*h[o+1]);return p}function pt(e,s,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+s>r)throw new RangeError("Trying to access beyond buffer length")}function Ct(e,s,r,h,p,o){if(!Ie.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(s>p||s<o)throw new RangeError('"value" argument is out of bounds');if(r+h>e.length)throw new RangeError("Index out of range")}function aa(e,s,r,h,p,o){if(r+h>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function la(e,s,r,h,p){return s=+s,r>>>=0,p||aa(e,0,r,4),Sr.write(e,s,r,h,23,4),r+4}function ca(e,s,r,h,p){return s=+s,r>>>=0,p||aa(e,0,r,8),Sr.write(e,s,r,h,52,8),r+8}function Oo(e,s){var r;s=s||1/0;for(var h=e.length,p=null,o=[],n=0;n<h;++n){if((r=e.charCodeAt(n))>55295&&r<57344){if(!p){if(r>56319){(s-=3)>-1&&o.push(239,191,189);continue}if(n+1===h){(s-=3)>-1&&o.push(239,191,189);continue}p=r;continue}if(r<56320){(s-=3)>-1&&o.push(239,191,189),p=r;continue}r=65536+(p-55296<<10|r-56320)}else p&&(s-=3)>-1&&o.push(239,191,189);if(p=null,r<128){if((s-=1)<0)break;o.push(r)}else if(r<2048){if((s-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((s-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((s-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function ua(e){return _n.toByteArray(function(s){if((s=(s=s.split("=")[0]).trim().replace(ma,"")).length<2)return"";for(;s.length%4!=0;)s+="=";return s}(e))}function bn(e,s,r,h){for(var p=0;p<h&&!(p+r>=s.length||p>=e.length);++p)s[p+r]=e[p];return p}function Gt(e,s){return e instanceof s||e!=null&&e.constructor!=null&&e.constructor.name!=null&&e.constructor.name===s.name}function Po(e){return e!=e}function ha(e,s){for(var r in e)s[r]=e[r]}function vr(e,s,r){return Nt(e,s,r)}function Qr(e){var s;switch(this.encoding=function(r){var h=function(p){if(!p)return"utf8";for(var o;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(o)return;p=(""+p).toLowerCase(),o=!0}}(r);if(typeof h!="string"&&(wn.isEncoding===No||!No(r)))throw new Error("Unknown encoding: "+r);return h||r}(e),this.encoding){case"utf16le":this.text=Nu,this.end=Mu,s=4;break;case"utf8":this.fillLast=Bu,s=4;break;case"base64":this.text=ju,this.end=Uu,s=3;break;default:return this.write=Lu,this.end=Du,void 0}this.lastNeed=0,this.lastTotal=0,this.lastChar=wn.allocUnsafe(s)}function xo(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function Bu(e){var s=this.lastTotal-this.lastNeed,r=function(h,p,o){if((192&p[0])!=128)return h.lastNeed=0,"�";if(h.lastNeed>1&&p.length>1){if((192&p[1])!=128)return h.lastNeed=1,"�";if(h.lastNeed>2&&p.length>2&&(192&p[2])!=128)return h.lastNeed=2,"�"}}(this,e);return r!==void 0?r:this.lastNeed<=e.length?(e.copy(this.lastChar,s,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,s,0,e.length),this.lastNeed-=e.length,void 0)}function Nu(e,s){if((e.length-s)%2==0){var r=e.toString("utf16le",s);if(r){var h=r.charCodeAt(r.length-1);if(h>=55296&&h<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",s,e.length-1)}function Mu(e){var s=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return s+this.lastChar.toString("utf16le",0,r)}return s}function ju(e,s){var r=(e.length-s)%3;return r===0?e.toString("base64",s):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",s,e.length-r))}function Uu(e){var s=e&&e.length?this.write(e):"";return this.lastNeed?s+this.lastChar.toString("base64",0,3-this.lastNeed):s}function Lu(e){return e.toString(this.encoding)}function Du(e){return e&&e.length?this.write(e):""}var fa,Bt,kt,da,yn,Er,pa,ga,$t,_n,Sr,Bo,ma,ba,Yr,Gr,Nt,ya,Fr,wn,No,_a=w(()=>{for(we(),_e(),M(),fa={byteLength:function(e){var s=Zs(e),r=s[0],h=s[1];return 3*(r+h)/4-h},toByteArray:function(e){var s,r,h=Zs(e),p=h[0],o=h[1],n=new da(function(c,g,y){return 3*(g+y)/4-y}(0,p,o)),a=0,i=o>0?p-4:p;for(r=0;r<i;r+=4)s=kt[e.charCodeAt(r)]<<18|kt[e.charCodeAt(r+1)]<<12|kt[e.charCodeAt(r+2)]<<6|kt[e.charCodeAt(r+3)],n[a++]=s>>16&255,n[a++]=s>>8&255,n[a++]=255&s;return o===2&&(s=kt[e.charCodeAt(r)]<<2|kt[e.charCodeAt(r+1)]>>4,n[a++]=255&s),o===1&&(s=kt[e.charCodeAt(r)]<<10|kt[e.charCodeAt(r+1)]<<4|kt[e.charCodeAt(r+2)]>>2,n[a++]=s>>8&255,n[a++]=255&s),n},fromByteArray:function(e){for(var s,r=e.length,h=r%3,p=[],o=0,n=r-h;o<n;o+=16383)p.push(wu(e,o,o+16383>n?n:o+16383));return h===1?(s=e[r-1],p.push(Bt[s>>2]+Bt[s<<4&63]+"==")):h===2&&(s=(e[r-2]<<8)+e[r-1],p.push(Bt[s>>10]+Bt[s>>4&63]+Bt[s<<2&63]+"=")),p.join("")}},Bt=[],kt=[],da=typeof Uint8Array<"u"?Uint8Array:Array,yn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Er=0,pa=yn.length;Er<pa;++Er)Bt[Er]=yn[Er],kt[yn.charCodeAt(Er)]=Er;kt[45]=62,kt[95]=63,ga={read:function(e,s,r,h,p){var o,n,a=8*p-h-1,i=(1<<a)-1,c=i>>1,g=-7,y=r?p-1:0,_=r?-1:1,v=e[s+y];for(y+=_,o=v&(1<<-g)-1,v>>=-g,g+=a;g>0;o=256*o+e[s+y],y+=_,g-=8);for(n=o&(1<<-g)-1,o>>=-g,g+=h;g>0;n=256*n+e[s+y],y+=_,g-=8);if(o===0)o=1-c;else{if(o===i)return n?NaN:1/0*(v?-1:1);n+=Math.pow(2,h),o-=c}return(v?-1:1)*n*Math.pow(2,o-h)},write:function(e,s,r,h,p,o){var n,a,i,c=8*o-p-1,g=(1<<c)-1,y=g>>1,_=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=h?0:o-1,S=h?1:-1,C=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(a=isNaN(s)?1:0,n=g):(n=Math.floor(Math.log(s)/Math.LN2),s*(i=Math.pow(2,-n))<1&&(n--,i*=2),(s+=n+y>=1?_/i:_*Math.pow(2,1-y))*i>=2&&(n++,i/=2),n+y>=g?(a=0,n=g):n+y>=1?(a=(s*i-1)*Math.pow(2,p),n+=y):(a=s*Math.pow(2,y-1)*Math.pow(2,p),n=0));p>=8;e[r+v]=255&a,v+=S,a/=256,p-=8);for(n=n<<p|a,c+=p;c>0;e[r+v]=255&n,v+=S,n/=256,c-=8);e[r+v-S]|=128*C}},$t={},_n=fa,Sr=ga,Bo=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null,$t.Buffer=Ie,$t.SlowBuffer=function(e){return+e!=e&&(e=0),Ie.alloc(+e)},$t.INSPECT_MAX_BYTES=50,$t.kMaxLength=2147483647,Ie.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),s={foo:function(){return 42}};return Object.setPrototypeOf(s,Uint8Array.prototype),Object.setPrototypeOf(e,s),e.foo()===42}catch{return!1}}(),Ie.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Ie.prototype,"parent",{enumerable:!0,get:function(){if(Ie.isBuffer(this))return this.buffer}}),Object.defineProperty(Ie.prototype,"offset",{enumerable:!0,get:function(){if(Ie.isBuffer(this))return this.byteOffset}}),Ie.poolSize=8192,Ie.from=function(e,s,r){return ea(e,s,r)},Object.setPrototypeOf(Ie.prototype,Uint8Array.prototype),Object.setPrototypeOf(Ie,Uint8Array),Ie.alloc=function(e,s,r){return function(h,p,o){return ta(h),h<=0?Yt(h):p!==void 0?typeof o=="string"?Yt(h).fill(p,o):Yt(h).fill(p):Yt(h)}(e,s,r)},Ie.allocUnsafe=function(e){return To(e)},Ie.allocUnsafeSlow=function(e){return To(e)},Ie.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==Ie.prototype},Ie.compare=function(e,s){if(Gt(e,Uint8Array)&&(e=Ie.from(e,e.offset,e.byteLength)),Gt(s,Uint8Array)&&(s=Ie.from(s,s.offset,s.byteLength)),!Ie.isBuffer(e)||!Ie.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===s)return 0;for(var r=e.length,h=s.length,p=0,o=Math.min(r,h);p<o;++p)if(e[p]!==s[p]){r=e[p],h=s[p];break}return r<h?-1:h<r?1:0},Ie.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ie.concat=function(e,s){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return Ie.alloc(0);var r;if(s===void 0)for(s=0,r=0;r<e.length;++r)s+=e[r].length;var h=Ie.allocUnsafe(s),p=0;for(r=0;r<e.length;++r){var o=e[r];if(Gt(o,Uint8Array)&&(o=Ie.from(o)),!Ie.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(h,p),p+=o.length}return h},Ie.byteLength=ra,Ie.prototype._isBuffer=!0,Ie.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var s=0;s<e;s+=2)wr(this,s,s+1);return this},Ie.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var s=0;s<e;s+=4)wr(this,s,s+3),wr(this,s+1,s+2);return this},Ie.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var s=0;s<e;s+=8)wr(this,s,s+7),wr(this,s+1,s+6),wr(this,s+2,s+5),wr(this,s+3,s+4);return this},Ie.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?sa(this,0,e):Eu.apply(this,arguments)},Ie.prototype.toLocaleString=Ie.prototype.toString,Ie.prototype.equals=function(e){if(!Ie.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||Ie.compare(this,e)===0},Ie.prototype.inspect=function(){var e="",s=$t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(e+=" ... "),"<Buffer "+e+">"},Bo&&(Ie.prototype[Bo]=Ie.prototype.inspect),Ie.prototype.compare=function(e,s,r,h,p){if(Gt(e,Uint8Array)&&(e=Ie.from(e,e.offset,e.byteLength)),!Ie.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(s===void 0&&(s=0),r===void 0&&(r=e?e.length:0),h===void 0&&(h=0),p===void 0&&(p=this.length),s<0||r>e.length||h<0||p>this.length)throw new RangeError("out of range index");if(h>=p&&s>=r)return 0;if(h>=p)return-1;if(s>=r)return 1;if(this===e)return 0;for(var o=(p>>>=0)-(h>>>=0),n=(r>>>=0)-(s>>>=0),a=Math.min(o,n),i=this.slice(h,p),c=e.slice(s,r),g=0;g<a;++g)if(i[g]!==c[g]){o=i[g],n=c[g];break}return o<n?-1:n<o?1:0},Ie.prototype.includes=function(e,s,r){return this.indexOf(e,s,r)!==-1},Ie.prototype.indexOf=function(e,s,r){return na(this,e,s,r,!0)},Ie.prototype.lastIndexOf=function(e,s,r){return na(this,e,s,r,!1)},Ie.prototype.write=function(e,s,r,h){if(s===void 0)h="utf8",r=this.length,s=0;else if(r===void 0&&typeof s=="string")h=s,r=this.length,s=0;else{if(!isFinite(s))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");s>>>=0,isFinite(r)?(r>>>=0,h===void 0&&(h="utf8")):(h=r,r=void 0)}var p=this.length-s;if((r===void 0||r>p)&&(r=p),e.length>0&&(r<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");h||(h="utf8");for(var o=!1;;)switch(h){case"hex":return Su(this,e,s,r);case"utf8":case"utf-8":return Au(this,e,s,r);case"ascii":return oa(this,e,s,r);case"latin1":case"binary":return Cu(this,e,s,r);case"base64":return Iu(this,e,s,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Tu(this,e,s,r);default:if(o)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),o=!0}},Ie.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Ie.prototype.slice=function(e,s){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(s=s===void 0?r:~~s)<0?(s+=r)<0&&(s=0):s>r&&(s=r),s<e&&(s=e);var h=this.subarray(e,s);return Object.setPrototypeOf(h,Ie.prototype),h},Ie.prototype.readUIntLE=function(e,s,r){e>>>=0,s>>>=0,r||pt(e,s,this.length);for(var h=this[e],p=1,o=0;++o<s&&(p*=256);)h+=this[e+o]*p;return h},Ie.prototype.readUIntBE=function(e,s,r){e>>>=0,s>>>=0,r||pt(e,s,this.length);for(var h=this[e+--s],p=1;s>0&&(p*=256);)h+=this[e+--s]*p;return h},Ie.prototype.readUInt8=function(e,s){return e>>>=0,s||pt(e,1,this.length),this[e]},Ie.prototype.readUInt16LE=function(e,s){return e>>>=0,s||pt(e,2,this.length),this[e]|this[e+1]<<8},Ie.prototype.readUInt16BE=function(e,s){return e>>>=0,s||pt(e,2,this.length),this[e]<<8|this[e+1]},Ie.prototype.readUInt32LE=function(e,s){return e>>>=0,s||pt(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ie.prototype.readUInt32BE=function(e,s){return e>>>=0,s||pt(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ie.prototype.readIntLE=function(e,s,r){e>>>=0,s>>>=0,r||pt(e,s,this.length);for(var h=this[e],p=1,o=0;++o<s&&(p*=256);)h+=this[e+o]*p;return h>=(p*=128)&&(h-=Math.pow(2,8*s)),h},Ie.prototype.readIntBE=function(e,s,r){e>>>=0,s>>>=0,r||pt(e,s,this.length);for(var h=s,p=1,o=this[e+--h];h>0&&(p*=256);)o+=this[e+--h]*p;return o>=(p*=128)&&(o-=Math.pow(2,8*s)),o},Ie.prototype.readInt8=function(e,s){return e>>>=0,s||pt(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ie.prototype.readInt16LE=function(e,s){e>>>=0,s||pt(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Ie.prototype.readInt16BE=function(e,s){e>>>=0,s||pt(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Ie.prototype.readInt32LE=function(e,s){return e>>>=0,s||pt(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ie.prototype.readInt32BE=function(e,s){return e>>>=0,s||pt(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ie.prototype.readFloatLE=function(e,s){return e>>>=0,s||pt(e,4,this.length),Sr.read(this,e,!0,23,4)},Ie.prototype.readFloatBE=function(e,s){return e>>>=0,s||pt(e,4,this.length),Sr.read(this,e,!1,23,4)},Ie.prototype.readDoubleLE=function(e,s){return e>>>=0,s||pt(e,8,this.length),Sr.read(this,e,!0,52,8)},Ie.prototype.readDoubleBE=function(e,s){return e>>>=0,s||pt(e,8,this.length),Sr.read(this,e,!1,52,8)},Ie.prototype.writeUIntLE=function(e,s,r,h){e=+e,s>>>=0,r>>>=0,h||Ct(this,e,s,r,Math.pow(2,8*r)-1,0);var p=1,o=0;for(this[s]=255&e;++o<r&&(p*=256);)this[s+o]=e/p&255;return s+r},Ie.prototype.writeUIntBE=function(e,s,r,h){e=+e,s>>>=0,r>>>=0,h||Ct(this,e,s,r,Math.pow(2,8*r)-1,0);var p=r-1,o=1;for(this[s+p]=255&e;--p>=0&&(o*=256);)this[s+p]=e/o&255;return s+r},Ie.prototype.writeUInt8=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,1,255,0),this[s]=255&e,s+1},Ie.prototype.writeUInt16LE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,2,65535,0),this[s]=255&e,this[s+1]=e>>>8,s+2},Ie.prototype.writeUInt16BE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,2,65535,0),this[s]=e>>>8,this[s+1]=255&e,s+2},Ie.prototype.writeUInt32LE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,4,4294967295,0),this[s+3]=e>>>24,this[s+2]=e>>>16,this[s+1]=e>>>8,this[s]=255&e,s+4},Ie.prototype.writeUInt32BE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,4,4294967295,0),this[s]=e>>>24,this[s+1]=e>>>16,this[s+2]=e>>>8,this[s+3]=255&e,s+4},Ie.prototype.writeIntLE=function(e,s,r,h){if(e=+e,s>>>=0,!h){var p=Math.pow(2,8*r-1);Ct(this,e,s,r,p-1,-p)}var o=0,n=1,a=0;for(this[s]=255&e;++o<r&&(n*=256);)e<0&&a===0&&this[s+o-1]!==0&&(a=1),this[s+o]=(e/n>>0)-a&255;return s+r},Ie.prototype.writeIntBE=function(e,s,r,h){if(e=+e,s>>>=0,!h){var p=Math.pow(2,8*r-1);Ct(this,e,s,r,p-1,-p)}var o=r-1,n=1,a=0;for(this[s+o]=255&e;--o>=0&&(n*=256);)e<0&&a===0&&this[s+o+1]!==0&&(a=1),this[s+o]=(e/n>>0)-a&255;return s+r},Ie.prototype.writeInt8=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,1,127,-128),e<0&&(e=255+e+1),this[s]=255&e,s+1},Ie.prototype.writeInt16LE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,2,32767,-32768),this[s]=255&e,this[s+1]=e>>>8,s+2},Ie.prototype.writeInt16BE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,2,32767,-32768),this[s]=e>>>8,this[s+1]=255&e,s+2},Ie.prototype.writeInt32LE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,4,2147483647,-2147483648),this[s]=255&e,this[s+1]=e>>>8,this[s+2]=e>>>16,this[s+3]=e>>>24,s+4},Ie.prototype.writeInt32BE=function(e,s,r){return e=+e,s>>>=0,r||Ct(this,e,s,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[s]=e>>>24,this[s+1]=e>>>16,this[s+2]=e>>>8,this[s+3]=255&e,s+4},Ie.prototype.writeFloatLE=function(e,s,r){return la(this,e,s,!0,r)},Ie.prototype.writeFloatBE=function(e,s,r){return la(this,e,s,!1,r)},Ie.prototype.writeDoubleLE=function(e,s,r){return ca(this,e,s,!0,r)},Ie.prototype.writeDoubleBE=function(e,s,r){return ca(this,e,s,!1,r)},Ie.prototype.copy=function(e,s,r,h){if(!Ie.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),h||h===0||(h=this.length),s>=e.length&&(s=e.length),s||(s=0),h>0&&h<r&&(h=r),h===r||e.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),e.length-s<h-r&&(h=e.length-s+r);var p=h-r;if(this===e&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(s,r,h);else if(this===e&&r<s&&s<h)for(var o=p-1;o>=0;--o)e[o+s]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,h),s);return p},Ie.prototype.fill=function(e,s,r,h){if(typeof e=="string"){if(typeof s=="string"?(h=s,s=0,r=this.length):typeof r=="string"&&(h=r,r=this.length),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!Ie.isEncoding(h))throw new TypeError("Unknown encoding: "+h);if(e.length===1){var p=e.charCodeAt(0);(h==="utf8"&&p<128||h==="latin1")&&(e=p)}}else typeof e=="number"?e&=255:typeof e=="boolean"&&(e=Number(e));if(s<0||this.length<s||this.length<r)throw new RangeError("Out of range index");if(r<=s)return this;var o;if(s>>>=0,r=r===void 0?this.length:r>>>0,e||(e=0),typeof e=="number")for(o=s;o<r;++o)this[o]=e;else{var n=Ie.isBuffer(e)?e:Ie.from(e,h),a=n.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-s;++o)this[o+s]=n[o%a]}return this},ma=/[^+/0-9A-Za-z-_]/g,ba=function(){for(var e=new Array(256),s=0;s<16;++s)for(var r=16*s,h=0;h<16;++h)e[r+h]="0123456789abcdef"[s]+"0123456789abcdef"[h];return e}(),$t.Buffer,$t.INSPECT_MAX_BYTES,$t.kMaxLength,Yr={},Gr=$t,Nt=Gr.Buffer,Nt.from&&Nt.alloc&&Nt.allocUnsafe&&Nt.allocUnsafeSlow?Yr=Gr:(ha(Gr,Yr),Yr.Buffer=vr),vr.prototype=Object.create(Nt.prototype),ha(Nt,vr),vr.from=function(e,s,r){if(typeof e=="number")throw new TypeError("Argument must not be a number");return Nt(e,s,r)},vr.alloc=function(e,s,r){if(typeof e!="number")throw new TypeError("Argument must be a number");var h=Nt(e);return s!==void 0?typeof r=="string"?h.fill(s,r):h.fill(s):h.fill(0),h},vr.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Nt(e)},vr.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return Gr.SlowBuffer(e)},ya=Yr,Fr={},wn=ya.Buffer,No=wn.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},Fr.StringDecoder=Qr,Qr.prototype.write=function(e){if(e.length===0)return"";var s,r;if(this.lastNeed){if((s=this.fillLast(e))===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?s?s+this.text(e,r):this.text(e,r):s||""},Qr.prototype.end=function(e){var s=e&&e.length?this.write(e):"";return this.lastNeed?s+"�":s},Qr.prototype.text=function(e,s){var r=function(p,o,n){var a=o.length-1;if(a<n)return 0;var i=xo(o[a]);return i>=0?(i>0&&(p.lastNeed=i-1),i):--a<n||i===-2?0:(i=xo(o[a]))>=0?(i>0&&(p.lastNeed=i-2),i):--a<n||i===-2?0:(i=xo(o[a]))>=0?(i>0&&(i===2?i=0:p.lastNeed=i-3),i):0}(this,e,s);if(!this.lastNeed)return e.toString("utf8",s);this.lastTotal=r;var h=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,h),e.toString("utf8",s,h)},Qr.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},Fr.StringDecoder,Fr.StringDecoder}),wa={};A(wa,{StringDecoder:()=>va,default:()=>Fr});var va,Fu=w(()=>{we(),_e(),M(),_a(),_a(),va=Fr.StringDecoder}),Ea=E((e,s)=>{we(),_e(),M();var r=br(),{PromisePrototypeThen:h,SymbolAsyncIterator:p,SymbolIterator:o}=dt(),{Buffer:n}=(yt(),V(bt)),{ERR_INVALID_ARG_TYPE:a,ERR_STREAM_NULL_VALUES:i}=At().codes;function c(g,y,_){let v;if(typeof y=="string"||y instanceof n)return new g({objectMode:!0,..._,read(){this.push(y),this.push(null)}});let S;if(y&&y[p])S=!0,v=y[p]();else if(y&&y[o])S=!1,v=y[o]();else throw new a("iterable",["Iterable"],y);let C=new g({objectMode:!0,highWaterMark:1,..._}),x=!1;C._read=function(){x||(x=!0,k())},C._destroy=function(P,K){h(H(P),()=>r.nextTick(K,P),Q=>r.nextTick(K,Q||P))};async function H(P){let K=P!=null,Q=typeof v.throw=="function";if(K&&Q){let{value:j,done:N}=await v.throw(P);if(await j,N)return}if(typeof v.return=="function"){let{value:j}=await v.return();await j}}async function k(){for(;;){try{let{value:P,done:K}=S?await v.next():v.next();if(K)C.push(null);else{let Q=P&&typeof P.then=="function"?await P:P;if(Q===null)throw x=!1,new i;if(C.push(Q))continue;x=!1}}catch(P){C.destroy(P)}break}}return C}s.exports=c}),vn=E((e,s)=>{we(),_e(),M();var r=br(),{ArrayPrototypeIndexOf:h,NumberIsInteger:p,NumberIsNaN:o,NumberParseInt:n,ObjectDefineProperties:a,ObjectKeys:i,ObjectSetPrototypeOf:c,Promise:g,SafeSet:y,SymbolAsyncIterator:_,Symbol:v}=dt();s.exports=T,T.ReadableState=Ne;var{EventEmitter:S}=(Dr(),V(_r)),{Stream:C,prependListener:x}=Co(),{Buffer:H}=(yt(),V(bt)),{addAbortSignal:k}=mn(),P=cr(),K=Jt().debuglog("stream",f=>{K=f}),Q=_u(),j=Lr(),{getHighWaterMark:N,getDefaultHighWaterMark:$}=Io(),{aggregateTwoErrors:X,codes:{ERR_INVALID_ARG_TYPE:ae,ERR_METHOD_NOT_IMPLEMENTED:pe,ERR_OUT_OF_RANGE:O,ERR_STREAM_PUSH_AFTER_EOF:te,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:de}}=At(),{validateObject:ie}=pn(),ke=v("kPaused"),{StringDecoder:ye}=(Fu(),V(wa)),ee=Ea();c(T.prototype,C.prototype),c(T,C);var Oe=()=>{},{errorOrDestroy:be}=j;function Ne(f,b,I){typeof I!="boolean"&&(I=b instanceof Xt()),this.objectMode=!!(f&&f.objectMode),I&&(this.objectMode=this.objectMode||!!(f&&f.readableObjectMode)),this.highWaterMark=f?N(this,f,"readableHighWaterMark",I):$(!1),this.buffer=new Q,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[ke]=null,this.errorEmitted=!1,this.emitClose=!f||f.emitClose!==!1,this.autoDestroy=!f||f.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=f&&f.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,f&&f.encoding&&(this.decoder=new ye(f.encoding),this.encoding=f.encoding)}function T(f){if(!(this instanceof T))return new T(f);let b=this instanceof Xt();this._readableState=new Ne(f,this,b),f&&(typeof f.read=="function"&&(this._read=f.read),typeof f.destroy=="function"&&(this._destroy=f.destroy),typeof f.construct=="function"&&(this._construct=f.construct),f.signal&&!b&&k(f.signal,this)),C.call(this,f),j.construct(this,()=>{this._readableState.needReadable&&fe(this,this._readableState)})}T.prototype.destroy=j.destroy,T.prototype._undestroy=j.undestroy,T.prototype._destroy=function(f,b){b(f)},T.prototype[S.captureRejectionSymbol]=function(f){this.destroy(f)},T.prototype.push=function(f,b){return oe(this,f,b,!1)},T.prototype.unshift=function(f,b){return oe(this,f,b,!0)};function oe(f,b,I,B){K("readableAddChunk",b);let G=f._readableState,he;if(G.objectMode||(typeof b=="string"?(I=I||G.defaultEncoding,G.encoding!==I&&(B&&G.encoding?b=H.from(b,I).toString(G.encoding):(b=H.from(b,I),I=""))):b instanceof H?I="":C._isUint8Array(b)?(b=C._uint8ArrayToBuffer(b),I=""):b!=null&&(he=new ae("chunk",["string","Buffer","Uint8Array"],b))),he)be(f,he);else if(b===null)G.reading=!1,R(f,G);else if(G.objectMode||b&&b.length>0)if(B)if(G.endEmitted)be(f,new de);else{if(G.destroyed||G.errored)return!1;Ae(f,G,b,!0)}else if(G.ended)be(f,new te);else{if(G.destroyed||G.errored)return!1;G.reading=!1,G.decoder&&!I?(b=G.decoder.write(b),G.objectMode||b.length!==0?Ae(f,G,b,!1):fe(f,G)):Ae(f,G,b,!1)}else B||(G.reading=!1,fe(f,G));return!G.ended&&(G.length<G.highWaterMark||G.length===0)}function Ae(f,b,I,B){b.flowing&&b.length===0&&!b.sync&&f.listenerCount("data")>0?(b.multiAwaitDrain?b.awaitDrainWriters.clear():b.awaitDrainWriters=null,b.dataEmitted=!0,f.emit("data",I)):(b.length+=b.objectMode?1:I.length,B?b.buffer.unshift(I):b.buffer.push(I),b.needReadable&&ne(f)),fe(f,b)}T.prototype.isPaused=function(){let f=this._readableState;return f[ke]===!0||f.flowing===!1},T.prototype.setEncoding=function(f){let b=new ye(f);this._readableState.decoder=b,this._readableState.encoding=this._readableState.decoder.encoding;let I=this._readableState.buffer,B="";for(let G of I)B+=b.write(G);return I.clear(),B!==""&&I.push(B),this._readableState.length=B.length,this};var Me=1073741824;function Ee(f){if(f>Me)throw new O("size","<= 1GiB",f);return f--,f|=f>>>1,f|=f>>>2,f|=f>>>4,f|=f>>>8,f|=f>>>16,f++,f}function F(f,b){return f<=0||b.length===0&&b.ended?0:b.objectMode?1:o(f)?b.flowing&&b.length?b.buffer.first().length:b.length:f<=b.length?f:b.ended?b.length:0}T.prototype.read=function(f){K("read",f),f===void 0?f=NaN:p(f)||(f=n(f,10));let b=this._readableState,I=f;if(f>b.highWaterMark&&(b.highWaterMark=Ee(f)),f!==0&&(b.emittedReadable=!1),f===0&&b.needReadable&&((b.highWaterMark!==0?b.length>=b.highWaterMark:b.length>0)||b.ended))return K("read: emitReadable",b.length,b.ended),b.length===0&&b.ended?U(this):ne(this),null;if(f=F(f,b),f===0&&b.ended)return b.length===0&&U(this),null;let B=b.needReadable;if(K("need readable",B),(b.length===0||b.length-f<b.highWaterMark)&&(B=!0,K("length less than watermark",B)),b.ended||b.reading||b.destroyed||b.errored||!b.constructed)B=!1,K("reading, ended or constructing",B);else if(B){K("do read"),b.reading=!0,b.sync=!0,b.length===0&&(b.needReadable=!0);try{this._read(b.highWaterMark)}catch(he){be(this,he)}b.sync=!1,b.reading||(f=F(I,b))}let G;return f>0?G=re(f,b):G=null,G===null?(b.needReadable=b.length<=b.highWaterMark,f=0):(b.length-=f,b.multiAwaitDrain?b.awaitDrainWriters.clear():b.awaitDrainWriters=null),b.length===0&&(b.ended||(b.needReadable=!0),I!==f&&b.ended&&U(this)),G!==null&&!b.errorEmitted&&!b.closeEmitted&&(b.dataEmitted=!0,this.emit("data",G)),G};function R(f,b){if(K("onEofChunk"),!b.ended){if(b.decoder){let I=b.decoder.end();I&&I.length&&(b.buffer.push(I),b.length+=b.objectMode?1:I.length)}b.ended=!0,b.sync?ne(f):(b.needReadable=!1,b.emittedReadable=!0,Se(f))}}function ne(f){let b=f._readableState;K("emitReadable",b.needReadable,b.emittedReadable),b.needReadable=!1,b.emittedReadable||(K("emitReadable",b.flowing),b.emittedReadable=!0,r.nextTick(Se,f))}function Se(f){let b=f._readableState;K("emitReadable_",b.destroyed,b.length,b.ended),!b.destroyed&&!b.errored&&(b.length||b.ended)&&(f.emit("readable"),b.emittedReadable=!1),b.needReadable=!b.flowing&&!b.ended&&b.length<=b.highWaterMark,me(f)}function fe(f,b){!b.readingMore&&b.constructed&&(b.readingMore=!0,r.nextTick(ue,f,b))}function ue(f,b){for(;!b.reading&&!b.ended&&(b.length<b.highWaterMark||b.flowing&&b.length===0);){let I=b.length;if(K("maybeReadMore read 0"),f.read(0),I===b.length)break}b.readingMore=!1}T.prototype._read=function(f){throw new pe("_read()")},T.prototype.pipe=function(f,b){let I=this,B=this._readableState;B.pipes.length===1&&(B.multiAwaitDrain||(B.multiAwaitDrain=!0,B.awaitDrainWriters=new y(B.awaitDrainWriters?[B.awaitDrainWriters]:[]))),B.pipes.push(f),K("pipe count=%d opts=%j",B.pipes.length,b);let G=(!b||b.end!==!1)&&f!==r.stdout&&f!==r.stderr?De:_t;B.endEmitted?r.nextTick(G):I.once("end",G),f.on("unpipe",he);function he(Et,mt){K("onunpipe"),Et===I&&mt&&mt.hasUnpiped===!1&&(mt.hasUnpiped=!0,Le())}function De(){K("onend"),f.end()}let ze,Ke=!1;function Le(){K("cleanup"),f.removeListener("close",gt),f.removeListener("finish",ct),ze&&f.removeListener("drain",ze),f.removeListener("error",tt),f.removeListener("unpipe",he),I.removeListener("end",De),I.removeListener("end",_t),I.removeListener("data",$e),Ke=!0,ze&&B.awaitDrainWriters&&(!f._writableState||f._writableState.needDrain)&&ze()}function qe(){Ke||(B.pipes.length===1&&B.pipes[0]===f?(K("false write response, pause",0),B.awaitDrainWriters=f,B.multiAwaitDrain=!1):B.pipes.length>1&&B.pipes.includes(f)&&(K("false write response, pause",B.awaitDrainWriters.size),B.awaitDrainWriters.add(f)),I.pause()),ze||(ze=Pe(I,f),f.on("drain",ze))}I.on("data",$e);function $e(Et){K("ondata");let mt=f.write(Et);K("dest.write",mt),mt===!1&&qe()}function tt(Et){if(K("onerror",Et),_t(),f.removeListener("error",tt),f.listenerCount("error")===0){let mt=f._writableState||f._readableState;mt&&!mt.errorEmitted?be(f,Et):f.emit("error",Et)}}x(f,"error",tt);function gt(){f.removeListener("finish",ct),_t()}f.once("close",gt);function ct(){K("onfinish"),f.removeListener("close",gt),_t()}f.once("finish",ct);function _t(){K("unpipe"),I.unpipe(f)}return f.emit("pipe",I),f.writableNeedDrain===!0?B.flowing&&qe():B.flowing||(K("pipe resume"),I.resume()),f};function Pe(f,b){return function(){let I=f._readableState;I.awaitDrainWriters===b?(K("pipeOnDrain",1),I.awaitDrainWriters=null):I.multiAwaitDrain&&(K("pipeOnDrain",I.awaitDrainWriters.size),I.awaitDrainWriters.delete(b)),(!I.awaitDrainWriters||I.awaitDrainWriters.size===0)&&f.listenerCount("data")&&f.resume()}}T.prototype.unpipe=function(f){let b=this._readableState,I={hasUnpiped:!1};if(b.pipes.length===0)return this;if(!f){let G=b.pipes;b.pipes=[],this.pause();for(let he=0;he<G.length;he++)G[he].emit("unpipe",this,{hasUnpiped:!1});return this}let B=h(b.pipes,f);return B===-1?this:(b.pipes.splice(B,1),b.pipes.length===0&&this.pause(),f.emit("unpipe",this,I),this)},T.prototype.on=function(f,b){let I=C.prototype.on.call(this,f,b),B=this._readableState;return f==="data"?(B.readableListening=this.listenerCount("readable")>0,B.flowing!==!1&&this.resume()):f==="readable"&&!B.endEmitted&&!B.readableListening&&(B.readableListening=B.needReadable=!0,B.flowing=!1,B.emittedReadable=!1,K("on readable",B.length,B.reading),B.length?ne(this):B.reading||r.nextTick(L,this)),I},T.prototype.addListener=T.prototype.on,T.prototype.removeListener=function(f,b){let I=C.prototype.removeListener.call(this,f,b);return f==="readable"&&r.nextTick(Te,this),I},T.prototype.off=T.prototype.removeListener,T.prototype.removeAllListeners=function(f){let b=C.prototype.removeAllListeners.apply(this,arguments);return(f==="readable"||f===void 0)&&r.nextTick(Te,this),b};function Te(f){let b=f._readableState;b.readableListening=f.listenerCount("readable")>0,b.resumeScheduled&&b[ke]===!1?b.flowing=!0:f.listenerCount("data")>0?f.resume():b.readableListening||(b.flowing=null)}function L(f){K("readable nexttick read 0"),f.read(0)}T.prototype.resume=function(){let f=this._readableState;return f.flowing||(K("resume"),f.flowing=!f.readableListening,J(this,f)),f[ke]=!1,this};function J(f,b){b.resumeScheduled||(b.resumeScheduled=!0,r.nextTick(Y,f,b))}function Y(f,b){K("resume",b.reading),b.reading||f.read(0),b.resumeScheduled=!1,f.emit("resume"),me(f),b.flowing&&!b.reading&&f.read(0)}T.prototype.pause=function(){return K("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(K("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[ke]=!0,this};function me(f){let b=f._readableState;for(K("flow",b.flowing);b.flowing&&f.read()!==null;);}T.prototype.wrap=function(f){let b=!1;f.on("data",B=>{!this.push(B)&&f.pause&&(b=!0,f.pause())}),f.on("end",()=>{this.push(null)}),f.on("error",B=>{be(this,B)}),f.on("close",()=>{this.destroy()}),f.on("destroy",()=>{this.destroy()}),this._read=()=>{b&&f.resume&&(b=!1,f.resume())};let I=i(f);for(let B=1;B<I.length;B++){let G=I[B];this[G]===void 0&&typeof f[G]=="function"&&(this[G]=f[G].bind(f))}return this},T.prototype[_]=function(){return ce(this)},T.prototype.iterator=function(f){return f!==void 0&&ie(f,"options"),ce(this,f)};function ce(f,b){typeof f.read!="function"&&(f=T.wrap(f,{objectMode:!0}));let I=q(f,b);return I.stream=f,I}async function*q(f,b){let I=Oe;function B(De){this===f?(I(),I=Oe):I=De}f.on("readable",B);let G,he=P(f,{writable:!1},De=>{G=De?X(G,De):null,I(),I=Oe});try{for(;;){let De=f.destroyed?null:f.read();if(De!==null)yield De;else{if(G)throw G;if(G===null)return;await new g(B)}}}catch(De){throw G=X(G,De),G}finally{(G||(b==null?void 0:b.destroyOnReturn)!==!1)&&(G===void 0||f._readableState.autoDestroy)?j.destroyer(f,null):(f.off("readable",B),he())}}a(T.prototype,{readable:{__proto__:null,get(){let f=this._readableState;return!!f&&f.readable!==!1&&!f.destroyed&&!f.errorEmitted&&!f.endEmitted},set(f){this._readableState&&(this._readableState.readable=!!f)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(f){this._readableState&&(this._readableState.flowing=f)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(f){this._readableState&&(this._readableState.destroyed=f)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),a(Ne.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[ke]!==!1},set(f){this[ke]=!!f}}}),T._fromList=re;function re(f,b){if(b.length===0)return null;let I;return b.objectMode?I=b.buffer.shift():!f||f>=b.length?(b.decoder?I=b.buffer.join(""):b.buffer.length===1?I=b.buffer.first():I=b.buffer.concat(b.length),b.buffer.clear()):I=b.buffer.consume(f,b.decoder),I}function U(f){let b=f._readableState;K("endReadable",b.endEmitted),b.endEmitted||(b.ended=!0,r.nextTick(z,b,f))}function z(f,b){if(K("endReadableNT",f.endEmitted,f.length),!f.errored&&!f.closeEmitted&&!f.endEmitted&&f.length===0){if(f.endEmitted=!0,b.emit("end"),b.writable&&b.allowHalfOpen===!1)r.nextTick(Z,b);else if(f.autoDestroy){let I=b._writableState;(!I||I.autoDestroy&&(I.finished||I.writable===!1))&&b.destroy()}}}function Z(f){f.writable&&!f.writableEnded&&!f.destroyed&&f.end()}T.from=function(f,b){return ee(T,f,b)};var ve;function d(){return ve===void 0&&(ve={}),ve}T.fromWeb=function(f,b){return d().newStreamReadableFromReadableStream(f,b)},T.toWeb=function(f,b){return d().newReadableStreamFromStreamReadable(f,b)},T.wrap=function(f,b){var I,B;return new T({objectMode:(I=(B=f.readableObjectMode)!==null&&B!==void 0?B:f.objectMode)!==null&&I!==void 0?I:!0,...b,destroy(G,he){j.destroyer(f,G),he(G)}}).wrap(f)}}),Sa=E((e,s)=>{we(),_e(),M();var r=br(),{ArrayPrototypeSlice:h,Error:p,FunctionPrototypeSymbolHasInstance:o,ObjectDefineProperty:n,ObjectDefineProperties:a,ObjectSetPrototypeOf:i,StringPrototypeToLowerCase:c,Symbol:g,SymbolHasInstance:y}=dt();s.exports=ye,ye.WritableState=ie;var{EventEmitter:_}=(Dr(),V(_r)),v=Co().Stream,{Buffer:S}=(yt(),V(bt)),C=Lr(),{addAbortSignal:x}=mn(),{getHighWaterMark:H,getDefaultHighWaterMark:k}=Io(),{ERR_INVALID_ARG_TYPE:P,ERR_METHOD_NOT_IMPLEMENTED:K,ERR_MULTIPLE_CALLBACK:Q,ERR_STREAM_CANNOT_PIPE:j,ERR_STREAM_DESTROYED:N,ERR_STREAM_ALREADY_FINISHED:$,ERR_STREAM_NULL_VALUES:X,ERR_STREAM_WRITE_AFTER_END:ae,ERR_UNKNOWN_ENCODING:pe}=At().codes,{errorOrDestroy:O}=C;i(ye.prototype,v.prototype),i(ye,v);function te(){}var de=g("kOnFinished");function ie(L,J,Y){typeof Y!="boolean"&&(Y=J instanceof Xt()),this.objectMode=!!(L&&L.objectMode),Y&&(this.objectMode=this.objectMode||!!(L&&L.writableObjectMode)),this.highWaterMark=L?H(this,L,"writableHighWaterMark",Y):k(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let me=!!(L&&L.decodeStrings===!1);this.decodeStrings=!me,this.defaultEncoding=L&&L.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=T.bind(void 0,J),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,ke(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!L||L.emitClose!==!1,this.autoDestroy=!L||L.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[de]=[]}function ke(L){L.buffered=[],L.bufferedIndex=0,L.allBuffers=!0,L.allNoop=!0}ie.prototype.getBuffer=function(){return h(this.buffered,this.bufferedIndex)},n(ie.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ye(L){let J=this instanceof Xt();if(!J&&!o(ye,this))return new ye(L);this._writableState=new ie(L,this,J),L&&(typeof L.write=="function"&&(this._write=L.write),typeof L.writev=="function"&&(this._writev=L.writev),typeof L.destroy=="function"&&(this._destroy=L.destroy),typeof L.final=="function"&&(this._final=L.final),typeof L.construct=="function"&&(this._construct=L.construct),L.signal&&x(L.signal,this)),v.call(this,L),C.construct(this,()=>{let Y=this._writableState;Y.writing||Ee(this,Y),Se(this,Y)})}n(ye,y,{__proto__:null,value:function(L){return o(this,L)?!0:this!==ye?!1:L&&L._writableState instanceof ie}}),ye.prototype.pipe=function(){O(this,new j)};function ee(L,J,Y,me){let ce=L._writableState;if(typeof Y=="function")me=Y,Y=ce.defaultEncoding;else{if(!Y)Y=ce.defaultEncoding;else if(Y!=="buffer"&&!S.isEncoding(Y))throw new pe(Y);typeof me!="function"&&(me=te)}if(J===null)throw new X;if(!ce.objectMode)if(typeof J=="string")ce.decodeStrings!==!1&&(J=S.from(J,Y),Y="buffer");else if(J instanceof S)Y="buffer";else if(v._isUint8Array(J))J=v._uint8ArrayToBuffer(J),Y="buffer";else throw new P("chunk",["string","Buffer","Uint8Array"],J);let q;return ce.ending?q=new ae:ce.destroyed&&(q=new N("write")),q?(r.nextTick(me,q),O(L,q,!0),q):(ce.pendingcb++,Oe(L,ce,J,Y,me))}ye.prototype.write=function(L,J,Y){return ee(this,L,J,Y)===!0},ye.prototype.cork=function(){this._writableState.corked++},ye.prototype.uncork=function(){let L=this._writableState;L.corked&&(L.corked--,L.writing||Ee(this,L))},ye.prototype.setDefaultEncoding=function(L){if(typeof L=="string"&&(L=c(L)),!S.isEncoding(L))throw new pe(L);return this._writableState.defaultEncoding=L,this};function Oe(L,J,Y,me,ce){let q=J.objectMode?1:Y.length;J.length+=q;let re=J.length<J.highWaterMark;return re||(J.needDrain=!0),J.writing||J.corked||J.errored||!J.constructed?(J.buffered.push({chunk:Y,encoding:me,callback:ce}),J.allBuffers&&me!=="buffer"&&(J.allBuffers=!1),J.allNoop&&ce!==te&&(J.allNoop=!1)):(J.writelen=q,J.writecb=ce,J.writing=!0,J.sync=!0,L._write(Y,me,J.onwrite),J.sync=!1),re&&!J.errored&&!J.destroyed}function be(L,J,Y,me,ce,q,re){J.writelen=me,J.writecb=re,J.writing=!0,J.sync=!0,J.destroyed?J.onwrite(new N("write")):Y?L._writev(ce,J.onwrite):L._write(ce,q,J.onwrite),J.sync=!1}function Ne(L,J,Y,me){--J.pendingcb,me(Y),Me(J),O(L,Y)}function T(L,J){let Y=L._writableState,me=Y.sync,ce=Y.writecb;if(typeof ce!="function"){O(L,new Q);return}Y.writing=!1,Y.writecb=null,Y.length-=Y.writelen,Y.writelen=0,J?(J.stack,Y.errored||(Y.errored=J),L._readableState&&!L._readableState.errored&&(L._readableState.errored=J),me?r.nextTick(Ne,L,Y,J,ce):Ne(L,Y,J,ce)):(Y.buffered.length>Y.bufferedIndex&&Ee(L,Y),me?Y.afterWriteTickInfo!==null&&Y.afterWriteTickInfo.cb===ce?Y.afterWriteTickInfo.count++:(Y.afterWriteTickInfo={count:1,cb:ce,stream:L,state:Y},r.nextTick(oe,Y.afterWriteTickInfo)):Ae(L,Y,1,ce))}function oe({stream:L,state:J,count:Y,cb:me}){return J.afterWriteTickInfo=null,Ae(L,J,Y,me)}function Ae(L,J,Y,me){for(!J.ending&&!L.destroyed&&J.length===0&&J.needDrain&&(J.needDrain=!1,L.emit("drain"));Y-- >0;)J.pendingcb--,me();J.destroyed&&Me(J),Se(L,J)}function Me(L){if(L.writing)return;for(let ce=L.bufferedIndex;ce<L.buffered.length;++ce){var J;let{chunk:q,callback:re}=L.buffered[ce],U=L.objectMode?1:q.length;L.length-=U,re((J=L.errored)!==null&&J!==void 0?J:new N("write"))}let Y=L[de].splice(0);for(let ce=0;ce<Y.length;ce++){var me;Y[ce]((me=L.errored)!==null&&me!==void 0?me:new N("end"))}ke(L)}function Ee(L,J){if(J.corked||J.bufferProcessing||J.destroyed||!J.constructed)return;let{buffered:Y,bufferedIndex:me,objectMode:ce}=J,q=Y.length-me;if(!q)return;let re=me;if(J.bufferProcessing=!0,q>1&&L._writev){J.pendingcb-=q-1;let U=J.allNoop?te:Z=>{for(let ve=re;ve<Y.length;++ve)Y[ve].callback(Z)},z=J.allNoop&&re===0?Y:h(Y,re);z.allBuffers=J.allBuffers,be(L,J,!0,J.length,z,"",U),ke(J)}else{do{let{chunk:U,encoding:z,callback:Z}=Y[re];Y[re++]=null;let ve=ce?1:U.length;be(L,J,!1,ve,U,z,Z)}while(re<Y.length&&!J.writing);re===Y.length?ke(J):re>256?(Y.splice(0,re),J.bufferedIndex=0):J.bufferedIndex=re}J.bufferProcessing=!1}ye.prototype._write=function(L,J,Y){if(this._writev)this._writev([{chunk:L,encoding:J}],Y);else throw new K("_write()")},ye.prototype._writev=null,ye.prototype.end=function(L,J,Y){let me=this._writableState;typeof L=="function"?(Y=L,L=null,J=null):typeof J=="function"&&(Y=J,J=null);let ce;if(L!=null){let q=ee(this,L,J);q instanceof p&&(ce=q)}return me.corked&&(me.corked=1,this.uncork()),ce||(!me.errored&&!me.ending?(me.ending=!0,Se(this,me,!0),me.ended=!0):me.finished?ce=new $("end"):me.destroyed&&(ce=new N("end"))),typeof Y=="function"&&(ce||me.finished?r.nextTick(Y,ce):me[de].push(Y)),this};function F(L){return L.ending&&!L.destroyed&&L.constructed&&L.length===0&&!L.errored&&L.buffered.length===0&&!L.finished&&!L.writing&&!L.errorEmitted&&!L.closeEmitted}function R(L,J){let Y=!1;function me(ce){if(Y){O(L,ce??Q());return}if(Y=!0,J.pendingcb--,ce){let q=J[de].splice(0);for(let re=0;re<q.length;re++)q[re](ce);O(L,ce,J.sync)}else F(J)&&(J.prefinished=!0,L.emit("prefinish"),J.pendingcb++,r.nextTick(fe,L,J))}J.sync=!0,J.pendingcb++;try{L._final(me)}catch(ce){me(ce)}J.sync=!1}function ne(L,J){!J.prefinished&&!J.finalCalled&&(typeof L._final=="function"&&!J.destroyed?(J.finalCalled=!0,R(L,J)):(J.prefinished=!0,L.emit("prefinish")))}function Se(L,J,Y){F(J)&&(ne(L,J),J.pendingcb===0&&(Y?(J.pendingcb++,r.nextTick((me,ce)=>{F(ce)?fe(me,ce):ce.pendingcb--},L,J)):F(J)&&(J.pendingcb++,fe(L,J))))}function fe(L,J){J.pendingcb--,J.finished=!0;let Y=J[de].splice(0);for(let me=0;me<Y.length;me++)Y[me]();if(L.emit("finish"),J.autoDestroy){let me=L._readableState;(!me||me.autoDestroy&&(me.endEmitted||me.readable===!1))&&L.destroy()}}a(ye.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(L){this._writableState&&(this._writableState.destroyed=L)}},writable:{__proto__:null,get(){let L=this._writableState;return!!L&&L.writable!==!1&&!L.destroyed&&!L.errored&&!L.ending&&!L.ended},set(L){this._writableState&&(this._writableState.writable=!!L)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let L=this._writableState;return L?!L.destroyed&&!L.ending&&L.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var ue=C.destroy;ye.prototype.destroy=function(L,J){let Y=this._writableState;return!Y.destroyed&&(Y.bufferedIndex<Y.buffered.length||Y[de].length)&&r.nextTick(Me,Y),ue.call(this,L,J),this},ye.prototype._undestroy=C.undestroy,ye.prototype._destroy=function(L,J){J(L)},ye.prototype[_.captureRejectionSymbol]=function(L){this.destroy(L)};var Pe;function Te(){return Pe===void 0&&(Pe={}),Pe}ye.fromWeb=function(L,J){return Te().newStreamWritableFromWritableStream(L,J)},ye.toWeb=function(L){return Te().newWritableStreamFromStreamWritable(L)}}),$u=E((e,s)=>{we(),_e(),M();var r=br(),h=(yt(),V(bt)),{isReadable:p,isWritable:o,isIterable:n,isNodeStream:a,isReadableNodeStream:i,isWritableNodeStream:c,isDuplexNodeStream:g}=Qt(),y=cr(),{AbortError:_,codes:{ERR_INVALID_ARG_TYPE:v,ERR_INVALID_RETURN_VALUE:S}}=At(),{destroyer:C}=Lr(),x=Xt(),H=vn(),{createDeferredPromise:k}=Jt(),P=Ea(),K=globalThis.Blob||h.Blob,Q=typeof K<"u"?function(pe){return pe instanceof K}:function(pe){return!1},j=globalThis.AbortController||vo().AbortController,{FunctionPrototypeCall:N}=dt(),$=class extends x{constructor(pe){super(pe),(pe==null?void 0:pe.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(pe==null?void 0:pe.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};s.exports=function pe(O,te){if(g(O))return O;if(i(O))return ae({readable:O});if(c(O))return ae({writable:O});if(a(O))return ae({writable:!1,readable:!1});if(typeof O=="function"){let{value:ie,write:ke,final:ye,destroy:ee}=X(O);if(n(ie))return P($,ie,{objectMode:!0,write:ke,final:ye,destroy:ee});let Oe=ie==null?void 0:ie.then;if(typeof Oe=="function"){let be,Ne=N(Oe,ie,T=>{if(T!=null)throw new S("nully","body",T)},T=>{C(be,T)});return be=new $({objectMode:!0,readable:!1,write:ke,final(T){ye(async()=>{try{await Ne,r.nextTick(T,null)}catch(oe){r.nextTick(T,oe)}})},destroy:ee})}throw new S("Iterable, AsyncIterable or AsyncFunction",te,ie)}if(Q(O))return pe(O.arrayBuffer());if(n(O))return P($,O,{objectMode:!0,writable:!1});if(typeof(O==null?void 0:O.writable)=="object"||typeof(O==null?void 0:O.readable)=="object"){let ie=O!=null&&O.readable?i(O==null?void 0:O.readable)?O==null?void 0:O.readable:pe(O.readable):void 0,ke=O!=null&&O.writable?c(O==null?void 0:O.writable)?O==null?void 0:O.writable:pe(O.writable):void 0;return ae({readable:ie,writable:ke})}let de=O==null?void 0:O.then;if(typeof de=="function"){let ie;return N(de,O,ke=>{ke!=null&&ie.push(ke),ie.push(null)},ke=>{C(ie,ke)}),ie=new $({objectMode:!0,writable:!1,read(){}})}throw new v(te,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],O)};function X(pe){let{promise:O,resolve:te}=k(),de=new j,ie=de.signal;return{value:pe(async function*(){for(;;){let ke=O;O=null;let{chunk:ye,done:ee,cb:Oe}=await ke;if(r.nextTick(Oe),ee)return;if(ie.aborted)throw new _(void 0,{cause:ie.reason});({promise:O,resolve:te}=k()),yield ye}}(),{signal:ie}),write(ke,ye,ee){let Oe=te;te=null,Oe({chunk:ke,done:!1,cb:ee})},final(ke){let ye=te;te=null,ye({done:!0,cb:ke})},destroy(ke,ye){de.abort(),ye(ke)}}}function ae(pe){let O=pe.readable&&typeof pe.readable.read!="function"?H.wrap(pe.readable):pe.readable,te=pe.writable,de=!!p(O),ie=!!o(te),ke,ye,ee,Oe,be;function Ne(T){let oe=Oe;Oe=null,oe?oe(T):T&&be.destroy(T)}return be=new $({readableObjectMode:!!(O!=null&&O.readableObjectMode),writableObjectMode:!!(te!=null&&te.writableObjectMode),readable:de,writable:ie}),ie&&(y(te,T=>{ie=!1,T&&C(O,T),Ne(T)}),be._write=function(T,oe,Ae){te.write(T,oe)?Ae():ke=Ae},be._final=function(T){te.end(),ye=T},te.on("drain",function(){if(ke){let T=ke;ke=null,T()}}),te.on("finish",function(){if(ye){let T=ye;ye=null,T()}})),de&&(y(O,T=>{de=!1,T&&C(O,T),Ne(T)}),O.on("readable",function(){if(ee){let T=ee;ee=null,T()}}),O.on("end",function(){be.push(null)}),be._read=function(){for(;;){let T=O.read();if(T===null){ee=be._read;return}if(!be.push(T))return}}),be._destroy=function(T,oe){!T&&Oe!==null&&(T=new _),ee=null,ke=null,ye=null,Oe===null?oe(T):(Oe=oe,C(te,T),C(O,T))},be}}),Xt=E((e,s)=>{we(),_e(),M();var{ObjectDefineProperties:r,ObjectGetOwnPropertyDescriptor:h,ObjectKeys:p,ObjectSetPrototypeOf:o}=dt();s.exports=i;var n=vn(),a=Sa();o(i.prototype,n.prototype),o(i,n);{let _=p(a.prototype);for(let v=0;v<_.length;v++){let S=_[v];i.prototype[S]||(i.prototype[S]=a.prototype[S])}}function i(_){if(!(this instanceof i))return new i(_);n.call(this,_),a.call(this,_),_?(this.allowHalfOpen=_.allowHalfOpen!==!1,_.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),_.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}r(i.prototype,{writable:{__proto__:null,...h(a.prototype,"writable")},writableHighWaterMark:{__proto__:null,...h(a.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...h(a.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...h(a.prototype,"writableBuffer")},writableLength:{__proto__:null,...h(a.prototype,"writableLength")},writableFinished:{__proto__:null,...h(a.prototype,"writableFinished")},writableCorked:{__proto__:null,...h(a.prototype,"writableCorked")},writableEnded:{__proto__:null,...h(a.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...h(a.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(_){this._readableState&&this._writableState&&(this._readableState.destroyed=_,this._writableState.destroyed=_)}}});var c;function g(){return c===void 0&&(c={}),c}i.fromWeb=function(_,v){return g().newStreamDuplexFromReadableWritablePair(_,v)},i.toWeb=function(_){return g().newReadableWritablePairFromDuplex(_)};var y;i.from=function(_){return y||(y=$u()),y(_,"body")}}),Aa=E((e,s)=>{we(),_e(),M();var{ObjectSetPrototypeOf:r,Symbol:h}=dt();s.exports=i;var{ERR_METHOD_NOT_IMPLEMENTED:p}=At().codes,o=Xt(),{getHighWaterMark:n}=Io();r(i.prototype,o.prototype),r(i,o);var a=h("kCallback");function i(y){if(!(this instanceof i))return new i(y);let _=y?n(this,y,"readableHighWaterMark",!0):null;_===0&&(y={...y,highWaterMark:null,readableHighWaterMark:_,writableHighWaterMark:y.writableHighWaterMark||0}),o.call(this,y),this._readableState.sync=!1,this[a]=null,y&&(typeof y.transform=="function"&&(this._transform=y.transform),typeof y.flush=="function"&&(this._flush=y.flush)),this.on("prefinish",g)}function c(y){typeof this._flush=="function"&&!this.destroyed?this._flush((_,v)=>{if(_){y?y(_):this.destroy(_);return}v!=null&&this.push(v),this.push(null),y&&y()}):(this.push(null),y&&y())}function g(){this._final!==c&&c.call(this)}i.prototype._final=c,i.prototype._transform=function(y,_,v){throw new p("_transform()")},i.prototype._write=function(y,_,v){let S=this._readableState,C=this._writableState,x=S.length;this._transform(y,_,(H,k)=>{if(H){v(H);return}k!=null&&this.push(k),C.ended||x===S.length||S.length<S.highWaterMark?v():this[a]=v})},i.prototype._read=function(){if(this[a]){let y=this[a];this[a]=null,y()}}}),Ca=E((e,s)=>{we(),_e(),M();var{ObjectSetPrototypeOf:r}=dt();s.exports=p;var h=Aa();r(p.prototype,h.prototype),r(p,h);function p(o){if(!(this instanceof p))return new p(o);h.call(this,o)}p.prototype._transform=function(o,n,a){a(null,o)}}),Mo=E((e,s)=>{we(),_e(),M();var r=br(),{ArrayIsArray:h,Promise:p,SymbolAsyncIterator:o}=dt(),n=cr(),{once:a}=Jt(),i=Lr(),c=Xt(),{aggregateTwoErrors:g,codes:{ERR_INVALID_ARG_TYPE:y,ERR_INVALID_RETURN_VALUE:_,ERR_MISSING_ARGS:v,ERR_STREAM_DESTROYED:S,ERR_STREAM_PREMATURE_CLOSE:C},AbortError:x}=At(),{validateFunction:H,validateAbortSignal:k}=pn(),{isIterable:P,isReadable:K,isReadableNodeStream:Q,isNodeStream:j,isTransformStream:N,isWebStream:$,isReadableStream:X,isReadableEnded:ae}=Qt(),pe=globalThis.AbortController||vo().AbortController,O,te;function de(oe,Ae,Me){let Ee=!1;oe.on("close",()=>{Ee=!0});let F=n(oe,{readable:Ae,writable:Me},R=>{Ee=!R});return{destroy:R=>{Ee||(Ee=!0,i.destroyer(oe,R||new S("pipe")))},cleanup:F}}function ie(oe){return H(oe[oe.length-1],"streams[stream.length - 1]"),oe.pop()}function ke(oe){if(P(oe))return oe;if(Q(oe))return ye(oe);throw new y("val",["Readable","Iterable","AsyncIterable"],oe)}async function*ye(oe){te||(te=vn()),yield*te.prototype[o].call(oe)}async function ee(oe,Ae,Me,{end:Ee}){let F,R=null,ne=ue=>{if(ue&&(F=ue),R){let Pe=R;R=null,Pe()}},Se=()=>new p((ue,Pe)=>{F?Pe(F):R=()=>{F?Pe(F):ue()}});Ae.on("drain",ne);let fe=n(Ae,{readable:!1},ne);try{Ae.writableNeedDrain&&await Se();for await(let ue of oe)Ae.write(ue)||await Se();Ee&&Ae.end(),await Se(),Me()}catch(ue){Me(F!==ue?g(F,ue):ue)}finally{fe(),Ae.off("drain",ne)}}async function Oe(oe,Ae,Me,{end:Ee}){N(Ae)&&(Ae=Ae.writable);let F=Ae.getWriter();try{for await(let R of oe)await F.ready,F.write(R).catch(()=>{});await F.ready,Ee&&await F.close(),Me()}catch(R){try{await F.abort(R),Me(R)}catch(ne){Me(ne)}}}function be(...oe){return Ne(oe,a(ie(oe)))}function Ne(oe,Ae,Me){if(oe.length===1&&h(oe[0])&&(oe=oe[0]),oe.length<2)throw new v("streams");let Ee=new pe,F=Ee.signal,R=Me==null?void 0:Me.signal,ne=[];k(R,"options.signal");function Se(){J(new x)}R==null||R.addEventListener("abort",Se);let fe,ue,Pe=[],Te=0;function L(q){J(q,--Te===0)}function J(q,re){if(q&&(!fe||fe.code==="ERR_STREAM_PREMATURE_CLOSE")&&(fe=q),!(!fe&&!re)){for(;Pe.length;)Pe.shift()(fe);R==null||R.removeEventListener("abort",Se),Ee.abort(),re&&(fe||ne.forEach(U=>U()),r.nextTick(Ae,fe,ue))}}let Y;for(let q=0;q<oe.length;q++){let re=oe[q],U=q<oe.length-1,z=q>0,Z=U||(Me==null?void 0:Me.end)!==!1,ve=q===oe.length-1;if(j(re)){let d=function(f){f&&f.name!=="AbortError"&&f.code!=="ERR_STREAM_PREMATURE_CLOSE"&&L(f)};if(Z){let{destroy:f,cleanup:b}=de(re,U,z);Pe.push(f),K(re)&&ve&&ne.push(b)}re.on("error",d),K(re)&&ve&&ne.push(()=>{re.removeListener("error",d)})}if(q===0)if(typeof re=="function"){if(Y=re({signal:F}),!P(Y))throw new _("Iterable, AsyncIterable or Stream","source",Y)}else P(re)||Q(re)||N(re)?Y=re:Y=c.from(re);else if(typeof re=="function"){if(N(Y)){var me;Y=ke((me=Y)===null||me===void 0?void 0:me.readable)}else Y=ke(Y);if(Y=re(Y,{signal:F}),U){if(!P(Y,!0))throw new _("AsyncIterable",`transform[${q-1}]`,Y)}else{var ce;O||(O=Ca());let d=new O({objectMode:!0}),f=(ce=Y)===null||ce===void 0?void 0:ce.then;if(typeof f=="function")Te++,f.call(Y,B=>{ue=B,B!=null&&d.write(B),Z&&d.end(),r.nextTick(L)},B=>{d.destroy(B),r.nextTick(L,B)});else if(P(Y,!0))Te++,ee(Y,d,L,{end:Z});else if(X(Y)||N(Y)){let B=Y.readable||Y;Te++,ee(B,d,L,{end:Z})}else throw new _("AsyncIterable or Promise","destination",Y);Y=d;let{destroy:b,cleanup:I}=de(Y,!1,!0);Pe.push(b),ve&&ne.push(I)}}else if(j(re)){if(Q(Y)){Te+=2;let d=T(Y,re,L,{end:Z});K(re)&&ve&&ne.push(d)}else if(N(Y)||X(Y)){let d=Y.readable||Y;Te++,ee(d,re,L,{end:Z})}else if(P(Y))Te++,ee(Y,re,L,{end:Z});else throw new y("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Y);Y=re}else if($(re)){if(Q(Y))Te++,Oe(ke(Y),re,L,{end:Z});else if(X(Y)||P(Y))Te++,Oe(Y,re,L,{end:Z});else if(N(Y))Te++,Oe(Y.readable,re,L,{end:Z});else throw new y("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],Y);Y=re}else Y=c.from(re)}return(F!=null&&F.aborted||R!=null&&R.aborted)&&r.nextTick(Se),Y}function T(oe,Ae,Me,{end:Ee}){let F=!1;if(Ae.on("close",()=>{F||Me(new C)}),oe.pipe(Ae,{end:!1}),Ee){let R=function(){F=!0,Ae.end()};ae(oe)?r.nextTick(R):oe.once("end",R)}else Me();return n(oe,{readable:!0,writable:!1},R=>{let ne=oe._readableState;R&&R.code==="ERR_STREAM_PREMATURE_CLOSE"&&ne&&ne.ended&&!ne.errored&&!ne.errorEmitted?oe.once("end",Me).once("error",Me):Me(R)}),n(Ae,{readable:!1,writable:!0},Me)}s.exports={pipelineImpl:Ne,pipeline:be}}),Ia=E((e,s)=>{we(),_e(),M();var{pipeline:r}=Mo(),h=Xt(),{destroyer:p}=Lr(),{isNodeStream:o,isReadable:n,isWritable:a,isWebStream:i,isTransformStream:c,isWritableStream:g,isReadableStream:y}=Qt(),{AbortError:_,codes:{ERR_INVALID_ARG_VALUE:v,ERR_MISSING_ARGS:S}}=At(),C=cr();s.exports=function(...x){if(x.length===0)throw new S("streams");if(x.length===1)return h.from(x[0]);let H=[...x];if(typeof x[0]=="function"&&(x[0]=h.from(x[0])),typeof x[x.length-1]=="function"){let O=x.length-1;x[O]=h.from(x[O])}for(let O=0;O<x.length;++O)if(!(!o(x[O])&&!i(x[O]))){if(O<x.length-1&&!(n(x[O])||y(x[O])||c(x[O])))throw new v(`streams[${O}]`,H[O],"must be readable");if(O>0&&!(a(x[O])||g(x[O])||c(x[O])))throw new v(`streams[${O}]`,H[O],"must be writable")}let k,P,K,Q,j;function N(O){let te=Q;Q=null,te?te(O):O?j.destroy(O):!pe&&!ae&&j.destroy()}let $=x[0],X=r(x,N),ae=!!(a($)||g($)||c($)),pe=!!(n(X)||y(X)||c(X));if(j=new h({writableObjectMode:!!($!=null&&$.writableObjectMode),readableObjectMode:!!(X!=null&&X.writableObjectMode),writable:ae,readable:pe}),ae){if(o($))j._write=function(te,de,ie){$.write(te,de)?ie():k=ie},j._final=function(te){$.end(),P=te},$.on("drain",function(){if(k){let te=k;k=null,te()}});else if(i($)){let te=(c($)?$.writable:$).getWriter();j._write=async function(de,ie,ke){try{await te.ready,te.write(de).catch(()=>{}),ke()}catch(ye){ke(ye)}},j._final=async function(de){try{await te.ready,te.close().catch(()=>{}),P=de}catch(ie){de(ie)}}}let O=c(X)?X.readable:X;C(O,()=>{if(P){let te=P;P=null,te()}})}if(pe){if(o(X))X.on("readable",function(){if(K){let O=K;K=null,O()}}),X.on("end",function(){j.push(null)}),j._read=function(){for(;;){let O=X.read();if(O===null){K=j._read;return}if(!j.push(O))return}};else if(i(X)){let O=(c(X)?X.readable:X).getReader();j._read=async function(){for(;;)try{let{value:te,done:de}=await O.read();if(!j.push(te))return;if(de){j.push(null);return}}catch{return}}}}return j._destroy=function(O,te){!O&&Q!==null&&(O=new _),K=null,k=null,P=null,Q===null?te(O):(Q=te,o(X)&&p(X,O))},j}}),Wu=E((e,s)=>{we(),_e(),M();var r=globalThis.AbortController||vo().AbortController,{codes:{ERR_INVALID_ARG_VALUE:h,ERR_INVALID_ARG_TYPE:p,ERR_MISSING_ARGS:o,ERR_OUT_OF_RANGE:n},AbortError:a}=At(),{validateAbortSignal:i,validateInteger:c,validateObject:g}=pn(),y=dt().Symbol("kWeak"),{finished:_}=cr(),v=Ia(),{addAbortSignalNoValidate:S}=mn(),{isWritable:C,isNodeStream:x}=Qt(),{ArrayPrototypePush:H,MathFloor:k,Number:P,NumberIsNaN:K,Promise:Q,PromiseReject:j,PromisePrototypeThen:N,Symbol:$}=dt(),X=$("kEmpty"),ae=$("kEof");function pe(Ee,F){if(F!=null&&g(F,"options"),(F==null?void 0:F.signal)!=null&&i(F.signal,"options.signal"),x(Ee)&&!C(Ee))throw new h("stream",Ee,"must be writable");let R=v(this,Ee);return F!=null&&F.signal&&S(F.signal,R),R}function O(Ee,F){if(typeof Ee!="function")throw new p("fn",["Function","AsyncFunction"],Ee);F!=null&&g(F,"options"),(F==null?void 0:F.signal)!=null&&i(F.signal,"options.signal");let R=1;return(F==null?void 0:F.concurrency)!=null&&(R=k(F.concurrency)),c(R,"concurrency",1),(async function*(){var ne,Se;let fe=new r,ue=this,Pe=[],Te=fe.signal,L={signal:Te},J=()=>fe.abort();F!=null&&(ne=F.signal)!==null&&ne!==void 0&&ne.aborted&&J(),F==null||(Se=F.signal)===null||Se===void 0||Se.addEventListener("abort",J);let Y,me,ce=!1;function q(){ce=!0}async function re(){try{for await(let Z of ue){var U;if(ce)return;if(Te.aborted)throw new a;try{Z=Ee(Z,L)}catch(ve){Z=j(ve)}Z!==X&&(typeof((U=Z)===null||U===void 0?void 0:U.catch)=="function"&&Z.catch(q),Pe.push(Z),Y&&(Y(),Y=null),!ce&&Pe.length&&Pe.length>=R&&await new Q(ve=>{me=ve}))}Pe.push(ae)}catch(Z){let ve=j(Z);N(ve,void 0,q),Pe.push(ve)}finally{var z;ce=!0,Y&&(Y(),Y=null),F==null||(z=F.signal)===null||z===void 0||z.removeEventListener("abort",J)}}re();try{for(;;){for(;Pe.length>0;){let U=await Pe[0];if(U===ae)return;if(Te.aborted)throw new a;U!==X&&(yield U),Pe.shift(),me&&(me(),me=null)}await new Q(U=>{Y=U})}}finally{fe.abort(),ce=!0,me&&(me(),me=null)}}).call(this)}function te(Ee=void 0){return Ee!=null&&g(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&i(Ee.signal,"options.signal"),(async function*(){let F=0;for await(let ne of this){var R;if(Ee!=null&&(R=Ee.signal)!==null&&R!==void 0&&R.aborted)throw new a({cause:Ee.signal.reason});yield[F++,ne]}}).call(this)}async function de(Ee,F=void 0){for await(let R of ee.call(this,Ee,F))return!0;return!1}async function ie(Ee,F=void 0){if(typeof Ee!="function")throw new p("fn",["Function","AsyncFunction"],Ee);return!await de.call(this,async(...R)=>!await Ee(...R),F)}async function ke(Ee,F){for await(let R of ee.call(this,Ee,F))return R}async function ye(Ee,F){if(typeof Ee!="function")throw new p("fn",["Function","AsyncFunction"],Ee);async function R(ne,Se){return await Ee(ne,Se),X}for await(let ne of O.call(this,R,F));}function ee(Ee,F){if(typeof Ee!="function")throw new p("fn",["Function","AsyncFunction"],Ee);async function R(ne,Se){return await Ee(ne,Se)?ne:X}return O.call(this,R,F)}var Oe=class extends o{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function be(Ee,F,R){var ne;if(typeof Ee!="function")throw new p("reducer",["Function","AsyncFunction"],Ee);R!=null&&g(R,"options"),(R==null?void 0:R.signal)!=null&&i(R.signal,"options.signal");let Se=arguments.length>1;if(R!=null&&(ne=R.signal)!==null&&ne!==void 0&&ne.aborted){let L=new a(void 0,{cause:R.signal.reason});throw this.once("error",()=>{}),await _(this.destroy(L)),L}let fe=new r,ue=fe.signal;if(R!=null&&R.signal){let L={once:!0,[y]:this};R.signal.addEventListener("abort",()=>fe.abort(),L)}let Pe=!1;try{for await(let L of this){var Te;if(Pe=!0,R!=null&&(Te=R.signal)!==null&&Te!==void 0&&Te.aborted)throw new a;Se?F=await Ee(F,L,{signal:ue}):(F=L,Se=!0)}if(!Pe&&!Se)throw new Oe}finally{fe.abort()}return F}async function Ne(Ee){Ee!=null&&g(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&i(Ee.signal,"options.signal");let F=[];for await(let ne of this){var R;if(Ee!=null&&(R=Ee.signal)!==null&&R!==void 0&&R.aborted)throw new a(void 0,{cause:Ee.signal.reason});H(F,ne)}return F}function T(Ee,F){let R=O.call(this,Ee,F);return(async function*(){for await(let ne of R)yield*ne}).call(this)}function oe(Ee){if(Ee=P(Ee),K(Ee))return 0;if(Ee<0)throw new n("number",">= 0",Ee);return Ee}function Ae(Ee,F=void 0){return F!=null&&g(F,"options"),(F==null?void 0:F.signal)!=null&&i(F.signal,"options.signal"),Ee=oe(Ee),(async function*(){var R;if(F!=null&&(R=F.signal)!==null&&R!==void 0&&R.aborted)throw new a;for await(let Se of this){var ne;if(F!=null&&(ne=F.signal)!==null&&ne!==void 0&&ne.aborted)throw new a;Ee--<=0&&(yield Se)}}).call(this)}function Me(Ee,F=void 0){return F!=null&&g(F,"options"),(F==null?void 0:F.signal)!=null&&i(F.signal,"options.signal"),Ee=oe(Ee),(async function*(){var R;if(F!=null&&(R=F.signal)!==null&&R!==void 0&&R.aborted)throw new a;for await(let Se of this){var ne;if(F!=null&&(ne=F.signal)!==null&&ne!==void 0&&ne.aborted)throw new a;if(Ee-- >0)yield Se;else return}}).call(this)}s.exports.streamReturningOperators={asIndexedPairs:te,drop:Ae,filter:ee,flatMap:T,map:O,take:Me,compose:pe},s.exports.promiseReturningOperators={every:ie,forEach:ye,reduce:be,toArray:Ne,some:de,find:ke}}),Ta=E((e,s)=>{we(),_e(),M();var{ArrayPrototypePop:r,Promise:h}=dt(),{isIterable:p,isNodeStream:o,isWebStream:n}=Qt(),{pipelineImpl:a}=Mo(),{finished:i}=cr();ka();function c(...g){return new h((y,_)=>{let v,S,C=g[g.length-1];if(C&&typeof C=="object"&&!o(C)&&!p(C)&&!n(C)){let x=r(g);v=x.signal,S=x.end}a(g,(x,H)=>{x?_(x):y(H)},{signal:v,end:S})})}s.exports={finished:i,pipeline:c}}),ka=E((e,s)=>{we(),_e(),M();var{Buffer:r}=(yt(),V(bt)),{ObjectDefineProperty:h,ObjectKeys:p,ReflectApply:o}=dt(),{promisify:{custom:n}}=Jt(),{streamReturningOperators:a,promiseReturningOperators:i}=Wu(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:c}}=At(),g=Ia(),{pipeline:y}=Mo(),{destroyer:_}=Lr(),v=cr(),S=Ta(),C=Qt(),x=s.exports=Co().Stream;x.isDisturbed=C.isDisturbed,x.isErrored=C.isErrored,x.isReadable=C.isReadable,x.Readable=vn();for(let k of p(a)){let P=function(...Q){if(new.target)throw c();return x.Readable.from(o(K,this,Q))},K=a[k];h(P,"name",{__proto__:null,value:K.name}),h(P,"length",{__proto__:null,value:K.length}),h(x.Readable.prototype,k,{__proto__:null,value:P,enumerable:!1,configurable:!0,writable:!0})}for(let k of p(i)){let P=function(...Q){if(new.target)throw c();return o(K,this,Q)},K=i[k];h(P,"name",{__proto__:null,value:K.name}),h(P,"length",{__proto__:null,value:K.length}),h(x.Readable.prototype,k,{__proto__:null,value:P,enumerable:!1,configurable:!0,writable:!0})}x.Writable=Sa(),x.Duplex=Xt(),x.Transform=Aa(),x.PassThrough=Ca(),x.pipeline=y;var{addAbortSignal:H}=mn();x.addAbortSignal=H,x.finished=v,x.destroy=_,x.compose=g,h(x,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return S}}),h(y,n,{__proto__:null,enumerable:!0,get(){return S.pipeline}}),h(v,n,{__proto__:null,enumerable:!0,get(){return S.finished}}),x.Stream=x,x._isUint8Array=function(k){return k instanceof Uint8Array},x._uint8ArrayToBuffer=function(k){return r.from(k.buffer,k.byteOffset,k.byteLength)}}),Ar=E((e,s)=>{we(),_e(),M();var r=ka(),h=Ta(),p=r.Readable.destroy;s.exports=r.Readable,s.exports._uint8ArrayToBuffer=r._uint8ArrayToBuffer,s.exports._isUint8Array=r._isUint8Array,s.exports.isDisturbed=r.isDisturbed,s.exports.isErrored=r.isErrored,s.exports.isReadable=r.isReadable,s.exports.Readable=r.Readable,s.exports.Writable=r.Writable,s.exports.Duplex=r.Duplex,s.exports.Transform=r.Transform,s.exports.PassThrough=r.PassThrough,s.exports.addAbortSignal=r.addAbortSignal,s.exports.finished=r.finished,s.exports.destroy=r.destroy,s.exports.destroy=p,s.exports.pipeline=r.pipeline,s.exports.compose=r.compose,Object.defineProperty(r,"promises",{configurable:!0,enumerable:!0,get(){return h}}),s.exports.Stream=r.Stream,s.exports.default=s.exports}),Hu=E((e,s)=>{we(),_e(),M(),typeof Object.create=="function"?s.exports=function(r,h){h&&(r.super_=h,r.prototype=Object.create(h.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:s.exports=function(r,h){if(h){r.super_=h;var p=function(){};p.prototype=h.prototype,r.prototype=new p,r.prototype.constructor=r}}}),qu=E((e,s)=>{we(),_e(),M();var{Buffer:r}=(yt(),V(bt)),h=Symbol.for("BufferList");function p(o){if(!(this instanceof p))return new p(o);p._init.call(this,o)}p._init=function(o){Object.defineProperty(this,h,{value:!0}),this._bufs=[],this.length=0,o&&this.append(o)},p.prototype._new=function(o){return new p(o)},p.prototype._offset=function(o){if(o===0)return[0,0];let n=0;for(let a=0;a<this._bufs.length;a++){let i=n+this._bufs[a].length;if(o<i||a===this._bufs.length-1)return[a,o-n];n=i}},p.prototype._reverseOffset=function(o){let n=o[0],a=o[1];for(let i=0;i<n;i++)a+=this._bufs[i].length;return a},p.prototype.get=function(o){if(o>this.length||o<0)return;let n=this._offset(o);return this._bufs[n[0]][n[1]]},p.prototype.slice=function(o,n){return typeof o=="number"&&o<0&&(o+=this.length),typeof n=="number"&&n<0&&(n+=this.length),this.copy(null,0,o,n)},p.prototype.copy=function(o,n,a,i){if((typeof a!="number"||a<0)&&(a=0),(typeof i!="number"||i>this.length)&&(i=this.length),a>=this.length||i<=0)return o||r.alloc(0);let c=!!o,g=this._offset(a),y=i-a,_=y,v=c&&n||0,S=g[1];if(a===0&&i===this.length){if(!c)return this._bufs.length===1?this._bufs[0]:r.concat(this._bufs,this.length);for(let C=0;C<this._bufs.length;C++)this._bufs[C].copy(o,v),v+=this._bufs[C].length;return o}if(_<=this._bufs[g[0]].length-S)return c?this._bufs[g[0]].copy(o,n,S,S+_):this._bufs[g[0]].slice(S,S+_);c||(o=r.allocUnsafe(y));for(let C=g[0];C<this._bufs.length;C++){let x=this._bufs[C].length-S;if(_>x)this._bufs[C].copy(o,v,S),v+=x;else{this._bufs[C].copy(o,v,S,S+_),v+=x;break}_-=x,S&&(S=0)}return o.length>v?o.slice(0,v):o},p.prototype.shallowSlice=function(o,n){if(o=o||0,n=typeof n!="number"?this.length:n,o<0&&(o+=this.length),n<0&&(n+=this.length),o===n)return this._new();let a=this._offset(o),i=this._offset(n),c=this._bufs.slice(a[0],i[0]+1);return i[1]===0?c.pop():c[c.length-1]=c[c.length-1].slice(0,i[1]),a[1]!==0&&(c[0]=c[0].slice(a[1])),this._new(c)},p.prototype.toString=function(o,n,a){return this.slice(n,a).toString(o)},p.prototype.consume=function(o){if(o=Math.trunc(o),Number.isNaN(o)||o<=0)return this;for(;this._bufs.length;)if(o>=this._bufs[0].length)o-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(o),this.length-=o;break}return this},p.prototype.duplicate=function(){let o=this._new();for(let n=0;n<this._bufs.length;n++)o.append(this._bufs[n]);return o},p.prototype.append=function(o){if(o==null)return this;if(o.buffer)this._appendBuffer(r.from(o.buffer,o.byteOffset,o.byteLength));else if(Array.isArray(o))for(let n=0;n<o.length;n++)this.append(o[n]);else if(this._isBufferList(o))for(let n=0;n<o._bufs.length;n++)this.append(o._bufs[n]);else typeof o=="number"&&(o=o.toString()),this._appendBuffer(r.from(o));return this},p.prototype._appendBuffer=function(o){this._bufs.push(o),this.length+=o.length},p.prototype.indexOf=function(o,n,a){if(a===void 0&&typeof n=="string"&&(a=n,n=void 0),typeof o=="function"||Array.isArray(o))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof o=="number"?o=r.from([o]):typeof o=="string"?o=r.from(o,a):this._isBufferList(o)?o=o.slice():Array.isArray(o.buffer)?o=r.from(o.buffer,o.byteOffset,o.byteLength):r.isBuffer(o)||(o=r.from(o)),n=Number(n||0),isNaN(n)&&(n=0),n<0&&(n=this.length+n),n<0&&(n=0),o.length===0)return n>this.length?this.length:n;let i=this._offset(n),c=i[0],g=i[1];for(;c<this._bufs.length;c++){let y=this._bufs[c];for(;g<y.length;)if(y.length-g>=o.length){let _=y.indexOf(o,g);if(_!==-1)return this._reverseOffset([c,_]);g=y.length-o.length+1}else{let _=this._reverseOffset([c,g]);if(this._match(_,o))return _;g++}g=0}return-1},p.prototype._match=function(o,n){if(this.length-o<n.length)return!1;for(let a=0;a<n.length;a++)if(this.get(o+a)!==n[a])return!1;return!0},function(){let o={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readBigInt64BE:8,readBigInt64LE:8,readBigUInt64BE:8,readBigUInt64LE:8,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let n in o)(function(a){o[a]===null?p.prototype[a]=function(i,c){return this.slice(i,i+c)[a](0,c)}:p.prototype[a]=function(i=0){return this.slice(i,i+o[a])[a](0)}})(n)}(),p.prototype._isBufferList=function(o){return o instanceof p||p.isBufferList(o)},p.isBufferList=function(o){return o!=null&&o[h]},s.exports=p}),Vu=E((e,s)=>{we(),_e(),M();var r=Ar().Duplex,h=Hu(),p=qu();function o(n){if(!(this instanceof o))return new o(n);if(typeof n=="function"){this._callback=n;let a=(function(i){this._callback&&(this._callback(i),this._callback=null)}).bind(this);this.on("pipe",function(i){i.on("error",a)}),this.on("unpipe",function(i){i.removeListener("error",a)}),n=null}p._init.call(this,n),r.call(this)}h(o,r),Object.assign(o.prototype,p.prototype),o.prototype._new=function(n){return new o(n)},o.prototype._write=function(n,a,i){this._appendBuffer(n),typeof i=="function"&&i()},o.prototype._read=function(n){if(!this.length)return this.push(null);n=Math.min(n,this.length),this.push(this.slice(0,n)),this.consume(n)},o.prototype.end=function(n){r.prototype.end.call(this,n),this._callback&&(this._callback(null,this.slice()),this._callback=null)},o.prototype._destroy=function(n,a){this._bufs.length=0,this.length=0,a(n)},o.prototype._isBufferList=function(n){return n instanceof o||n instanceof p||o.isBufferList(n)},o.isBufferList=p.isBufferList,s.exports=o,s.exports.BufferListStream=o,s.exports.BufferList=p}),zu=E((e,s)=>{we(),_e(),M();var r=class{constructor(){this.cmd=null,this.retain=!1,this.qos=0,this.dup=!1,this.length=-1,this.topic=null,this.payload=null}};s.exports=r}),Ra=E((e,s)=>{we(),_e(),M();var r=s.exports,{Buffer:h}=(yt(),V(bt));r.types={0:"reserved",1:"connect",2:"connack",3:"publish",4:"puback",5:"pubrec",6:"pubrel",7:"pubcomp",8:"subscribe",9:"suback",10:"unsubscribe",11:"unsuback",12:"pingreq",13:"pingresp",14:"disconnect",15:"auth"},r.requiredHeaderFlags={1:0,2:0,4:0,5:0,6:2,7:0,8:2,9:0,10:2,11:0,12:0,13:0,14:0,15:0},r.requiredHeaderFlagsErrors={};for(let o in r.requiredHeaderFlags){let n=r.requiredHeaderFlags[o];r.requiredHeaderFlagsErrors[o]="Invalid header flag bits, must be 0x"+n.toString(16)+" for "+r.types[o]+" packet"}r.codes={};for(let o in r.types){let n=r.types[o];r.codes[n]=o}r.CMD_SHIFT=4,r.CMD_MASK=240,r.DUP_MASK=8,r.QOS_MASK=3,r.QOS_SHIFT=1,r.RETAIN_MASK=1,r.VARBYTEINT_MASK=127,r.VARBYTEINT_FIN_MASK=128,r.VARBYTEINT_MAX=268435455,r.SESSIONPRESENT_MASK=1,r.SESSIONPRESENT_HEADER=h.from([r.SESSIONPRESENT_MASK]),r.CONNACK_HEADER=h.from([r.codes.connack<<r.CMD_SHIFT]),r.USERNAME_MASK=128,r.PASSWORD_MASK=64,r.WILL_RETAIN_MASK=32,r.WILL_QOS_MASK=24,r.WILL_QOS_SHIFT=3,r.WILL_FLAG_MASK=4,r.CLEAN_SESSION_MASK=2,r.CONNECT_HEADER=h.from([r.codes.connect<<r.CMD_SHIFT]),r.properties={sessionExpiryInterval:17,willDelayInterval:24,receiveMaximum:33,maximumPacketSize:39,topicAliasMaximum:34,requestResponseInformation:25,requestProblemInformation:23,userProperties:38,authenticationMethod:21,authenticationData:22,payloadFormatIndicator:1,messageExpiryInterval:2,contentType:3,responseTopic:8,correlationData:9,maximumQoS:36,retainAvailable:37,assignedClientIdentifier:18,reasonString:31,wildcardSubscriptionAvailable:40,subscriptionIdentifiersAvailable:41,sharedSubscriptionAvailable:42,serverKeepAlive:19,responseInformation:26,serverReference:28,topicAlias:35,subscriptionIdentifier:11},r.propertiesCodes={};for(let o in r.properties){let n=r.properties[o];r.propertiesCodes[n]=o}r.propertiesTypes={sessionExpiryInterval:"int32",willDelayInterval:"int32",receiveMaximum:"int16",maximumPacketSize:"int32",topicAliasMaximum:"int16",requestResponseInformation:"byte",requestProblemInformation:"byte",userProperties:"pair",authenticationMethod:"string",authenticationData:"binary",payloadFormatIndicator:"byte",messageExpiryInterval:"int32",contentType:"string",responseTopic:"string",correlationData:"binary",maximumQoS:"int8",retainAvailable:"byte",assignedClientIdentifier:"string",reasonString:"string",wildcardSubscriptionAvailable:"byte",subscriptionIdentifiersAvailable:"byte",sharedSubscriptionAvailable:"byte",serverKeepAlive:"int16",responseInformation:"string",serverReference:"string",topicAlias:"int16",subscriptionIdentifier:"var"};function p(o){return[0,1,2].map(n=>[0,1].map(a=>[0,1].map(i=>{let c=h.alloc(1);return c.writeUInt8(r.codes[o]<<r.CMD_SHIFT|(a?r.DUP_MASK:0)|n<<r.QOS_SHIFT|i,0,!0),c})))}r.PUBLISH_HEADER=p("publish"),r.SUBSCRIBE_HEADER=p("subscribe"),r.SUBSCRIBE_OPTIONS_QOS_MASK=3,r.SUBSCRIBE_OPTIONS_NL_MASK=1,r.SUBSCRIBE_OPTIONS_NL_SHIFT=2,r.SUBSCRIBE_OPTIONS_RAP_MASK=1,r.SUBSCRIBE_OPTIONS_RAP_SHIFT=3,r.SUBSCRIBE_OPTIONS_RH_MASK=3,r.SUBSCRIBE_OPTIONS_RH_SHIFT=4,r.SUBSCRIBE_OPTIONS_RH=[0,16,32],r.SUBSCRIBE_OPTIONS_NL=4,r.SUBSCRIBE_OPTIONS_RAP=8,r.SUBSCRIBE_OPTIONS_QOS=[0,1,2],r.UNSUBSCRIBE_HEADER=p("unsubscribe"),r.ACKS={unsuback:p("unsuback"),puback:p("puback"),pubcomp:p("pubcomp"),pubrel:p("pubrel"),pubrec:p("pubrec")},r.SUBACK_HEADER=h.from([r.codes.suback<<r.CMD_SHIFT]),r.VERSION3=h.from([3]),r.VERSION4=h.from([4]),r.VERSION5=h.from([5]),r.VERSION131=h.from([131]),r.VERSION132=h.from([132]),r.QOS=[0,1,2].map(o=>h.from([o])),r.EMPTY={pingreq:h.from([r.codes.pingreq<<4,0]),pingresp:h.from([r.codes.pingresp<<4,0]),disconnect:h.from([r.codes.disconnect<<4,0])},r.MQTT5_PUBACK_PUBREC_CODES={0:"Success",16:"No matching subscribers",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",144:"Topic Name invalid",145:"Packet identifier in use",151:"Quota exceeded",153:"Payload format invalid"},r.MQTT5_PUBREL_PUBCOMP_CODES={0:"Success",146:"Packet Identifier not found"},r.MQTT5_SUBACK_CODES={0:"Granted QoS 0",1:"Granted QoS 1",2:"Granted QoS 2",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use",151:"Quota exceeded",158:"Shared Subscriptions not supported",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},r.MQTT5_UNSUBACK_CODES={0:"Success",17:"No subscription existed",128:"Unspecified error",131:"Implementation specific error",135:"Not authorized",143:"Topic Filter invalid",145:"Packet Identifier in use"},r.MQTT5_DISCONNECT_CODES={0:"Normal disconnection",4:"Disconnect with Will Message",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",135:"Not authorized",137:"Server busy",139:"Server shutting down",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"},r.MQTT5_AUTH_CODES={0:"Success",24:"Continue authentication",25:"Re-authenticate"}}),Ku=E((e,s)=>{we(),_e(),M();var r=1e3,h=r*60,p=h*60,o=p*24,n=o*7,a=o*365.25;s.exports=function(_,v){v=v||{};var S=typeof _;if(S==="string"&&_.length>0)return i(_);if(S==="number"&&isFinite(_))return v.long?g(_):c(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function i(_){if(_=String(_),!(_.length>100)){var v=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(v){var S=parseFloat(v[1]),C=(v[2]||"ms").toLowerCase();switch(C){case"years":case"year":case"yrs":case"yr":case"y":return S*a;case"weeks":case"week":case"w":return S*n;case"days":case"day":case"d":return S*o;case"hours":case"hour":case"hrs":case"hr":case"h":return S*p;case"minutes":case"minute":case"mins":case"min":case"m":return S*h;case"seconds":case"second":case"secs":case"sec":case"s":return S*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return S;default:return}}}}function c(_){var v=Math.abs(_);return v>=o?Math.round(_/o)+"d":v>=p?Math.round(_/p)+"h":v>=h?Math.round(_/h)+"m":v>=r?Math.round(_/r)+"s":_+"ms"}function g(_){var v=Math.abs(_);return v>=o?y(_,v,o,"day"):v>=p?y(_,v,p,"hour"):v>=h?y(_,v,h,"minute"):v>=r?y(_,v,r,"second"):_+" ms"}function y(_,v,S,C){var x=v>=S*1.5;return Math.round(_/S)+" "+C+(x?"s":"")}}),Ju=E((e,s)=>{we(),_e(),M();function r(h){o.debug=o,o.default=o,o.coerce=y,o.disable=i,o.enable=a,o.enabled=c,o.humanize=Ku(),o.destroy=_,Object.keys(h).forEach(v=>{o[v]=h[v]}),o.names=[],o.skips=[],o.formatters={};function p(v){let S=0;for(let C=0;C<v.length;C++)S=(S<<5)-S+v.charCodeAt(C),S|=0;return o.colors[Math.abs(S)%o.colors.length]}o.selectColor=p;function o(v){let S,C=null,x,H;function k(...P){if(!k.enabled)return;let K=k,Q=Number(new Date),j=Q-(S||Q);K.diff=j,K.prev=S,K.curr=Q,S=Q,P[0]=o.coerce(P[0]),typeof P[0]!="string"&&P.unshift("%O");let N=0;P[0]=P[0].replace(/%([a-zA-Z%])/g,($,X)=>{if($==="%%")return"%";N++;let ae=o.formatters[X];if(typeof ae=="function"){let pe=P[N];$=ae.call(K,pe),P.splice(N,1),N--}return $}),o.formatArgs.call(K,P),(K.log||o.log).apply(K,P)}return k.namespace=v,k.useColors=o.useColors(),k.color=o.selectColor(v),k.extend=n,k.destroy=o.destroy,Object.defineProperty(k,"enabled",{enumerable:!0,configurable:!1,get:()=>C!==null?C:(x!==o.namespaces&&(x=o.namespaces,H=o.enabled(v)),H),set:P=>{C=P}}),typeof o.init=="function"&&o.init(k),k}function n(v,S){let C=o(this.namespace+(typeof S>"u"?":":S)+v);return C.log=this.log,C}function a(v){o.save(v),o.namespaces=v,o.names=[],o.skips=[];let S,C=(typeof v=="string"?v:"").split(/[\s,]+/),x=C.length;for(S=0;S<x;S++)C[S]&&(v=C[S].replace(/\*/g,".*?"),v[0]==="-"?o.skips.push(new RegExp("^"+v.slice(1)+"$")):o.names.push(new RegExp("^"+v+"$")))}function i(){let v=[...o.names.map(g),...o.skips.map(g).map(S=>"-"+S)].join(",");return o.enable(""),v}function c(v){if(v[v.length-1]==="*")return!0;let S,C;for(S=0,C=o.skips.length;S<C;S++)if(o.skips[S].test(v))return!1;for(S=0,C=o.names.length;S<C;S++)if(o.names[S].test(v))return!0;return!1}function g(v){return v.toString().substring(2,v.toString().length-2).replace(/\.\*\?$/,"*")}function y(v){return v instanceof Error?v.stack||v.message:v}function _(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return o.enable(o.load()),o}s.exports=r}),Zt=E((e,s)=>{we(),_e(),M(),e.formatArgs=h,e.save=p,e.load=o,e.useColors=r,e.storage=n(),e.destroy=(()=>{let i=!1;return()=>{i||(i=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof se<"u"&&se.userAgent&&se.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof se<"u"&&se.userAgent&&se.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof se<"u"&&se.userAgent&&se.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function h(i){if(i[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+i[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;let c="color: "+this.color;i.splice(1,0,c,"color: inherit");let g=0,y=0;i[0].replace(/%[a-zA-Z%]/g,_=>{_!=="%%"&&(g++,_==="%c"&&(y=g))}),i.splice(y,0,c)}e.log=console.debug||console.log||(()=>{});function p(i){try{i?e.storage.setItem("debug",i):e.storage.removeItem("debug")}catch{}}function o(){let i;try{i=e.storage.getItem("debug")}catch{}return!i&&typeof Re<"u"&&"env"in Re&&(i=Re.env.DEBUG),i}function n(){try{return localStorage}catch{}}s.exports=Ju()(e);var{formatters:a}=s.exports;a.j=function(i){try{return JSON.stringify(i)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}}),Qu=E((e,s)=>{we(),_e(),M();var r=Vu(),{EventEmitter:h}=(Dr(),V(_r)),p=zu(),o=Ra(),n=Zt()("mqtt-packet:parser"),a=class ms extends h{constructor(){super(),this.parser=this.constructor.parser}static parser(c){return this instanceof ms?(this.settings=c||{},this._states=["_parseHeader","_parseLength","_parsePayload","_newPacket"],this._resetState(),this):new ms().parser(c)}_resetState(){n("_resetState: resetting packet, error, _list, and _stateCounter"),this.packet=new p,this.error=null,this._list=r(),this._stateCounter=0}parse(c){for(this.error&&this._resetState(),this._list.append(c),n("parse: current state: %s",this._states[this._stateCounter]);(this.packet.length!==-1||this._list.length>0)&&this[this._states[this._stateCounter]]()&&!this.error;)this._stateCounter++,n("parse: state complete. _stateCounter is now: %d",this._stateCounter),n("parse: packet.length: %d, buffer list length: %d",this.packet.length,this._list.length),this._stateCounter>=this._states.length&&(this._stateCounter=0);return n("parse: exited while loop. packet: %d, buffer list length: %d",this.packet.length,this._list.length),this._list.length}_parseHeader(){let c=this._list.readUInt8(0),g=c>>o.CMD_SHIFT;this.packet.cmd=o.types[g];let y=c&15,_=o.requiredHeaderFlags[g];return _!=null&&y!==_?this._emitError(new Error(o.requiredHeaderFlagsErrors[g])):(this.packet.retain=(c&o.RETAIN_MASK)!==0,this.packet.qos=c>>o.QOS_SHIFT&o.QOS_MASK,this.packet.qos>2?this._emitError(new Error("Packet must not have both QoS bits set to 1")):(this.packet.dup=(c&o.DUP_MASK)!==0,n("_parseHeader: packet: %o",this.packet),this._list.consume(1),!0))}_parseLength(){let c=this._parseVarByteNum(!0);return c&&(this.packet.length=c.value,this._list.consume(c.bytes)),n("_parseLength %d",c.value),!!c}_parsePayload(){n("_parsePayload: payload %O",this._list);let c=!1;if(this.packet.length===0||this._list.length>=this.packet.length){switch(this._pos=0,this.packet.cmd){case"connect":this._parseConnect();break;case"connack":this._parseConnack();break;case"publish":this._parsePublish();break;case"puback":case"pubrec":case"pubrel":case"pubcomp":this._parseConfirmation();break;case"subscribe":this._parseSubscribe();break;case"suback":this._parseSuback();break;case"unsubscribe":this._parseUnsubscribe();break;case"unsuback":this._parseUnsuback();break;case"pingreq":case"pingresp":break;case"disconnect":this._parseDisconnect();break;case"auth":this._parseAuth();break;default:this._emitError(new Error("Not supported"))}c=!0}return n("_parsePayload complete result: %s",c),c}_parseConnect(){n("_parseConnect");let c,g,y,_,v={},S=this.packet,C=this._parseString();if(C===null)return this._emitError(new Error("Cannot parse protocolId"));if(C!=="MQTT"&&C!=="MQIsdp")return this._emitError(new Error("Invalid protocolId"));if(S.protocolId=C,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(S.protocolVersion=this._list.readUInt8(this._pos),S.protocolVersion>=128&&(S.bridgeMode=!0,S.protocolVersion=S.protocolVersion-128),S.protocolVersion!==3&&S.protocolVersion!==4&&S.protocolVersion!==5)return this._emitError(new Error("Invalid protocol version"));if(this._pos++,this._pos>=this._list.length)return this._emitError(new Error("Packet too short"));if(this._list.readUInt8(this._pos)&1)return this._emitError(new Error("Connect flag bit 0 must be 0, but got 1"));v.username=this._list.readUInt8(this._pos)&o.USERNAME_MASK,v.password=this._list.readUInt8(this._pos)&o.PASSWORD_MASK,v.will=this._list.readUInt8(this._pos)&o.WILL_FLAG_MASK;let x=!!(this._list.readUInt8(this._pos)&o.WILL_RETAIN_MASK),H=(this._list.readUInt8(this._pos)&o.WILL_QOS_MASK)>>o.WILL_QOS_SHIFT;if(v.will)S.will={},S.will.retain=x,S.will.qos=H;else{if(x)return this._emitError(new Error("Will Retain Flag must be set to zero when Will Flag is set to 0"));if(H)return this._emitError(new Error("Will QoS must be set to zero when Will Flag is set to 0"))}if(S.clean=(this._list.readUInt8(this._pos)&o.CLEAN_SESSION_MASK)!==0,this._pos++,S.keepalive=this._parseNum(),S.keepalive===-1)return this._emitError(new Error("Packet too short"));if(S.protocolVersion===5){let P=this._parseProperties();Object.getOwnPropertyNames(P).length&&(S.properties=P)}let k=this._parseString();if(k===null)return this._emitError(new Error("Packet too short"));if(S.clientId=k,n("_parseConnect: packet.clientId: %s",S.clientId),v.will){if(S.protocolVersion===5){let P=this._parseProperties();Object.getOwnPropertyNames(P).length&&(S.will.properties=P)}if(c=this._parseString(),c===null)return this._emitError(new Error("Cannot parse will topic"));if(S.will.topic=c,n("_parseConnect: packet.will.topic: %s",S.will.topic),g=this._parseBuffer(),g===null)return this._emitError(new Error("Cannot parse will payload"));S.will.payload=g,n("_parseConnect: packet.will.paylaod: %s",S.will.payload)}if(v.username){if(_=this._parseString(),_===null)return this._emitError(new Error("Cannot parse username"));S.username=_,n("_parseConnect: packet.username: %s",S.username)}if(v.password){if(y=this._parseBuffer(),y===null)return this._emitError(new Error("Cannot parse password"));S.password=y}return this.settings=S,n("_parseConnect: complete"),S}_parseConnack(){n("_parseConnack");let c=this.packet;if(this._list.length<1)return null;let g=this._list.readUInt8(this._pos++);if(g>1)return this._emitError(new Error("Invalid connack flags, bits 7-1 must be set to 0"));if(c.sessionPresent=!!(g&o.SESSIONPRESENT_MASK),this.settings.protocolVersion===5)this._list.length>=2?c.reasonCode=this._list.readUInt8(this._pos++):c.reasonCode=0;else{if(this._list.length<2)return null;c.returnCode=this._list.readUInt8(this._pos++)}if(c.returnCode===-1||c.reasonCode===-1)return this._emitError(new Error("Cannot parse return code"));if(this.settings.protocolVersion===5){let y=this._parseProperties();Object.getOwnPropertyNames(y).length&&(c.properties=y)}n("_parseConnack: complete")}_parsePublish(){n("_parsePublish");let c=this.packet;if(c.topic=this._parseString(),c.topic===null)return this._emitError(new Error("Cannot parse topic"));if(!(c.qos>0&&!this._parseMessageId())){if(this.settings.protocolVersion===5){let g=this._parseProperties();Object.getOwnPropertyNames(g).length&&(c.properties=g)}c.payload=this._list.slice(this._pos,c.length),n("_parsePublish: payload from buffer list: %o",c.payload)}}_parseSubscribe(){n("_parseSubscribe");let c=this.packet,g,y,_,v,S,C,x;if(c.subscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let H=this._parseProperties();Object.getOwnPropertyNames(H).length&&(c.properties=H)}if(c.length<=0)return this._emitError(new Error("Malformed subscribe, no payload specified"));for(;this._pos<c.length;){if(g=this._parseString(),g===null)return this._emitError(new Error("Cannot parse topic"));if(this._pos>=c.length)return this._emitError(new Error("Malformed Subscribe Payload"));if(y=this._parseByte(),this.settings.protocolVersion===5){if(y&192)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-6 must be 0"))}else if(y&252)return this._emitError(new Error("Invalid subscribe topic flag bits, bits 7-2 must be 0"));if(_=y&o.SUBSCRIBE_OPTIONS_QOS_MASK,_>2)return this._emitError(new Error("Invalid subscribe QoS, must be <= 2"));if(C=(y>>o.SUBSCRIBE_OPTIONS_NL_SHIFT&o.SUBSCRIBE_OPTIONS_NL_MASK)!==0,S=(y>>o.SUBSCRIBE_OPTIONS_RAP_SHIFT&o.SUBSCRIBE_OPTIONS_RAP_MASK)!==0,v=y>>o.SUBSCRIBE_OPTIONS_RH_SHIFT&o.SUBSCRIBE_OPTIONS_RH_MASK,v>2)return this._emitError(new Error("Invalid retain handling, must be <= 2"));x={topic:g,qos:_},this.settings.protocolVersion===5?(x.nl=C,x.rap=S,x.rh=v):this.settings.bridgeMode&&(x.rh=0,x.rap=!0,x.nl=!0),n("_parseSubscribe: push subscription `%s` to subscription",x),c.subscriptions.push(x)}}}_parseSuback(){n("_parseSuback");let c=this.packet;if(this.packet.granted=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let g=this._parseProperties();Object.getOwnPropertyNames(g).length&&(c.properties=g)}if(c.length<=0)return this._emitError(new Error("Malformed suback, no payload specified"));for(;this._pos<this.packet.length;){let g=this._list.readUInt8(this._pos++);if(this.settings.protocolVersion===5){if(!o.MQTT5_SUBACK_CODES[g])return this._emitError(new Error("Invalid suback code"))}else if(g>2&&g!==128)return this._emitError(new Error("Invalid suback QoS, must be 0, 1, 2 or 128"));this.packet.granted.push(g)}}}_parseUnsubscribe(){n("_parseUnsubscribe");let c=this.packet;if(c.unsubscriptions=[],!!this._parseMessageId()){if(this.settings.protocolVersion===5){let g=this._parseProperties();Object.getOwnPropertyNames(g).length&&(c.properties=g)}if(c.length<=0)return this._emitError(new Error("Malformed unsubscribe, no payload specified"));for(;this._pos<c.length;){let g=this._parseString();if(g===null)return this._emitError(new Error("Cannot parse topic"));n("_parseUnsubscribe: push topic `%s` to unsubscriptions",g),c.unsubscriptions.push(g)}}}_parseUnsuback(){n("_parseUnsuback");let c=this.packet;if(!this._parseMessageId())return this._emitError(new Error("Cannot parse messageId"));if((this.settings.protocolVersion===3||this.settings.protocolVersion===4)&&c.length!==2)return this._emitError(new Error("Malformed unsuback, payload length must be 2"));if(c.length<=0)return this._emitError(new Error("Malformed unsuback, no payload specified"));if(this.settings.protocolVersion===5){let g=this._parseProperties();for(Object.getOwnPropertyNames(g).length&&(c.properties=g),c.granted=[];this._pos<this.packet.length;){let y=this._list.readUInt8(this._pos++);if(!o.MQTT5_UNSUBACK_CODES[y])return this._emitError(new Error("Invalid unsuback code"));this.packet.granted.push(y)}}}_parseConfirmation(){n("_parseConfirmation: packet.cmd: `%s`",this.packet.cmd);let c=this.packet;if(this._parseMessageId(),this.settings.protocolVersion===5){if(c.length>2){switch(c.reasonCode=this._parseByte(),this.packet.cmd){case"puback":case"pubrec":if(!o.MQTT5_PUBACK_PUBREC_CODES[c.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break;case"pubrel":case"pubcomp":if(!o.MQTT5_PUBREL_PUBCOMP_CODES[c.reasonCode])return this._emitError(new Error("Invalid "+this.packet.cmd+" reason code"));break}n("_parseConfirmation: packet.reasonCode `%d`",c.reasonCode)}else c.reasonCode=0;if(c.length>3){let g=this._parseProperties();Object.getOwnPropertyNames(g).length&&(c.properties=g)}}return!0}_parseDisconnect(){let c=this.packet;if(n("_parseDisconnect"),this.settings.protocolVersion===5){this._list.length>0?(c.reasonCode=this._parseByte(),o.MQTT5_DISCONNECT_CODES[c.reasonCode]||this._emitError(new Error("Invalid disconnect reason code"))):c.reasonCode=0;let g=this._parseProperties();Object.getOwnPropertyNames(g).length&&(c.properties=g)}return n("_parseDisconnect result: true"),!0}_parseAuth(){n("_parseAuth");let c=this.packet;if(this.settings.protocolVersion!==5)return this._emitError(new Error("Not supported auth packet for this version MQTT"));if(c.reasonCode=this._parseByte(),!o.MQTT5_AUTH_CODES[c.reasonCode])return this._emitError(new Error("Invalid auth reason code"));let g=this._parseProperties();return Object.getOwnPropertyNames(g).length&&(c.properties=g),n("_parseAuth: result: true"),!0}_parseMessageId(){let c=this.packet;return c.messageId=this._parseNum(),c.messageId===null?(this._emitError(new Error("Cannot parse messageId")),!1):(n("_parseMessageId: packet.messageId %d",c.messageId),!0)}_parseString(c){let g=this._parseNum(),y=g+this._pos;if(g===-1||y>this._list.length||y>this.packet.length)return null;let _=this._list.toString("utf8",this._pos,y);return this._pos+=g,n("_parseString: result: %s",_),_}_parseStringPair(){return n("_parseStringPair"),{name:this._parseString(),value:this._parseString()}}_parseBuffer(){let c=this._parseNum(),g=c+this._pos;if(c===-1||g>this._list.length||g>this.packet.length)return null;let y=this._list.slice(this._pos,g);return this._pos+=c,n("_parseBuffer: result: %o",y),y}_parseNum(){if(this._list.length-this._pos<2)return-1;let c=this._list.readUInt16BE(this._pos);return this._pos+=2,n("_parseNum: result: %s",c),c}_parse4ByteNum(){if(this._list.length-this._pos<4)return-1;let c=this._list.readUInt32BE(this._pos);return this._pos+=4,n("_parse4ByteNum: result: %s",c),c}_parseVarByteNum(c){n("_parseVarByteNum");let g=4,y=0,_=1,v=0,S=!1,C,x=this._pos?this._pos:0;for(;y<g&&x+y<this._list.length;){if(C=this._list.readUInt8(x+y++),v+=_*(C&o.VARBYTEINT_MASK),_*=128,!(C&o.VARBYTEINT_FIN_MASK)){S=!0;break}if(this._list.length<=y)break}return!S&&y===g&&this._list.length>=y&&this._emitError(new Error("Invalid variable byte integer")),x&&(this._pos+=y),S?c?S={bytes:y,value:v}:S=v:S=!1,n("_parseVarByteNum: result: %o",S),S}_parseByte(){let c;return this._pos<this._list.length&&(c=this._list.readUInt8(this._pos),this._pos++),n("_parseByte: result: %o",c),c}_parseByType(c){switch(n("_parseByType: type: %s",c),c){case"byte":return this._parseByte()!==0;case"int8":return this._parseByte();case"int16":return this._parseNum();case"int32":return this._parse4ByteNum();case"var":return this._parseVarByteNum();case"string":return this._parseString();case"pair":return this._parseStringPair();case"binary":return this._parseBuffer()}}_parseProperties(){n("_parseProperties");let c=this._parseVarByteNum(),g=this._pos+c,y={};for(;this._pos<g;){let _=this._parseByte();if(!_)return this._emitError(new Error("Cannot parse property code type")),!1;let v=o.propertiesCodes[_];if(!v)return this._emitError(new Error("Unknown property")),!1;if(v==="userProperties"){y[v]||(y[v]=Object.create(null));let S=this._parseByType(o.propertiesTypes[v]);if(y[v][S.name])if(Array.isArray(y[v][S.name]))y[v][S.name].push(S.value);else{let C=y[v][S.name];y[v][S.name]=[C],y[v][S.name].push(S.value)}else y[v][S.name]=S.value;continue}y[v]?Array.isArray(y[v])?y[v].push(this._parseByType(o.propertiesTypes[v])):(y[v]=[y[v]],y[v].push(this._parseByType(o.propertiesTypes[v]))):y[v]=this._parseByType(o.propertiesTypes[v])}return y}_newPacket(){return n("_newPacket"),this.packet&&(this._list.consume(this.packet.length),n("_newPacket: parser emit packet: packet.cmd: %s, packet.payload: %s, packet.length: %d",this.packet.cmd,this.packet.payload,this.packet.length),this.emit("packet",this.packet)),n("_newPacket: new packet"),this.packet=new p,this._pos=0,!0}_emitError(c){n("_emitError",c),this.error=c,this.emit("error",c)}};s.exports=a}),Yu=E((e,s)=>{we(),_e(),M();var{Buffer:r}=(yt(),V(bt)),h=65536,p={},o=r.isBuffer(r.from([1,2]).subarray(0,1));function n(g){let y=r.allocUnsafe(2);return y.writeUInt8(g>>8,0),y.writeUInt8(g&255,1),y}function a(){for(let g=0;g<h;g++)p[g]=n(g)}function i(g){let y=0,_=0,v=r.allocUnsafe(4);do y=g%128|0,g=g/128|0,g>0&&(y=y|128),v.writeUInt8(y,_++);while(g>0&&_<4);return g>0&&(_=0),o?v.subarray(0,_):v.slice(0,_)}function c(g){let y=r.allocUnsafe(4);return y.writeUInt32BE(g,0),y}s.exports={cache:p,generateCache:a,generateNumber:n,genBufVariableByteInt:i,generate4ByteBuffer:c}}),Gu=E((e,s)=>{we(),_e(),M(),typeof Re>"u"||!Re.version||Re.version.indexOf("v0.")===0||Re.version.indexOf("v1.")===0&&Re.version.indexOf("v1.8.")!==0?s.exports={nextTick:r}:s.exports=Re;function r(h,p,o,n){if(typeof h!="function")throw new TypeError('"callback" argument must be a function');var a=arguments.length,i,c;switch(a){case 0:case 1:return Re.nextTick(h);case 2:return Re.nextTick(function(){h.call(null,p)});case 3:return Re.nextTick(function(){h.call(null,p,o)});case 4:return Re.nextTick(function(){h.call(null,p,o,n)});default:for(i=new Array(a-1),c=0;c<i.length;)i[c++]=arguments[c];return Re.nextTick(function(){h.apply(null,i)})}}}),Oa=E((e,s)=>{we(),_e(),M();var r=Ra(),{Buffer:h}=(yt(),V(bt)),p=h.allocUnsafe(0),o=h.from([0]),n=Yu(),a=Gu().nextTick,i=Zt()("mqtt-packet:writeToStream"),c=n.cache,g=n.generateNumber,y=n.generateCache,_=n.genBufVariableByteInt,v=n.generate4ByteBuffer,S=ye,C=!0;function x(F,R,ne){switch(i("generate called"),R.cork&&(R.cork(),a(H,R)),C&&(C=!1,y()),i("generate: packet.cmd: %s",F.cmd),F.cmd){case"connect":return k(F,R);case"connack":return P(F,R,ne);case"publish":return K(F,R,ne);case"puback":case"pubrec":case"pubrel":case"pubcomp":return Q(F,R,ne);case"subscribe":return j(F,R,ne);case"suback":return N(F,R,ne);case"unsubscribe":return $(F,R,ne);case"unsuback":return X(F,R,ne);case"pingreq":case"pingresp":return ae(F,R);case"disconnect":return pe(F,R,ne);case"auth":return O(F,R,ne);default:return R.destroy(new Error("Unknown command")),!1}}Object.defineProperty(x,"cacheNumbers",{get(){return S===ye},set(F){F?((!c||Object.keys(c).length===0)&&(C=!0),S=ye):(C=!1,S=ee)}});function H(F){F.uncork()}function k(F,R,ne){let Se=F||{},fe=Se.protocolId||"MQTT",ue=Se.protocolVersion||4,Pe=Se.will,Te=Se.clean,L=Se.keepalive||0,J=Se.clientId||"",Y=Se.username,me=Se.password,ce=Se.properties;Te===void 0&&(Te=!0);let q=0;if(!fe||typeof fe!="string"&&!h.isBuffer(fe))return R.destroy(new Error("Invalid protocolId")),!1;if(q+=fe.length+2,ue!==3&&ue!==4&&ue!==5)return R.destroy(new Error("Invalid protocol version")),!1;if(q+=1,(typeof J=="string"||h.isBuffer(J))&&(J||ue>=4)&&(J||Te))q+=h.byteLength(J)+2;else{if(ue<4)return R.destroy(new Error("clientId must be supplied before 3.1.1")),!1;if(Te*1===0)return R.destroy(new Error("clientId must be given if cleanSession set to 0")),!1}if(typeof L!="number"||L<0||L>65535||L%1!==0)return R.destroy(new Error("Invalid keepalive")),!1;q+=2,q+=1;let re,U;if(ue===5){if(re=Ne(R,ce),!re)return!1;q+=re.length}if(Pe){if(typeof Pe!="object")return R.destroy(new Error("Invalid will")),!1;if(!Pe.topic||typeof Pe.topic!="string")return R.destroy(new Error("Invalid will topic")),!1;if(q+=h.byteLength(Pe.topic)+2,q+=2,Pe.payload)if(Pe.payload.length>=0)typeof Pe.payload=="string"?q+=h.byteLength(Pe.payload):q+=Pe.payload.length;else return R.destroy(new Error("Invalid will payload")),!1;if(U={},ue===5){if(U=Ne(R,Pe.properties),!U)return!1;q+=U.length}}let z=!1;if(Y!=null)if(Ee(Y))z=!0,q+=h.byteLength(Y)+2;else return R.destroy(new Error("Invalid username")),!1;if(me!=null){if(!z)return R.destroy(new Error("Username is required to use password")),!1;if(Ee(me))q+=Me(me)+2;else return R.destroy(new Error("Invalid password")),!1}R.write(r.CONNECT_HEADER),de(R,q),be(R,fe),Se.bridgeMode&&(ue+=128),R.write(ue===131?r.VERSION131:ue===132?r.VERSION132:ue===4?r.VERSION4:ue===5?r.VERSION5:r.VERSION3);let Z=0;return Z|=Y!=null?r.USERNAME_MASK:0,Z|=me!=null?r.PASSWORD_MASK:0,Z|=Pe&&Pe.retain?r.WILL_RETAIN_MASK:0,Z|=Pe&&Pe.qos?Pe.qos<<r.WILL_QOS_SHIFT:0,Z|=Pe?r.WILL_FLAG_MASK:0,Z|=Te?r.CLEAN_SESSION_MASK:0,R.write(h.from([Z])),S(R,L),ue===5&&re.write(),be(R,J),Pe&&(ue===5&&U.write(),ie(R,Pe.topic),be(R,Pe.payload)),Y!=null&&be(R,Y),me!=null&&be(R,me),!0}function P(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=Se===5?fe.reasonCode:fe.returnCode,Pe=fe.properties,Te=2;if(typeof ue!="number")return R.destroy(new Error("Invalid return code")),!1;let L=null;if(Se===5){if(L=Ne(R,Pe),!L)return!1;Te+=L.length}return R.write(r.CONNACK_HEADER),de(R,Te),R.write(fe.sessionPresent?r.SESSIONPRESENT_HEADER:o),R.write(h.from([ue])),L==null||L.write(),!0}function K(F,R,ne){i("publish: packet: %o",F);let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.qos||0,Pe=fe.retain?r.RETAIN_MASK:0,Te=fe.topic,L=fe.payload||p,J=fe.messageId,Y=fe.properties,me=0;if(typeof Te=="string")me+=h.byteLength(Te)+2;else if(h.isBuffer(Te))me+=Te.length+2;else return R.destroy(new Error("Invalid topic")),!1;if(h.isBuffer(L)?me+=L.length:me+=h.byteLength(L),ue&&typeof J!="number")return R.destroy(new Error("Invalid messageId")),!1;ue&&(me+=2);let ce=null;if(Se===5){if(ce=Ne(R,Y),!ce)return!1;me+=ce.length}return R.write(r.PUBLISH_HEADER[ue][fe.dup?1:0][Pe?1:0]),de(R,me),S(R,Me(Te)),R.write(Te),ue>0&&S(R,J),ce==null||ce.write(),i("publish: payload: %o",L),R.write(L)}function Q(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.cmd||"puback",Pe=fe.messageId,Te=fe.dup&&ue==="pubrel"?r.DUP_MASK:0,L=0,J=fe.reasonCode,Y=fe.properties,me=Se===5?3:2;if(ue==="pubrel"&&(L=1),typeof Pe!="number")return R.destroy(new Error("Invalid messageId")),!1;let ce=null;if(Se===5&&typeof Y=="object"){if(ce=T(R,Y,ne,me),!ce)return!1;me+=ce.length}return R.write(r.ACKS[ue][L][Te][0]),me===3&&(me+=J!==0?1:-1),de(R,me),S(R,Pe),Se===5&&me!==2&&R.write(h.from([J])),ce!==null?ce.write():me===4&&R.write(h.from([0])),!0}function j(F,R,ne){i("subscribe: packet: ");let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.dup?r.DUP_MASK:0,Pe=fe.messageId,Te=fe.subscriptions,L=fe.properties,J=0;if(typeof Pe!="number")return R.destroy(new Error("Invalid messageId")),!1;J+=2;let Y=null;if(Se===5){if(Y=Ne(R,L),!Y)return!1;J+=Y.length}if(typeof Te=="object"&&Te.length)for(let ce=0;ce<Te.length;ce+=1){let q=Te[ce].topic,re=Te[ce].qos;if(typeof q!="string")return R.destroy(new Error("Invalid subscriptions - invalid topic")),!1;if(typeof re!="number")return R.destroy(new Error("Invalid subscriptions - invalid qos")),!1;if(Se===5){if(typeof(Te[ce].nl||!1)!="boolean")return R.destroy(new Error("Invalid subscriptions - invalid No Local")),!1;if(typeof(Te[ce].rap||!1)!="boolean")return R.destroy(new Error("Invalid subscriptions - invalid Retain as Published")),!1;let U=Te[ce].rh||0;if(typeof U!="number"||U>2)return R.destroy(new Error("Invalid subscriptions - invalid Retain Handling")),!1}J+=h.byteLength(q)+2+1}else return R.destroy(new Error("Invalid subscriptions")),!1;i("subscribe: writing to stream: %o",r.SUBSCRIBE_HEADER),R.write(r.SUBSCRIBE_HEADER[1][ue?1:0][0]),de(R,J),S(R,Pe),Y!==null&&Y.write();let me=!0;for(let ce of Te){let q=ce.topic,re=ce.qos,U=+ce.nl,z=+ce.rap,Z=ce.rh,ve;ie(R,q),ve=r.SUBSCRIBE_OPTIONS_QOS[re],Se===5&&(ve|=U?r.SUBSCRIBE_OPTIONS_NL:0,ve|=z?r.SUBSCRIBE_OPTIONS_RAP:0,ve|=Z?r.SUBSCRIBE_OPTIONS_RH[Z]:0),me=R.write(h.from([ve]))}return me}function N(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.messageId,Pe=fe.granted,Te=fe.properties,L=0;if(typeof ue!="number")return R.destroy(new Error("Invalid messageId")),!1;if(L+=2,typeof Pe=="object"&&Pe.length)for(let Y=0;Y<Pe.length;Y+=1){if(typeof Pe[Y]!="number")return R.destroy(new Error("Invalid qos vector")),!1;L+=1}else return R.destroy(new Error("Invalid qos vector")),!1;let J=null;if(Se===5){if(J=T(R,Te,ne,L),!J)return!1;L+=J.length}return R.write(r.SUBACK_HEADER),de(R,L),S(R,ue),J!==null&&J.write(),R.write(h.from(Pe))}function $(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.messageId,Pe=fe.dup?r.DUP_MASK:0,Te=fe.unsubscriptions,L=fe.properties,J=0;if(typeof ue!="number")return R.destroy(new Error("Invalid messageId")),!1;if(J+=2,typeof Te=="object"&&Te.length)for(let ce=0;ce<Te.length;ce+=1){if(typeof Te[ce]!="string")return R.destroy(new Error("Invalid unsubscriptions")),!1;J+=h.byteLength(Te[ce])+2}else return R.destroy(new Error("Invalid unsubscriptions")),!1;let Y=null;if(Se===5){if(Y=Ne(R,L),!Y)return!1;J+=Y.length}R.write(r.UNSUBSCRIBE_HEADER[1][Pe?1:0][0]),de(R,J),S(R,ue),Y!==null&&Y.write();let me=!0;for(let ce=0;ce<Te.length;ce++)me=ie(R,Te[ce]);return me}function X(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.messageId,Pe=fe.dup?r.DUP_MASK:0,Te=fe.granted,L=fe.properties,J=fe.cmd,Y=0,me=2;if(typeof ue!="number")return R.destroy(new Error("Invalid messageId")),!1;if(Se===5)if(typeof Te=="object"&&Te.length)for(let q=0;q<Te.length;q+=1){if(typeof Te[q]!="number")return R.destroy(new Error("Invalid qos vector")),!1;me+=1}else return R.destroy(new Error("Invalid qos vector")),!1;let ce=null;if(Se===5){if(ce=T(R,L,ne,me),!ce)return!1;me+=ce.length}return R.write(r.ACKS[J][Y][Pe][0]),de(R,me),S(R,ue),ce!==null&&ce.write(),Se===5&&R.write(h.from(Te)),!0}function ae(F,R,ne){return R.write(r.EMPTY[F.cmd])}function pe(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.reasonCode,Pe=fe.properties,Te=Se===5?1:0,L=null;if(Se===5){if(L=T(R,Pe,ne,Te),!L)return!1;Te+=L.length}return R.write(h.from([r.codes.disconnect<<4])),de(R,Te),Se===5&&R.write(h.from([ue])),L!==null&&L.write(),!0}function O(F,R,ne){let Se=ne?ne.protocolVersion:4,fe=F||{},ue=fe.reasonCode,Pe=fe.properties,Te=Se===5?1:0;Se!==5&&R.destroy(new Error("Invalid mqtt version for auth packet"));let L=T(R,Pe,ne,Te);return L?(Te+=L.length,R.write(h.from([r.codes.auth<<4])),de(R,Te),R.write(h.from([ue])),L!==null&&L.write(),!0):!1}var te={};function de(F,R){if(R>r.VARBYTEINT_MAX)return F.destroy(new Error(`Invalid variable byte integer: ${R}`)),!1;let ne=te[R];return ne||(ne=_(R),R<16384&&(te[R]=ne)),i("writeVarByteInt: writing to stream: %o",ne),F.write(ne)}function ie(F,R){let ne=h.byteLength(R);return S(F,ne),i("writeString: %s",R),F.write(R,"utf8")}function ke(F,R,ne){ie(F,R),ie(F,ne)}function ye(F,R){return i("writeNumberCached: number: %d",R),i("writeNumberCached: %o",c[R]),F.write(c[R])}function ee(F,R){let ne=g(R);return i("writeNumberGenerated: %o",ne),F.write(ne)}function Oe(F,R){let ne=v(R);return i("write4ByteNumber: %o",ne),F.write(ne)}function be(F,R){typeof R=="string"?ie(F,R):R?(S(F,R.length),F.write(R)):S(F,0)}function Ne(F,R){if(typeof R!="object"||R.length!=null)return{length:1,write(){Ae(F,{},0)}};let ne=0;function Se(fe,ue){let Pe=r.propertiesTypes[fe],Te=0;switch(Pe){case"byte":{if(typeof ue!="boolean")return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=2;break}case"int8":{if(typeof ue!="number"||ue<0||ue>255)return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=2;break}case"binary":{if(ue&&ue===null)return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=1+h.byteLength(ue)+2;break}case"int16":{if(typeof ue!="number"||ue<0||ue>65535)return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=3;break}case"int32":{if(typeof ue!="number"||ue<0||ue>4294967295)return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=5;break}case"var":{if(typeof ue!="number"||ue<0||ue>268435455)return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=1+h.byteLength(_(ue));break}case"string":{if(typeof ue!="string")return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=3+h.byteLength(ue.toString());break}case"pair":{if(typeof ue!="object")return F.destroy(new Error(`Invalid ${fe}: ${ue}`)),!1;Te+=Object.getOwnPropertyNames(ue).reduce((L,J)=>{let Y=ue[J];return Array.isArray(Y)?L+=Y.reduce((me,ce)=>(me+=3+h.byteLength(J.toString())+2+h.byteLength(ce.toString()),me),0):L+=3+h.byteLength(J.toString())+2+h.byteLength(ue[J].toString()),L},0);break}default:return F.destroy(new Error(`Invalid property ${fe}: ${ue}`)),!1}return Te}if(R)for(let fe in R){let ue=0,Pe=0,Te=R[fe];if(Array.isArray(Te))for(let L=0;L<Te.length;L++){if(Pe=Se(fe,Te[L]),!Pe)return!1;ue+=Pe}else{if(Pe=Se(fe,Te),!Pe)return!1;ue=Pe}if(!ue)return!1;ne+=ue}return{length:h.byteLength(_(ne))+ne,write(){Ae(F,R,ne)}}}function T(F,R,ne,Se){let fe=["reasonString","userProperties"],ue=ne&&ne.properties&&ne.properties.maximumPacketSize?ne.properties.maximumPacketSize:0,Pe=Ne(F,R);if(ue)for(;Se+Pe.length>ue;){let Te=fe.shift();if(Te&&R[Te])delete R[Te],Pe=Ne(F,R);else return!1}return Pe}function oe(F,R,ne){switch(r.propertiesTypes[R]){case"byte":{F.write(h.from([r.properties[R]])),F.write(h.from([+ne]));break}case"int8":{F.write(h.from([r.properties[R]])),F.write(h.from([ne]));break}case"binary":{F.write(h.from([r.properties[R]])),be(F,ne);break}case"int16":{F.write(h.from([r.properties[R]])),S(F,ne);break}case"int32":{F.write(h.from([r.properties[R]])),Oe(F,ne);break}case"var":{F.write(h.from([r.properties[R]])),de(F,ne);break}case"string":{F.write(h.from([r.properties[R]])),ie(F,ne);break}case"pair":{Object.getOwnPropertyNames(ne).forEach(Se=>{let fe=ne[Se];Array.isArray(fe)?fe.forEach(ue=>{F.write(h.from([r.properties[R]])),ke(F,Se.toString(),ue.toString())}):(F.write(h.from([r.properties[R]])),ke(F,Se.toString(),fe.toString()))});break}default:return F.destroy(new Error(`Invalid property ${R} value: ${ne}`)),!1}}function Ae(F,R,ne){de(F,ne);for(let Se in R)if(Object.prototype.hasOwnProperty.call(R,Se)&&R[Se]!==null){let fe=R[Se];if(Array.isArray(fe))for(let ue=0;ue<fe.length;ue++)oe(F,Se,fe[ue]);else oe(F,Se,fe)}}function Me(F){return F?F instanceof h?F.length:h.byteLength(F):0}function Ee(F){return typeof F=="string"||F instanceof h}s.exports=x}),Xu=E((e,s)=>{we(),_e(),M();var r=Oa(),{EventEmitter:h}=(Dr(),V(_r)),{Buffer:p}=(yt(),V(bt));function o(a,i){let c=new n;return r(a,c,i),c.concat()}var n=class extends h{constructor(){super(),this._array=new Array(20),this._i=0}write(a){return this._array[this._i++]=a,!0}concat(){let a=0,i=new Array(this._array.length),c=this._array,g=0,y;for(y=0;y<c.length&&c[y]!==void 0;y++)typeof c[y]!="string"?i[y]=c[y].length:i[y]=p.byteLength(c[y]),a+=i[y];let _=p.allocUnsafe(a);for(y=0;y<c.length&&c[y]!==void 0;y++)typeof c[y]!="string"?(c[y].copy(_,g),g+=i[y]):(_.write(c[y],g),g+=i[y]);return _}destroy(a){a&&this.emit("error",a)}};s.exports=o}),Zu=E(e=>{we(),_e(),M(),e.parser=Qu().parser,e.generate=Xu(),e.writeToStream=Oa()}),Pa=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=class{constructor(){this.nextId=Math.max(1,Math.floor(Math.random()*65535))}allocate(){let r=this.nextId++;return this.nextId===65536&&(this.nextId=1),r}getLastAllocated(){return this.nextId===1?65535:this.nextId-1}register(r){return!0}deallocate(r){}clear(){}};e.default=s}),eh=E((e,s)=>{we(),_e(),M(),s.exports=h;function r(o){return o instanceof dn?dn.from(o):new o.constructor(o.buffer.slice(),o.byteOffset,o.length)}function h(o){if(o=o||{},o.circles)return p(o);return o.proto?i:a;function n(c,g){for(var y=Object.keys(c),_=new Array(y.length),v=0;v<y.length;v++){var S=y[v],C=c[S];typeof C!="object"||C===null?_[S]=C:C instanceof Date?_[S]=new Date(C):ArrayBuffer.isView(C)?_[S]=r(C):_[S]=g(C)}return _}function a(c){if(typeof c!="object"||c===null)return c;if(c instanceof Date)return new Date(c);if(Array.isArray(c))return n(c,a);if(c instanceof Map)return new Map(n(Array.from(c),a));if(c instanceof Set)return new Set(n(Array.from(c),a));var g={};for(var y in c)if(Object.hasOwnProperty.call(c,y)!==!1){var _=c[y];typeof _!="object"||_===null?g[y]=_:_ instanceof Date?g[y]=new Date(_):_ instanceof Map?g[y]=new Map(n(Array.from(_),a)):_ instanceof Set?g[y]=new Set(n(Array.from(_),a)):ArrayBuffer.isView(_)?g[y]=r(_):g[y]=a(_)}return g}function i(c){if(typeof c!="object"||c===null)return c;if(c instanceof Date)return new Date(c);if(Array.isArray(c))return n(c,i);if(c instanceof Map)return new Map(n(Array.from(c),i));if(c instanceof Set)return new Set(n(Array.from(c),i));var g={};for(var y in c){var _=c[y];typeof _!="object"||_===null?g[y]=_:_ instanceof Date?g[y]=new Date(_):_ instanceof Map?g[y]=new Map(n(Array.from(_),i)):_ instanceof Set?g[y]=new Set(n(Array.from(_),i)):ArrayBuffer.isView(_)?g[y]=r(_):g[y]=i(_)}return g}}function p(o){var n=[],a=[];return o.proto?g:c;function i(y,_){for(var v=Object.keys(y),S=new Array(v.length),C=0;C<v.length;C++){var x=v[C],H=y[x];if(typeof H!="object"||H===null)S[x]=H;else if(H instanceof Date)S[x]=new Date(H);else if(ArrayBuffer.isView(H))S[x]=r(H);else{var k=n.indexOf(H);k!==-1?S[x]=a[k]:S[x]=_(H)}}return S}function c(y){if(typeof y!="object"||y===null)return y;if(y instanceof Date)return new Date(y);if(Array.isArray(y))return i(y,c);if(y instanceof Map)return new Map(i(Array.from(y),c));if(y instanceof Set)return new Set(i(Array.from(y),c));var _={};n.push(y),a.push(_);for(var v in y)if(Object.hasOwnProperty.call(y,v)!==!1){var S=y[v];if(typeof S!="object"||S===null)_[v]=S;else if(S instanceof Date)_[v]=new Date(S);else if(S instanceof Map)_[v]=new Map(i(Array.from(S),c));else if(S instanceof Set)_[v]=new Set(i(Array.from(S),c));else if(ArrayBuffer.isView(S))_[v]=r(S);else{var C=n.indexOf(S);C!==-1?_[v]=a[C]:_[v]=c(S)}}return n.pop(),a.pop(),_}function g(y){if(typeof y!="object"||y===null)return y;if(y instanceof Date)return new Date(y);if(Array.isArray(y))return i(y,g);if(y instanceof Map)return new Map(i(Array.from(y),g));if(y instanceof Set)return new Set(i(Array.from(y),g));var _={};n.push(y),a.push(_);for(var v in y){var S=y[v];if(typeof S!="object"||S===null)_[v]=S;else if(S instanceof Date)_[v]=new Date(S);else if(S instanceof Map)_[v]=new Map(i(Array.from(S),g));else if(S instanceof Set)_[v]=new Set(i(Array.from(S),g));else if(ArrayBuffer.isView(S))_[v]=r(S);else{var C=n.indexOf(S);C!==-1?_[v]=a[C]:_[v]=g(S)}}return n.pop(),a.pop(),_}}}),th=E((e,s)=>{we(),_e(),M(),s.exports=eh()()}),rh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.validateTopics=e.validateTopic=void 0;function s(h){let p=h.split("/");for(let o=0;o<p.length;o++)if(p[o]!=="+"){if(p[o]==="#")return o===p.length-1;if(p[o].indexOf("+")!==-1||p[o].indexOf("#")!==-1)return!1}return!0}e.validateTopic=s;function r(h){if(h.length===0)return"empty_topic_list";for(let p=0;p<h.length;p++)if(!s(h[p]))return h[p];return null}e.validateTopics=r}),xa=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=Ar(),r={objectMode:!0},h={clean:!0},p=class{constructor(o){this.options=o||{},this.options=Object.assign(Object.assign({},h),o),this._inflights=new Map}put(o,n){return this._inflights.set(o.messageId,o),n&&n(),this}createStream(){let o=new s.Readable(r),n=[],a=!1,i=0;return this._inflights.forEach((c,g)=>{n.push(c)}),o._read=()=>{!a&&i<n.length?o.push(n[i++]):o.push(null)},o.destroy=c=>{if(!a)return a=!0,setTimeout(()=>{o.emit("close")},0),o},o}del(o,n){let a=this._inflights.get(o.messageId);return a?(this._inflights.delete(o.messageId),n(null,a)):n&&n(new Error("missing packet")),this}get(o,n){let a=this._inflights.get(o.messageId);return a?n(null,a):n&&n(new Error("missing packet")),this}close(o){this.options.clean&&(this._inflights=null),o&&o()}};e.default=p}),nh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=[0,16,128,131,135,144,145,151,153],r=(h,p,o)=>{h.log("handlePublish: packet %o",p),o=typeof o<"u"?o:h.noop;let n=p.topic.toString(),a=p.payload,{qos:i}=p,{messageId:c}=p,{options:g}=h;if(h.options.protocolVersion===5){let y;if(p.properties&&(y=p.properties.topicAlias),typeof y<"u")if(n.length===0)if(y>0&&y<=65535){let _=h.topicAliasRecv.getTopicByAlias(y);if(_)n=_,h.log("handlePublish :: topic complemented by alias. topic: %s - alias: %d",n,y);else{h.log("handlePublish :: unregistered topic alias. alias: %d",y),h.emit("error",new Error("Received unregistered Topic Alias"));return}}else{h.log("handlePublish :: topic alias out of range. alias: %d",y),h.emit("error",new Error("Received Topic Alias is out of range"));return}else if(h.topicAliasRecv.put(n,y))h.log("handlePublish :: registered topic: %s - alias: %d",n,y);else{h.log("handlePublish :: topic alias out of range. alias: %d",y),h.emit("error",new Error("Received Topic Alias is out of range"));return}}switch(h.log("handlePublish: qos %d",i),i){case 2:{g.customHandleAcks(n,a,p,(y,_)=>{if(typeof y=="number"&&(_=y,y=null),y)return h.emit("error",y);if(s.indexOf(_)===-1)return h.emit("error",new Error("Wrong reason code for pubrec"));_?h._sendPacket({cmd:"pubrec",messageId:c,reasonCode:_},o):h.incomingStore.put(p,()=>{h._sendPacket({cmd:"pubrec",messageId:c},o)})});break}case 1:{g.customHandleAcks(n,a,p,(y,_)=>{if(typeof y=="number"&&(_=y,y=null),y)return h.emit("error",y);if(s.indexOf(_)===-1)return h.emit("error",new Error("Wrong reason code for puback"));_||h.emit("message",n,a,p),h.handleMessage(p,v=>{if(v)return o&&o(v);h._sendPacket({cmd:"puback",messageId:c,reasonCode:_},o)})});break}case 0:h.emit("message",n,a,p),h.handleMessage(p,o);break;default:h.log("handlePublish: unknown QoS. Doing nothing.");break}};e.default=r}),ih=E((e,s)=>{s.exports={version:"5.7.0"}}),Xr=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.MQTTJS_VERSION=e.nextTick=e.applyMixin=e.ErrorWithReasonCode=void 0;var s=class Gc extends Error{constructor(p,o){super(p),this.code=o,Object.setPrototypeOf(this,Gc.prototype),Object.getPrototypeOf(this).name="ErrorWithReasonCode"}};e.ErrorWithReasonCode=s;function r(h,p,o=!1){var n;let a=[p];for(;;){let i=a[0],c=Object.getPrototypeOf(i);if(c!=null&&c.prototype)a.unshift(c);else break}for(let i of a)for(let c of Object.getOwnPropertyNames(i.prototype))(o||c!=="constructor")&&Object.defineProperty(h.prototype,c,(n=Object.getOwnPropertyDescriptor(i.prototype,c))!==null&&n!==void 0?n:Object.create(null))}e.applyMixin=r,e.nextTick=typeof(Re==null?void 0:Re.nextTick)=="function"?Re.nextTick:h=>{setTimeout(h,0)},e.MQTTJS_VERSION=ih().version}),En=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=void 0,e.ReasonCodes={0:"",1:"Unacceptable protocol version",2:"Identifier rejected",3:"Server unavailable",4:"Bad username or password",5:"Not authorized",16:"No matching subscribers",17:"No subscription existed",128:"Unspecified error",129:"Malformed Packet",130:"Protocol Error",131:"Implementation specific error",132:"Unsupported Protocol Version",133:"Client Identifier not valid",134:"Bad User Name or Password",135:"Not authorized",136:"Server unavailable",137:"Server busy",138:"Banned",139:"Server shutting down",140:"Bad authentication method",141:"Keep Alive timeout",142:"Session taken over",143:"Topic Filter invalid",144:"Topic Name invalid",145:"Packet identifier in use",146:"Packet Identifier not found",147:"Receive Maximum exceeded",148:"Topic Alias invalid",149:"Packet too large",150:"Message rate too high",151:"Quota exceeded",152:"Administrative action",153:"Payload format invalid",154:"Retain not supported",155:"QoS not supported",156:"Use another server",157:"Server moved",158:"Shared Subscriptions not supported",159:"Connection rate exceeded",160:"Maximum connect time",161:"Subscription Identifiers not supported",162:"Wildcard Subscriptions not supported"};var s=(r,h)=>{let{messageId:p}=h,o=h.cmd,n=null,a=r.outgoing[p]?r.outgoing[p].cb:null,i;if(!a){r.log("_handleAck :: Server sent an ack in error. Ignoring.");return}switch(r.log("_handleAck :: packet type",o),o){case"pubcomp":case"puback":{let c=h.reasonCode;c&&c>0&&c!==16?(i=new Error(`Publish error: ${e.ReasonCodes[c]}`),i.code=c,r._removeOutgoingAndStoreMessage(p,()=>{a(i,h)})):r._removeOutgoingAndStoreMessage(p,a);break}case"pubrec":{n={cmd:"pubrel",qos:2,messageId:p};let c=h.reasonCode;c&&c>0&&c!==16?(i=new Error(`Publish error: ${e.ReasonCodes[c]}`),i.code=c,r._removeOutgoingAndStoreMessage(p,()=>{a(i,h)})):r._sendPacket(n);break}case"suback":{delete r.outgoing[p],r.messageIdProvider.deallocate(p);let c=h.granted;for(let g=0;g<c.length;g++)if(c[g]&128){let y=r.messageIdToTopic[p];y&&y.forEach(_=>{delete r._resubscribeTopics[_]})}delete r.messageIdToTopic[p],r._invokeStoreProcessingQueue(),a(null,h);break}case"unsuback":{delete r.outgoing[p],r.messageIdProvider.deallocate(p),r._invokeStoreProcessingQueue(),a(null);break}default:r.emit("error",new Error("unrecognized packet type"))}r.disconnecting&&Object.keys(r.outgoing).length===0&&r.emit("outgoingEmpty")};e.default=s}),oh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=Xr(),r=En(),h=(p,o)=>{let{options:n}=p,a=n.protocolVersion,i=a===5?o.reasonCode:o.returnCode;if(a!==5){let c=new s.ErrorWithReasonCode(`Protocol error: Auth packets are only supported in MQTT 5. Your version:${a}`,i);p.emit("error",c);return}p.handleAuth(o,(c,g)=>{if(c){p.emit("error",c);return}if(i===24)p.reconnecting=!1,p._sendPacket(g);else{let y=new s.ErrorWithReasonCode(`Connection refused: ${r.ReasonCodes[i]}`,i);p.emit("error",y)}})};e.default=h}),sh=E(e=>{var v,S,C,x,H,k,P,K,Q,j,N,$,X,ae,pe,O,te,de,ie,ke,ye,ee,Oe,be,Ne,T,bs,Ae,Me,Ee,F,Xc,ne,Se,fe,fr,dr,ys,Ln,Dn,it,_s,rn,q;we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.LRUCache=void 0;var s=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,r=new Set,h=typeof Re=="object"&&Re?Re:{},p=(re,U,z,Z)=>{typeof h.emitWarning=="function"?h.emitWarning(re,U,z,Z):console.error(`[${z}] ${U}: ${re}`)},o=globalThis.AbortController,n=globalThis.AbortSignal;if(typeof o>"u"){n=class{constructor(){Be(this,"onabort");Be(this,"_onabort",[]);Be(this,"reason");Be(this,"aborted",!1)}addEventListener(z,Z){this._onabort.push(Z)}},o=class{constructor(){Be(this,"signal",new n);U()}abort(z){var Z,ve;if(!this.signal.aborted){this.signal.reason=z,this.signal.aborted=!0;for(let d of this.signal._onabort)d(z);(ve=(Z=this.signal).onabort)==null||ve.call(Z,z)}}};let re=((v=h.env)==null?void 0:v.LRU_CACHE_IGNORE_AC_WARNING)!=="1",U=()=>{re&&(re=!1,p("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",U))}}var a=re=>!r.has(re),i=re=>re&&re===Math.floor(re)&&re>0&&isFinite(re),c=re=>i(re)?re<=Math.pow(2,8)?Uint8Array:re<=Math.pow(2,16)?Uint16Array:re<=Math.pow(2,32)?Uint32Array:re<=Number.MAX_SAFE_INTEGER?g:null:null,g=class extends Array{constructor(re){super(re),this.fill(0)}},y=(S=class{constructor(U,z){Be(this,"heap");Be(this,"length");if(!D(S,C))throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new z(U),this.length=0}static create(U){let z=c(U);if(!z)return[];Ue(S,C,!0);let Z=new S(U,z);return Ue(S,C,!1),Z}push(U){this.heap[this.length++]=U}pop(){return this.heap[--this.length]}},C=new WeakMap,Qe(S,C,!1),S),_=(q=class{constructor(U){Qe(this,T);Qe(this,x);Qe(this,H);Qe(this,k);Qe(this,P);Qe(this,K);Be(this,"ttl");Be(this,"ttlResolution");Be(this,"ttlAutopurge");Be(this,"updateAgeOnGet");Be(this,"updateAgeOnHas");Be(this,"allowStale");Be(this,"noDisposeOnSet");Be(this,"noUpdateTTL");Be(this,"maxEntrySize");Be(this,"sizeCalculation");Be(this,"noDeleteOnFetchRejection");Be(this,"noDeleteOnStaleGet");Be(this,"allowStaleOnFetchAbort");Be(this,"allowStaleOnFetchRejection");Be(this,"ignoreFetchAbort");Qe(this,Q);Qe(this,j);Qe(this,N);Qe(this,$);Qe(this,X);Qe(this,ae);Qe(this,pe);Qe(this,O);Qe(this,te);Qe(this,de);Qe(this,ie);Qe(this,ke);Qe(this,ye);Qe(this,ee);Qe(this,Oe);Qe(this,be);Qe(this,Ne);Qe(this,Ae,()=>{});Qe(this,Me,()=>{});Qe(this,Ee,()=>{});Qe(this,F,()=>!1);Qe(this,ne,U=>{});Qe(this,Se,(U,z,Z)=>{});Qe(this,fe,(U,z,Z,ve)=>{if(Z||ve)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0});let{max:z=0,ttl:Z,ttlResolution:ve=1,ttlAutopurge:d,updateAgeOnGet:f,updateAgeOnHas:b,allowStale:I,dispose:B,disposeAfter:G,noDisposeOnSet:he,noUpdateTTL:De,maxSize:ze=0,maxEntrySize:Ke=0,sizeCalculation:Le,fetchMethod:qe,noDeleteOnFetchRejection:$e,noDeleteOnStaleGet:tt,allowStaleOnFetchRejection:gt,allowStaleOnFetchAbort:ct,ignoreFetchAbort:_t}=U;if(z!==0&&!i(z))throw new TypeError("max option must be a nonnegative integer");let Et=z?c(z):Array;if(!Et)throw new Error("invalid max value: "+z);if(Ue(this,x,z),Ue(this,H,ze),this.maxEntrySize=Ke||D(this,H),this.sizeCalculation=Le,this.sizeCalculation){if(!D(this,H)&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(qe!==void 0&&typeof qe!="function")throw new TypeError("fetchMethod must be a function if specified");if(Ue(this,K,qe),Ue(this,be,!!qe),Ue(this,N,new Map),Ue(this,$,new Array(z).fill(void 0)),Ue(this,X,new Array(z).fill(void 0)),Ue(this,ae,new Et(z)),Ue(this,pe,new Et(z)),Ue(this,O,0),Ue(this,te,0),Ue(this,de,y.create(z)),Ue(this,Q,0),Ue(this,j,0),typeof B=="function"&&Ue(this,k,B),typeof G=="function"?(Ue(this,P,G),Ue(this,ie,[])):(Ue(this,P,void 0),Ue(this,ie,void 0)),Ue(this,Oe,!!D(this,k)),Ue(this,Ne,!!D(this,P)),this.noDisposeOnSet=!!he,this.noUpdateTTL=!!De,this.noDeleteOnFetchRejection=!!$e,this.allowStaleOnFetchRejection=!!gt,this.allowStaleOnFetchAbort=!!ct,this.ignoreFetchAbort=!!_t,this.maxEntrySize!==0){if(D(this,H)!==0&&!i(D(this,H)))throw new TypeError("maxSize must be a positive integer if specified");if(!i(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");je(this,T,Xc).call(this)}if(this.allowStale=!!I,this.noDeleteOnStaleGet=!!tt,this.updateAgeOnGet=!!f,this.updateAgeOnHas=!!b,this.ttlResolution=i(ve)||ve===0?ve:1,this.ttlAutopurge=!!d,this.ttl=Z||0,this.ttl){if(!i(this.ttl))throw new TypeError("ttl must be a positive integer if specified");je(this,T,bs).call(this)}if(D(this,x)===0&&this.ttl===0&&D(this,H)===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!D(this,x)&&!D(this,H)){let mt="LRU_CACHE_UNBOUNDED";a(mt)&&(r.add(mt),p("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",mt,q))}}static unsafeExposeInternals(U){return{starts:D(U,ye),ttls:D(U,ee),sizes:D(U,ke),keyMap:D(U,N),keyList:D(U,$),valList:D(U,X),next:D(U,ae),prev:D(U,pe),get head(){return D(U,O)},get tail(){return D(U,te)},free:D(U,de),isBackgroundFetch:z=>{var Z;return je(Z=U,T,it).call(Z,z)},backgroundFetch:(z,Z,ve,d)=>{var f;return je(f=U,T,Dn).call(f,z,Z,ve,d)},moveToTail:z=>{var Z;return je(Z=U,T,rn).call(Z,z)},indexes:z=>{var Z;return je(Z=U,T,fr).call(Z,z)},rindexes:z=>{var Z;return je(Z=U,T,dr).call(Z,z)},isStale:z=>{var Z;return D(Z=U,F).call(Z,z)}}}get max(){return D(this,x)}get maxSize(){return D(this,H)}get calculatedSize(){return D(this,j)}get size(){return D(this,Q)}get fetchMethod(){return D(this,K)}get dispose(){return D(this,k)}get disposeAfter(){return D(this,P)}getRemainingTTL(U){return D(this,N).has(U)?1/0:0}*entries(){for(let U of je(this,T,fr).call(this))D(this,X)[U]!==void 0&&D(this,$)[U]!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield[D(this,$)[U],D(this,X)[U]])}*rentries(){for(let U of je(this,T,dr).call(this))D(this,X)[U]!==void 0&&D(this,$)[U]!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield[D(this,$)[U],D(this,X)[U]])}*keys(){for(let U of je(this,T,fr).call(this)){let z=D(this,$)[U];z!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield z)}}*rkeys(){for(let U of je(this,T,dr).call(this)){let z=D(this,$)[U];z!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield z)}}*values(){for(let U of je(this,T,fr).call(this))D(this,X)[U]!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield D(this,X)[U])}*rvalues(){for(let U of je(this,T,dr).call(this))D(this,X)[U]!==void 0&&!je(this,T,it).call(this,D(this,X)[U])&&(yield D(this,X)[U])}[Symbol.iterator](){return this.entries()}find(U,z={}){for(let Z of je(this,T,fr).call(this)){let ve=D(this,X)[Z],d=je(this,T,it).call(this,ve)?ve.__staleWhileFetching:ve;if(d!==void 0&&U(d,D(this,$)[Z],this))return this.get(D(this,$)[Z],z)}}forEach(U,z=this){for(let Z of je(this,T,fr).call(this)){let ve=D(this,X)[Z],d=je(this,T,it).call(this,ve)?ve.__staleWhileFetching:ve;d!==void 0&&U.call(z,d,D(this,$)[Z],this)}}rforEach(U,z=this){for(let Z of je(this,T,dr).call(this)){let ve=D(this,X)[Z],d=je(this,T,it).call(this,ve)?ve.__staleWhileFetching:ve;d!==void 0&&U.call(z,d,D(this,$)[Z],this)}}purgeStale(){let U=!1;for(let z of je(this,T,dr).call(this,{allowStale:!0}))D(this,F).call(this,z)&&(this.delete(D(this,$)[z]),U=!0);return U}dump(){let U=[];for(let z of je(this,T,fr).call(this,{allowStale:!0})){let Z=D(this,$)[z],ve=D(this,X)[z],d=je(this,T,it).call(this,ve)?ve.__staleWhileFetching:ve;if(d===void 0||Z===void 0)continue;let f={value:d};if(D(this,ee)&&D(this,ye)){f.ttl=D(this,ee)[z];let b=s.now()-D(this,ye)[z];f.start=Math.floor(Date.now()-b)}D(this,ke)&&(f.size=D(this,ke)[z]),U.unshift([Z,f])}return U}load(U){this.clear();for(let[z,Z]of U){if(Z.start){let ve=Date.now()-Z.start;Z.start=s.now()-ve}this.set(z,Z.value,Z)}}set(U,z,Z={}){var De,ze,Ke,Le,qe;if(z===void 0)return this.delete(U),this;let{ttl:ve=this.ttl,start:d,noDisposeOnSet:f=this.noDisposeOnSet,sizeCalculation:b=this.sizeCalculation,status:I}=Z,{noUpdateTTL:B=this.noUpdateTTL}=Z,G=D(this,fe).call(this,U,z,Z.size||0,b);if(this.maxEntrySize&&G>this.maxEntrySize)return I&&(I.set="miss",I.maxEntrySizeExceeded=!0),this.delete(U),this;let he=D(this,Q)===0?void 0:D(this,N).get(U);if(he===void 0)he=D(this,Q)===0?D(this,te):D(this,de).length!==0?D(this,de).pop():D(this,Q)===D(this,x)?je(this,T,Ln).call(this,!1):D(this,Q),D(this,$)[he]=U,D(this,X)[he]=z,D(this,N).set(U,he),D(this,ae)[D(this,te)]=he,D(this,pe)[he]=D(this,te),Ue(this,te,he),Bn(this,Q)._++,D(this,Se).call(this,he,G,I),I&&(I.set="add"),B=!1;else{je(this,T,rn).call(this,he);let $e=D(this,X)[he];if(z!==$e){if(D(this,be)&&je(this,T,it).call(this,$e)){$e.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:tt}=$e;tt!==void 0&&!f&&(D(this,Oe)&&((De=D(this,k))==null||De.call(this,tt,U,"set")),D(this,Ne)&&((ze=D(this,ie))==null||ze.push([tt,U,"set"])))}else f||(D(this,Oe)&&((Ke=D(this,k))==null||Ke.call(this,$e,U,"set")),D(this,Ne)&&((Le=D(this,ie))==null||Le.push([$e,U,"set"])));if(D(this,ne).call(this,he),D(this,Se).call(this,he,G,I),D(this,X)[he]=z,I){I.set="replace";let tt=$e&&je(this,T,it).call(this,$e)?$e.__staleWhileFetching:$e;tt!==void 0&&(I.oldValue=tt)}}else I&&(I.set="update")}if(ve!==0&&!D(this,ee)&&je(this,T,bs).call(this),D(this,ee)&&(B||D(this,Ee).call(this,he,ve,d),I&&D(this,Me).call(this,I,he)),!f&&D(this,Ne)&&D(this,ie)){let $e=D(this,ie),tt;for(;tt=$e==null?void 0:$e.shift();)(qe=D(this,P))==null||qe.call(this,...tt)}return this}pop(){var U;try{for(;D(this,Q);){let z=D(this,X)[D(this,O)];if(je(this,T,Ln).call(this,!0),je(this,T,it).call(this,z)){if(z.__staleWhileFetching)return z.__staleWhileFetching}else if(z!==void 0)return z}}finally{if(D(this,Ne)&&D(this,ie)){let z=D(this,ie),Z;for(;Z=z==null?void 0:z.shift();)(U=D(this,P))==null||U.call(this,...Z)}}}has(U,z={}){let{updateAgeOnHas:Z=this.updateAgeOnHas,status:ve}=z,d=D(this,N).get(U);if(d!==void 0){let f=D(this,X)[d];if(je(this,T,it).call(this,f)&&f.__staleWhileFetching===void 0)return!1;if(D(this,F).call(this,d))ve&&(ve.has="stale",D(this,Me).call(this,ve,d));else return Z&&D(this,Ae).call(this,d),ve&&(ve.has="hit",D(this,Me).call(this,ve,d)),!0}else ve&&(ve.has="miss");return!1}peek(U,z={}){let{allowStale:Z=this.allowStale}=z,ve=D(this,N).get(U);if(ve!==void 0&&(Z||!D(this,F).call(this,ve))){let d=D(this,X)[ve];return je(this,T,it).call(this,d)?d.__staleWhileFetching:d}}async fetch(U,z={}){let{allowStale:Z=this.allowStale,updateAgeOnGet:ve=this.updateAgeOnGet,noDeleteOnStaleGet:d=this.noDeleteOnStaleGet,ttl:f=this.ttl,noDisposeOnSet:b=this.noDisposeOnSet,size:I=0,sizeCalculation:B=this.sizeCalculation,noUpdateTTL:G=this.noUpdateTTL,noDeleteOnFetchRejection:he=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:De=this.allowStaleOnFetchRejection,ignoreFetchAbort:ze=this.ignoreFetchAbort,allowStaleOnFetchAbort:Ke=this.allowStaleOnFetchAbort,context:Le,forceRefresh:qe=!1,status:$e,signal:tt}=z;if(!D(this,be))return $e&&($e.fetch="get"),this.get(U,{allowStale:Z,updateAgeOnGet:ve,noDeleteOnStaleGet:d,status:$e});let gt={allowStale:Z,updateAgeOnGet:ve,noDeleteOnStaleGet:d,ttl:f,noDisposeOnSet:b,size:I,sizeCalculation:B,noUpdateTTL:G,noDeleteOnFetchRejection:he,allowStaleOnFetchRejection:De,allowStaleOnFetchAbort:Ke,ignoreFetchAbort:ze,status:$e,signal:tt},ct=D(this,N).get(U);if(ct===void 0){$e&&($e.fetch="miss");let _t=je(this,T,Dn).call(this,U,ct,gt,Le);return _t.__returned=_t}else{let _t=D(this,X)[ct];if(je(this,T,it).call(this,_t)){let Jl=Z&&_t.__staleWhileFetching!==void 0;return $e&&($e.fetch="inflight",Jl&&($e.returnedStale=!0)),Jl?_t.__staleWhileFetching:_t.__returned=_t}let Et=D(this,F).call(this,ct);if(!qe&&!Et)return $e&&($e.fetch="hit"),je(this,T,rn).call(this,ct),ve&&D(this,Ae).call(this,ct),$e&&D(this,Me).call(this,$e,ct),_t;let mt=je(this,T,Dn).call(this,U,ct,gt,Le),Kl=mt.__staleWhileFetching!==void 0&&Z;return $e&&($e.fetch=Et?"stale":"refresh",Kl&&Et&&($e.returnedStale=!0)),Kl?mt.__staleWhileFetching:mt.__returned=mt}}get(U,z={}){let{allowStale:Z=this.allowStale,updateAgeOnGet:ve=this.updateAgeOnGet,noDeleteOnStaleGet:d=this.noDeleteOnStaleGet,status:f}=z,b=D(this,N).get(U);if(b!==void 0){let I=D(this,X)[b],B=je(this,T,it).call(this,I);return f&&D(this,Me).call(this,f,b),D(this,F).call(this,b)?(f&&(f.get="stale"),B?(f&&Z&&I.__staleWhileFetching!==void 0&&(f.returnedStale=!0),Z?I.__staleWhileFetching:void 0):(d||this.delete(U),f&&Z&&(f.returnedStale=!0),Z?I:void 0)):(f&&(f.get="hit"),B?I.__staleWhileFetching:(je(this,T,rn).call(this,b),ve&&D(this,Ae).call(this,b),I))}else f&&(f.get="miss")}delete(U){var Z,ve,d,f;let z=!1;if(D(this,Q)!==0){let b=D(this,N).get(U);if(b!==void 0)if(z=!0,D(this,Q)===1)this.clear();else{D(this,ne).call(this,b);let I=D(this,X)[b];je(this,T,it).call(this,I)?I.__abortController.abort(new Error("deleted")):(D(this,Oe)||D(this,Ne))&&(D(this,Oe)&&((Z=D(this,k))==null||Z.call(this,I,U,"delete")),D(this,Ne)&&((ve=D(this,ie))==null||ve.push([I,U,"delete"]))),D(this,N).delete(U),D(this,$)[b]=void 0,D(this,X)[b]=void 0,b===D(this,te)?Ue(this,te,D(this,pe)[b]):b===D(this,O)?Ue(this,O,D(this,ae)[b]):(D(this,ae)[D(this,pe)[b]]=D(this,ae)[b],D(this,pe)[D(this,ae)[b]]=D(this,pe)[b]),Bn(this,Q)._--,D(this,de).push(b)}}if(D(this,Ne)&&((d=D(this,ie))!=null&&d.length)){let b=D(this,ie),I;for(;I=b==null?void 0:b.shift();)(f=D(this,P))==null||f.call(this,...I)}return z}clear(){var U,z,Z;for(let ve of je(this,T,dr).call(this,{allowStale:!0})){let d=D(this,X)[ve];if(je(this,T,it).call(this,d))d.__abortController.abort(new Error("deleted"));else{let f=D(this,$)[ve];D(this,Oe)&&((U=D(this,k))==null||U.call(this,d,f,"delete")),D(this,Ne)&&((z=D(this,ie))==null||z.push([d,f,"delete"]))}}if(D(this,N).clear(),D(this,X).fill(void 0),D(this,$).fill(void 0),D(this,ee)&&D(this,ye)&&(D(this,ee).fill(0),D(this,ye).fill(0)),D(this,ke)&&D(this,ke).fill(0),Ue(this,O,0),Ue(this,te,0),D(this,de).length=0,Ue(this,j,0),Ue(this,Q,0),D(this,Ne)&&D(this,ie)){let ve=D(this,ie),d;for(;d=ve==null?void 0:ve.shift();)(Z=D(this,P))==null||Z.call(this,...d)}}},x=new WeakMap,H=new WeakMap,k=new WeakMap,P=new WeakMap,K=new WeakMap,Q=new WeakMap,j=new WeakMap,N=new WeakMap,$=new WeakMap,X=new WeakMap,ae=new WeakMap,pe=new WeakMap,O=new WeakMap,te=new WeakMap,de=new WeakMap,ie=new WeakMap,ke=new WeakMap,ye=new WeakMap,ee=new WeakMap,Oe=new WeakMap,be=new WeakMap,Ne=new WeakMap,T=new WeakSet,bs=function(){let U=new g(D(this,x)),z=new g(D(this,x));Ue(this,ee,U),Ue(this,ye,z),Ue(this,Ee,(d,f,b=s.now())=>{if(z[d]=f!==0?b:0,U[d]=f,f!==0&&this.ttlAutopurge){let I=setTimeout(()=>{D(this,F).call(this,d)&&this.delete(D(this,$)[d])},f+1);I.unref&&I.unref()}}),Ue(this,Ae,d=>{z[d]=U[d]!==0?s.now():0}),Ue(this,Me,(d,f)=>{if(U[f]){let b=U[f],I=z[f];d.ttl=b,d.start=I,d.now=Z||ve();let B=d.now-I;d.remainingTTL=b-B}});let Z=0,ve=()=>{let d=s.now();if(this.ttlResolution>0){Z=d;let f=setTimeout(()=>Z=0,this.ttlResolution);f.unref&&f.unref()}return d};this.getRemainingTTL=d=>{let f=D(this,N).get(d);if(f===void 0)return 0;let b=U[f],I=z[f];if(b===0||I===0)return 1/0;let B=(Z||ve())-I;return b-B},Ue(this,F,d=>U[d]!==0&&z[d]!==0&&(Z||ve())-z[d]>U[d])},Ae=new WeakMap,Me=new WeakMap,Ee=new WeakMap,F=new WeakMap,Xc=function(){let U=new g(D(this,x));Ue(this,j,0),Ue(this,ke,U),Ue(this,ne,z=>{Ue(this,j,D(this,j)-U[z]),U[z]=0}),Ue(this,fe,(z,Z,ve,d)=>{if(je(this,T,it).call(this,Z))return 0;if(!i(ve))if(d){if(typeof d!="function")throw new TypeError("sizeCalculation must be a function");if(ve=d(Z,z),!i(ve))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return ve}),Ue(this,Se,(z,Z,ve)=>{if(U[z]=Z,D(this,H)){let d=D(this,H)-U[z];for(;D(this,j)>d;)je(this,T,Ln).call(this,!0)}Ue(this,j,D(this,j)+U[z]),ve&&(ve.entrySize=Z,ve.totalCalculatedSize=D(this,j))})},ne=new WeakMap,Se=new WeakMap,fe=new WeakMap,fr=function*({allowStale:U=this.allowStale}={}){if(D(this,Q))for(let z=D(this,te);!(!je(this,T,ys).call(this,z)||((U||!D(this,F).call(this,z))&&(yield z),z===D(this,O)));)z=D(this,pe)[z]},dr=function*({allowStale:U=this.allowStale}={}){if(D(this,Q))for(let z=D(this,O);!(!je(this,T,ys).call(this,z)||((U||!D(this,F).call(this,z))&&(yield z),z===D(this,te)));)z=D(this,ae)[z]},ys=function(U){return U!==void 0&&D(this,N).get(D(this,$)[U])===U},Ln=function(U){var d,f;let z=D(this,O),Z=D(this,$)[z],ve=D(this,X)[z];return D(this,be)&&je(this,T,it).call(this,ve)?ve.__abortController.abort(new Error("evicted")):(D(this,Oe)||D(this,Ne))&&(D(this,Oe)&&((d=D(this,k))==null||d.call(this,ve,Z,"evict")),D(this,Ne)&&((f=D(this,ie))==null||f.push([ve,Z,"evict"]))),D(this,ne).call(this,z),U&&(D(this,$)[z]=void 0,D(this,X)[z]=void 0,D(this,de).push(z)),D(this,Q)===1?(Ue(this,O,Ue(this,te,0)),D(this,de).length=0):Ue(this,O,D(this,ae)[z]),D(this,N).delete(Z),Bn(this,Q)._--,z},Dn=function(U,z,Z,ve){let d=z===void 0?void 0:D(this,X)[z];if(je(this,T,it).call(this,d))return d;let f=new o,{signal:b}=Z;b==null||b.addEventListener("abort",()=>f.abort(b.reason),{signal:f.signal});let I={signal:f.signal,options:Z,context:ve},B=(Le,qe=!1)=>{let{aborted:$e}=f.signal,tt=Z.ignoreFetchAbort&&Le!==void 0;if(Z.status&&($e&&!qe?(Z.status.fetchAborted=!0,Z.status.fetchError=f.signal.reason,tt&&(Z.status.fetchAbortIgnored=!0)):Z.status.fetchResolved=!0),$e&&!tt&&!qe)return he(f.signal.reason);let gt=ze;return D(this,X)[z]===ze&&(Le===void 0?gt.__staleWhileFetching?D(this,X)[z]=gt.__staleWhileFetching:this.delete(U):(Z.status&&(Z.status.fetchUpdated=!0),this.set(U,Le,I.options))),Le},G=Le=>(Z.status&&(Z.status.fetchRejected=!0,Z.status.fetchError=Le),he(Le)),he=Le=>{let{aborted:qe}=f.signal,$e=qe&&Z.allowStaleOnFetchAbort,tt=$e||Z.allowStaleOnFetchRejection,gt=tt||Z.noDeleteOnFetchRejection,ct=ze;if(D(this,X)[z]===ze&&(!gt||ct.__staleWhileFetching===void 0?this.delete(U):$e||(D(this,X)[z]=ct.__staleWhileFetching)),tt)return Z.status&&ct.__staleWhileFetching!==void 0&&(Z.status.returnedStale=!0),ct.__staleWhileFetching;if(ct.__returned===ct)throw Le},De=(Le,qe)=>{var tt;let $e=(tt=D(this,K))==null?void 0:tt.call(this,U,d,I);$e&&$e instanceof Promise&&$e.then(gt=>Le(gt===void 0?void 0:gt),qe),f.signal.addEventListener("abort",()=>{(!Z.ignoreFetchAbort||Z.allowStaleOnFetchAbort)&&(Le(void 0),Z.allowStaleOnFetchAbort&&(Le=gt=>B(gt,!0)))})};Z.status&&(Z.status.fetchDispatched=!0);let ze=new Promise(De).then(B,G),Ke=Object.assign(ze,{__abortController:f,__staleWhileFetching:d,__returned:void 0});return z===void 0?(this.set(U,Ke,{...I.options,status:void 0}),z=D(this,N).get(U)):D(this,X)[z]=Ke,Ke},it=function(U){if(!D(this,be))return!1;let z=U;return!!z&&z instanceof Promise&&z.hasOwnProperty("__staleWhileFetching")&&z.__abortController instanceof o},_s=function(U,z){D(this,pe)[z]=U,D(this,ae)[U]=z},rn=function(U){U!==D(this,te)&&(U===D(this,O)?Ue(this,O,D(this,ae)[U]):je(this,T,_s).call(this,D(this,pe)[U],D(this,ae)[U]),je(this,T,_s).call(this,D(this,te),U),Ue(this,te,U))},q);e.LRUCache=_}),er=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.ContainerIterator=e.Container=e.Base=void 0;var s=class{constructor(p=0){this.iteratorType=p}equals(p){return this.o===p.o}};e.ContainerIterator=s;var r=class{constructor(){this.i=0}get length(){return this.i}size(){return this.i}empty(){return this.i===0}};e.Base=r;var h=class extends r{};e.Container=h}),ah=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=er(),r=class extends s.Base{constructor(p=[]){super(),this.S=[];let o=this;p.forEach(function(n){o.push(n)})}clear(){this.i=0,this.S=[]}push(p){return this.S.push(p),this.i+=1,this.i}pop(){if(this.i!==0)return this.i-=1,this.S.pop()}top(){return this.S[this.i-1]}},h=r;e.default=h}),lh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=er(),r=class extends s.Base{constructor(p=[]){super(),this.j=0,this.q=[];let o=this;p.forEach(function(n){o.push(n)})}clear(){this.q=[],this.i=this.j=0}push(p){let o=this.q.length;if(this.j/o>.5&&this.j+this.i>=o&&o>4096){let n=this.i;for(let a=0;a<n;++a)this.q[a]=this.q[this.j+a];this.j=0,this.q[this.i]=p}else this.q[this.j+this.i]=p;return++this.i}pop(){if(this.i===0)return;let p=this.q[this.j++];return this.i-=1,p}front(){if(this.i!==0)return this.q[this.j]}},h=r;e.default=h}),ch=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=er(),r=class extends s.Base{constructor(p=[],o=function(a,i){return a>i?-1:a<i?1:0},n=!0){if(super(),this.v=o,Array.isArray(p))this.C=n?[...p]:p;else{this.C=[];let i=this;p.forEach(function(c){i.C.push(c)})}this.i=this.C.length;let a=this.i>>1;for(let i=this.i-1>>1;i>=0;--i)this.k(i,a)}m(p){let o=this.C[p];for(;p>0;){let n=p-1>>1,a=this.C[n];if(this.v(a,o)<=0)break;this.C[p]=a,p=n}this.C[p]=o}k(p,o){let n=this.C[p];for(;p<o;){let a=p<<1|1,i=a+1,c=this.C[a];if(i<this.i&&this.v(c,this.C[i])>0&&(a=i,c=this.C[i]),this.v(c,n)>=0)break;this.C[p]=c,p=a}this.C[p]=n}clear(){this.i=0,this.C.length=0}push(p){this.C.push(p),this.m(this.i),this.i+=1}pop(){if(this.i===0)return;let p=this.C[0],o=this.C.pop();return this.i-=1,this.i&&(this.C[0]=o,this.k(0,this.i>>1)),p}top(){return this.C[0]}find(p){return this.C.indexOf(p)>=0}remove(p){let o=this.C.indexOf(p);return o<0?!1:(o===0?this.pop():o===this.i-1?(this.C.pop(),this.i-=1):(this.C.splice(o,1,this.C.pop()),this.i-=1,this.m(o),this.k(o,this.i>>1)),!0)}updateItem(p){let o=this.C.indexOf(p);return o<0?!1:(this.m(o),this.k(o,this.i>>1),!0)}toArray(){return[...this.C]}},h=r;e.default=h}),jo=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=er(),r=class extends s.Container{},h=r;e.default=h}),tr=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.throwIteratorAccessError=s;function s(){throw new RangeError("Iterator access denied!")}}),Ba=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.RandomIterator=void 0;var s=er(),r=tr(),h=class extends s.ContainerIterator{constructor(p,o){super(o),this.o=p,this.iteratorType===0?(this.pre=function(){return this.o===0&&(0,r.throwIteratorAccessError)(),this.o-=1,this},this.next=function(){return this.o===this.container.size()&&(0,r.throwIteratorAccessError)(),this.o+=1,this}):(this.pre=function(){return this.o===this.container.size()-1&&(0,r.throwIteratorAccessError)(),this.o+=1,this},this.next=function(){return this.o===-1&&(0,r.throwIteratorAccessError)(),this.o-=1,this})}get pointer(){return this.container.getElementByPos(this.o)}set pointer(p){this.container.setElementByPos(this.o,p)}};e.RandomIterator=h}),uh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=h(jo()),r=Ba();function h(a){return a&&a.t?a:{default:a}}var p=class Zc extends r.RandomIterator{constructor(i,c,g){super(i,g),this.container=c}copy(){return new Zc(this.o,this.container,this.iteratorType)}},o=class extends s.default{constructor(a=[],i=!0){if(super(),Array.isArray(a))this.J=i?[...a]:a,this.i=a.length;else{this.J=[];let c=this;a.forEach(function(g){c.pushBack(g)})}}clear(){this.i=0,this.J.length=0}begin(){return new p(0,this)}end(){return new p(this.i,this)}rBegin(){return new p(this.i-1,this,1)}rEnd(){return new p(-1,this,1)}front(){return this.J[0]}back(){return this.J[this.i-1]}getElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;return this.J[a]}eraseElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;return this.J.splice(a,1),this.i-=1,this.i}eraseElementByValue(a){let i=0;for(let c=0;c<this.i;++c)this.J[c]!==a&&(this.J[i++]=this.J[c]);return this.i=this.J.length=i,this.i}eraseElementByIterator(a){let i=a.o;return a=a.next(),this.eraseElementByPos(i),a}pushBack(a){return this.J.push(a),this.i+=1,this.i}popBack(){if(this.i!==0)return this.i-=1,this.J.pop()}setElementByPos(a,i){if(a<0||a>this.i-1)throw new RangeError;this.J[a]=i}insert(a,i,c=1){if(a<0||a>this.i)throw new RangeError;return this.J.splice(a,0,...new Array(c).fill(i)),this.i+=c,this.i}find(a){for(let i=0;i<this.i;++i)if(this.J[i]===a)return new p(i,this);return this.end()}reverse(){this.J.reverse()}unique(){let a=1;for(let i=1;i<this.i;++i)this.J[i]!==this.J[i-1]&&(this.J[a++]=this.J[i]);return this.i=this.J.length=a,this.i}sort(a){this.J.sort(a)}forEach(a){for(let i=0;i<this.i;++i)a(this.J[i],i,this)}[Symbol.iterator](){return(function*(){yield*this.J}).bind(this)()}},n=o;e.default=n}),hh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=p(jo()),r=er(),h=tr();function p(i){return i&&i.t?i:{default:i}}var o=class eu extends r.ContainerIterator{constructor(c,g,y,_){super(_),this.o=c,this.h=g,this.container=y,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.L,this})}get pointer(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o.l}set pointer(c){this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o.l=c}copy(){return new eu(this.o,this.h,this.container,this.iteratorType)}},n=class extends s.default{constructor(i=[]){super(),this.h={},this.p=this._=this.h.L=this.h.B=this.h;let c=this;i.forEach(function(g){c.pushBack(g)})}V(i){let{L:c,B:g}=i;c.B=g,g.L=c,i===this.p&&(this.p=g),i===this._&&(this._=c),this.i-=1}G(i,c){let g=c.B,y={l:i,L:c,B:g};c.B=y,g.L=y,c===this.h&&(this.p=y),g===this.h&&(this._=y),this.i+=1}clear(){this.i=0,this.p=this._=this.h.L=this.h.B=this.h}begin(){return new o(this.p,this.h,this)}end(){return new o(this.h,this.h,this)}rBegin(){return new o(this._,this.h,this,1)}rEnd(){return new o(this.h,this.h,this,1)}front(){return this.p.l}back(){return this._.l}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let c=this.p;for(;i--;)c=c.B;return c.l}eraseElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let c=this.p;for(;i--;)c=c.B;return this.V(c),this.i}eraseElementByValue(i){let c=this.p;for(;c!==this.h;)c.l===i&&this.V(c),c=c.B;return this.i}eraseElementByIterator(i){let c=i.o;return c===this.h&&(0,h.throwIteratorAccessError)(),i=i.next(),this.V(c),i}pushBack(i){return this.G(i,this._),this.i}popBack(){if(this.i===0)return;let i=this._.l;return this.V(this._),i}pushFront(i){return this.G(i,this.h),this.i}popFront(){if(this.i===0)return;let i=this.p.l;return this.V(this.p),i}setElementByPos(i,c){if(i<0||i>this.i-1)throw new RangeError;let g=this.p;for(;i--;)g=g.B;g.l=c}insert(i,c,g=1){if(i<0||i>this.i)throw new RangeError;if(g<=0)return this.i;if(i===0)for(;g--;)this.pushFront(c);else if(i===this.i)for(;g--;)this.pushBack(c);else{let y=this.p;for(let v=1;v<i;++v)y=y.B;let _=y.B;for(this.i+=g;g--;)y.B={l:c,L:y},y.B.L=y,y=y.B;y.B=_,_.L=y}return this.i}find(i){let c=this.p;for(;c!==this.h;){if(c.l===i)return new o(c,this.h,this);c=c.B}return this.end()}reverse(){if(this.i<=1)return;let i=this.p,c=this._,g=0;for(;g<<1<this.i;){let y=i.l;i.l=c.l,c.l=y,i=i.B,c=c.L,g+=1}}unique(){if(this.i<=1)return this.i;let i=this.p;for(;i!==this.h;){let c=i;for(;c.B!==this.h&&c.l===c.B.l;)c=c.B,this.i-=1;i.B=c.B,i.B.L=i,i=i.B}return this.i}sort(i){if(this.i<=1)return;let c=[];this.forEach(function(y){c.push(y)}),c.sort(i);let g=this.p;c.forEach(function(y){g.l=y,g=g.B})}merge(i){let c=this;if(this.i===0)i.forEach(function(g){c.pushBack(g)});else{let g=this.p;i.forEach(function(y){for(;g!==c.h&&g.l<=y;)g=g.B;c.G(y,g.L)})}return this.i}forEach(i){let c=this.p,g=0;for(;c!==this.h;)i(c.l,g++,this),c=c.B}[Symbol.iterator](){return(function*(){if(this.i===0)return;let i=this.p;for(;i!==this.h;)yield i.l,i=i.B}).bind(this)()}},a=n;e.default=a}),fh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=h(jo()),r=Ba();function h(a){return a&&a.t?a:{default:a}}var p=class tu extends r.RandomIterator{constructor(i,c,g){super(i,g),this.container=c}copy(){return new tu(this.o,this.container,this.iteratorType)}},o=class extends s.default{constructor(a=[],i=4096){super(),this.j=0,this.D=0,this.R=0,this.N=0,this.P=0,this.A=[];let c=(()=>{if(typeof a.length=="number")return a.length;if(typeof a.size=="number")return a.size;if(typeof a.size=="function")return a.size();throw new TypeError("Cannot get the length or size of the container")})();this.F=i,this.P=Math.max(Math.ceil(c/this.F),1);for(let _=0;_<this.P;++_)this.A.push(new Array(this.F));let g=Math.ceil(c/this.F);this.j=this.R=(this.P>>1)-(g>>1),this.D=this.N=this.F-c%this.F>>1;let y=this;a.forEach(function(_){y.pushBack(_)})}T(){let a=[],i=Math.max(this.P>>1,1);for(let c=0;c<i;++c)a[c]=new Array(this.F);for(let c=this.j;c<this.P;++c)a[a.length]=this.A[c];for(let c=0;c<this.R;++c)a[a.length]=this.A[c];a[a.length]=[...this.A[this.R]],this.j=i,this.R=a.length-1;for(let c=0;c<i;++c)a[a.length]=new Array(this.F);this.A=a,this.P=a.length}O(a){let i=this.D+a+1,c=i%this.F,g=c-1,y=this.j+(i-c)/this.F;return c===0&&(y-=1),y%=this.P,g<0&&(g+=this.F),{curNodeBucketIndex:y,curNodePointerIndex:g}}clear(){this.A=[new Array(this.F)],this.P=1,this.j=this.R=this.i=0,this.D=this.N=this.F>>1}begin(){return new p(0,this)}end(){return new p(this.i,this)}rBegin(){return new p(this.i-1,this,1)}rEnd(){return new p(-1,this,1)}front(){if(this.i!==0)return this.A[this.j][this.D]}back(){if(this.i!==0)return this.A[this.R][this.N]}pushBack(a){return this.i&&(this.N<this.F-1?this.N+=1:this.R<this.P-1?(this.R+=1,this.N=0):(this.R=0,this.N=0),this.R===this.j&&this.N===this.D&&this.T()),this.i+=1,this.A[this.R][this.N]=a,this.i}popBack(){if(this.i===0)return;let a=this.A[this.R][this.N];return this.i!==1&&(this.N>0?this.N-=1:this.R>0?(this.R-=1,this.N=this.F-1):(this.R=this.P-1,this.N=this.F-1)),this.i-=1,a}pushFront(a){return this.i&&(this.D>0?this.D-=1:this.j>0?(this.j-=1,this.D=this.F-1):(this.j=this.P-1,this.D=this.F-1),this.j===this.R&&this.D===this.N&&this.T()),this.i+=1,this.A[this.j][this.D]=a,this.i}popFront(){if(this.i===0)return;let a=this.A[this.j][this.D];return this.i!==1&&(this.D<this.F-1?this.D+=1:this.j<this.P-1?(this.j+=1,this.D=0):(this.j=0,this.D=0)),this.i-=1,a}getElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;let{curNodeBucketIndex:i,curNodePointerIndex:c}=this.O(a);return this.A[i][c]}setElementByPos(a,i){if(a<0||a>this.i-1)throw new RangeError;let{curNodeBucketIndex:c,curNodePointerIndex:g}=this.O(a);this.A[c][g]=i}insert(a,i,c=1){if(a<0||a>this.i)throw new RangeError;if(a===0)for(;c--;)this.pushFront(i);else if(a===this.i)for(;c--;)this.pushBack(i);else{let g=[];for(let y=a;y<this.i;++y)g.push(this.getElementByPos(y));this.cut(a-1);for(let y=0;y<c;++y)this.pushBack(i);for(let y=0;y<g.length;++y)this.pushBack(g[y])}return this.i}cut(a){if(a<0)return this.clear(),0;let{curNodeBucketIndex:i,curNodePointerIndex:c}=this.O(a);return this.R=i,this.N=c,this.i=a+1,this.i}eraseElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;if(a===0)this.popFront();else if(a===this.i-1)this.popBack();else{let i=[];for(let g=a+1;g<this.i;++g)i.push(this.getElementByPos(g));this.cut(a),this.popBack();let c=this;i.forEach(function(g){c.pushBack(g)})}return this.i}eraseElementByValue(a){if(this.i===0)return 0;let i=[];for(let g=0;g<this.i;++g){let y=this.getElementByPos(g);y!==a&&i.push(y)}let c=i.length;for(let g=0;g<c;++g)this.setElementByPos(g,i[g]);return this.cut(c-1)}eraseElementByIterator(a){let i=a.o;return this.eraseElementByPos(i),a=a.next(),a}find(a){for(let i=0;i<this.i;++i)if(this.getElementByPos(i)===a)return new p(i,this);return this.end()}reverse(){let a=0,i=this.i-1;for(;a<i;){let c=this.getElementByPos(a);this.setElementByPos(a,this.getElementByPos(i)),this.setElementByPos(i,c),a+=1,i-=1}}unique(){if(this.i<=1)return this.i;let a=1,i=this.getElementByPos(0);for(let c=1;c<this.i;++c){let g=this.getElementByPos(c);g!==i&&(i=g,this.setElementByPos(a++,g))}for(;this.i>a;)this.popBack();return this.i}sort(a){let i=[];for(let c=0;c<this.i;++c)i.push(this.getElementByPos(c));i.sort(a);for(let c=0;c<this.i;++c)this.setElementByPos(c,i[c])}shrinkToFit(){if(this.i===0)return;let a=[];this.forEach(function(i){a.push(i)}),this.P=Math.max(Math.ceil(this.i/this.F),1),this.i=this.j=this.R=this.D=this.N=0,this.A=[];for(let i=0;i<this.P;++i)this.A.push(new Array(this.F));for(let i=0;i<a.length;++i)this.pushBack(a[i])}forEach(a){for(let i=0;i<this.i;++i)a(this.getElementByPos(i),i,this)}[Symbol.iterator](){return(function*(){for(let a=0;a<this.i;++a)yield this.getElementByPos(a)}).bind(this)()}},n=o;e.default=n}),dh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.TreeNodeEnableIndex=e.TreeNode=void 0;var s=class{constructor(h,p){this.ee=1,this.u=void 0,this.l=void 0,this.U=void 0,this.W=void 0,this.tt=void 0,this.u=h,this.l=p}L(){let h=this;if(h.ee===1&&h.tt.tt===h)h=h.W;else if(h.U)for(h=h.U;h.W;)h=h.W;else{let p=h.tt;for(;p.U===h;)h=p,p=h.tt;h=p}return h}B(){let h=this;if(h.W){for(h=h.W;h.U;)h=h.U;return h}else{let p=h.tt;for(;p.W===h;)h=p,p=h.tt;return h.W!==p?p:h}}te(){let h=this.tt,p=this.W,o=p.U;return h.tt===this?h.tt=p:h.U===this?h.U=p:h.W=p,p.tt=h,p.U=this,this.tt=p,this.W=o,o&&(o.tt=this),p}se(){let h=this.tt,p=this.U,o=p.W;return h.tt===this?h.tt=p:h.U===this?h.U=p:h.W=p,p.tt=h,p.W=this,this.tt=p,this.U=o,o&&(o.tt=this),p}};e.TreeNode=s;var r=class extends s{constructor(){super(...arguments),this.rt=1}te(){let h=super.te();return this.ie(),h.ie(),h}se(){let h=super.se();return this.ie(),h.ie(),h}ie(){this.rt=1,this.U&&(this.rt+=this.U.rt),this.W&&(this.rt+=this.W.rt)}};e.TreeNodeEnableIndex=r}),Na=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=dh(),r=er(),h=tr(),p=class extends r.Container{constructor(n=function(i,c){return i<c?-1:i>c?1:0},a=!1){super(),this.Y=void 0,this.v=n,a?(this.re=s.TreeNodeEnableIndex,this.M=function(i,c,g){let y=this.ne(i,c,g);if(y){let _=y.tt;for(;_!==this.h;)_.rt+=1,_=_.tt;let v=this.he(y);if(v){let{parentNode:S,grandParent:C,curNode:x}=v;S.ie(),C.ie(),x.ie()}}return this.i},this.V=function(i){let c=this.fe(i);for(;c!==this.h;)c.rt-=1,c=c.tt}):(this.re=s.TreeNode,this.M=function(i,c,g){let y=this.ne(i,c,g);return y&&this.he(y),this.i},this.V=this.fe),this.h=new this.re}X(n,a){let i=this.h;for(;n;){let c=this.v(n.u,a);if(c<0)n=n.W;else if(c>0)i=n,n=n.U;else return n}return i}Z(n,a){let i=this.h;for(;n;)this.v(n.u,a)<=0?n=n.W:(i=n,n=n.U);return i}$(n,a){let i=this.h;for(;n;){let c=this.v(n.u,a);if(c<0)i=n,n=n.W;else if(c>0)n=n.U;else return n}return i}rr(n,a){let i=this.h;for(;n;)this.v(n.u,a)<0?(i=n,n=n.W):n=n.U;return i}ue(n){for(;;){let a=n.tt;if(a===this.h)return;if(n.ee===1){n.ee=0;return}if(n===a.U){let i=a.W;if(i.ee===1)i.ee=0,a.ee=1,a===this.Y?this.Y=a.te():a.te();else if(i.W&&i.W.ee===1){i.ee=a.ee,a.ee=0,i.W.ee=0,a===this.Y?this.Y=a.te():a.te();return}else i.U&&i.U.ee===1?(i.ee=1,i.U.ee=0,i.se()):(i.ee=1,n=a)}else{let i=a.U;if(i.ee===1)i.ee=0,a.ee=1,a===this.Y?this.Y=a.se():a.se();else if(i.U&&i.U.ee===1){i.ee=a.ee,a.ee=0,i.U.ee=0,a===this.Y?this.Y=a.se():a.se();return}else i.W&&i.W.ee===1?(i.ee=1,i.W.ee=0,i.te()):(i.ee=1,n=a)}}}fe(n){if(this.i===1)return this.clear(),this.h;let a=n;for(;a.U||a.W;){if(a.W)for(a=a.W;a.U;)a=a.U;else a=a.U;[n.u,a.u]=[a.u,n.u],[n.l,a.l]=[a.l,n.l],n=a}this.h.U===a?this.h.U=a.tt:this.h.W===a&&(this.h.W=a.tt),this.ue(a);let i=a.tt;return a===i.U?i.U=void 0:i.W=void 0,this.i-=1,this.Y.ee=0,i}oe(n,a){return n===void 0?!1:this.oe(n.U,a)||a(n)?!0:this.oe(n.W,a)}he(n){for(;;){let a=n.tt;if(a.ee===0)return;let i=a.tt;if(a===i.U){let c=i.W;if(c&&c.ee===1){if(c.ee=a.ee=0,i===this.Y)return;i.ee=1,n=i;continue}else if(n===a.W){if(n.ee=0,n.U&&(n.U.tt=a),n.W&&(n.W.tt=i),a.W=n.U,i.U=n.W,n.U=a,n.W=i,i===this.Y)this.Y=n,this.h.tt=n;else{let g=i.tt;g.U===i?g.U=n:g.W=n}return n.tt=i.tt,a.tt=n,i.tt=n,i.ee=1,{parentNode:a,grandParent:i,curNode:n}}else a.ee=0,i===this.Y?this.Y=i.se():i.se(),i.ee=1}else{let c=i.U;if(c&&c.ee===1){if(c.ee=a.ee=0,i===this.Y)return;i.ee=1,n=i;continue}else if(n===a.U){if(n.ee=0,n.U&&(n.U.tt=i),n.W&&(n.W.tt=a),i.W=n.U,a.U=n.W,n.U=i,n.W=a,i===this.Y)this.Y=n,this.h.tt=n;else{let g=i.tt;g.U===i?g.U=n:g.W=n}return n.tt=i.tt,a.tt=n,i.tt=n,i.ee=1,{parentNode:a,grandParent:i,curNode:n}}else a.ee=0,i===this.Y?this.Y=i.te():i.te(),i.ee=1}return}}ne(n,a,i){if(this.Y===void 0){this.i+=1,this.Y=new this.re(n,a),this.Y.ee=0,this.Y.tt=this.h,this.h.tt=this.Y,this.h.U=this.Y,this.h.W=this.Y;return}let c,g=this.h.U,y=this.v(g.u,n);if(y===0){g.l=a;return}else if(y>0)g.U=new this.re(n,a),g.U.tt=g,c=g.U,this.h.U=c;else{let _=this.h.W,v=this.v(_.u,n);if(v===0){_.l=a;return}else if(v<0)_.W=new this.re(n,a),_.W.tt=_,c=_.W,this.h.W=c;else{if(i!==void 0){let S=i.o;if(S!==this.h){let C=this.v(S.u,n);if(C===0){S.l=a;return}else if(C>0){let x=S.L(),H=this.v(x.u,n);if(H===0){x.l=a;return}else H<0&&(c=new this.re(n,a),x.W===void 0?(x.W=c,c.tt=x):(S.U=c,c.tt=S))}}}if(c===void 0)for(c=this.Y;;){let S=this.v(c.u,n);if(S>0){if(c.U===void 0){c.U=new this.re(n,a),c.U.tt=c,c=c.U;break}c=c.U}else if(S<0){if(c.W===void 0){c.W=new this.re(n,a),c.W.tt=c,c=c.W;break}c=c.W}else{c.l=a;return}}}}return this.i+=1,c}I(n,a){for(;n;){let i=this.v(n.u,a);if(i<0)n=n.W;else if(i>0)n=n.U;else return n}return n||this.h}clear(){this.i=0,this.Y=void 0,this.h.tt=void 0,this.h.U=this.h.W=void 0}updateKeyByIterator(n,a){let i=n.o;if(i===this.h&&(0,h.throwIteratorAccessError)(),this.i===1)return i.u=a,!0;if(i===this.h.U)return this.v(i.B().u,a)>0?(i.u=a,!0):!1;if(i===this.h.W)return this.v(i.L().u,a)<0?(i.u=a,!0):!1;let c=i.L().u;if(this.v(c,a)>=0)return!1;let g=i.B().u;return this.v(g,a)<=0?!1:(i.u=a,!0)}eraseElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let a=0,i=this;return this.oe(this.Y,function(c){return n===a?(i.V(c),!0):(a+=1,!1)}),this.i}eraseElementByKey(n){if(this.i===0)return!1;let a=this.I(this.Y,n);return a===this.h?!1:(this.V(a),!0)}eraseElementByIterator(n){let a=n.o;a===this.h&&(0,h.throwIteratorAccessError)();let i=a.W===void 0;return n.iteratorType===0?i&&n.next():(!i||a.U===void 0)&&n.next(),this.V(a),n}forEach(n){let a=0;for(let i of this)n(i,a++,this)}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let a,i=0;for(let c of this){if(i===n){a=c;break}i+=1}return a}getHeight(){if(this.i===0)return 0;let n=function(a){return a?Math.max(n(a.U),n(a.W))+1:0};return n(this.Y)}},o=p;e.default=o}),Ma=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=er(),r=tr(),h=class extends s.ContainerIterator{constructor(o,n,a){super(a),this.o=o,this.h=n,this.iteratorType===0?(this.pre=function(){return this.o===this.h.U&&(0,r.throwIteratorAccessError)(),this.o=this.o.L(),this},this.next=function(){return this.o===this.h&&(0,r.throwIteratorAccessError)(),this.o=this.o.B(),this}):(this.pre=function(){return this.o===this.h.W&&(0,r.throwIteratorAccessError)(),this.o=this.o.B(),this},this.next=function(){return this.o===this.h&&(0,r.throwIteratorAccessError)(),this.o=this.o.L(),this})}get index(){let o=this.o,n=this.h.tt;if(o===this.h)return n?n.rt-1:0;let a=0;for(o.U&&(a+=o.U.rt);o!==n;){let i=o.tt;o===i.W&&(a+=1,i.U&&(a+=i.U.rt)),o=i}return a}},p=h;e.default=p}),ph=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=p(Na()),r=p(Ma()),h=tr();function p(i){return i&&i.t?i:{default:i}}var o=class ru extends r.default{constructor(c,g,y,_){super(c,g,_),this.container=y}get pointer(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o.u}copy(){return new ru(this.o,this.h,this.container,this.iteratorType)}},n=class extends s.default{constructor(i=[],c,g){super(c,g);let y=this;i.forEach(function(_){y.insert(_)})}*K(i){i!==void 0&&(yield*this.K(i.U),yield i.u,yield*this.K(i.W))}begin(){return new o(this.h.U||this.h,this.h,this)}end(){return new o(this.h,this.h,this)}rBegin(){return new o(this.h.W||this.h,this.h,this,1)}rEnd(){return new o(this.h,this.h,this,1)}front(){return this.h.U?this.h.U.u:void 0}back(){return this.h.W?this.h.W.u:void 0}insert(i,c){return this.M(i,void 0,c)}find(i){let c=this.I(this.Y,i);return new o(c,this.h,this)}lowerBound(i){let c=this.X(this.Y,i);return new o(c,this.h,this)}upperBound(i){let c=this.Z(this.Y,i);return new o(c,this.h,this)}reverseLowerBound(i){let c=this.$(this.Y,i);return new o(c,this.h,this)}reverseUpperBound(i){let c=this.rr(this.Y,i);return new o(c,this.h,this)}union(i){let c=this;return i.forEach(function(g){c.insert(g)}),this.i}[Symbol.iterator](){return this.K(this.Y)}},a=n;e.default=a}),gh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=p(Na()),r=p(Ma()),h=tr();function p(i){return i&&i.t?i:{default:i}}var o=class nu extends r.default{constructor(c,g,y,_){super(c,g,_),this.container=y}get pointer(){this.o===this.h&&(0,h.throwIteratorAccessError)();let c=this;return new Proxy([],{get(g,y){if(y==="0")return c.o.u;if(y==="1")return c.o.l},set(g,y,_){if(y!=="1")throw new TypeError("props must be 1");return c.o.l=_,!0}})}copy(){return new nu(this.o,this.h,this.container,this.iteratorType)}},n=class extends s.default{constructor(i=[],c,g){super(c,g);let y=this;i.forEach(function(_){y.setElement(_[0],_[1])})}*K(i){i!==void 0&&(yield*this.K(i.U),yield[i.u,i.l],yield*this.K(i.W))}begin(){return new o(this.h.U||this.h,this.h,this)}end(){return new o(this.h,this.h,this)}rBegin(){return new o(this.h.W||this.h,this.h,this,1)}rEnd(){return new o(this.h,this.h,this,1)}front(){if(this.i===0)return;let i=this.h.U;return[i.u,i.l]}back(){if(this.i===0)return;let i=this.h.W;return[i.u,i.l]}lowerBound(i){let c=this.X(this.Y,i);return new o(c,this.h,this)}upperBound(i){let c=this.Z(this.Y,i);return new o(c,this.h,this)}reverseLowerBound(i){let c=this.$(this.Y,i);return new o(c,this.h,this)}reverseUpperBound(i){let c=this.rr(this.Y,i);return new o(c,this.h,this)}setElement(i,c,g){return this.M(i,c,g)}find(i){let c=this.I(this.Y,i);return new o(c,this.h,this)}getElementByKey(i){return this.I(this.Y,i).l}union(i){let c=this;return i.forEach(function(g){c.setElement(g[0],g[1])}),this.i}[Symbol.iterator](){return this.K(this.Y)}},a=n;e.default=a}),ja=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=s;function s(r){let h=typeof r;return h==="object"&&r!==null||h==="function"}}),Ua=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.HashContainerIterator=e.HashContainer=void 0;var s=er(),r=p(ja()),h=tr();function p(a){return a&&a.t?a:{default:a}}var o=class extends s.ContainerIterator{constructor(a,i,c){super(c),this.o=a,this.h=i,this.iteratorType===0?(this.pre=function(){return this.o.L===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.L,this},this.next=function(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.B,this}):(this.pre=function(){return this.o.B===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.B,this},this.next=function(){return this.o===this.h&&(0,h.throwIteratorAccessError)(),this.o=this.o.L,this})}};e.HashContainerIterator=o;var n=class extends s.Container{constructor(){super(),this.H=[],this.g={},this.HASH_TAG=Symbol("@@HASH_TAG"),Object.setPrototypeOf(this.g,null),this.h={},this.h.L=this.h.B=this.p=this._=this.h}V(a){let{L:i,B:c}=a;i.B=c,c.L=i,a===this.p&&(this.p=c),a===this._&&(this._=i),this.i-=1}M(a,i,c){c===void 0&&(c=(0,r.default)(a));let g;if(c){let y=a[this.HASH_TAG];if(y!==void 0)return this.H[y].l=i,this.i;Object.defineProperty(a,this.HASH_TAG,{value:this.H.length,configurable:!0}),g={u:a,l:i,L:this._,B:this.h},this.H.push(g)}else{let y=this.g[a];if(y)return y.l=i,this.i;g={u:a,l:i,L:this._,B:this.h},this.g[a]=g}return this.i===0?(this.p=g,this.h.B=g):this._.B=g,this._=g,this.h.L=g,++this.i}I(a,i){if(i===void 0&&(i=(0,r.default)(a)),i){let c=a[this.HASH_TAG];return c===void 0?this.h:this.H[c]}else return this.g[a]||this.h}clear(){let a=this.HASH_TAG;this.H.forEach(function(i){delete i.u[a]}),this.H=[],this.g={},Object.setPrototypeOf(this.g,null),this.i=0,this.p=this._=this.h.L=this.h.B=this.h}eraseElementByKey(a,i){let c;if(i===void 0&&(i=(0,r.default)(a)),i){let g=a[this.HASH_TAG];if(g===void 0)return!1;delete a[this.HASH_TAG],c=this.H[g],delete this.H[g]}else{if(c=this.g[a],c===void 0)return!1;delete this.g[a]}return this.V(c),!0}eraseElementByIterator(a){let i=a.o;return i===this.h&&(0,h.throwIteratorAccessError)(),this.V(i),a.next()}eraseElementByPos(a){if(a<0||a>this.i-1)throw new RangeError;let i=this.p;for(;a--;)i=i.B;return this.V(i),this.i}};e.HashContainer=n}),mh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=Ua(),r=tr(),h=class iu extends s.HashContainerIterator{constructor(a,i,c,g){super(a,i,g),this.container=c}get pointer(){return this.o===this.h&&(0,r.throwIteratorAccessError)(),this.o.u}copy(){return new iu(this.o,this.h,this.container,this.iteratorType)}},p=class extends s.HashContainer{constructor(n=[]){super();let a=this;n.forEach(function(i){a.insert(i)})}begin(){return new h(this.p,this.h,this)}end(){return new h(this.h,this.h,this)}rBegin(){return new h(this._,this.h,this,1)}rEnd(){return new h(this.h,this.h,this,1)}front(){return this.p.u}back(){return this._.u}insert(n,a){return this.M(n,void 0,a)}getElementByPos(n){if(n<0||n>this.i-1)throw new RangeError;let a=this.p;for(;n--;)a=a.B;return a.u}find(n,a){let i=this.I(n,a);return new h(i,this.h,this)}forEach(n){let a=0,i=this.p;for(;i!==this.h;)n(i.u,a++,this),i=i.B}[Symbol.iterator](){return(function*(){let n=this.p;for(;n!==this.h;)yield n.u,n=n.B}).bind(this)()}},o=p;e.default=o}),bh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),e.default=void 0;var s=Ua(),r=p(ja()),h=tr();function p(i){return i&&i.t?i:{default:i}}var o=class ou extends s.HashContainerIterator{constructor(c,g,y,_){super(c,g,_),this.container=y}get pointer(){this.o===this.h&&(0,h.throwIteratorAccessError)();let c=this;return new Proxy([],{get(g,y){if(y==="0")return c.o.u;if(y==="1")return c.o.l},set(g,y,_){if(y!=="1")throw new TypeError("props must be 1");return c.o.l=_,!0}})}copy(){return new ou(this.o,this.h,this.container,this.iteratorType)}},n=class extends s.HashContainer{constructor(i=[]){super();let c=this;i.forEach(function(g){c.setElement(g[0],g[1])})}begin(){return new o(this.p,this.h,this)}end(){return new o(this.h,this.h,this)}rBegin(){return new o(this._,this.h,this,1)}rEnd(){return new o(this.h,this.h,this,1)}front(){if(this.i!==0)return[this.p.u,this.p.l]}back(){if(this.i!==0)return[this._.u,this._.l]}setElement(i,c,g){return this.M(i,c,g)}getElementByKey(i,c){if(c===void 0&&(c=(0,r.default)(i)),c){let y=i[this.HASH_TAG];return y!==void 0?this.H[y].l:void 0}let g=this.g[i];return g?g.l:void 0}getElementByPos(i){if(i<0||i>this.i-1)throw new RangeError;let c=this.p;for(;i--;)c=c.B;return[c.u,c.l]}find(i,c){let g=this.I(i,c);return new o(g,this.h,this)}forEach(i){let c=0,g=this.p;for(;g!==this.h;)i([g.u,g.l],c++,this),g=g.B}[Symbol.iterator](){return(function*(){let i=this.p;for(;i!==this.h;)yield[i.u,i.l],i=i.B}).bind(this)()}},a=n;e.default=a}),yh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"t",{value:!0}),Object.defineProperty(e,"Deque",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"HashMap",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"HashSet",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"LinkList",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"OrderedMap",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"OrderedSet",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"PriorityQueue",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"Queue",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(e,"Stack",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"Vector",{enumerable:!0,get:function(){return p.default}});var s=y(ah()),r=y(lh()),h=y(ch()),p=y(uh()),o=y(hh()),n=y(fh()),a=y(ph()),i=y(gh()),c=y(mh()),g=y(bh());function y(_){return _&&_.t?_:{default:_}}}),_h=E((e,s)=>{we(),_e(),M();var r=yh().OrderedSet,h=Zt()("number-allocator:trace"),p=Zt()("number-allocator:error");function o(a,i){this.low=a,this.high=i}o.prototype.equals=function(a){return this.low===a.low&&this.high===a.high},o.prototype.compare=function(a){return this.low<a.low&&this.high<a.low?-1:a.low<this.low&&a.high<this.low?1:0};function n(a,i){if(!(this instanceof n))return new n(a,i);this.min=a,this.max=i,this.ss=new r([],(c,g)=>c.compare(g)),h("Create"),this.clear()}n.prototype.firstVacant=function(){return this.ss.size()===0?null:this.ss.front().low},n.prototype.alloc=function(){if(this.ss.size()===0)return h("alloc():empty"),null;let a=this.ss.begin(),i=a.pointer.low,c=a.pointer.high,g=i;return g+1<=c?this.ss.updateKeyByIterator(a,new o(i+1,c)):this.ss.eraseElementByPos(0),h("alloc():"+g),g},n.prototype.use=function(a){let i=new o(a,a),c=this.ss.lowerBound(i);if(!c.equals(this.ss.end())){let g=c.pointer.low,y=c.pointer.high;return c.pointer.equals(i)?(this.ss.eraseElementByIterator(c),h("use():"+a),!0):g>a?!1:g===a?(this.ss.updateKeyByIterator(c,new o(g+1,y)),h("use():"+a),!0):y===a?(this.ss.updateKeyByIterator(c,new o(g,y-1)),h("use():"+a),!0):(this.ss.updateKeyByIterator(c,new o(a+1,y)),this.ss.insert(new o(g,a-1)),h("use():"+a),!0)}return h("use():failed"),!1},n.prototype.free=function(a){if(a<this.min||a>this.max){p("free():"+a+" is out of range");return}let i=new o(a,a),c=this.ss.upperBound(i);if(c.equals(this.ss.end())){if(c.equals(this.ss.begin())){this.ss.insert(i);return}c.pre();let g=c.pointer.high;c.pointer.high+1===a?this.ss.updateKeyByIterator(c,new o(g,a)):this.ss.insert(i)}else if(c.equals(this.ss.begin()))if(a+1===c.pointer.low){let g=c.pointer.high;this.ss.updateKeyByIterator(c,new o(a,g))}else this.ss.insert(i);else{let g=c.pointer.low,y=c.pointer.high;c.pre();let _=c.pointer.low;c.pointer.high+1===a?a+1===g?(this.ss.eraseElementByIterator(c),this.ss.updateKeyByIterator(c,new o(_,y))):this.ss.updateKeyByIterator(c,new o(_,a)):a+1===g?(this.ss.eraseElementByIterator(c.next()),this.ss.insert(new o(a,y))):this.ss.insert(i)}h("free():"+a)},n.prototype.clear=function(){h("clear()"),this.ss.clear(),this.ss.insert(new o(this.min,this.max))},n.prototype.intervalCount=function(){return this.ss.size()},n.prototype.dump=function(){console.log("length:"+this.ss.size());for(let a of this.ss)console.log(a)},s.exports=n}),La=E((e,s)=>{we(),_e(),M();var r=_h();s.exports.NumberAllocator=r}),wh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=sh(),r=La(),h=class{constructor(p){p>0&&(this.aliasToTopic=new s.LRUCache({max:p}),this.topicToAlias={},this.numberAllocator=new r.NumberAllocator(1,p),this.max=p,this.length=0)}put(p,o){if(o===0||o>this.max)return!1;let n=this.aliasToTopic.get(o);return n&&delete this.topicToAlias[n],this.aliasToTopic.set(o,p),this.topicToAlias[p]=o,this.numberAllocator.use(o),this.length=this.aliasToTopic.size,!0}getTopicByAlias(p){return this.aliasToTopic.get(p)}getAliasByTopic(p){let o=this.topicToAlias[p];return typeof o<"u"&&this.aliasToTopic.get(o),o}clear(){this.aliasToTopic.clear(),this.topicToAlias={},this.numberAllocator.clear(),this.length=0}getLruAlias(){return this.numberAllocator.firstVacant()||[...this.aliasToTopic.keys()][this.aliasToTopic.size-1]}};e.default=h}),vh=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0});var r=En(),h=s(wh()),p=Xr(),o=(n,a)=>{n.log("_handleConnack");let{options:i}=n,c=i.protocolVersion===5?a.reasonCode:a.returnCode;if(clearTimeout(n.connackTimer),delete n.topicAliasSend,a.properties){if(a.properties.topicAliasMaximum){if(a.properties.topicAliasMaximum>65535){n.emit("error",new Error("topicAliasMaximum from broker is out of range"));return}a.properties.topicAliasMaximum>0&&(n.topicAliasSend=new h.default(a.properties.topicAliasMaximum))}a.properties.serverKeepAlive&&i.keepalive&&(i.keepalive=a.properties.serverKeepAlive),a.properties.maximumPacketSize&&(i.properties||(i.properties={}),i.properties.maximumPacketSize=a.properties.maximumPacketSize)}if(c===0)n.reconnecting=!1,n._onConnect(a);else if(c>0){let g=new p.ErrorWithReasonCode(`Connection refused: ${r.ReasonCodes[c]}`,c);n.emit("error",g)}};e.default=o}),Eh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=(r,h,p)=>{r.log("handling pubrel packet");let o=typeof p<"u"?p:r.noop,{messageId:n}=h,a={cmd:"pubcomp",messageId:n};r.incomingStore.get(h,(i,c)=>{i?r._sendPacket(a,o):(r.emit("message",c.topic,c.payload,c),r.handleMessage(c,g=>{if(g)return o(g);r.incomingStore.del(c,r.noop),r._sendPacket(a,o)}))})};e.default=s}),Sh=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0});var r=s(nh()),h=s(oh()),p=s(vh()),o=s(En()),n=s(Eh()),a=(i,c,g)=>{let{options:y}=i;if(y.protocolVersion===5&&y.properties&&y.properties.maximumPacketSize&&y.properties.maximumPacketSize<c.length)return i.emit("error",new Error(`exceeding packets size ${c.cmd}`)),i.end({reasonCode:149,properties:{reasonString:"Maximum packet size was exceeded"}}),i;switch(i.log("_handlePacket :: emitting packetreceive"),i.emit("packetreceive",c),c.cmd){case"publish":(0,r.default)(i,c,g);break;case"puback":case"pubrec":case"pubcomp":case"suback":case"unsuback":i.reschedulePing(),(0,o.default)(i,c),g();break;case"pubrel":i.reschedulePing(),(0,n.default)(i,c,g);break;case"connack":(0,p.default)(i,c),g();break;case"auth":i.reschedulePing(),(0,h.default)(i,c),g();break;case"pingresp":i.log("_handlePacket :: received pingresp"),i.reschedulePing(),g();break;case"disconnect":i.emit("disconnect",c),g();break;default:i.log("_handlePacket :: unknown command"),g();break}};e.default=a}),Ah=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(e,"__esModule",{value:!0}),e.TypedEventEmitter=void 0;var r=s((Dr(),V(_r))),h=Xr(),p=class{};e.TypedEventEmitter=p,(0,h.applyMixin)(p,r.default)}),Sn=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.isReactNativeBrowser=e.isWebWorker=void 0;var s=()=>{var o;return typeof window<"u"?typeof se<"u"&&((o=se.userAgent)===null||o===void 0?void 0:o.toLowerCase().indexOf(" electron/"))>-1&&Re!=null&&Re.versions?!Object.prototype.hasOwnProperty.call(Re.versions,"electron"):typeof window.document<"u":!1},r=()=>{var o,n;return!!(typeof self=="object"&&!((n=(o=self==null?void 0:self.constructor)===null||o===void 0?void 0:o.name)===null||n===void 0)&&n.includes("WorkerGlobalScope"))},h=()=>typeof se<"u"&&se.product==="ReactNative",p=s()||r()||h();e.isWebWorker=r(),e.isReactNativeBrowser=h(),e.default=p}),Ch=E((e,s)=>{we(),_e(),M(),function(r,h){typeof e=="object"&&typeof s<"u"?h(e):(r=typeof globalThis<"u"?globalThis:r||self,h(r.fastUniqueNumbers={}))}(e,function(r){var h=function(v){return function(S){var C=v(S);return S.add(C),C}},p=function(v){return function(S,C){return v.set(S,C),C}},o=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,a=n*2,i=function(v,S){return function(C){var x=S.get(C),H=x===void 0?C.size:x<a?x+1:0;if(!C.has(H))return v(C,H);if(C.size<n){for(;C.has(H);)H=Math.floor(Math.random()*a);return v(C,H)}if(C.size>o)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;C.has(H);)H=Math.floor(Math.random()*o);return v(C,H)}},c=new WeakMap,g=p(c),y=i(g,c),_=h(y);r.addUniqueNumber=_,r.generateUniqueNumber=y})}),Ih=E((e,s)=>{we(),_e(),M(),function(r,h){typeof e=="object"&&typeof s<"u"?h(e,Ch()):(r=typeof globalThis<"u"?globalThis:r||self,h(r.workerTimersBroker={},r.fastUniqueNumbers))}(e,function(r,h){var p=function(a){return a.method!==void 0&&a.method==="call"},o=function(a){return a.error===null&&typeof a.id=="number"},n=function(a){var i=new Map([[0,function(){}]]),c=new Map([[0,function(){}]]),g=new Map,y=new Worker(a);y.addEventListener("message",function(x){var H=x.data;if(p(H)){var k=H.params,P=k.timerId,K=k.timerType;if(K==="interval"){var Q=i.get(P);if(typeof Q=="number"){var j=g.get(Q);if(j===void 0||j.timerId!==P||j.timerType!==K)throw new Error("The timer is in an undefined state.")}else if(typeof Q<"u")Q();else throw new Error("The timer is in an undefined state.")}else if(K==="timeout"){var N=c.get(P);if(typeof N=="number"){var $=g.get(N);if($===void 0||$.timerId!==P||$.timerType!==K)throw new Error("The timer is in an undefined state.")}else if(typeof N<"u")N(),c.delete(P);else throw new Error("The timer is in an undefined state.")}}else if(o(H)){var X=H.id,ae=g.get(X);if(ae===void 0)throw new Error("The timer is in an undefined state.");var pe=ae.timerId,O=ae.timerType;g.delete(X),O==="interval"?i.delete(pe):c.delete(pe)}else{var te=H.error.message;throw new Error(te)}});var _=function(x){var H=h.generateUniqueNumber(g);g.set(H,{timerId:x,timerType:"interval"}),i.set(x,H),y.postMessage({id:H,method:"clear",params:{timerId:x,timerType:"interval"}})},v=function(x){var H=h.generateUniqueNumber(g);g.set(H,{timerId:x,timerType:"timeout"}),c.set(x,H),y.postMessage({id:H,method:"clear",params:{timerId:x,timerType:"timeout"}})},S=function(x){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=h.generateUniqueNumber(i);return i.set(k,function(){x(),typeof i.get(k)=="function"&&y.postMessage({id:null,method:"set",params:{delay:H,now:performance.now(),timerId:k,timerType:"interval"}})}),y.postMessage({id:null,method:"set",params:{delay:H,now:performance.now(),timerId:k,timerType:"interval"}}),k},C=function(x){var H=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,k=h.generateUniqueNumber(c);return c.set(k,x),y.postMessage({id:null,method:"set",params:{delay:H,now:performance.now(),timerId:k,timerType:"timeout"}}),k};return{clearInterval:_,clearTimeout:v,setInterval:S,setTimeout:C}};r.load=n})}),Th=E((e,s)=>{we(),_e(),M(),function(r,h){typeof e=="object"&&typeof s<"u"?h(e,Ih()):(r=typeof globalThis<"u"?globalThis:r||self,h(r.workerTimers={},r.workerTimersBroker))}(e,function(r,h){var p=function(y,_){var v=null;return function(){if(v!==null)return v;var S=new Blob([_],{type:"application/javascript; charset=utf-8"}),C=URL.createObjectURL(S);return v=y(C),setTimeout(function(){return URL.revokeObjectURL(C)}),v}},o=`(()=>{var e={472:(e,t,r)=>{var o,i;void 0===(i="function"==typeof(o=function(){"use strict";var e=new Map,t=new Map,r=function(t){var r=e.get(t);if(void 0===r)throw new Error('There is no interval scheduled with the given id "'.concat(t,'".'));clearTimeout(r),e.delete(t)},o=function(e){var r=t.get(e);if(void 0===r)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(r),t.delete(e)},i=function(e,t){var r,o=performance.now();return{expected:o+(r=e-Math.max(0,o-t)),remainingDelay:r}},n=function e(t,r,o,i){var n=performance.now();n>o?postMessage({id:null,method:"call",params:{timerId:r,timerType:i}}):t.set(r,setTimeout(e,o-n,t,r,o,i))},a=function(t,r,o){var a=i(t,o),s=a.expected,d=a.remainingDelay;e.set(r,setTimeout(n,d,e,r,s,"interval"))},s=function(e,r,o){var a=i(e,o),s=a.expected,d=a.remainingDelay;t.set(r,setTimeout(n,d,t,r,s,"timeout"))};addEventListener("message",(function(e){var t=e.data;try{if("clear"===t.method){var i=t.id,n=t.params,d=n.timerId,c=n.timerType;if("interval"===c)r(d),postMessage({error:null,id:i});else{if("timeout"!==c)throw new Error('The given type "'.concat(c,'" is not supported'));o(d),postMessage({error:null,id:i})}}else{if("set"!==t.method)throw new Error('The given method "'.concat(t.method,'" is not supported'));var u=t.params,l=u.delay,p=u.now,m=u.timerId,v=u.timerType;if("interval"===v)a(l,m,p);else{if("timeout"!==v)throw new Error('The given type "'.concat(v,'" is not supported'));s(l,m,p)}}}catch(e){postMessage({error:{message:e.message},id:t.id,result:null})}}))})?o.call(t,r,t,e):o)||(e.exports=i)}},t={};function r(o){var i=t[o];if(void 0!==i)return i.exports;var n=t[o]={exports:{}};return e[o](n,n.exports,r),n.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(472)})()})();`,n=p(h.load,o),a=function(y){return n().clearInterval(y)},i=function(y){return n().clearTimeout(y)},c=function(){var y;return(y=n()).setInterval.apply(y,arguments)},g=function(){var y;return(y=n()).setTimeout.apply(y,arguments)};r.clearInterval=a,r.clearTimeout=i,r.setInterval=c,r.setTimeout=g})}),kh=E(e=>{we(),_e(),M();var s=e&&e.__createBinding||(Object.create?function(c,g,y,_){_===void 0&&(_=y);var v=Object.getOwnPropertyDescriptor(g,y);(!v||("get"in v?!g.__esModule:v.writable||v.configurable))&&(v={enumerable:!0,get:function(){return g[y]}}),Object.defineProperty(c,_,v)}:function(c,g,y,_){_===void 0&&(_=y),c[_]=g[y]}),r=e&&e.__setModuleDefault||(Object.create?function(c,g){Object.defineProperty(c,"default",{enumerable:!0,value:g})}:function(c,g){c.default=g}),h=e&&e.__importStar||function(c){if(c&&c.__esModule)return c;var g={};if(c!=null)for(var y in c)y!=="default"&&Object.prototype.hasOwnProperty.call(c,y)&&s(g,c,y);return r(g,c),g};Object.defineProperty(e,"__esModule",{value:!0});var p=h(Sn()),o=Th(),n={set:o.setInterval,clear:o.clearInterval},a={set:(c,g)=>setInterval(c,g),clear:c=>clearInterval(c)},i=c=>{switch(c){case"native":return a;case"worker":return n;case"auto":default:return p.default&&!p.isWebWorker&&!p.isReactNativeBrowser?n:a}};e.default=i}),Da=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(e,"__esModule",{value:!0});var r=s(kh()),h=class{get keepaliveTimeoutTimestamp(){return this._keepaliveTimeoutTimestamp}get intervalEvery(){return this._intervalEvery}get keepalive(){return this._keepalive}constructor(p,o){this.destroyed=!1,this.client=p,this.timer=(0,r.default)(o),this.setKeepalive(p.options.keepalive)}clear(){this.timerId&&(this.timer.clear(this.timerId),this.timerId=null)}setKeepalive(p){if(p*=1e3,isNaN(p)||p<=0||p>2147483647)throw new Error(`Keepalive value must be an integer between 0 and 2147483647. Provided value is ${p}`);this._keepalive=p,this.reschedule(),this.client.log(`KeepaliveManager: set keepalive to ${p}ms`)}destroy(){this.clear(),this.destroyed=!0}reschedule(){if(this.destroyed)return;this.clear(),this.counter=0;let p=Math.ceil(this._keepalive*1.5);this._keepaliveTimeoutTimestamp=Date.now()+p,this._intervalEvery=Math.ceil(this._keepalive/2),this.timerId=this.timer.set(()=>{this.destroyed||(this.counter+=1,this.counter===2?this.client.sendPing():this.counter>2&&this.client.onKeepaliveTimeout())},this._intervalEvery)}};e.default=h}),Uo=E(e=>{we(),_e(),M();var s=e&&e.__createBinding||(Object.create?function(Q,j,N,$){$===void 0&&($=N);var X=Object.getOwnPropertyDescriptor(j,N);(!X||("get"in X?!j.__esModule:X.writable||X.configurable))&&(X={enumerable:!0,get:function(){return j[N]}}),Object.defineProperty(Q,$,X)}:function(Q,j,N,$){$===void 0&&($=N),Q[$]=j[N]}),r=e&&e.__setModuleDefault||(Object.create?function(Q,j){Object.defineProperty(Q,"default",{enumerable:!0,value:j})}:function(Q,j){Q.default=j}),h=e&&e.__importStar||function(Q){if(Q&&Q.__esModule)return Q;var j={};if(Q!=null)for(var N in Q)N!=="default"&&Object.prototype.hasOwnProperty.call(Q,N)&&s(j,Q,N);return r(j,Q),j},p=e&&e.__importDefault||function(Q){return Q&&Q.__esModule?Q:{default:Q}};Object.defineProperty(e,"__esModule",{value:!0});var o=p(bu()),n=p(Zu()),a=p(Pa()),i=Ar(),c=p(th()),g=h(rh()),y=p(Zt()),_=p(xa()),v=p(Sh()),S=Xr(),C=Ah(),x=p(Da()),H=h(Sn()),k=globalThis.setImmediate||((...Q)=>{let j=Q.shift();(0,S.nextTick)(()=>{j(...Q)})}),P={keepalive:60,reschedulePings:!0,protocolId:"MQTT",protocolVersion:4,reconnectPeriod:1e3,connectTimeout:30*1e3,clean:!0,resubscribe:!0,writeCache:!0,timerVariant:"auto"},K=class ws extends C.TypedEventEmitter{static defaultId(){return`mqttjs_${Math.random().toString(16).substr(2,8)}`}constructor(j,N){super(),this.options=N||{};for(let $ in P)typeof this.options[$]>"u"?this.options[$]=P[$]:this.options[$]=N[$];this.log=this.options.log||(0,y.default)("mqttjs:client"),this.noop=this._noop.bind(this),this.log("MqttClient :: version:",ws.VERSION),H.isWebWorker?this.log("MqttClient :: environment","webworker"):this.log("MqttClient :: environment",H.default?"browser":"node"),this.log("MqttClient :: options.protocol",N.protocol),this.log("MqttClient :: options.protocolVersion",N.protocolVersion),this.log("MqttClient :: options.username",N.username),this.log("MqttClient :: options.keepalive",N.keepalive),this.log("MqttClient :: options.reconnectPeriod",N.reconnectPeriod),this.log("MqttClient :: options.rejectUnauthorized",N.rejectUnauthorized),this.log("MqttClient :: options.properties.topicAliasMaximum",N.properties?N.properties.topicAliasMaximum:void 0),this.options.clientId=typeof N.clientId=="string"?N.clientId:ws.defaultId(),this.log("MqttClient :: clientId",this.options.clientId),this.options.customHandleAcks=N.protocolVersion===5&&N.customHandleAcks?N.customHandleAcks:(...$)=>{$[3](null,0)},this.options.writeCache||(n.default.writeToStream.cacheNumbers=!1),this.streamBuilder=j,this.messageIdProvider=typeof this.options.messageIdProvider>"u"?new a.default:this.options.messageIdProvider,this.outgoingStore=N.outgoingStore||new _.default,this.incomingStore=N.incomingStore||new _.default,this.queueQoSZero=N.queueQoSZero===void 0?!0:N.queueQoSZero,this._resubscribeTopics={},this.messageIdToTopic={},this.keepaliveManager=null,this.connected=!1,this.disconnecting=!1,this.reconnecting=!1,this.queue=[],this.connackTimer=null,this.reconnectTimer=null,this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={},this._storeProcessingQueue=[],this.outgoing={},this._firstConnection=!0,N.properties&&N.properties.topicAliasMaximum>0&&(N.properties.topicAliasMaximum>65535?this.log("MqttClient :: options.properties.topicAliasMaximum is out of range"):this.topicAliasRecv=new o.default(N.properties.topicAliasMaximum)),this.on("connect",()=>{let{queue:$}=this,X=()=>{let ae=$.shift();this.log("deliver :: entry %o",ae);let pe=null;if(!ae){this._resubscribe();return}pe=ae.packet,this.log("deliver :: call _sendPacket for %o",pe);let O=!0;pe.messageId&&pe.messageId!==0&&(this.messageIdProvider.register(pe.messageId)||(O=!1)),O?this._sendPacket(pe,te=>{ae.cb&&ae.cb(te),X()}):(this.log("messageId: %d has already used. The message is skipped and removed.",pe.messageId),X())};this.log("connect :: sending queued packets"),X()}),this.on("close",()=>{this.log("close :: connected set to `false`"),this.connected=!1,this.log("close :: clearing connackTimer"),clearTimeout(this.connackTimer),this._destroyKeepaliveManager(),this.topicAliasRecv&&this.topicAliasRecv.clear(),this.log("close :: calling _setupReconnect"),this._setupReconnect()}),this.options.manualConnect||(this.log("MqttClient :: setting up stream"),this.connect())}handleAuth(j,N){N()}handleMessage(j,N){N()}_nextId(){return this.messageIdProvider.allocate()}getLastMessageId(){return this.messageIdProvider.getLastAllocated()}connect(){var j;let N=new i.Writable,$=n.default.parser(this.options),X=null,ae=[];this.log("connect :: calling method to clear reconnect"),this._clearReconnect(),this.log("connect :: using streamBuilder provided to client to create stream"),this.stream=this.streamBuilder(this),$.on("packet",ie=>{this.log("parser :: on packet push to packets array."),ae.push(ie)});let pe=()=>{this.log("work :: getting next packet in queue");let ie=ae.shift();if(ie)this.log("work :: packet pulled from queue"),(0,v.default)(this,ie,O);else{this.log("work :: no packets in queue");let ke=X;X=null,this.log("work :: done flag is %s",!!ke),ke&&ke()}},O=()=>{if(ae.length)(0,S.nextTick)(pe);else{let ie=X;X=null,ie()}};N._write=(ie,ke,ye)=>{X=ye,this.log("writable stream :: parsing buffer"),$.parse(ie),pe()};let te=ie=>{this.log("streamErrorHandler :: error",ie.message),ie.code?(this.log("streamErrorHandler :: emitting error"),this.emit("error",ie)):this.noop(ie)};this.log("connect :: pipe stream to writable stream"),this.stream.pipe(N),this.stream.on("error",te),this.stream.on("close",()=>{this.log("(%s)stream :: on close",this.options.clientId),this._flushVolatile(),this.log("stream: emit close to MqttClient"),this.emit("close")}),this.log("connect: sending packet `connect`");let de={cmd:"connect",protocolId:this.options.protocolId,protocolVersion:this.options.protocolVersion,clean:this.options.clean,clientId:this.options.clientId,keepalive:this.options.keepalive,username:this.options.username,password:this.options.password,properties:this.options.properties};if(this.options.will&&(de.will=Object.assign(Object.assign({},this.options.will),{payload:(j=this.options.will)===null||j===void 0?void 0:j.payload})),this.topicAliasRecv&&(de.properties||(de.properties={}),this.topicAliasRecv&&(de.properties.topicAliasMaximum=this.topicAliasRecv.max)),this._writePacket(de),$.on("error",this.emit.bind(this,"error")),this.options.properties){if(!this.options.properties.authenticationMethod&&this.options.properties.authenticationData)return this.end(()=>this.emit("error",new Error("Packet has no Authentication Method"))),this;if(this.options.properties.authenticationMethod&&this.options.authPacket&&typeof this.options.authPacket=="object"){let ie=Object.assign({cmd:"auth",reasonCode:0},this.options.authPacket);this._writePacket(ie)}}return this.stream.setMaxListeners(1e3),clearTimeout(this.connackTimer),this.connackTimer=setTimeout(()=>{this.log("!!connectTimeout hit!! Calling _cleanUp with force `true`"),this.emit("error",new Error("connack timeout")),this._cleanUp(!0)},this.options.connectTimeout),this}publish(j,N,$,X){this.log("publish :: message `%s` to topic `%s`",N,j);let{options:ae}=this;typeof $=="function"&&(X=$,$=null),$=$||{},$=Object.assign(Object.assign({},{qos:0,retain:!1,dup:!1}),$);let{qos:pe,retain:O,dup:te,properties:de,cbStorePut:ie}=$;if(this._checkDisconnecting(X))return this;let ke=()=>{let ye=0;if((pe===1||pe===2)&&(ye=this._nextId(),ye===null))return this.log("No messageId left"),!1;let ee={cmd:"publish",topic:j,payload:N,qos:pe,retain:O,messageId:ye,dup:te};switch(ae.protocolVersion===5&&(ee.properties=de),this.log("publish :: qos",pe),pe){case 1:case 2:this.outgoing[ee.messageId]={volatile:!1,cb:X||this.noop},this.log("MqttClient:publish: packet cmd: %s",ee.cmd),this._sendPacket(ee,void 0,ie);break;default:this.log("MqttClient:publish: packet cmd: %s",ee.cmd),this._sendPacket(ee,X,ie);break}return!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ke())&&this._storeProcessingQueue.push({invoke:ke,cbStorePut:$.cbStorePut,callback:X}),this}publishAsync(j,N,$){return new Promise((X,ae)=>{this.publish(j,N,$,(pe,O)=>{pe?ae(pe):X(O)})})}subscribe(j,N,$){let X=this.options.protocolVersion;typeof N=="function"&&($=N),$=$||this.noop;let ae=!1,pe=[];typeof j=="string"?(j=[j],pe=j):Array.isArray(j)?pe=j:typeof j=="object"&&(ae=j.resubscribe,delete j.resubscribe,pe=Object.keys(j));let O=g.validateTopics(pe);if(O!==null)return k($,new Error(`Invalid topic ${O}`)),this;if(this._checkDisconnecting($))return this.log("subscribe: discconecting true"),this;let te={qos:0};X===5&&(te.nl=!1,te.rap=!1,te.rh=0),N=Object.assign(Object.assign({},te),N);let de=N.properties,ie=[],ke=(ee,Oe)=>{if(Oe=Oe||N,!Object.prototype.hasOwnProperty.call(this._resubscribeTopics,ee)||this._resubscribeTopics[ee].qos<Oe.qos||ae){let be={topic:ee,qos:Oe.qos};X===5&&(be.nl=Oe.nl,be.rap=Oe.rap,be.rh=Oe.rh,be.properties=de),this.log("subscribe: pushing topic `%s` and qos `%s` to subs list",be.topic,be.qos),ie.push(be)}};if(Array.isArray(j)?j.forEach(ee=>{this.log("subscribe: array topic %s",ee),ke(ee)}):Object.keys(j).forEach(ee=>{this.log("subscribe: object topic %s, %o",ee,j[ee]),ke(ee,j[ee])}),!ie.length)return $(null,[]),this;let ye=()=>{let ee=this._nextId();if(ee===null)return this.log("No messageId left"),!1;let Oe={cmd:"subscribe",subscriptions:ie,messageId:ee};if(de&&(Oe.properties=de),this.options.resubscribe){this.log("subscribe :: resubscribe true");let be=[];ie.forEach(Ne=>{if(this.options.reconnectPeriod>0){let T={qos:Ne.qos};X===5&&(T.nl=Ne.nl||!1,T.rap=Ne.rap||!1,T.rh=Ne.rh||0,T.properties=Ne.properties),this._resubscribeTopics[Ne.topic]=T,be.push(Ne.topic)}}),this.messageIdToTopic[Oe.messageId]=be}return this.outgoing[Oe.messageId]={volatile:!0,cb(be,Ne){if(!be){let{granted:T}=Ne;for(let oe=0;oe<T.length;oe+=1)ie[oe].qos=T[oe]}$(be,ie)}},this.log("subscribe :: call _sendPacket"),this._sendPacket(Oe),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ye())&&this._storeProcessingQueue.push({invoke:ye,callback:$}),this}subscribeAsync(j,N){return new Promise(($,X)=>{this.subscribe(j,N,(ae,pe)=>{ae?X(ae):$(pe)})})}unsubscribe(j,N,$){typeof j=="string"&&(j=[j]),typeof N=="function"&&($=N),$=$||this.noop;let X=g.validateTopics(j);if(X!==null)return k($,new Error(`Invalid topic ${X}`)),this;if(this._checkDisconnecting($))return this;let ae=()=>{let pe=this._nextId();if(pe===null)return this.log("No messageId left"),!1;let O={cmd:"unsubscribe",messageId:pe,unsubscriptions:[]};return typeof j=="string"?O.unsubscriptions=[j]:Array.isArray(j)&&(O.unsubscriptions=j),this.options.resubscribe&&O.unsubscriptions.forEach(te=>{delete this._resubscribeTopics[te]}),typeof N=="object"&&N.properties&&(O.properties=N.properties),this.outgoing[O.messageId]={volatile:!0,cb:$},this.log("unsubscribe: call _sendPacket"),this._sendPacket(O),!0};return(this._storeProcessing||this._storeProcessingQueue.length>0||!ae())&&this._storeProcessingQueue.push({invoke:ae,callback:$}),this}unsubscribeAsync(j,N){return new Promise(($,X)=>{this.unsubscribe(j,N,(ae,pe)=>{ae?X(ae):$(pe)})})}end(j,N,$){this.log("end :: (%s)",this.options.clientId),(j==null||typeof j!="boolean")&&($=$||N,N=j,j=!1),typeof N!="object"&&($=$||N,N=null),this.log("end :: cb? %s",!!$),(!$||typeof $!="function")&&($=this.noop);let X=()=>{this.log("end :: closeStores: closing incoming and outgoing stores"),this.disconnected=!0,this.incomingStore.close(pe=>{this.outgoingStore.close(O=>{if(this.log("end :: closeStores: emitting end"),this.emit("end"),$){let te=pe||O;this.log("end :: closeStores: invoking callback with args"),$(te)}})}),this._deferredReconnect&&this._deferredReconnect()},ae=()=>{this.log("end :: (%s) :: finish :: calling _cleanUp with force %s",this.options.clientId,j),this._cleanUp(j,()=>{this.log("end :: finish :: calling process.nextTick on closeStores"),(0,S.nextTick)(X)},N)};return this.disconnecting?($(),this):(this._clearReconnect(),this.disconnecting=!0,!j&&Object.keys(this.outgoing).length>0?(this.log("end :: (%s) :: calling finish in 10ms once outgoing is empty",this.options.clientId),this.once("outgoingEmpty",setTimeout.bind(null,ae,10))):(this.log("end :: (%s) :: immediately calling finish",this.options.clientId),ae()),this)}endAsync(j,N){return new Promise(($,X)=>{this.end(j,N,ae=>{ae?X(ae):$()})})}removeOutgoingMessage(j){if(this.outgoing[j]){let{cb:N}=this.outgoing[j];this._removeOutgoingAndStoreMessage(j,()=>{N(new Error("Message removed"))})}return this}reconnect(j){this.log("client reconnect");let N=()=>{j?(this.options.incomingStore=j.incomingStore,this.options.outgoingStore=j.outgoingStore):(this.options.incomingStore=null,this.options.outgoingStore=null),this.incomingStore=this.options.incomingStore||new _.default,this.outgoingStore=this.options.outgoingStore||new _.default,this.disconnecting=!1,this.disconnected=!1,this._deferredReconnect=null,this._reconnect()};return this.disconnecting&&!this.disconnected?this._deferredReconnect=N:N(),this}_flushVolatile(){this.outgoing&&(this.log("_flushVolatile :: deleting volatile messages from the queue and setting their callbacks as error function"),Object.keys(this.outgoing).forEach(j=>{this.outgoing[j].volatile&&typeof this.outgoing[j].cb=="function"&&(this.outgoing[j].cb(new Error("Connection closed")),delete this.outgoing[j])}))}_flush(){this.outgoing&&(this.log("_flush: queue exists? %b",!!this.outgoing),Object.keys(this.outgoing).forEach(j=>{typeof this.outgoing[j].cb=="function"&&(this.outgoing[j].cb(new Error("Connection closed")),delete this.outgoing[j])}))}_removeTopicAliasAndRecoverTopicName(j){let N;j.properties&&(N=j.properties.topicAlias);let $=j.topic.toString();if(this.log("_removeTopicAliasAndRecoverTopicName :: alias %d, topic %o",N,$),$.length===0){if(typeof N>"u")return new Error("Unregistered Topic Alias");if($=this.topicAliasSend.getTopicByAlias(N),typeof $>"u")return new Error("Unregistered Topic Alias");j.topic=$}N&&delete j.properties.topicAlias}_checkDisconnecting(j){return this.disconnecting&&(j&&j!==this.noop?j(new Error("client disconnecting")):this.emit("error",new Error("client disconnecting"))),this.disconnecting}_reconnect(){this.log("_reconnect: emitting reconnect to client"),this.emit("reconnect"),this.connected?(this.end(()=>{this.connect()}),this.log("client already connected. disconnecting first.")):(this.log("_reconnect: calling connect"),this.connect())}_setupReconnect(){!this.disconnecting&&!this.reconnectTimer&&this.options.reconnectPeriod>0?(this.reconnecting||(this.log("_setupReconnect :: emit `offline` state"),this.emit("offline"),this.log("_setupReconnect :: set `reconnecting` to `true`"),this.reconnecting=!0),this.log("_setupReconnect :: setting reconnectTimer for %d ms",this.options.reconnectPeriod),this.reconnectTimer=setInterval(()=>{this.log("reconnectTimer :: reconnect triggered!"),this._reconnect()},this.options.reconnectPeriod)):this.log("_setupReconnect :: doing nothing...")}_clearReconnect(){this.log("_clearReconnect : clearing reconnect timer"),this.reconnectTimer&&(clearInterval(this.reconnectTimer),this.reconnectTimer=null)}_cleanUp(j,N,$={}){if(N&&(this.log("_cleanUp :: done callback provided for on stream close"),this.stream.on("close",N)),this.log("_cleanUp :: forced? %s",j),j)this.options.reconnectPeriod===0&&this.options.clean&&this._flush(),this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),this.stream.destroy();else{let X=Object.assign({cmd:"disconnect"},$);this.log("_cleanUp :: (%s) :: call _sendPacket with disconnect packet",this.options.clientId),this._sendPacket(X,()=>{this.log("_cleanUp :: (%s) :: destroying stream",this.options.clientId),k(()=>{this.stream.end(()=>{this.log("_cleanUp :: (%s) :: stream destroyed",this.options.clientId)})})})}!this.disconnecting&&!this.reconnecting&&(this.log("_cleanUp :: client not disconnecting/reconnecting. Clearing and resetting reconnect."),this._clearReconnect(),this._setupReconnect()),this._destroyKeepaliveManager(),N&&!this.connected&&(this.log("_cleanUp :: (%s) :: removing stream `done` callback `close` listener",this.options.clientId),this.stream.removeListener("close",N),N())}_storeAndSend(j,N,$){this.log("storeAndSend :: store packet with cmd %s to outgoingStore",j.cmd);let X=j,ae;if(X.cmd==="publish"&&(X=(0,c.default)(j),ae=this._removeTopicAliasAndRecoverTopicName(X),ae))return N&&N(ae);this.outgoingStore.put(X,pe=>{if(pe)return N&&N(pe);$(),this._writePacket(j,N)})}_applyTopicAlias(j){if(this.options.protocolVersion===5&&j.cmd==="publish"){let N;j.properties&&(N=j.properties.topicAlias);let $=j.topic.toString();if(this.topicAliasSend)if(N){if($.length!==0&&(this.log("applyTopicAlias :: register topic: %s - alias: %d",$,N),!this.topicAliasSend.put($,N)))return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",$,N),new Error("Sending Topic Alias out of range")}else $.length!==0&&(this.options.autoAssignTopicAlias?(N=this.topicAliasSend.getAliasByTopic($),N?(j.topic="",j.properties=Object.assign(Object.assign({},j.properties),{topicAlias:N}),this.log("applyTopicAlias :: auto assign(use) topic: %s - alias: %d",$,N)):(N=this.topicAliasSend.getLruAlias(),this.topicAliasSend.put($,N),j.properties=Object.assign(Object.assign({},j.properties),{topicAlias:N}),this.log("applyTopicAlias :: auto assign topic: %s - alias: %d",$,N))):this.options.autoUseTopicAlias&&(N=this.topicAliasSend.getAliasByTopic($),N&&(j.topic="",j.properties=Object.assign(Object.assign({},j.properties),{topicAlias:N}),this.log("applyTopicAlias :: auto use topic: %s - alias: %d",$,N))));else if(N)return this.log("applyTopicAlias :: error out of range. topic: %s - alias: %d",$,N),new Error("Sending Topic Alias out of range")}}_noop(j){this.log("noop ::",j)}_writePacket(j,N){this.log("_writePacket :: packet: %O",j),this.log("_writePacket :: emitting `packetsend`"),this.emit("packetsend",j),this.log("_writePacket :: writing to stream");let $=n.default.writeToStream(j,this.stream,this.options);this.log("_writePacket :: writeToStream result %s",$),!$&&N&&N!==this.noop?(this.log("_writePacket :: handle events on `drain` once through callback."),this.stream.once("drain",N)):N&&(this.log("_writePacket :: invoking cb"),N())}_sendPacket(j,N,$,X){this.log("_sendPacket :: (%s) ::  start",this.options.clientId),$=$||this.noop,N=N||this.noop;let ae=this._applyTopicAlias(j);if(ae){N(ae);return}if(!this.connected){if(j.cmd==="auth"){this._writePacket(j,N);return}this.log("_sendPacket :: client not connected. Storing packet offline."),this._storePacket(j,N,$);return}if(X){this._writePacket(j,N);return}switch(j.cmd){case"publish":break;case"pubrel":this._storeAndSend(j,N,$);return;default:this._writePacket(j,N);return}switch(j.qos){case 2:case 1:this._storeAndSend(j,N,$);break;case 0:default:this._writePacket(j,N);break}this.log("_sendPacket :: (%s) ::  end",this.options.clientId)}_storePacket(j,N,$){this.log("_storePacket :: packet: %o",j),this.log("_storePacket :: cb? %s",!!N),$=$||this.noop;let X=j;if(X.cmd==="publish"){X=(0,c.default)(j);let pe=this._removeTopicAliasAndRecoverTopicName(X);if(pe)return N&&N(pe)}let ae=X.qos||0;ae===0&&this.queueQoSZero||X.cmd!=="publish"?this.queue.push({packet:X,cb:N}):ae>0?(N=this.outgoing[X.messageId]?this.outgoing[X.messageId].cb:null,this.outgoingStore.put(X,pe=>{if(pe)return N&&N(pe);$()})):N&&N(new Error("No connection to broker"))}_setupKeepaliveManager(){this.log("_setupKeepaliveManager :: keepalive %d (seconds)",this.options.keepalive),!this.keepaliveManager&&this.options.keepalive&&(this.keepaliveManager=new x.default(this,this.options.timerVariant))}_destroyKeepaliveManager(){this.keepaliveManager&&(this.log("_destroyKeepaliveManager :: destroying keepalive manager"),this.keepaliveManager.destroy(),this.keepaliveManager=null)}reschedulePing(){this.keepaliveManager&&this.options.keepalive&&this.options.reschedulePings&&this._reschedulePing()}_reschedulePing(){this.log("_reschedulePing :: rescheduling ping"),this.keepaliveManager.reschedule()}sendPing(){this.log("_sendPing :: sending pingreq"),this._sendPacket({cmd:"pingreq"})}onKeepaliveTimeout(){this.emit("error",new Error("Keepalive timeout")),this.log("onKeepaliveTimeout :: calling _cleanUp with force true"),this._cleanUp(!0)}_resubscribe(){this.log("_resubscribe");let j=Object.keys(this._resubscribeTopics);if(!this._firstConnection&&(this.options.clean||this.options.protocolVersion>=4&&!this.connackPacket.sessionPresent)&&j.length>0)if(this.options.resubscribe)if(this.options.protocolVersion===5){this.log("_resubscribe: protocolVersion 5");for(let N=0;N<j.length;N++){let $={};$[j[N]]=this._resubscribeTopics[j[N]],$.resubscribe=!0,this.subscribe($,{properties:$[j[N]].properties})}}else this._resubscribeTopics.resubscribe=!0,this.subscribe(this._resubscribeTopics);else this._resubscribeTopics={};this._firstConnection=!1}_onConnect(j){if(this.disconnected){this.emit("connect",j);return}this.connackPacket=j,this.messageIdProvider.clear(),this._setupKeepaliveManager(),this.connected=!0;let N=()=>{let $=this.outgoingStore.createStream(),X=()=>{$.destroy(),$=null,this._flushStoreProcessingQueue(),ae()},ae=()=>{this._storeProcessing=!1,this._packetIdsDuringStoreProcessing={}};this.once("close",X),$.on("error",O=>{ae(),this._flushStoreProcessingQueue(),this.removeListener("close",X),this.emit("error",O)});let pe=()=>{if(!$)return;let O=$.read(1),te;if(!O){$.once("readable",pe);return}if(this._storeProcessing=!0,this._packetIdsDuringStoreProcessing[O.messageId]){pe();return}!this.disconnecting&&!this.reconnectTimer?(te=this.outgoing[O.messageId]?this.outgoing[O.messageId].cb:null,this.outgoing[O.messageId]={volatile:!1,cb(de,ie){te&&te(de,ie),pe()}},this._packetIdsDuringStoreProcessing[O.messageId]=!0,this.messageIdProvider.register(O.messageId)?this._sendPacket(O,void 0,void 0,!0):this.log("messageId: %d has already used.",O.messageId)):$.destroy&&$.destroy()};$.on("end",()=>{let O=!0;for(let te in this._packetIdsDuringStoreProcessing)if(!this._packetIdsDuringStoreProcessing[te]){O=!1;break}this.removeListener("close",X),O?(ae(),this._invokeAllStoreProcessingQueue(),this.emit("connect",j)):N()}),pe()};N()}_invokeStoreProcessingQueue(){if(!this._storeProcessing&&this._storeProcessingQueue.length>0){let j=this._storeProcessingQueue[0];if(j&&j.invoke())return this._storeProcessingQueue.shift(),!0}return!1}_invokeAllStoreProcessingQueue(){for(;this._invokeStoreProcessingQueue(););}_flushStoreProcessingQueue(){for(let j of this._storeProcessingQueue)j.cbStorePut&&j.cbStorePut(new Error("Connection closed")),j.callback&&j.callback(new Error("Connection closed"));this._storeProcessingQueue.splice(0)}_removeOutgoingAndStoreMessage(j,N){delete this.outgoing[j],this.outgoingStore.del({messageId:j},($,X)=>{N($,X),this.messageIdProvider.deallocate(j),this._invokeStoreProcessingQueue()})}};K.VERSION=S.MQTTJS_VERSION,e.default=K}),Rh=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=La(),r=class{constructor(){this.numberAllocator=new s.NumberAllocator(1,65535)}allocate(){return this.lastId=this.numberAllocator.alloc(),this.lastId}getLastAllocated(){return this.lastId}register(h){return this.numberAllocator.use(h)}deallocate(h){this.numberAllocator.free(h)}clear(){this.numberAllocator.clear()}};e.default=r});function Cr(e){throw new RangeError(Va[e])}function Fa(e,s){let r=e.split("@"),h="";r.length>1&&(h=r[0]+"@",e=r[1]);let p=function(o,n){let a=[],i=o.length;for(;i--;)a[i]=n(o[i]);return a}((e=e.replace(qa,".")).split("."),s).join(".");return h+p}function $a(e){let s=[],r=0,h=e.length;for(;r<h;){let p=e.charCodeAt(r++);if(p>=55296&&p<=56319&&r<h){let o=e.charCodeAt(r++);(64512&o)==56320?s.push(((1023&p)<<10)+(1023&o)+65536):(s.push(p),r--)}else s.push(p)}return s}var Wa,Ha,qa,Va,Mt,An,Lo,Do,Fo,$o,ur,Oh=w(()=>{we(),_e(),M(),Wa=/^xn--/,Ha=/[^\0-\x7E]/,qa=/[\x2E\u3002\uFF0E\uFF61]/g,Va={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Mt=Math.floor,An=String.fromCharCode,Lo=function(e,s){return e+22+75*(e<26)-((s!=0)<<5)},Do=function(e,s,r){let h=0;for(e=r?Mt(e/700):e>>1,e+=Mt(e/s);e>455;h+=36)e=Mt(e/35);return Mt(h+36*e/(e+38))},Fo=function(e){let s=[],r=e.length,h=0,p=128,o=72,n=e.lastIndexOf("-");n<0&&(n=0);for(let i=0;i<n;++i)e.charCodeAt(i)>=128&&Cr("not-basic"),s.push(e.charCodeAt(i));for(let i=n>0?n+1:0;i<r;){let c=h;for(let y=1,_=36;;_+=36){i>=r&&Cr("invalid-input");let v=(a=e.charCodeAt(i++))-48<10?a-22:a-65<26?a-65:a-97<26?a-97:36;(v>=36||v>Mt((2147483647-h)/y))&&Cr("overflow"),h+=v*y;let S=_<=o?1:_>=o+26?26:_-o;if(v<S)break;let C=36-S;y>Mt(2147483647/C)&&Cr("overflow"),y*=C}let g=s.length+1;o=Do(h-c,g,c==0),Mt(h/g)>2147483647-p&&Cr("overflow"),p+=Mt(h/g),h%=g,s.splice(h++,0,p)}var a;return String.fromCodePoint(...s)},$o=function(e){let s=[],r=(e=$a(e)).length,h=128,p=0,o=72;for(let i of e)i<128&&s.push(An(i));let n=s.length,a=n;for(n&&s.push("-");a<r;){let i=2147483647;for(let g of e)g>=h&&g<i&&(i=g);let c=a+1;i-h>Mt((2147483647-p)/c)&&Cr("overflow"),p+=(i-h)*c,h=i;for(let g of e)if(g<h&&++p>2147483647&&Cr("overflow"),g==h){let y=p;for(let _=36;;_+=36){let v=_<=o?1:_>=o+26?26:_-o;if(y<v)break;let S=y-v,C=36-v;s.push(An(Lo(v+S%C,0))),y=Mt(S/C)}s.push(An(Lo(y,0))),o=Do(p,c,a==n),p=0,++a}++p,++h}return s.join("")},ur={version:"2.1.0",ucs2:{decode:$a,encode:e=>String.fromCodePoint(...e)},decode:Fo,encode:$o,toASCII:function(e){return Fa(e,function(s){return Ha.test(s)?"xn--"+$o(s):s})},toUnicode:function(e){return Fa(e,function(s){return Wa.test(s)?Fo(s.slice(4).toLowerCase()):s})}},ur.decode,ur.encode,ur.toASCII,ur.toUnicode,ur.ucs2,ur.version});function Ph(e,s){return Object.prototype.hasOwnProperty.call(e,s)}var za,$r,Ka,Wt,xh=w(()=>{we(),_e(),M(),za=function(e,s,r,h){s=s||"&",r=r||"=";var p={};if(typeof e!="string"||e.length===0)return p;var o=/\+/g;e=e.split(s);var n=1e3;h&&typeof h.maxKeys=="number"&&(n=h.maxKeys);var a=e.length;n>0&&a>n&&(a=n);for(var i=0;i<a;++i){var c,g,y,_,v=e[i].replace(o,"%20"),S=v.indexOf(r);S>=0?(c=v.substr(0,S),g=v.substr(S+1)):(c=v,g=""),y=decodeURIComponent(c),_=decodeURIComponent(g),Ph(p,y)?Array.isArray(p[y])?p[y].push(_):p[y]=[p[y],_]:p[y]=_}return p},$r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Ka=function(e,s,r,h){return s=s||"&",r=r||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(p){var o=encodeURIComponent($r(p))+r;return Array.isArray(e[p])?e[p].map(function(n){return o+encodeURIComponent($r(n))}).join(s):o+encodeURIComponent($r(e[p]))}).join(s):h?encodeURIComponent($r(h))+r+encodeURIComponent($r(e)):""},Wt={},Wt.decode=Wt.parse=za,Wt.encode=Wt.stringify=Ka,Wt.decode,Wt.encode,Wt.parse,Wt.stringify});function Wo(){throw new Error("setTimeout has not been defined")}function Ho(){throw new Error("clearTimeout has not been defined")}function Ja(e){if(nr===setTimeout)return setTimeout(e,0);if((nr===Wo||!nr)&&setTimeout)return nr=setTimeout,setTimeout(e,0);try{return nr(e,0)}catch{try{return nr.call(null,e,0)}catch{return nr.call(this||Ir,e,0)}}}function Bh(){kr&&Tr&&(kr=!1,Tr.length?Ht=Tr.concat(Ht):Zr=-1,Ht.length&&Qa())}function Qa(){if(!kr){var e=Ja(Bh);kr=!0;for(var s=Ht.length;s;){for(Tr=Ht,Ht=[];++Zr<s;)Tr&&Tr[Zr].run();Zr=-1,s=Ht.length}Tr=null,kr=!1,function(r){if(ir===clearTimeout)return clearTimeout(r);if((ir===Ho||!ir)&&clearTimeout)return ir=clearTimeout,clearTimeout(r);try{ir(r)}catch{try{return ir.call(null,r)}catch{return ir.call(this||Ir,r)}}}(e)}}function Ya(e,s){(this||Ir).fun=e,(this||Ir).array=s}function rr(){}var Ga,nr,ir,Ir,lt,Tr,Ht,kr,Zr,st,Nh=w(()=>{we(),_e(),M(),Ir=typeof globalThis<"u"?globalThis:typeof self<"u"?self:gc,lt=Ga={},function(){try{nr=typeof setTimeout=="function"?setTimeout:Wo}catch{nr=Wo}try{ir=typeof clearTimeout=="function"?clearTimeout:Ho}catch{ir=Ho}}(),Ht=[],kr=!1,Zr=-1,lt.nextTick=function(e){var s=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)s[r-1]=arguments[r];Ht.push(new Ya(e,s)),Ht.length!==1||kr||Ja(Qa)},Ya.prototype.run=function(){(this||Ir).fun.apply(null,(this||Ir).array)},lt.title="browser",lt.browser=!0,lt.env={},lt.argv=[],lt.version="",lt.versions={},lt.on=rr,lt.addListener=rr,lt.once=rr,lt.off=rr,lt.removeListener=rr,lt.removeAllListeners=rr,lt.emit=rr,lt.prependListener=rr,lt.prependOnceListener=rr,lt.listeners=function(e){return[]},lt.binding=function(e){throw new Error("process.binding is not supported")},lt.cwd=function(){return"/"},lt.chdir=function(e){throw new Error("process.chdir is not supported")},lt.umask=function(){return 0},st=Ga,st.addListener,st.argv,st.binding,st.browser,st.chdir,st.cwd,st.emit,st.env,st.listeners,st.nextTick,st.off,st.on,st.once,st.prependListener,st.prependOnceListener,st.removeAllListeners,st.removeListener,st.title,st.umask,st.version,st.versions});function Mh(){if(qo)return Cn;qo=!0;var e=Cn={},s,r;function h(){throw new Error("setTimeout has not been defined")}function p(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=h}catch{s=h}try{typeof clearTimeout=="function"?r=clearTimeout:r=p}catch{r=p}})();function o(C){if(s===setTimeout)return setTimeout(C,0);if((s===h||!s)&&setTimeout)return s=setTimeout,setTimeout(C,0);try{return s(C,0)}catch{try{return s.call(null,C,0)}catch{return s.call(this||Rr,C,0)}}}function n(C){if(r===clearTimeout)return clearTimeout(C);if((r===p||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(C);try{return r(C)}catch{try{return r.call(null,C)}catch{return r.call(this||Rr,C)}}}var a=[],i=!1,c,g=-1;function y(){!i||!c||(i=!1,c.length?a=c.concat(a):g=-1,a.length&&_())}function _(){if(!i){var C=o(y);i=!0;for(var x=a.length;x;){for(c=a,a=[];++g<x;)c&&c[g].run();g=-1,x=a.length}c=null,i=!1,n(C)}}e.nextTick=function(C){var x=new Array(arguments.length-1);if(arguments.length>1)for(var H=1;H<arguments.length;H++)x[H-1]=arguments[H];a.push(new v(C,x)),a.length===1&&!i&&o(_)};function v(C,x){(this||Rr).fun=C,(this||Rr).array=x}v.prototype.run=function(){(this||Rr).fun.apply(null,(this||Rr).array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function S(){}return e.on=S,e.addListener=S,e.once=S,e.off=S,e.removeListener=S,e.removeAllListeners=S,e.emit=S,e.prependListener=S,e.prependOnceListener=S,e.listeners=function(C){return[]},e.binding=function(C){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(C){throw new Error("process.chdir is not supported")},e.umask=function(){return 0},Cn}var Cn,qo,Rr,rt,Xa=w(()=>{we(),_e(),M(),Cn={},qo=!1,Rr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:gc,rt=Mh(),rt.platform="browser",rt.addListener,rt.argv,rt.binding,rt.browser,rt.chdir,rt.cwd,rt.emit,rt.env,rt.listeners,rt.nextTick,rt.off,rt.on,rt.once,rt.prependListener,rt.prependOnceListener,rt.removeAllListeners,rt.removeListener,rt.title,rt.umask,rt.version,rt.versions});function jh(){if(Vo)return In;Vo=!0;var e=rt;function s(o){if(typeof o!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(o))}function r(o,n){for(var a="",i=0,c=-1,g=0,y,_=0;_<=o.length;++_){if(_<o.length)y=o.charCodeAt(_);else{if(y===47)break;y=47}if(y===47){if(!(c===_-1||g===1))if(c!==_-1&&g===2){if(a.length<2||i!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var v=a.lastIndexOf("/");if(v!==a.length-1){v===-1?(a="",i=0):(a=a.slice(0,v),i=a.length-1-a.lastIndexOf("/")),c=_,g=0;continue}}else if(a.length===2||a.length===1){a="",i=0,c=_,g=0;continue}}n&&(a.length>0?a+="/..":a="..",i=2)}else a.length>0?a+="/"+o.slice(c+1,_):a=o.slice(c+1,_),i=_-c-1;c=_,g=0}else y===46&&g!==-1?++g:g=-1}return a}function h(o,n){var a=n.dir||n.root,i=n.base||(n.name||"")+(n.ext||"");return a?a===n.root?a+i:a+o+i:i}var p={resolve:function(){for(var o="",n=!1,a,i=arguments.length-1;i>=-1&&!n;i--){var c;i>=0?c=arguments[i]:(a===void 0&&(a=e.cwd()),c=a),s(c),c.length!==0&&(o=c+"/"+o,n=c.charCodeAt(0)===47)}return o=r(o,!n),n?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(o){if(s(o),o.length===0)return".";var n=o.charCodeAt(0)===47,a=o.charCodeAt(o.length-1)===47;return o=r(o,!n),o.length===0&&!n&&(o="."),o.length>0&&a&&(o+="/"),n?"/"+o:o},isAbsolute:function(o){return s(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var o,n=0;n<arguments.length;++n){var a=arguments[n];s(a),a.length>0&&(o===void 0?o=a:o+="/"+a)}return o===void 0?".":p.normalize(o)},relative:function(o,n){if(s(o),s(n),o===n||(o=p.resolve(o),n=p.resolve(n),o===n))return"";for(var a=1;a<o.length&&o.charCodeAt(a)===47;++a);for(var i=o.length,c=i-a,g=1;g<n.length&&n.charCodeAt(g)===47;++g);for(var y=n.length,_=y-g,v=c<_?c:_,S=-1,C=0;C<=v;++C){if(C===v){if(_>v){if(n.charCodeAt(g+C)===47)return n.slice(g+C+1);if(C===0)return n.slice(g+C)}else c>v&&(o.charCodeAt(a+C)===47?S=C:C===0&&(S=0));break}var x=o.charCodeAt(a+C),H=n.charCodeAt(g+C);if(x!==H)break;x===47&&(S=C)}var k="";for(C=a+S+1;C<=i;++C)(C===i||o.charCodeAt(C)===47)&&(k.length===0?k+="..":k+="/..");return k.length>0?k+n.slice(g+S):(g+=S,n.charCodeAt(g)===47&&++g,n.slice(g))},_makeLong:function(o){return o},dirname:function(o){if(s(o),o.length===0)return".";for(var n=o.charCodeAt(0),a=n===47,i=-1,c=!0,g=o.length-1;g>=1;--g)if(n=o.charCodeAt(g),n===47){if(!c){i=g;break}}else c=!1;return i===-1?a?"/":".":a&&i===1?"//":o.slice(0,i)},basename:function(o,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');s(o);var a=0,i=-1,c=!0,g;if(n!==void 0&&n.length>0&&n.length<=o.length){if(n.length===o.length&&n===o)return"";var y=n.length-1,_=-1;for(g=o.length-1;g>=0;--g){var v=o.charCodeAt(g);if(v===47){if(!c){a=g+1;break}}else _===-1&&(c=!1,_=g+1),y>=0&&(v===n.charCodeAt(y)?--y===-1&&(i=g):(y=-1,i=_))}return a===i?i=_:i===-1&&(i=o.length),o.slice(a,i)}else{for(g=o.length-1;g>=0;--g)if(o.charCodeAt(g)===47){if(!c){a=g+1;break}}else i===-1&&(c=!1,i=g+1);return i===-1?"":o.slice(a,i)}},extname:function(o){s(o);for(var n=-1,a=0,i=-1,c=!0,g=0,y=o.length-1;y>=0;--y){var _=o.charCodeAt(y);if(_===47){if(!c){a=y+1;break}continue}i===-1&&(c=!1,i=y+1),_===46?n===-1?n=y:g!==1&&(g=1):n!==-1&&(g=-1)}return n===-1||i===-1||g===0||g===1&&n===i-1&&n===a+1?"":o.slice(n,i)},format:function(o){if(o===null||typeof o!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof o);return h("/",o)},parse:function(o){s(o);var n={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return n;var a=o.charCodeAt(0),i=a===47,c;i?(n.root="/",c=1):c=0;for(var g=-1,y=0,_=-1,v=!0,S=o.length-1,C=0;S>=c;--S){if(a=o.charCodeAt(S),a===47){if(!v){y=S+1;break}continue}_===-1&&(v=!1,_=S+1),a===46?g===-1?g=S:C!==1&&(C=1):g!==-1&&(C=-1)}return g===-1||_===-1||C===0||C===1&&g===_-1&&g===y+1?_!==-1&&(y===0&&i?n.base=n.name=o.slice(1,_):n.base=n.name=o.slice(y,_)):(y===0&&i?(n.name=o.slice(1,g),n.base=o.slice(1,_)):(n.name=o.slice(y,g),n.base=o.slice(y,_)),n.ext=o.slice(g,_)),y>0?n.dir=o.slice(0,y-1):i&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};return p.posix=p,In=p,In}var In,Vo,zo,Uh=w(()=>{we(),_e(),M(),Xa(),In={},Vo=!1,zo=jh()}),Za={};A(Za,{URL:()=>Il,Url:()=>vl,default:()=>et,fileURLToPath:()=>el,format:()=>El,parse:()=>Cl,pathToFileURL:()=>tl,resolve:()=>Sl,resolveObject:()=>Al});function Ot(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function en(e,s,r){if(e&&jt.isObject(e)&&e instanceof Ot)return e;var h=new Ot;return h.parse(e,s,r),h}function Lh(){if(Yo)return On;Yo=!0;var e=st;function s(o){if(typeof o!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(o))}function r(o,n){for(var a="",i=0,c=-1,g=0,y,_=0;_<=o.length;++_){if(_<o.length)y=o.charCodeAt(_);else{if(y===47)break;y=47}if(y===47){if(!(c===_-1||g===1))if(c!==_-1&&g===2){if(a.length<2||i!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var v=a.lastIndexOf("/");if(v!==a.length-1){v===-1?(a="",i=0):(a=a.slice(0,v),i=a.length-1-a.lastIndexOf("/")),c=_,g=0;continue}}else if(a.length===2||a.length===1){a="",i=0,c=_,g=0;continue}}n&&(a.length>0?a+="/..":a="..",i=2)}else a.length>0?a+="/"+o.slice(c+1,_):a=o.slice(c+1,_),i=_-c-1;c=_,g=0}else y===46&&g!==-1?++g:g=-1}return a}function h(o,n){var a=n.dir||n.root,i=n.base||(n.name||"")+(n.ext||"");return a?a===n.root?a+i:a+o+i:i}var p={resolve:function(){for(var o="",n=!1,a,i=arguments.length-1;i>=-1&&!n;i--){var c;i>=0?c=arguments[i]:(a===void 0&&(a=e.cwd()),c=a),s(c),c.length!==0&&(o=c+"/"+o,n=c.charCodeAt(0)===47)}return o=r(o,!n),n?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(o){if(s(o),o.length===0)return".";var n=o.charCodeAt(0)===47,a=o.charCodeAt(o.length-1)===47;return o=r(o,!n),o.length===0&&!n&&(o="."),o.length>0&&a&&(o+="/"),n?"/"+o:o},isAbsolute:function(o){return s(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var o,n=0;n<arguments.length;++n){var a=arguments[n];s(a),a.length>0&&(o===void 0?o=a:o+="/"+a)}return o===void 0?".":p.normalize(o)},relative:function(o,n){if(s(o),s(n),o===n||(o=p.resolve(o),n=p.resolve(n),o===n))return"";for(var a=1;a<o.length&&o.charCodeAt(a)===47;++a);for(var i=o.length,c=i-a,g=1;g<n.length&&n.charCodeAt(g)===47;++g);for(var y=n.length,_=y-g,v=c<_?c:_,S=-1,C=0;C<=v;++C){if(C===v){if(_>v){if(n.charCodeAt(g+C)===47)return n.slice(g+C+1);if(C===0)return n.slice(g+C)}else c>v&&(o.charCodeAt(a+C)===47?S=C:C===0&&(S=0));break}var x=o.charCodeAt(a+C),H=n.charCodeAt(g+C);if(x!==H)break;x===47&&(S=C)}var k="";for(C=a+S+1;C<=i;++C)(C===i||o.charCodeAt(C)===47)&&(k.length===0?k+="..":k+="/..");return k.length>0?k+n.slice(g+S):(g+=S,n.charCodeAt(g)===47&&++g,n.slice(g))},_makeLong:function(o){return o},dirname:function(o){if(s(o),o.length===0)return".";for(var n=o.charCodeAt(0),a=n===47,i=-1,c=!0,g=o.length-1;g>=1;--g)if(n=o.charCodeAt(g),n===47){if(!c){i=g;break}}else c=!1;return i===-1?a?"/":".":a&&i===1?"//":o.slice(0,i)},basename:function(o,n){if(n!==void 0&&typeof n!="string")throw new TypeError('"ext" argument must be a string');s(o);var a=0,i=-1,c=!0,g;if(n!==void 0&&n.length>0&&n.length<=o.length){if(n.length===o.length&&n===o)return"";var y=n.length-1,_=-1;for(g=o.length-1;g>=0;--g){var v=o.charCodeAt(g);if(v===47){if(!c){a=g+1;break}}else _===-1&&(c=!1,_=g+1),y>=0&&(v===n.charCodeAt(y)?--y===-1&&(i=g):(y=-1,i=_))}return a===i?i=_:i===-1&&(i=o.length),o.slice(a,i)}else{for(g=o.length-1;g>=0;--g)if(o.charCodeAt(g)===47){if(!c){a=g+1;break}}else i===-1&&(c=!1,i=g+1);return i===-1?"":o.slice(a,i)}},extname:function(o){s(o);for(var n=-1,a=0,i=-1,c=!0,g=0,y=o.length-1;y>=0;--y){var _=o.charCodeAt(y);if(_===47){if(!c){a=y+1;break}continue}i===-1&&(c=!1,i=y+1),_===46?n===-1?n=y:g!==1&&(g=1):n!==-1&&(g=-1)}return n===-1||i===-1||g===0||g===1&&n===i-1&&n===a+1?"":o.slice(n,i)},format:function(o){if(o===null||typeof o!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof o);return h("/",o)},parse:function(o){s(o);var n={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return n;var a=o.charCodeAt(0),i=a===47,c;i?(n.root="/",c=1):c=0;for(var g=-1,y=0,_=-1,v=!0,S=o.length-1,C=0;S>=c;--S){if(a=o.charCodeAt(S),a===47){if(!v){y=S+1;break}continue}_===-1&&(v=!1,_=S+1),a===46?g===-1?g=S:C!==1&&(C=1):g!==-1&&(C=-1)}return g===-1||_===-1||C===0||C===1&&g===_-1&&g===y+1?_!==-1&&(y===0&&i?n.base=n.name=o.slice(1,_):n.base=n.name=o.slice(y,_)):(y===0&&i?(n.name=o.slice(1,g),n.base=o.slice(1,_)):(n.name=o.slice(y,g),n.base=o.slice(y,_)),n.ext=o.slice(g,_)),y>0?n.dir=o.slice(0,y-1):i&&(n.dir="/"),n},sep:"/",delimiter:":",win32:null,posix:null};return p.posix=p,On=p,On}function Dh(e){if(typeof e=="string")e=new URL(e);else if(!(e instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(e.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return Pn?Fh(e):$h(e)}function Fh(e){let s=e.hostname,r=e.pathname;for(let h=0;h<r.length;h++)if(r[h]==="%"){let p=r.codePointAt(h+2)||32;if(r[h+1]==="2"&&p===102||r[h+1]==="5"&&p===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(r=r.replace(pl,"\\"),r=decodeURIComponent(r),s!=="")return`\\\\${s}${r}`;{let h=r.codePointAt(1)|32,p=r[2];if(h<fl||h>dl||p!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return r.slice(1)}}function $h(e){if(e.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let s=e.pathname;for(let r=0;r<s.length;r++)if(s[r]==="%"){let h=s.codePointAt(r+2)||32;if(s[r+1]==="2"&&h===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(s)}function Wh(e){let s=Go.resolve(e),r=e.charCodeAt(e.length-1);(r===hl||Pn&&r===ul)&&s[s.length-1]!==Go.sep&&(s+="/");let h=new URL("file://");return s.includes("%")&&(s=s.replace(gl,"%25")),!Pn&&s.includes("\\")&&(s=s.replace(ml,"%5C")),s.includes(`
`)&&(s=s.replace(bl,"%0A")),s.includes("\r")&&(s=s.replace(yl,"%0D")),s.includes("	")&&(s=s.replace(_l,"%09")),h.pathname=s,h}function el(e){if(typeof e=="string")e=new URL(e);else if(!(e instanceof URL))throw new Deno.errors.InvalidData("invalid argument path , must be a string or URL");if(e.protocol!=="file:")throw new Deno.errors.InvalidData("invalid url scheme");return xn?Hh(e):qh(e)}function Hh(e){let s=e.hostname,r=e.pathname;for(let h=0;h<r.length;h++)if(r[h]==="%"){let p=r.codePointAt(h+2)||32;if(r[h+1]==="2"&&p===102||r[h+1]==="5"&&p===99)throw new Deno.errors.InvalidData("must not include encoded \\ or / characters")}if(r=r.replace(Pl,"\\"),r=decodeURIComponent(r),s!=="")return`\\\\${s}${r}`;{let h=r.codePointAt(1)|32,p=r[2];if(h<Rl||h>Ol||p!==":")throw new Deno.errors.InvalidData("file url path must be absolute");return r.slice(1)}}function qh(e){if(e.hostname!=="")throw new Deno.errors.InvalidData("invalid file url hostname");let s=e.pathname;for(let r=0;r<s.length;r++)if(s[r]==="%"){let h=s.codePointAt(r+2)||32;if(s[r+1]==="2"&&h===102)throw new Deno.errors.InvalidData("must not include encoded / characters")}return decodeURIComponent(s)}function tl(e){let s=zo.resolve(e),r=e.charCodeAt(e.length-1);(r===kl||xn&&r===Tl)&&s[s.length-1]!==zo.sep&&(s+="/");let h=new URL("file://");return s.includes("%")&&(s=s.replace(xl,"%25")),!xn&&s.includes("\\")&&(s=s.replace(Bl,"%5C")),s.includes(`
`)&&(s=s.replace(Nl,"%0A")),s.includes("\r")&&(s=s.replace(Ml,"%0D")),s.includes("	")&&(s=s.replace(jl,"%09")),h.pathname=s,h}var et,rl,jt,nl,il,ol,sl,Tn,Ko,Jo,Qo,al,ll,kn,Or,Rn,On,Yo,Go,cl,ul,hl,fl,dl,Pn,pl,gl,ml,bl,yl,_l,wl,vl,El,Sl,Al,Cl,Il,Tl,kl,Rl,Ol,xn,Pl,xl,Bl,Nl,Ml,jl,Vh=w(()=>{we(),_e(),M(),Oh(),xh(),Nh(),Uh(),Xa(),et={},rl=ur,jt={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}},et.parse=en,et.resolve=function(e,s){return en(e,!1,!0).resolve(s)},et.resolveObject=function(e,s){return e?en(e,!1,!0).resolveObject(s):s},et.format=function(e){return jt.isString(e)&&(e=en(e)),e instanceof Ot?e.format():Ot.prototype.format.call(e)},et.Url=Ot,nl=/^([a-z0-9.+-]+:)/i,il=/:[0-9]*$/,ol=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,sl=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r",`
`,"	"]),Tn=["'"].concat(sl),Ko=["%","/","?",";","#"].concat(Tn),Jo=["/","?","#"],Qo=/^[+a-z0-9A-Z_-]{0,63}$/,al=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,ll={javascript:!0,"javascript:":!0},kn={javascript:!0,"javascript:":!0},Or={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Rn=Wt,Ot.prototype.parse=function(e,s,r){if(!jt.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var h=e.indexOf("?"),p=h!==-1&&h<e.indexOf("#")?"?":"#",o=e.split(p);o[0]=o[0].replace(/\\/g,"/");var n=e=o.join(p);if(n=n.trim(),!r&&e.split("#").length===1){var a=ol.exec(n);if(a)return this.path=n,this.href=n,this.pathname=a[1],a[2]?(this.search=a[2],this.query=s?Rn.parse(this.search.substr(1)):this.search.substr(1)):s&&(this.search="",this.query={}),this}var i=nl.exec(n);if(i){var c=(i=i[0]).toLowerCase();this.protocol=c,n=n.substr(i.length)}if(r||i||n.match(/^\/\/[^@\/]+@[^@\/]+/)){var g=n.substr(0,2)==="//";!g||i&&kn[i]||(n=n.substr(2),this.slashes=!0)}if(!kn[i]&&(g||i&&!Or[i])){for(var y,_,v=-1,S=0;S<Jo.length;S++)(C=n.indexOf(Jo[S]))!==-1&&(v===-1||C<v)&&(v=C);for((_=v===-1?n.lastIndexOf("@"):n.lastIndexOf("@",v))!==-1&&(y=n.slice(0,_),n=n.slice(_+1),this.auth=decodeURIComponent(y)),v=-1,S=0;S<Ko.length;S++){var C;(C=n.indexOf(Ko[S]))!==-1&&(v===-1||C<v)&&(v=C)}v===-1&&(v=n.length),this.host=n.slice(0,v),n=n.slice(v),this.parseHost(),this.hostname=this.hostname||"";var x=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!x)for(var H=this.hostname.split(/\./),k=(S=0,H.length);S<k;S++){var P=H[S];if(P&&!P.match(Qo)){for(var K="",Q=0,j=P.length;Q<j;Q++)P.charCodeAt(Q)>127?K+="x":K+=P[Q];if(!K.match(Qo)){var N=H.slice(0,S),$=H.slice(S+1),X=P.match(al);X&&(N.push(X[1]),$.unshift(X[2])),$.length&&(n="/"+$.join(".")+n),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=rl.toASCII(this.hostname));var ae=this.port?":"+this.port:"",pe=this.hostname||"";this.host=pe+ae,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),n[0]!=="/"&&(n="/"+n))}if(!ll[c])for(S=0,k=Tn.length;S<k;S++){var O=Tn[S];if(n.indexOf(O)!==-1){var te=encodeURIComponent(O);te===O&&(te=escape(O)),n=n.split(O).join(te)}}var de=n.indexOf("#");de!==-1&&(this.hash=n.substr(de),n=n.slice(0,de));var ie=n.indexOf("?");if(ie!==-1?(this.search=n.substr(ie),this.query=n.substr(ie+1),s&&(this.query=Rn.parse(this.query)),n=n.slice(0,ie)):s&&(this.search="",this.query={}),n&&(this.pathname=n),Or[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){ae=this.pathname||"";var ke=this.search||"";this.path=ae+ke}return this.href=this.format(),this},Ot.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var s=this.protocol||"",r=this.pathname||"",h=this.hash||"",p=!1,o="";this.host?p=e+this.host:this.hostname&&(p=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(p+=":"+this.port)),this.query&&jt.isObject(this.query)&&Object.keys(this.query).length&&(o=Rn.stringify(this.query));var n=this.search||o&&"?"+o||"";return s&&s.substr(-1)!==":"&&(s+=":"),this.slashes||(!s||Or[s])&&p!==!1?(p="//"+(p||""),r&&r.charAt(0)!=="/"&&(r="/"+r)):p||(p=""),h&&h.charAt(0)!=="#"&&(h="#"+h),n&&n.charAt(0)!=="?"&&(n="?"+n),s+p+(r=r.replace(/[?#]/g,function(a){return encodeURIComponent(a)}))+(n=n.replace("#","%23"))+h},Ot.prototype.resolve=function(e){return this.resolveObject(en(e,!1,!0)).format()},Ot.prototype.resolveObject=function(e){if(jt.isString(e)){var s=new Ot;s.parse(e,!1,!0),e=s}for(var r=new Ot,h=Object.keys(this),p=0;p<h.length;p++){var o=h[p];r[o]=this[o]}if(r.hash=e.hash,e.href==="")return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var n=Object.keys(e),a=0;a<n.length;a++){var i=n[a];i!=="protocol"&&(r[i]=e[i])}return Or[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!Or[e.protocol]){for(var c=Object.keys(e),g=0;g<c.length;g++){var y=c[g];r[y]=e[y]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||kn[e.protocol])r.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),_[0]!==""&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var v=r.pathname||"",S=r.search||"";r.path=v+S}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var C=r.pathname&&r.pathname.charAt(0)==="/",x=e.host||e.pathname&&e.pathname.charAt(0)==="/",H=x||C||r.host&&e.pathname,k=H,P=r.pathname&&r.pathname.split("/")||[],K=(_=e.pathname&&e.pathname.split("/")||[],r.protocol&&!Or[r.protocol]);if(K&&(r.hostname="",r.port=null,r.host&&(P[0]===""?P[0]=r.host:P.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(_[0]===""?_[0]=e.host:_.unshift(e.host)),e.host=null),H=H&&(_[0]===""||P[0]==="")),x)r.host=e.host||e.host===""?e.host:r.host,r.hostname=e.hostname||e.hostname===""?e.hostname:r.hostname,r.search=e.search,r.query=e.query,P=_;else if(_.length)P||(P=[]),P.pop(),P=P.concat(_),r.search=e.search,r.query=e.query;else if(!jt.isNullOrUndefined(e.search))return K&&(r.hostname=r.host=P.shift(),(X=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=X.shift(),r.host=r.hostname=X.shift())),r.search=e.search,r.query=e.query,jt.isNull(r.pathname)&&jt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!P.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var Q=P.slice(-1)[0],j=(r.host||e.host||P.length>1)&&(Q==="."||Q==="..")||Q==="",N=0,$=P.length;$>=0;$--)(Q=P[$])==="."?P.splice($,1):Q===".."?(P.splice($,1),N++):N&&(P.splice($,1),N--);if(!H&&!k)for(;N--;N)P.unshift("..");!H||P[0]===""||P[0]&&P[0].charAt(0)==="/"||P.unshift(""),j&&P.join("/").substr(-1)!=="/"&&P.push("");var X,ae=P[0]===""||P[0]&&P[0].charAt(0)==="/";return K&&(r.hostname=r.host=ae?"":P.length?P.shift():"",(X=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=X.shift(),r.host=r.hostname=X.shift())),(H=H||r.host&&P.length)&&!ae&&P.unshift(""),P.length?r.pathname=P.join("/"):(r.pathname=null,r.path=null),jt.isNull(r.pathname)&&jt.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},Ot.prototype.parseHost=function(){var e=this.host,s=il.exec(e);s&&((s=s[0])!==":"&&(this.port=s.substr(1)),e=e.substr(0,e.length-s.length)),e&&(this.hostname=e)},et.Url,et.format,et.resolve,et.resolveObject,On={},Yo=!1,Go=Lh(),cl=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,et.URL=typeof URL<"u"?URL:null,et.pathToFileURL=Wh,et.fileURLToPath=Dh,et.Url,et.format,et.resolve,et.resolveObject,et.URL,ul=92,hl=47,fl=97,dl=122,Pn=cl==="win32",pl=/\//g,gl=/%/g,ml=/\\/g,bl=/\n/g,yl=/\r/g,_l=/\t/g,wl=typeof Deno<"u"?Deno.build.os==="windows"?"win32":Deno.build.os:void 0,et.URL=typeof URL<"u"?URL:null,et.pathToFileURL=tl,et.fileURLToPath=el,vl=et.Url,El=et.format,Sl=et.resolve,Al=et.resolveObject,Cl=et.parse,Il=et.URL,Tl=92,kl=47,Rl=97,Ol=122,xn=wl==="win32",Pl=/\//g,xl=/%/g,Bl=/\\/g,Nl=/\n/g,Ml=/\r/g,jl=/\t/g}),Xo={};A(Xo,{Server:()=>nt,Socket:()=>nt,Stream:()=>nt,_createServerHandle:()=>nt,_normalizeArgs:()=>nt,_setSimultaneousAccepts:()=>nt,connect:()=>nt,createConnection:()=>nt,createServer:()=>nt,default:()=>Ul,isIP:()=>nt,isIPv4:()=>nt,isIPv6:()=>nt});function nt(){throw new Error("Node.js net module is not supported by JSPM core outside of Node.js")}var Ul,Ll=w(()=>{we(),_e(),M(),Ul={_createServerHandle:nt,_normalizeArgs:nt,_setSimultaneousAccepts:nt,connect:nt,createConnection:nt,createServer:nt,isIP:nt,isIPv4:nt,isIPv6:nt,Server:nt,Socket:nt,Stream:nt}}),Dl=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(e,"__esModule",{value:!0});var r=s((Ll(),V(Xo))),h=s(Zt()),p=(0,h.default)("mqttjs:tcp"),o=(n,a)=>{a.port=a.port||1883,a.hostname=a.hostname||a.host||"localhost";let{port:i,path:c}=a,g=a.hostname;return p("port %d and host %s",i,g),r.default.createConnection({port:i,host:g,path:c})};e.default=o}),Fl={};A(Fl,{default:()=>$l});var $l,zh=w(()=>{we(),_e(),M(),$l={}}),Wl=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(e,"__esModule",{value:!0});var r=s((zh(),V(Fl))),h=s((Ll(),V(Xo))),p=s(Zt()),o=(0,p.default)("mqttjs:tls"),n=(a,i)=>{i.port=i.port||8883,i.host=i.hostname||i.host||"localhost",h.default.isIP(i.host)===0&&(i.servername=i.host),i.rejectUnauthorized=i.rejectUnauthorized!==!1,delete i.path,o("port %d host %s rejectUnauthorized %b",i.port,i.host,i.rejectUnauthorized);let c=r.default.connect(i);c.on("secureConnect",()=>{i.rejectUnauthorized&&!c.authorized?c.emit("error",new Error("TLS not authorized")):c.removeListener("error",g)});function g(y){i.rejectUnauthorized&&a.emit("error",y),c.end()}return c.on("error",g),c};e.default=n}),Zo=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferedDuplex=e.writev=void 0;var s=Ar(),r=(yt(),V(bt));function h(o,n){let a=new Array(o.length);for(let i=0;i<o.length;i++)typeof o[i].chunk=="string"?a[i]=r.Buffer.from(o[i].chunk,"utf8"):a[i]=o[i].chunk;this._write(r.Buffer.concat(a),"binary",n)}e.writev=h;var p=class extends s.Duplex{constructor(o,n,a){super({objectMode:!0}),this.proxy=n,this.socket=a,this.writeQueue=[],o.objectMode||(this._writev=h.bind(this)),this.isSocketOpen=!1,this.proxy.on("data",i=>{this.push(i)})}_read(o){this.proxy.read(o)}_write(o,n,a){this.isSocketOpen?this.writeToProxy(o,n,a):this.writeQueue.push({chunk:o,encoding:n,cb:a})}_final(o){this.writeQueue=[],this.proxy.end(o)}_destroy(o,n){this.writeQueue=[],this.proxy.destroy(),n(o)}socketReady(){this.emit("connect"),this.isSocketOpen=!0,this.processWriteQueue()}writeToProxy(o,n,a){this.proxy.write(o,n)===!1?this.proxy.once("drain",a):a()}processWriteQueue(){for(;this.writeQueue.length>0;){let{chunk:o,encoding:n,cb:a}=this.writeQueue.shift();this.writeToProxy(o,n,a)}}};e.BufferedDuplex=p}),Hl=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=(yt(),V(bt)),r=Ar(),h=Zo(),p,o,n;function a(){let _=new r.Transform;return _._write=(v,S,C)=>{p.send({data:v.buffer,success(){C()},fail(x){C(new Error(x))}})},_._flush=v=>{p.close({success(){v()}})},_}function i(_){_.hostname||(_.hostname="localhost"),_.path||(_.path="/"),_.wsOptions||(_.wsOptions={})}function c(_,v){let S=_.protocol==="wxs"?"wss":"ws",C=`${S}://${_.hostname}${_.path}`;return _.port&&_.port!==80&&_.port!==443&&(C=`${S}://${_.hostname}:${_.port}${_.path}`),typeof _.transformWsUrl=="function"&&(C=_.transformWsUrl(C,_,v)),C}function g(){p.onOpen(()=>{n.socketReady()}),p.onMessage(_=>{let{data:v}=_;v instanceof ArrayBuffer?v=s.Buffer.from(v):v=s.Buffer.from(v,"utf8"),o.push(v)}),p.onClose(()=>{n.emit("close"),n.end(),n.destroy()}),p.onError(_=>{let v=new Error(_.errMsg);n.destroy(v)})}var y=(_,v)=>{if(v.hostname=v.hostname||v.host,!v.hostname)throw new Error("Could not determine host. Specify host manually.");let S=v.protocolId==="MQIsdp"&&v.protocolVersion===3?"mqttv3.1":"mqtt";i(v);let C=c(v,_);p=wx.connectSocket({url:C,protocols:[S]}),o=a(),n=new h.BufferedDuplex(v,o,p),n._destroy=(H,k)=>{p.close({success(){k&&k(H)}})};let x=n.destroy;return n.destroy=(H,k)=>(n.destroy=x,setTimeout(()=>{p.close({fail(){n._destroy(H,k)}})},0),n),g(),n};e.default=y}),ql=E(e=>{we(),_e(),M(),Object.defineProperty(e,"__esModule",{value:!0});var s=(yt(),V(bt)),r=Ar(),h=Zo(),p,o,n,a=!1;function i(){let v=new r.Transform;return v._write=(S,C,x)=>{p.sendSocketMessage({data:S.buffer,success(){x()},fail(){x(new Error)}})},v._flush=S=>{p.closeSocket({success(){S()}})},v}function c(v){v.hostname||(v.hostname="localhost"),v.path||(v.path="/"),v.wsOptions||(v.wsOptions={})}function g(v,S){let C=v.protocol==="alis"?"wss":"ws",x=`${C}://${v.hostname}${v.path}`;return v.port&&v.port!==80&&v.port!==443&&(x=`${C}://${v.hostname}:${v.port}${v.path}`),typeof v.transformWsUrl=="function"&&(x=v.transformWsUrl(x,v,S)),x}function y(){a||(a=!0,p.onSocketOpen(()=>{n.socketReady()}),p.onSocketMessage(v=>{if(typeof v.data=="string"){let S=s.Buffer.from(v.data,"base64");o.push(S)}else{let S=new FileReader;S.addEventListener("load",()=>{let C=S.result;C instanceof ArrayBuffer?C=s.Buffer.from(C):C=s.Buffer.from(C,"utf8"),o.push(C)}),S.readAsArrayBuffer(v.data)}}),p.onSocketClose(()=>{n.end(),n.destroy()}),p.onSocketError(v=>{n.destroy(v)}))}var _=(v,S)=>{if(S.hostname=S.hostname||S.host,!S.hostname)throw new Error("Could not determine host. Specify host manually.");let C=S.protocolId==="MQIsdp"&&S.protocolVersion===3?"mqttv3.1":"mqtt";c(S);let x=g(S,v);return p=S.my,p.connectSocket({url:x,protocols:C}),o=i(),n=new h.BufferedDuplex(S,o,p),y(),n};e.default=_}),Kh=E((e,s)=>{we(),_e(),M(),s.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),Vl=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(H){return H&&H.__esModule?H:{default:H}};Object.defineProperty(e,"__esModule",{value:!0});var r=(yt(),V(bt)),h=s(Kh()),p=s(Zt()),o=Ar(),n=s(Sn()),a=Zo(),i=(0,p.default)("mqttjs:ws"),c=["rejectUnauthorized","ca","cert","key","pfx","passphrase"];function g(H,k){let P=`${H.protocol}://${H.hostname}:${H.port}${H.path}`;return typeof H.transformWsUrl=="function"&&(P=H.transformWsUrl(P,H,k)),P}function y(H){let k=H;return H.port||(H.protocol==="wss"?k.port=443:k.port=80),H.path||(k.path="/"),H.wsOptions||(k.wsOptions={}),!n.default&&H.protocol==="wss"&&c.forEach(P=>{Object.prototype.hasOwnProperty.call(H,P)&&!Object.prototype.hasOwnProperty.call(H.wsOptions,P)&&(k.wsOptions[P]=H[P])}),k}function _(H){let k=y(H);if(k.hostname||(k.hostname=k.host),!k.hostname){if(typeof document>"u")throw new Error("Could not determine host. Specify host manually.");let P=new URL(document.URL);k.hostname=P.hostname,k.port||(k.port=Number(P.port))}return k.objectMode===void 0&&(k.objectMode=!(k.binary===!0||k.binary===void 0)),k}function v(H,k,P){i("createWebSocket"),i(`protocol: ${P.protocolId} ${P.protocolVersion}`);let K=P.protocolId==="MQIsdp"&&P.protocolVersion===3?"mqttv3.1":"mqtt";i(`creating new Websocket for url: ${k} and protocol: ${K}`);let Q;return P.createWebsocket?Q=P.createWebsocket(k,[K],P):Q=new h.default(k,[K],P.wsOptions),Q}function S(H,k){let P=k.protocolId==="MQIsdp"&&k.protocolVersion===3?"mqttv3.1":"mqtt",K=g(k,H),Q;return k.createWebsocket?Q=k.createWebsocket(K,[P],k):Q=new WebSocket(K,[P]),Q.binaryType="arraybuffer",Q}var C=(H,k)=>{i("streamBuilder");let P=y(k);P.hostname=P.hostname||P.host||"localhost";let K=g(P,H),Q=v(H,K,P),j=h.default.createWebSocketStream(Q,P.wsOptions);return j.url=K,Q.on("close",()=>{j.destroy()}),j},x=(H,k)=>{i("browserStreamBuilder");let P,K=_(k).browserBufferSize||1024*512,Q=k.browserBufferTimeout||1e3,j=!k.objectMode,N=S(H,k),$=ae(k,ie,ke);k.objectMode||($._writev=a.writev.bind($)),$.on("close",()=>{N.close()});let X=typeof N.addEventListener<"u";N.readyState===N.OPEN?(P=$,P.socket=N):(P=new a.BufferedDuplex(k,$,N),X?N.addEventListener("open",pe):N.onopen=pe),X?(N.addEventListener("close",O),N.addEventListener("error",te),N.addEventListener("message",de)):(N.onclose=O,N.onerror=te,N.onmessage=de);function ae(ye,ee,Oe){let be=new o.Transform({objectMode:ye.objectMode});return be._write=ee,be._flush=Oe,be}function pe(){i("WebSocket onOpen"),P instanceof a.BufferedDuplex&&P.socketReady()}function O(ye){i("WebSocket onClose",ye),P.end(),P.destroy()}function te(ye){i("WebSocket onError",ye);let ee=new Error("WebSocket error");ee.event=ye,P.destroy(ee)}function de(ye){let{data:ee}=ye;ee instanceof ArrayBuffer?ee=r.Buffer.from(ee):ee=r.Buffer.from(ee,"utf8"),$.push(ee)}function ie(ye,ee,Oe){if(N.bufferedAmount>K){setTimeout(ie,Q,ye,ee,Oe);return}j&&typeof ye=="string"&&(ye=r.Buffer.from(ye,"utf8"));try{N.send(ye)}catch(be){return Oe(be)}Oe()}function ke(ye){N.close(),ye()}return P};e.default=n.default?x:C}),Jh=E(e=>{we(),_e(),M();var s=e&&e.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(e,"__esModule",{value:!0}),e.connectAsync=void 0;var r=s(Zt()),h=s((Vh(),V(Za))),p=s(Uo()),o=s(Sn());typeof(Re==null?void 0:Re.nextTick)!="function"&&(Re.nextTick=setImmediate);var n=(0,r.default)("mqttjs"),a={};o.default?(a.wx=Hl().default,a.wxs=Hl().default,a.ali=ql().default,a.alis=ql().default):(a.mqtt=Dl().default,a.tcp=Dl().default,a.ssl=Wl().default,a.tls=a.ssl,a.mqtts=Wl().default),a.ws=Vl().default,a.wss=Vl().default;function i(y){let _;y.auth&&(_=y.auth.match(/^(.+):(.+)$/),_?(y.username=_[1],y.password=_[2]):y.username=y.auth)}function c(y,_){var v,S,C;if(n("connecting to an MQTT broker..."),typeof y=="object"&&!_&&(_=y,y=""),_=_||{},y&&typeof y=="string"){let k=h.default.parse(y,!0),P={};if(k.port!=null&&(P.port=Number(k.port)),P.host=k.hostname,P.query=k.query,P.auth=k.auth,P.protocol=k.protocol,P.path=k.path,P.protocol=(v=P.protocol)===null||v===void 0?void 0:v.replace(/:$/,""),_=Object.assign(Object.assign({},P),_),!_.protocol)throw new Error("Missing protocol")}if(_.unixSocket=_.unixSocket||((S=_.protocol)===null||S===void 0?void 0:S.includes("+unix")),_.unixSocket?_.protocol=_.protocol.replace("+unix",""):!((C=_.protocol)===null||C===void 0)&&C.startsWith("ws")||delete _.path,i(_),_.query&&typeof _.query.clientId=="string"&&(_.clientId=_.query.clientId),_.cert&&_.key)if(_.protocol){if(["mqtts","wss","wxs","alis"].indexOf(_.protocol)===-1)switch(_.protocol){case"mqtt":_.protocol="mqtts";break;case"ws":_.protocol="wss";break;case"wx":_.protocol="wxs";break;case"ali":_.protocol="alis";break;default:throw new Error(`Unknown protocol for secure connection: "${_.protocol}"!`)}}else throw new Error("Missing secure protocol key");if(!a[_.protocol]){let k=["mqtts","wss"].indexOf(_.protocol)!==-1;_.protocol=["mqtt","mqtts","ws","wss","wx","wxs","ali","alis"].filter((P,K)=>k&&K%2===0?!1:typeof a[P]=="function")[0]}if(_.clean===!1&&!_.clientId)throw new Error("Missing clientId for unclean clients");_.protocol&&(_.defaultProtocol=_.protocol);function x(k){return _.servers&&((!k._reconnectCount||k._reconnectCount===_.servers.length)&&(k._reconnectCount=0),_.host=_.servers[k._reconnectCount].host,_.port=_.servers[k._reconnectCount].port,_.protocol=_.servers[k._reconnectCount].protocol?_.servers[k._reconnectCount].protocol:_.defaultProtocol,_.hostname=_.host,k._reconnectCount++),n("calling streambuilder for",_.protocol),a[_.protocol](k,_)}let H=new p.default(x,_);return H.on("error",()=>{}),H}function g(y,_,v=!0){return new Promise((S,C)=>{let x=c(y,_),H={connect:P=>{k(),S(x)},end:()=>{k(),S(x)},error:P=>{k(),x.end(),C(P)}};v===!1&&(H.close=()=>{H.error(new Error("Couldn't connect to server"))});function k(){Object.keys(H).forEach(P=>{x.off(P,H[P])})}Object.keys(H).forEach(P=>{x.on(P,H[P])})})}e.connectAsync=g,e.default=c}),zl=E(e=>{we(),_e(),M();var s=e&&e.__createBinding||(Object.create?function(v,S,C,x){x===void 0&&(x=C);var H=Object.getOwnPropertyDescriptor(S,C);(!H||("get"in H?!S.__esModule:H.writable||H.configurable))&&(H={enumerable:!0,get:function(){return S[C]}}),Object.defineProperty(v,x,H)}:function(v,S,C,x){x===void 0&&(x=C),v[x]=S[C]}),r=e&&e.__setModuleDefault||(Object.create?function(v,S){Object.defineProperty(v,"default",{enumerable:!0,value:S})}:function(v,S){v.default=S}),h=e&&e.__importStar||function(v){if(v&&v.__esModule)return v;var S={};if(v!=null)for(var C in v)C!=="default"&&Object.prototype.hasOwnProperty.call(v,C)&&s(S,v,C);return r(S,v),S},p=e&&e.__exportStar||function(v,S){for(var C in v)C!=="default"&&!Object.prototype.hasOwnProperty.call(S,C)&&s(S,v,C)},o=e&&e.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(e,"__esModule",{value:!0}),e.ReasonCodes=e.KeepaliveManager=e.UniqueMessageIdProvider=e.DefaultMessageIdProvider=e.Store=e.MqttClient=e.connectAsync=e.connect=e.Client=void 0;var n=o(Uo());e.MqttClient=n.default;var a=o(Pa());e.DefaultMessageIdProvider=a.default;var i=o(Rh());e.UniqueMessageIdProvider=i.default;var c=o(xa());e.Store=c.default;var g=h(Jh());e.connect=g.default,Object.defineProperty(e,"connectAsync",{enumerable:!0,get:function(){return g.connectAsync}});var y=o(Da());e.KeepaliveManager=y.default,e.Client=n.default,p(Uo(),e),p(Xr(),e);var _=En();Object.defineProperty(e,"ReasonCodes",{enumerable:!0,get:function(){return _.ReasonCodes}})}),Qh=E(e=>{we(),_e(),M();var s=e&&e.__createBinding||(Object.create?function(n,a,i,c){c===void 0&&(c=i);var g=Object.getOwnPropertyDescriptor(a,i);(!g||("get"in g?!a.__esModule:g.writable||g.configurable))&&(g={enumerable:!0,get:function(){return a[i]}}),Object.defineProperty(n,c,g)}:function(n,a,i,c){c===void 0&&(c=i),n[c]=a[i]}),r=e&&e.__setModuleDefault||(Object.create?function(n,a){Object.defineProperty(n,"default",{enumerable:!0,value:a})}:function(n,a){n.default=a}),h=e&&e.__importStar||function(n){if(n&&n.__esModule)return n;var a={};if(n!=null)for(var i in n)i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)&&s(a,n,i);return r(a,n),a},p=e&&e.__exportStar||function(n,a){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&s(a,n,i)};Object.defineProperty(e,"__esModule",{value:!0});var o=h(zl());e.default=o,p(zl(),e)});return Qh()})();class vp{constructor(t,l,m){Be(this,"client");Be(this,"clientId");Be(this,"messageHandlers",[]);Be(this,"closeHandlers",[t=>console.log("mqtt disconnected: "+t)]);this.serverUrl=t,this.crisEndpoint=l,this.mqttTopic=m,this.clientId="od-watcher-"+crypto.randomUUID()}async startListeningAsync(t){const l={},m=t.map(async w=>{const E=new Vn(this.clientId,w.domainName,w.transactionCount),A=await this.crisEndpoint.sendOrThrowAsync(E);A?l[w.domainName]=JSON.parse(A):(console.warn(`Domain ${w.domainName} doesn't exists.`),l[w.domainName]="")});return await Promise.all(m),l}async startAsync(){try{return console.log(`connecting to mqtt with client id ${this.clientId}...`),this.client=await wp.connectAsync(this.serverUrl,{clean:!0,clientId:this.clientId}),this.client.on("message",(t,l,m)=>this.handleMessages(t,l,m)),this.client.on("disconnect",t=>this.handleClose(void 0)),console.log("connected"),!0}catch(t){return console.log("not connected"),console.error(t),!1}}handleMessages(t,l,m){if(console.log("Received MQTT message."),!t.startsWith(this.mqttTopic))return;const w=l.readInt32LE(),E=l.toString("utf-8",4,w+4),A=l.readInt32LE(4+w),W=l.toString("utf-8",8+w,8+w+A);this.messageHandlers.forEach(V=>{V(E,JSON.parse(W))})}handleClose(t){this.closeHandlers.forEach(l=>{l(t)})}onMessage(t){this.messageHandlers.push(t)}onClose(t){this.closeHandlers.push(t)}stopAsync(){return this.client.endAsync(!0)}}function mc(u,t){const{prefix:l,activator:m}=Object.assign({prefix:"~$£€"},t),w=l+">",E=l+"°",A=l+"þ";let W=null,V=null;const se=new Array;function M(xe,Ce){let Ve=null;if(Ce instanceof Array)if(Ce.length>0&&Ce[0]!=null&&(Ve=Ce[0][A])!==void 0){switch(Ce.splice(0,1),Ve[1]){case"A":break;case"M":Ce=Object.assign(new Map,{v:Ce});break;case"S":Ce=Object.assign(new Set,{v:Ce});break;default:throw new Error("Expecting typed array to be 'A', 'M' or 'S'.")}se[Ve[0]]=Ce}else V===null&&(V=new Set),V.add(Ce);else if(Ce!==null){const Fe=Ce[E];Fe!==void 0?(delete Ce[E],(Ve=Ce[A])!==void 0&&(delete Ce[A],m&&(Ce=m(Ce,Ve),Ce&&(W===null&&(W=new Set),W.add(Ce)))),se[Fe]=Ce):(V===null&&(V=new Set),V.add(Ce))}return Ce}function Re(xe){if(xe){if(xe instanceof Array)for(let Ce=0;Ce<xe.length;++Ce){const Ve=xe[Ce];Re(Ve),xe[Ce]=M(Ce,Ve)}else if(typeof xe=="object")for(const Ce in xe){const Ve=xe[Ce];Re(Ve),xe[Ce]=M(Ce,Ve)}}return xe}const Ye=typeof u=="string"?JSON.parse(u,M):M(void 0,Re(u));function Je(xe,Ce){const Ve=Ce.length;for(let Fe=0;Fe<Ve;++Fe){const vt=Ce[Fe];if(vt){const Xe=vt[w];Xe!==void 0&&(Ce[Fe]=xe[Xe])}}}for(let xe of se)if(W===null||!W.has(xe))if(xe instanceof Array)Je(se,xe);else if(xe instanceof Map)xe.v.forEach(Ce=>Je(se,Ce)),xe.v.forEach(Ce=>xe.set(Ce[0],Ce[1])),delete xe.v;else if(xe instanceof Set)Je(se,xe.v),xe.v.forEach(Ce=>xe.add(Ce)),delete xe.v;else for(const Ce in xe){const Ve=xe[Ce];if(Ve!==null){const Fe=Ve[w];Fe!==void 0&&(xe[Ce]=se[Fe])}}if(V!==null)for(let xe of V)if(xe instanceof Array)Je(se,xe);else for(const Ce in xe){const Ve=xe[Ce];if(Ve!==null){const Fe=Ve[w];Fe!==void 0&&(xe[Ce]=se[Fe])}}return Ye}class pr{constructor(t){Be(this,"_props");Be(this,"_tranNum");Be(this,"_objCount");Be(this,"_graph");Be(this,"_roots");Be(this,"_isInitialExport");if(this._isInitialExport=!0,t===void 0)this._props=[],this._tranNum=0,this._objCount=0,this._graph=[],this._roots=[];else{const l=typeof t=="string"?mc(t,{prefix:""}):t;this._props=l.P,this._tranNum=l.N,this._objCount=l.C,this._graph=l.O,this._roots=l.R.map(m=>this._graph[m])}}get transactionNumber(){return this._tranNum}get allObjectsCount(){return this._objCount}get allObjects(){function*t(l){for(const m of l)m!==null&&(yield m)}return t(this._graph)}get roots(){return this._roots}static isTransactionSetEvent(t){return t===""?!1:"E"in t}static isDomainExportEvent(t){return t===""?!1:"P"in t}static isErrorEvent(t){return t===""?!1:"Error"in t}applyWatchEvent(t){if(t===""){this._props.length=0,this._objCount=0,this._graph.length=0,this._roots.length=0,console.warn("Empty OD watch event.");return}if(t=mc(t,{prefix:""}),pr.isTransactionSetEvent(t)){const l=t.N-t.E.length+1;if(t.L)if(t.L!==this._tranNum)if(this._tranNum>t.L&&this._tranNum<t.N&&this._isInitialExport)console.warn(`Event claims last event was TN ${t.L}, current TN is ${this._tranNum}. Accepting partial event.`),this._tranNum=l-1;else throw new Error(`Event claims last event was TN ${t.L}, current TN is ${this._tranNum}`);else this._tranNum=l-1;for(let m=0;m<t.E.length;m++)this.applyEvent(l+m,t.E[m])}else if(pr.isDomainExportEvent(t))this.applyDomainExport(t);else throw t===""?new Error("The watch event received is empty. The domain doesn't exist (or has been destroyed)."):pr.isErrorEvent(t)?new Error("Domain error: "+t.Error):new Error("Unknown WatchEvent: "+JSON.stringify(t,void 0,4))}applyDomainExport(t){this._props.splice(0,this._props.length);for(let l=0;l<t.P.length;l++)this._props.push(t.P[l]);this._tranNum=t.N,this._objCount=t.C,this._graph.splice(0,this._graph.length);for(let l=0;l<t.O.length;l++)this._graph.push(t.O[l]);this._roots.splice(0,this._roots.length);for(let l=0;l<t.R.length;l++)this._roots.push(this._graph[t.R[l]]);this._isInitialExport=!0}applyEvent(t,l){if(this._tranNum+1!==t)throw new Error(`Invalid transaction number. Expected: ${this._tranNum+1}, got ${t}.`);const m=new Set,w=l;for(let E=0;E<w.length;++E){const A=w[E];switch(A[0]){case"N":{let V;switch(A[2]){case"":V={};break;case"A":V=[];break;case"M":V=new Map;break;case"S":V=new Set;break;default:throw new Error(`Unexpected Object type; ${A[2]}. Must be A, M, S or empty string.`)}m.delete(A[1]),this._graph[A[1]]=V,this._objCount++;break}case"D":{m.add(A[1]),this._objCount--;break}case"P":{if(A[2]!=this._props.length)throw new Error(`Invalid property creation event for '${A[1]}': index must be ${this._props.length}, got ${A[2]}.`);this._props.push(A[1]);break}case"C":{this._graph[A[1]][this._props[A[2]]]=this.getValue(A[3]);break}case"I":{const V=this._graph[A[1]],se=A[2],M=this.getValue(A[3]);se===V.length?V[se]=M:V.splice(se,0,M);break}case"CL":{const V=this._graph[A[1]];V instanceof Array?V.length=0:V.clear();break}case"R":{this._graph[A[1]].splice(A[2],1);break}case"S":{this._graph[A[1]].splice(A[2],1,this.getValue(A[3]));break}case"K":{this._graph[A[1]].delete(this.getValue(A[2]));break}case"M":{this._graph[A[1]].set(this.getValue(A[2]),this.getValue(A[3]));break}case"A":{this._graph[A[1]].add(this.getValue(A[2]));break}default:throw new Error(`Unexpected Event code: '${A[0]}'.`)}}m.forEach(E=>this._graph[E]=null),this._tranNum=t,this._isInitialExport=!1}getValue(t){if(t!=null){var l=t["="];if(l!==void 0)return this._graph[l]}return t}}var vs=function(u,t){return vs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,m){l.__proto__=m}||function(l,m){for(var w in m)Object.prototype.hasOwnProperty.call(m,w)&&(l[w]=m[w])},vs(u,t)};function cn(u,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");vs(u,t);function l(){this.constructor=u}u.prototype=t===null?Object.create(t):(l.prototype=t.prototype,new l)}function Es(u){var t=typeof Symbol=="function"&&Symbol.iterator,l=t&&u[t],m=0;if(l)return l.call(u);if(u&&typeof u.length=="number")return{next:function(){return u&&m>=u.length&&(u=void 0),{value:u&&u[m++],done:!u}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ss(u,t){var l=typeof Symbol=="function"&&u[Symbol.iterator];if(!l)return u;var m=l.call(u),w,E=[],A;try{for(;(t===void 0||t-- >0)&&!(w=m.next()).done;)E.push(w.value)}catch(W){A={error:W}}finally{try{w&&!w.done&&(l=m.return)&&l.call(m)}finally{if(A)throw A.error}}return E}function As(u,t,l){if(l||arguments.length===2)for(var m=0,w=t.length,E;m<w;m++)(E||!(m in t))&&(E||(E=Array.prototype.slice.call(t,0,m)),E[m]=t[m]);return u.concat(E||Array.prototype.slice.call(t))}function sr(u){return typeof u=="function"}function su(u){var t=function(m){Error.call(m),m.stack=new Error().stack},l=u(t);return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}var os=su(function(u){return function(l){u(this),this.message=l?l.length+` errors occurred during unsubscription:
`+l.map(function(m,w){return w+1+") "+m.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=l}});function Cs(u,t){if(u){var l=u.indexOf(t);0<=l&&u.splice(l,1)}}var hi=function(){function u(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return u.prototype.unsubscribe=function(){var t,l,m,w,E;if(!this.closed){this.closed=!0;var A=this._parentage;if(A)if(this._parentage=null,Array.isArray(A))try{for(var W=Es(A),V=W.next();!V.done;V=W.next()){var se=V.value;se.remove(this)}}catch(Ce){t={error:Ce}}finally{try{V&&!V.done&&(l=W.return)&&l.call(W)}finally{if(t)throw t.error}}else A.remove(this);var M=this.initialTeardown;if(sr(M))try{M()}catch(Ce){E=Ce instanceof os?Ce.errors:[Ce]}var Re=this._finalizers;if(Re){this._finalizers=null;try{for(var Ye=Es(Re),Je=Ye.next();!Je.done;Je=Ye.next()){var xe=Je.value;try{bc(xe)}catch(Ce){E=E??[],Ce instanceof os?E=As(As([],Ss(E)),Ss(Ce.errors)):E.push(Ce)}}}catch(Ce){m={error:Ce}}finally{try{Je&&!Je.done&&(w=Ye.return)&&w.call(Ye)}finally{if(m)throw m.error}}}if(E)throw new os(E)}},u.prototype.add=function(t){var l;if(t&&t!==this)if(this.closed)bc(t);else{if(t instanceof u){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(l=this._finalizers)!==null&&l!==void 0?l:[]).push(t)}},u.prototype._hasParent=function(t){var l=this._parentage;return l===t||Array.isArray(l)&&l.includes(t)},u.prototype._addParent=function(t){var l=this._parentage;this._parentage=Array.isArray(l)?(l.push(t),l):l?[l,t]:t},u.prototype._removeParent=function(t){var l=this._parentage;l===t?this._parentage=null:Array.isArray(l)&&Cs(l,t)},u.prototype.remove=function(t){var l=this._finalizers;l&&Cs(l,t),t instanceof u&&t._removeParent(this)},u.EMPTY=function(){var t=new u;return t.closed=!0,t}(),u}(),au=hi.EMPTY;function lu(u){return u instanceof hi||u&&"closed"in u&&sr(u.remove)&&sr(u.add)&&sr(u.unsubscribe)}function bc(u){sr(u)?u():u.unsubscribe()}var cu={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},uu={setTimeout:function(u,t){for(var l=[],m=2;m<arguments.length;m++)l[m-2]=arguments[m];return setTimeout.apply(void 0,As([u,t],Ss(l)))},clearTimeout:function(u){var t=uu.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(u)},delegate:void 0};function Ep(u){uu.setTimeout(function(){throw u})}function yc(){}function Fn(u){u()}var hu=function(u){cn(t,u);function t(l){var m=u.call(this)||this;return m.isStopped=!1,l?(m.destination=l,lu(l)&&l.add(m)):m.destination=Ip,m}return t.create=function(l,m,w){return new Is(l,m,w)},t.prototype.next=function(l){this.isStopped||this._next(l)},t.prototype.error=function(l){this.isStopped||(this.isStopped=!0,this._error(l))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,u.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(l){this.destination.next(l)},t.prototype._error=function(l){try{this.destination.error(l)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(hi),Sp=Function.prototype.bind;function ss(u,t){return Sp.call(u,t)}var Ap=function(){function u(t){this.partialObserver=t}return u.prototype.next=function(t){var l=this.partialObserver;if(l.next)try{l.next(t)}catch(m){Mn(m)}},u.prototype.error=function(t){var l=this.partialObserver;if(l.error)try{l.error(t)}catch(m){Mn(m)}else Mn(t)},u.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(l){Mn(l)}},u}(),Is=function(u){cn(t,u);function t(l,m,w){var E=u.call(this)||this,A;if(sr(l)||!l)A={next:l??void 0,error:m??void 0,complete:w??void 0};else{var W;E&&cu.useDeprecatedNextContext?(W=Object.create(l),W.unsubscribe=function(){return E.unsubscribe()},A={next:l.next&&ss(l.next,W),error:l.error&&ss(l.error,W),complete:l.complete&&ss(l.complete,W)}):A=l}return E.destination=new Ap(A),E}return t}(hu);function Mn(u){Ep(u)}function Cp(u){throw u}var Ip={closed:!0,next:yc,error:Cp,complete:yc},Tp=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function kp(u){return u}function Rp(u){return u.length===0?kp:u.length===1?u[0]:function(l){return u.reduce(function(m,w){return w(m)},l)}}var _c=function(){function u(t){t&&(this._subscribe=t)}return u.prototype.lift=function(t){var l=new u;return l.source=this,l.operator=t,l},u.prototype.subscribe=function(t,l,m){var w=this,E=Pp(t)?t:new Is(t,l,m);return Fn(function(){var A=w,W=A.operator,V=A.source;E.add(W?W.call(E,V):V?w._subscribe(E):w._trySubscribe(E))}),E},u.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(l){t.error(l)}},u.prototype.forEach=function(t,l){var m=this;return l=wc(l),new l(function(w,E){var A=new Is({next:function(W){try{t(W)}catch(V){E(V),A.unsubscribe()}},error:E,complete:w});m.subscribe(A)})},u.prototype._subscribe=function(t){var l;return(l=this.source)===null||l===void 0?void 0:l.subscribe(t)},u.prototype[Tp]=function(){return this},u.prototype.pipe=function(){for(var t=[],l=0;l<arguments.length;l++)t[l]=arguments[l];return Rp(t)(this)},u.prototype.toPromise=function(t){var l=this;return t=wc(t),new t(function(m,w){var E;l.subscribe(function(A){return E=A},function(A){return w(A)},function(){return m(E)})})},u.create=function(t){return new u(t)},u}();function wc(u){var t;return(t=u??cu.Promise)!==null&&t!==void 0?t:Promise}function Op(u){return u&&sr(u.next)&&sr(u.error)&&sr(u.complete)}function Pp(u){return u&&u instanceof hu||Op(u)&&lu(u)}var xp=su(function(u){return function(){u(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),fu=function(u){cn(t,u);function t(){var l=u.call(this)||this;return l.closed=!1,l.currentObservers=null,l.observers=[],l.isStopped=!1,l.hasError=!1,l.thrownError=null,l}return t.prototype.lift=function(l){var m=new vc(this,this);return m.operator=l,m},t.prototype._throwIfClosed=function(){if(this.closed)throw new xp},t.prototype.next=function(l){var m=this;Fn(function(){var w,E;if(m._throwIfClosed(),!m.isStopped){m.currentObservers||(m.currentObservers=Array.from(m.observers));try{for(var A=Es(m.currentObservers),W=A.next();!W.done;W=A.next()){var V=W.value;V.next(l)}}catch(se){w={error:se}}finally{try{W&&!W.done&&(E=A.return)&&E.call(A)}finally{if(w)throw w.error}}}})},t.prototype.error=function(l){var m=this;Fn(function(){if(m._throwIfClosed(),!m.isStopped){m.hasError=m.isStopped=!0,m.thrownError=l;for(var w=m.observers;w.length;)w.shift().error(l)}})},t.prototype.complete=function(){var l=this;Fn(function(){if(l._throwIfClosed(),!l.isStopped){l.isStopped=!0;for(var m=l.observers;m.length;)m.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var l;return((l=this.observers)===null||l===void 0?void 0:l.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(l){return this._throwIfClosed(),u.prototype._trySubscribe.call(this,l)},t.prototype._subscribe=function(l){return this._throwIfClosed(),this._checkFinalizedStatuses(l),this._innerSubscribe(l)},t.prototype._innerSubscribe=function(l){var m=this,w=this,E=w.hasError,A=w.isStopped,W=w.observers;return E||A?au:(this.currentObservers=null,W.push(l),new hi(function(){m.currentObservers=null,Cs(W,l)}))},t.prototype._checkFinalizedStatuses=function(l){var m=this,w=m.hasError,E=m.thrownError,A=m.isStopped;w?l.error(E):A&&l.complete()},t.prototype.asObservable=function(){var l=new _c;return l.source=this,l},t.create=function(l,m){return new vc(l,m)},t}(_c),vc=function(u){cn(t,u);function t(l,m){var w=u.call(this)||this;return w.destination=l,w.source=m,w}return t.prototype.next=function(l){var m,w;(w=(m=this.destination)===null||m===void 0?void 0:m.next)===null||w===void 0||w.call(m,l)},t.prototype.error=function(l){var m,w;(w=(m=this.destination)===null||m===void 0?void 0:m.error)===null||w===void 0||w.call(m,l)},t.prototype.complete=function(){var l,m;(m=(l=this.destination)===null||l===void 0?void 0:l.complete)===null||m===void 0||m.call(l)},t.prototype._subscribe=function(l){var m,w;return(w=(m=this.source)===null||m===void 0?void 0:m.subscribe(l))!==null&&w!==void 0?w:au},t}(fu),Ec=function(u){cn(t,u);function t(l){var m=u.call(this)||this;return m._value=l,m}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(l){var m=u.prototype._subscribe.call(this,l);return!m.closed&&l.next(this._value),m},t.prototype.getValue=function(){var l=this,m=l.hasError,w=l.thrownError,E=l._value;if(m)throw w;return this._throwIfClosed(),E},t.prototype.next=function(l){u.prototype.next.call(this,this._value=l)},t}(fu);class Sc{constructor(t){Be(this,"connectionState",new Ec(0));Be(this,"connectionState$",this.connectionState.asObservable());Be(this,"stopping",!1);Be(this,"buffering",!1);Be(this,"bufferedEvents",[]);Be(this,"onCloseHandler");Be(this,"domains",{});Be(this,"onClose",t=>{this.onCloseHandler!=null&&this.onCloseHandler(t)});Be(this,"onMessage",(t,l)=>{const m=this.domains[t];if(m===void 0){console.log(`Received event for unknown domain ${t}, ignoring this event.`);return}if(this.buffering){console.log("OD Client is starting, buffering an event for "+t),this.bufferedEvents.push({domainName:t,watchEvent:l});return}try{if(pr.isTransactionSetEvent(l)){if(l.N<=m.domain.transactionNumber){console.warn(`Ignoring received past event. Current TN: ${m.domain.transactionNumber}. New TN: ${l.N}`);return}console.log(`Received OD event for domain ${t}. Current TN: ${m.domain.transactionNumber}. New TN: ${l.N}`)}else pr.isDomainExportEvent(l)&&console.log(`Received domain export for domain ${t}. New TN: ${l.N}`);m.domain.applyWatchEvent(l),m.obs.next(m.domain.roots)}catch(w){console.error(w),m.domain=new pr,this.driver.stopAsync();return}});this.driver=t,this.driver.onMessage(this.onMessage),this.driver.onClose(this.onClose)}get domainsRoots(){const t={};return Object.keys(this.domains).forEach(l=>{t[l]=this.domains[l].domain.roots}),t}start(){this.loopReconnectAsync()}async listenToDomainAsync(t){if(this.domains[t]===void 0){const l=new pr,m=new Ec(l.roots);if(this.domains[t]={domain:l,obs:m},this.connectionState.value!=0){const w=(await this.driver.startListeningAsync([{domainName:t,transactionCount:0}]))[t];l.applyWatchEvent(w)}}return this.domains[t].obs}async loopReconnectAsync(){for(;!this.stopping;)try{if(this.buffering=!0,this.bufferedEvents=[],!await this.driver.startAsync())continue;this.connectionState.next(2);const t=await this.driver.startListeningAsync(Object.keys(this.domains).map(l=>{var m;return{domainName:l,transactionCount:((m=this.domains[l])==null?void 0:m.domain.transactionNumber)??0}}));this.buffering=!1,Object.keys(t).forEach(l=>{this.onMessage(l,t[l]);const m=this.domains[l];console.log(`Domain ${l}: ${m.domain.allObjectsCount} objects. ${m.domain.roots.length} root(s). Current Transaction Number: ${m.domain.transactionNumber}`)});for(const l of this.bufferedEvents)this.onMessage(l.domainName,l.watchEvent);this.connectionState.next(1),await new Promise(l=>{this.onCloseHandler=m=>{m!=null?console.log("OD driver Disconnected due to : "+m):console.log("OD driver Disconnected for an unknown reason"),l()}})}catch(t){console.error("Error in OD reconnect loop:",t)}finally{this.connectionState.next(0),this.driver.stopAsync()}}async stopAsync(){this.stopping=!0,await this.driver.stopAsync(),this.connectionState.complete()}}const Bp=ut.create(),Ts=new xd(Bp,"http://localhost:5000/.cris");(async function(){const u=new vp("ws://localhost:8080/mqtt/",Ts,"CK-OD"),t=new gs("http://localhost:5000/hub/league",Ts),l=new Sc(u);l.start();const m=new Sc(t);m.start();const w=await l.listenToDomainAsync("Test-Domain"),E=await m.listenToDomainAsync("Test-Domain"),A=document.getElementById("slider-left"),W=document.getElementById("slider-right");w.forEach(V=>{V.length<1||(console.log("Mqtt value: "+V[0].Slider),A.value=V[0].Slider)}),E.forEach(V=>{V.length<1||(console.log("SignalR value: "+V[0].Slider),W.value=V[0].Slider)})})();async function Np(u){await Ts.sendOrThrowAsync(new qn(u))}window.sliderUpdate=Np;
